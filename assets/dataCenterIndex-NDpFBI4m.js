var t=Object.defineProperty,e=(e,n,i)=>(((e,n,i)=>{n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i})(e,"symbol"!=typeof n?n+"":n,i),i);import{e as n,d as i,f as r,g as o,h as s,i as a,j as l,k as u,l as h,n as c,o as d,p,q as f,r as g,s as m,t as _,v as y,w as v,x as w,y as x,z as b,c as C,u as S,A as E,M as I,a as P}from"./searchStore-FZYi4-DB.js";import{g as T,c as k,Q as D,R as M,U as L,V as R,W as O,X as F,Y as A,Z as z,$ as B,a0 as j,a1 as G,a2 as N,a3 as V,a4 as H,a5 as W,a6 as X,a7 as U,a8 as $,a9 as Y,M as q,aa as Z,ab as K,d as J,_ as Q,o as tt,h as et,x as nt,y as it,i as rt,t as ot,a as st,ac as at,v as lt,w as ut,ad as ht,r as ct,ae as dt,af as pt,ag as ft,l as gt,ah as mt,ai as _t,b as yt,H as vt,aj as wt,I as xt,s as bt,ak as Ct,F as St,k as Et,j as It,m as Pt,A as Tt,D as kt,al as Dt,am as Mt,e as Lt,n as Rt,q as Ot,an as Ft,ao as At,ap as zt,aq as Bt,ar as jt,as as Gt,at as Nt,u as Vt,B as Ht,P as Wt,au as Xt,av as Ut,aw as $t}from"./index-BqHiQ-nG.js";let Yt=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+=(e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_"),"");const qt=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Zt="propertychange";const Kt=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function Jt(t,e){return t>e?1:t<e?-1:0}function Qt(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if("function"==typeof n){for(let r=1;r<i;++r){const i=t[r];if(i===e)return r;if(i<e)return n(e,t[r-1],i)>0?r-1:r}return i-1}if(n>0){for(let n=1;n<i;++n)if(t[n]<e)return n-1;return i-1}if(n<0){for(let n=1;n<i;++n)if(t[n]<=e)return n;return i-1}for(let r=1;r<i;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return i-1}function te(t,e,n){for(;e<n;){const i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function ee(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let r=0;r<i;r++)t[t.length]=n[r]}function ne(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function ie(){return!0}function re(){return!1}function oe(){}function se(t){let e,n,i,r=!1;return function(){const o=Array.prototype.slice.call(arguments);return r&&this===i&&ne(o,n)||(r=!0,i=this,n=o,e=t.apply(this,arguments)),e}}function ae(t){return function(){let e;try{e=t()}catch(n){return Promise.reject(n)}return e instanceof Promise?e:Promise.resolve(e)}()}function le(t){for(const e in t)delete t[e]}function ue(t){let e;for(e in t)return!1;return!e}const he=class extends Kt{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),i=n[t]||(n[t]=[]);i.includes(e)||i.push(e)}dispatchEvent(t){const e="string"==typeof t,n=e?t:t.type,i=this.listeners_&&this.listeners_[n];if(!i)return;const r=e?new qt(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});let a;n in o||(o[n]=0,s[n]=0),++o[n];for(let l=0,u=i.length;l<u;++l)if(a="handleEvent"in i[l]?i[l].handleEvent(r):i[l].call(this,r),!1===a||r.propagationStopped){a=!1;break}if(0==--o[n]){let t=s[n];for(delete s[n];t--;)this.removeEventListener(n,oe);delete o[n]}return a}disposeInternal(){this.listeners_&&le(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const i=n.indexOf(e);-1!==i&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=oe,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},ce="change",de="error",pe="contextmenu",fe="click",ge="dblclick",me="keydown",_e="keypress",ye="load",ve="touchmove",we="wheel";function xe(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){const i=n;n=function(){t.removeEventListener(e,n),i.apply(this,arguments)}}const o={target:t,type:e,listener:n};return t.addEventListener(e,n),o}function be(t,e,n,i){return xe(t,e,n,i,!0)}function Ce(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),le(t))}class Se extends he{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ce)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=xe(this,t[r],e);return i}return xe(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const i=t.length;n=new Array(i);for(let r=0;r<i;++r)n[r]=be(this,t[r],e)}else n=be(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Ce(t[e]);else Ce(t)}(n);else if(Array.isArray(t))for(let i=0,r=t.length;i<r;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}Se.prototype.on,Se.prototype.once,Se.prototype.un;const Ee=Se;function Ie(){throw new Error("Unimplemented abstract method.")}let Pe=0;function Te(t){return t.ol_uid||(t.ol_uid=String(++Pe))}class ke extends qt{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const De=class extends Ee{constructor(t){super(),this.on,this.once,this.un,Te(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new ke(n,t,e)),n=Zt,this.hasListener(n)&&this.dispatchEvent(new ke(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const i=this.values_||(this.values_={});if(n)i[t]=e;else{const n=i[t];i[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],ue(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},Me="add",Le="remove",Re="length";class Oe extends qt{constructor(t,e,n){super(t),this.element=e,this.index=n}}const Fe=class extends De{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,i=this.array_.length;n<i;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Re)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Oe(Me,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Oe(Le,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Oe(Le,n,t)),this.dispatchEvent(new Oe(Me,e,t))}updateLength_(){this.set(Re,this.array_.length)}assertUnique_(t,e){for(let n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}};function Ae(t,e){if(!t)throw new Error(e)}class ze extends De{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new ze(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ce(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=xe(t,ce,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;if(Array.isArray(t))e=t;else{Ae("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`");e=[t]}return function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Be=ze,je="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Ge=je.includes("firefox");je.includes("safari")&&!je.includes("chrom")&&(je.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(je));const Ne=je.includes("webkit")&&!je.includes("edge"),Ve=je.includes("macintosh"),He="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,We="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Xe="undefined"!=typeof Image&&Image.prototype.decode,Ue="function"==typeof createImageBitmap,$e=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(e){}return t}(),Ye=new Array(6);function qe(t){return Ke(t,1,0,0,1,0,0)}function Ze(t,e){const n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],p=e[5];return t[0]=n*l+r*u,t[1]=i*l+o*u,t[2]=n*h+r*c,t[3]=i*h+o*c,t[4]=n*d+r*p+s,t[5]=i*d+o*p+a,t}function Ke(t,e,n,i,r,o,s){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=s,t}function Je(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function Qe(t,e,n){return Ze(t,Ke(Ye,e,0,0,n,0,0))}function tn(t,e,n,i,r,o,s,a){const l=Math.sin(o),u=Math.cos(o);return t[0]=i*u,t[1]=r*l,t[2]=-i*l,t[3]=r*u,t[4]=s*i*u-a*i*l+e,t[5]=s*r*l+a*r*u+n,t}function en(t,e){const n=(i=e)[0]*i[3]-i[1]*i[2];var i;Ae(0!==n,"Transformation matrix cannot be inverted");const r=e[0],o=e[1],s=e[2],a=e[3],l=e[4],u=e[5];return t[0]=a/n,t[1]=-o/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*u-a*l)/n,t[5]=-(r*u-o*l)/n,t}let nn;function rn(t){const e="matrix("+t.join(", ")+")";if(We)return e;const n=nn||(nn=document.createElement("div"));return n.style.transform=e,n.style.transform}const on={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function sn(t){const e=fn();for(let n=0,i=t.length;n<i;++n)xn(e,t[n]);return e}function an(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function ln(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function un(t,e,n){let i,r;return i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,i*i+r*r}function hn(t,e){return dn(t,e[0],e[1])}function cn(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function dn(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function pn(t,e){const n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1];let l=on.UNKNOWN;return s<n?l|=on.LEFT:s>r&&(l|=on.RIGHT),a<i?l|=on.BELOW:a>o&&(l|=on.ABOVE),l===on.UNKNOWN&&(l=on.INTERSECTING),l}function fn(){return[1/0,1/0,-1/0,-1/0]}function gn(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function mn(t){return gn(1/0,1/0,-1/0,-1/0,t)}function _n(t,e){const n=t[0],i=t[1];return gn(n,i,n,i,e)}function yn(t,e,n,i,r){return bn(mn(r),t,e,n,i)}function vn(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function wn(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function xn(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function bn(t,e,n,i,r){for(;n<i;n+=r)Cn(t,e[n],e[n+1]);return t}function Cn(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Sn(t,e){let n;return n=e(In(t)),n||(n=e(Pn(t)),n||(n=e(Fn(t)),n||(n=e(On(t)),n||!1)))}function En(t){let e=0;return Bn(t)||(e=An(t)*Ln(t)),e}function In(t){return[t[0],t[1]]}function Pn(t){return[t[2],t[1]]}function Tn(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function kn(t,e){let n;if("bottom-left"===e)n=In(t);else if("bottom-right"===e)n=Pn(t);else if("top-left"===e)n=On(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=Fn(t)}return n}function Dn(t,e,n,i,r){const[o,s,a,l,u,h,c,d]=Mn(t,e,n,i);return gn(Math.min(o,a,u,c),Math.min(s,l,h,d),Math.max(o,a,u,c),Math.max(s,l,h,d),r)}function Mn(t,e,n,i){const r=e*i[0]/2,o=e*i[1]/2,s=Math.cos(n),a=Math.sin(n),l=r*s,u=r*a,h=o*s,c=o*a,d=t[0],p=t[1];return[d-l+c,p-u-h,d-l-c,p-u+h,d+l-c,p+u+h,d+l+c,p+u-h,d-l+c,p-u-h]}function Ln(t){return t[3]-t[1]}function Rn(t,e,n){const i=n||[1/0,1/0,-1/0,-1/0];return zn(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):mn(i),i}function On(t){return[t[0],t[3]]}function Fn(t){return[t[2],t[3]]}function An(t){return t[2]-t[0]}function zn(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Bn(t){return t[2]<t[0]||t[3]<t[1]}function jn(t,e,n,i){if(Bn(t))return mn(n);let r=[];if(i>1){const e=t[2]-t[0],n=t[3]-t[1];for(let o=0;o<i;++o)r.push(t[0]+e*o/i,t[1],t[2],t[1]+n*o/i,t[2]-e*o/i,t[3],t[0],t[3]-n*o/i)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const o=[],s=[];for(let a=0,l=r.length;a<l;a+=2)o.push(r[a]),s.push(r[a+1]);return function(t,e,n){return gn(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(o,s,n)}function Gn(t,e){const n=e.getExtent(),i=Tn(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){const e=An(n),r=Math.floor((i[0]-n[0])/e)*e;t[0]-=r,t[2]-=r}return t}const Nn={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};const Vn=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Nn[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Hn=6378137,Wn=Math.PI*Hn,Xn=[-Wn,-Wn,Wn,Wn],Un=[-180,-85,180,85],$n=Hn*Math.log(Math.tan(Math.PI/2));class Yn extends Vn{constructor(t){super({code:t,units:"m",extent:Xn,global:!0,worldExtent:Un,getPointResolution:function(t,e){return t/Math.cosh(e[1]/Hn)}})}}const qn=[new Yn("EPSG:3857"),new Yn("EPSG:102100"),new Yn("EPSG:102113"),new Yn("EPSG:900913"),new Yn("http://www.opengis.net/def/crs/EPSG/0/3857"),new Yn("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Zn(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n){e[r]=Wn*t[r]/180;let n=Hn*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));n>$n?n=$n:n<-$n&&(n=-$n),e[r+1]=n}return e}function Kn(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n)e[r]=180*t[r]/Wn,e[r+1]=360*Math.atan(Math.exp(t[r+1]/Hn))/Math.PI-90;return e}const Jn=[-180,-90,180,90],Qn=6378137*Math.PI/180;class ti extends Vn{constructor(t,e){super({code:t,units:"degrees",extent:Jn,axisOrientation:e,global:!0,metersPerUnit:Qn,worldExtent:Jn})}}const ei=[new ti("CRS:84"),new ti("EPSG:4326","neu"),new ti("urn:ogc:def:crs:OGC:1.3:CRS84"),new ti("urn:ogc:def:crs:OGC:2:84"),new ti("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ti("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ti("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ni={};let ii={};function ri(t,e,n){const i=t.getCode(),r=e.getCode();i in ii||(ii[i]={}),ii[i][r]=n}function oi(t,e,n){return Math.min(Math.max(t,e),n)}function si(t,e,n,i,r,o){const s=r-n,a=o-i;if(0!==s||0!==a){const l=((t-n)*s+(e-i)*a)/(s*s+a*a);l>1?(n=r,i=o):l>0&&(n+=s*l,i+=a*l)}return ai(t,e,n,i)}function ai(t,e,n,i){const r=n-t,o=i-e;return r*r+o*o}function li(t){return 180*t/Math.PI}function ui(t){return t*Math.PI/180}function hi(t,e){const n=t%e;return n*e<0?n+e:n}function ci(t,e,n){return t+n*(e-t)}function di(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function pi(t,e){return Math.floor(di(t,e))}function fi(t,e){return Math.ceil(di(t,e))}function gi(t,e){const n=e.getRadius(),i=e.getCenter(),r=i[0],o=i[1];let s=t[0]-r;const a=t[1]-o;0===s&&0===a&&(s=1);const l=Math.sqrt(s*s+a*a);return[r+n*s/l,o+n*a/l]}function mi(t,e){const n=t[0],i=t[1],r=e[0],o=e[1],s=r[0],a=r[1],l=o[0],u=o[1],h=l-s,c=u-a,d=0===h&&0===c?0:(h*(n-s)+c*(i-a))/(h*h+c*c||0);let p,f;return d<=0?(p=s,f=a):d>=1?(p=l,f=u):(p=s+d*h,f=a+d*c),[p,f]}function _i(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function yi(t,e){const n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,o=t[1]*n+t[0]*i;return t[0]=r,t[1]=o,t}function vi(t,e){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function wi(t,e){return Math.sqrt(vi(t,e))}function xi(t,e){if(e.canWrapX()){const n=An(e.getExtent()),i=function(t,e,n){const i=e.getExtent();let r=0;e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||An(i),r=Math.floor((t[0]-i[0])/n));return r}(t,e,n);i&&(t[0]-=i*n)}return t}const bi=6371008.8;function Ci(t,e,n){n=n||bi;const i=ui(t[1]),r=ui(e[1]),o=(r-i)/2,s=ui(e[0]-t[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Si(t,e){let n=0;for(let i=0,r=t.length;i<r-1;++i)n+=Ci(t[i],t[i+1],e);return n}function Ei(t,e){const n=(e=e||{}).radius||bi,i=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(i,"EPSG:4326"));let o,s,a,l,u,h,c=0;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":o=t.getCoordinates(),c=Si(o,n);break;case"MultiLineString":case"Polygon":for(o=t.getCoordinates(),a=0,l=o.length;a<l;++a)c+=Si(o[a],n);break;case"MultiPolygon":for(o=t.getCoordinates(),a=0,l=o.length;a<l;++a)for(s=o[a],u=0,h=s.length;u<h;++u)c+=Si(s[u],n);break;case"GeometryCollection":{const n=t.getGeometries();for(a=0,l=n.length;a<l;++a)c+=Ei(n[a],e);break}default:throw new Error("Unsupported geometry type: "+r)}return c}function Ii(t,e){let n=0;const i=t.length;let r=t[i-1][0],o=t[i-1][1];for(let s=0;s<i;s++){const e=t[s][0],i=t[s][1];n+=ui(e-r)*(2+Math.sin(ui(o))+Math.sin(ui(i))),r=e,o=i}return n*e*e/2}function Pi(t,e){const n=(e=e||{}).radius||bi,i=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(i,"EPSG:4326"));let o,s,a,l,u,h,c=0;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(o=t.getCoordinates(),c=Math.abs(Ii(o[0],n)),a=1,l=o.length;a<l;++a)c-=Math.abs(Ii(o[a],n));break;case"MultiPolygon":for(o=t.getCoordinates(),a=0,l=o.length;a<l;++a)for(s=o[a],c+=Math.abs(Ii(s[0],n)),u=1,h=s.length;u<h;++u)c-=Math.abs(Ii(s[u],n));break;case"GeometryCollection":{const n=t.getGeometries();for(a=0,l=n.length;a<l;++a)c+=Pi(n[a],e);break}default:throw new Error("Unsupported geometry type: "+r)}return c}function Ti(t,e,n,i){i=i||bi;const r=ui(t[1]),o=ui(t[0]),s=e/i,a=Math.asin(Math.sin(r)*Math.cos(s)+Math.cos(r)*Math.sin(s)*Math.cos(n));return[li(o+Math.atan2(Math.sin(n)*Math.sin(s)*Math.cos(r),Math.cos(s)-Math.sin(r)*Math.sin(a))),li(a)]}const ki={info:1,warn:2,error:3,none:4};ki.info;function Di(...t){ki.warn}let Mi=!0;function Li(t){Mi=!(void 0===t||t)}function Ri(t,e){if(void 0!==e)for(let n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function Oi(t,e){if(void 0!==e&&t!==e){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function Fi(t){!function(t,e){ni[t]=e}(t.getCode(),t),ri(t,t,Ri)}function Ai(t){return"string"==typeof t?ni[e=t]||ni[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function zi(t,e,n,i){let r;const o=(t=Ai(t)).getPointResolutionFunc();if(o){if(r=o(e,n),i&&i!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/Nn[i])}}else{const o=t.getUnits();if("degrees"==o&&!i||"degrees"==i)r=e;else{const s=Vi(t,Ai("EPSG:4326"));if(s===Oi&&"degrees"!==o)r=e*t.getMetersPerUnit();else{let t=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];t=s(t,t,2);r=(Ci(t.slice(0,2),t.slice(2,4))+Ci(t.slice(4,6),t.slice(6,8)))/2}const a=i?Nn[i]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function Bi(t){!function(t){t.forEach(Fi)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&ri(e,t,Ri)}))}))}function ji(t,e){return t?"string"==typeof t?Ai(t):t:Ai(e)}function Gi(t,e){return Li(),Wi(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function Ni(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();if(t.getCode()===e.getCode())return n;return Vi(t,e)===Ri&&n}function Vi(t,e){let n=function(t,e){let n;return t in ii&&e in ii[t]&&(n=ii[t][e]),n}(t.getCode(),e.getCode());return n||(n=Oi),n}function Hi(t,e){return Vi(Ai(t),Ai(e))}function Wi(t,e,n){return Hi(e,n)(t,void 0,t.length)}function Xi(t,e,n,i){return jn(t,Hi(e,n),void 0,i)}function Ui(t,e){return t}function $i(t,e){return Mi&&!_i(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Mi=!1,Di()),t}function Yi(t,e){return t}function qi(t,e){return t}var Zi,Ki,Ji;function Qi(t,e,n,i,r,o){o=o||[];let s=0;for(let a=e;a<n;a+=i){const e=t[a],n=t[a+1];o[s++]=r[0]*e+r[2]*n+r[4],o[s++]=r[1]*e+r[3]*n+r[5]}return o&&o.length!=s&&(o.length=s),o}function tr(t,e,n,i,r,o,s){s=s||[];const a=Math.cos(r),l=Math.sin(r),u=o[0],h=o[1];let c=0;for(let d=e;d<n;d+=i){const e=t[d]-u,n=t[d+1]-h;s[c++]=u+e*a-n*l,s[c++]=h+e*l+n*a;for(let r=d+2;r<d+i;++r)s[c++]=t[r]}return s&&s.length!=c&&(s.length=c),s}Bi(qn),Bi(ei),Zi=qn,Ki=Zn,Ji=Kn,ei.forEach((function(t){Zi.forEach((function(e){ri(t,e,Ki),ri(e,t,Ji)}))}));const er=[1,0,0,1,0,0];const nr=class extends De{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=se(((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return Ie()}closestPointXY(t,e,n,i){return Ie()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return Ie()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&mn(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){Ie()}scale(t,e,n){Ie()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return Ie()}getType(){return Ie()}applyTransform(t){Ie()}intersectsExtent(t){return Ie()}translate(t,e){Ie()}transform(t,e){const n=Ai(t),i="tile-pixels"==n.getUnits()?function(t,i,r){const o=n.getExtent(),s=n.getWorldExtent(),a=Ln(s)/Ln(o);return tn(er,s[0],s[3],a,-a,0,0,0),Qi(t,0,t.length,r,er,i),Hi(n,e)(t,i,r)}:Hi(n,e);return this.applyTransform(i),this}};function ir(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function rr(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const or=class extends nr{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return Ie()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=rr(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){Ie()}setLayout(t,e,n){let i;if(t)i=rr(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}i=e.length,t=ir(i)}this.layout=t,this.stride=i}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();tr(n,0,n.length,i,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=Tn(this.getExtent()));const i=this.getFlatCoordinates();if(i){const r=this.getStride();!function(t,e,n,i,r,o,s,a){a=a||[];const l=s[0],u=s[1];let h=0;for(let c=e;c<n;c+=i){const e=t[c]-l,n=t[c+1]-u;a[h++]=l+r*e,a[h++]=u+o*n;for(let r=c+2;r<c+i;++r)a[h++]=t[r]}a&&a.length!=h&&(a.length=h)}(i,0,i.length,r,t,e,n,i),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,r,o,s){s=s||[];let a=0;for(let l=e;l<n;l+=i){s[a++]=t[l]+r,s[a++]=t[l+1]+o;for(let e=l+2;e<l+i;++e)s[a++]=t[e]}s&&s.length!=a&&(s.length=a)}(n,0,n.length,i,t,e,n),this.changed()}}};function sr(t,e,n,i,r,o,s){const a=t[e],l=t[e+1],u=t[n]-a,h=t[n+1]-l;let c;if(0===u&&0===h)c=e;else{const d=((r-a)*u+(o-l)*h)/(u*u+h*h);if(d>1)c=n;else{if(d>0){for(let r=0;r<i;++r)s[r]=ci(t[e+r],t[n+r],d);return void(s.length=i)}c=e}}for(let d=0;d<i;++d)s[d]=t[c+d];s.length=i}function ar(t,e,n,i,r){let o=t[e],s=t[e+1];for(e+=i;e<n;e+=i){const n=t[e],i=t[e+1],a=ai(o,s,n,i);a>r&&(r=a),o=n,s=i}return r}function lr(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){const s=n[o];r=ar(t,e,s,i,r),e=s}return r}function ur(t,e,n,i,r,o,s,a,l,u,h){if(e==n)return u;let c,d;if(0===r){if(d=ai(s,a,t[e],t[e+1]),d<u){for(c=0;c<i;++c)l[c]=t[e+c];return l.length=i,d}return u}h=h||[NaN,NaN];let p=e+i;for(;p<n;)if(sr(t,p-i,p,i,s,a,h),d=ai(s,a,h[0],h[1]),d<u){for(u=d,c=0;c<i;++c)l[c]=h[c];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(sr(t,n-i,e,i,s,a,h),d=ai(s,a,h[0],h[1]),d<u)){for(u=d,c=0;c<i;++c)l[c]=h[c];l.length=i}return u}function hr(t,e,n,i,r,o,s,a,l,u,h){h=h||[NaN,NaN];for(let c=0,d=n.length;c<d;++c){const d=n[c];u=ur(t,e,d,i,r,o,s,a,l,u,h),e=d}return u}function cr(t,e,n,i){for(let r=0,o=n.length;r<o;++r)t[e++]=n[r];return e}function dr(t,e,n,i){for(let r=0,o=n.length;r<o;++r){const o=n[r];for(let n=0;n<i;++n)t[e++]=o[n]}return e}function pr(t,e,n,i,r){r=r||[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=dr(t,e,n[s],i);r[o++]=a,e=a}return r.length=o,r}function fr(t,e,n,i,r){r=r||[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=pr(t,e,n[s],i,r[o]);0===a.length&&(a[0]=e),r[o++]=a,e=a[a.length-1]}return r.length=o,r}function gr(t,e,n,i,r,o,s){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)o[s++]=t[e],o[s++]=t[e+1];return s}const l=new Array(a);l[0]=1,l[a-1]=1;const u=[e,n-i];let h=0;for(;u.length>0;){const n=u.pop(),o=u.pop();let s=0;const a=t[o],c=t[o+1],d=t[n],p=t[n+1];for(let e=o+i;e<n;e+=i){const n=si(t[e],t[e+1],a,c,d,p);n>s&&(h=e,s=n)}s>r&&(l[(h-e)/i]=1,o+i<h&&u.push(o,h),h+i<n&&u.push(h,n))}for(let c=0;c<a;++c)l[c]&&(o[s++]=t[e+c*i],o[s++]=t[e+c*i+1]);return s}function mr(t,e,n,i,r,o,s,a){for(let l=0,u=n.length;l<u;++l){const u=n[l];s=gr(t,e,u,i,r,o,s),a.push(s),e=u}return s}function _r(t,e){return e*Math.round(t/e)}function yr(t,e,n,i,r,o,s){if(e==n)return s;let a,l,u=_r(t[e],r),h=_r(t[e+1],r);e+=i,o[s++]=u,o[s++]=h;do{if(a=_r(t[e],r),l=_r(t[e+1],r),(e+=i)==n)return o[s++]=a,o[s++]=l,s}while(a==u&&l==h);for(;e<n;){const n=_r(t[e],r),c=_r(t[e+1],r);if(e+=i,n==a&&c==l)continue;const d=a-u,p=l-h,f=n-u,g=c-h;d*g==p*f&&(d<0&&f<d||d==f||d>0&&f>d)&&(p<0&&g<p||p==g||p>0&&g>p)?(a=n,l=c):(o[s++]=a,o[s++]=l,u=a,h=l,a=n,l=c)}return o[s++]=a,o[s++]=l,s}function vr(t,e,n,i,r,o,s,a){for(let l=0,u=n.length;l<u;++l){const u=n[l];s=yr(t,e,u,i,r,o,s),a.push(s),e=u}return s}function wr(t,e,n,i,r){r=void 0!==r?r:[];let o=0;for(let s=e;s<n;s+=i)r[o++]=t.slice(s,s+i);return r.length=o,r}function xr(t,e,n,i,r){r=void 0!==r?r:[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=n[s];r[o++]=wr(t,e,a,i,r[o]),e=a}return r.length=o,r}function br(t,e,n,i,r){r=void 0!==r?r:[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=n[s];r[o++]=1===a.length&&a[0]===e?[]:xr(t,e,a,i,r[o]),e=a[a.length-1]}return r.length=o,r}function Cr(t,e,n,i){let r=0,o=t[n-i],s=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=s*n-o*i,o=n,s=i}return r/2}function Sr(t,e,n,i){let r=0;for(let o=0,s=n.length;o<s;++o){const s=n[o];r+=Cr(t,e,s,i),e=s}return r}class Er extends or{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Er(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,i){return i<un(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}getArea(){return Cr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Er(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=dr(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ir=Er;class Pr extends or{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Pr(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){const r=this.flatCoordinates,o=ai(t,e,r[0],r[1]);if(o<i){const t=this.stride;for(let e=0;e<t;++e)n[e]=r[e];return n.length=t,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return _n(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return dn(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cr(this.flatCoordinates,0,t,this.stride),this.changed()}}const Tr=Pr;function kr(t,e,n,i,r){return!Sn(r,(function(r){return!Dr(t,e,n,i,r[0],r[1])}))}function Dr(t,e,n,i,r,o){let s=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];l<=o?i>o&&(n-a)*(o-l)-(r-a)*(i-l)>0&&s++:i<=o&&(n-a)*(o-l)-(r-a)*(i-l)<0&&s--,a=n,l=i}return 0!==s}function Mr(t,e,n,i,r,o){if(0===n.length)return!1;if(!Dr(t,e,n[0],i,r,o))return!1;for(let s=1,a=n.length;s<a;++s)if(Dr(t,n[s-1],n[s],i,r,o))return!1;return!0}function Lr(t,e,n,i,r,o,s){let a,l,u,h,c,d,p;const f=r[o+1],g=[];for(let y=0,v=n.length;y<v;++y){const r=n[y];for(h=t[r-i],d=t[r-i+1],a=e;a<r;a+=i)c=t[a],p=t[a+1],(f<=d&&p<=f||d<=f&&f<=p)&&(u=(f-d)/(p-d)*(c-h)+h,g.push(u)),h=c,d=p}let m=NaN,_=-1/0;for(g.sort(Jt),h=g[0],a=1,l=g.length;a<l;++a){c=g[a];const r=Math.abs(c-h);r>_&&(u=(h+c)/2,Mr(t,e,n,i,u,f)&&(m=u,_=r)),h=c}return isNaN(m)&&(m=r[o]),s?(s.push(m,f,_),s):[m,f,_]}function Rr(t,e,n,i,r){let o=[];for(let s=0,a=n.length;s<a;++s){const a=n[s];o=Lr(t,e,a,i,r,2*s,o),e=a[a.length-1]}return o}function Or(t,e,n,i,r){let o;for(e+=i;e<n;e+=i)if(o=r(t.slice(e-i,e),t.slice(e,e+i)),o)return o;return!1}function Fr(t,e,n,i,r){const o=bn([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!zn(r,o)&&(!!cn(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||Or(t,e,n,i,(function(t,e){return function(t,e,n){let i=!1;const r=pn(t,e),o=pn(t,n);if(r===on.INTERSECTING||o===on.INTERSECTING)i=!0;else{const s=t[0],a=t[1],l=t[2],u=t[3],h=e[0],c=e[1],d=n[0],p=n[1],f=(p-c)/(d-h);let g,m;o&on.ABOVE&&!(r&on.ABOVE)&&(g=d-(p-u)/f,i=g>=s&&g<=l),i||!(o&on.RIGHT)||r&on.RIGHT||(m=p-(d-l)*f,i=m>=a&&m<=u),i||!(o&on.BELOW)||r&on.BELOW||(g=d-(p-a)/f,i=g>=s&&g<=l),i||!(o&on.LEFT)||r&on.LEFT||(m=p-(d-s)*f,i=m>=a&&m<=u)}return i}(r,t,e)})))))}function Ar(t,e,n,i,r){return!!Fr(t,e,n,i,r)||(!!Dr(t,e,n,i,r[0],r[1])||(!!Dr(t,e,n,i,r[0],r[3])||(!!Dr(t,e,n,i,r[2],r[1])||!!Dr(t,e,n,i,r[2],r[3]))))}function zr(t,e,n,i,r){if(!Ar(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(let o=1,s=n.length;o<s;++o)if(kr(t,n[o-1],n[o],i,r)&&!Fr(t,n[o-1],n[o],i,r))return!1;return!0}function Br(t,e,n,i){for(;e<n-i;){for(let r=0;r<i;++r){const o=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=o}e+=i,n-=i}}function jr(t,e,n,i){let r=0,o=t[n-i],s=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=(n-o)*(i+s),o=n,s=i}return 0===r?void 0:r>0}function Gr(t,e,n,i,r){r=void 0!==r&&r;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=jr(t,e,s,i);if(0===o){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=s}return!0}function Nr(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){const s=n[o];if(!Gr(t,e,s,i,r))return!1;s.length&&(e=s[s.length-1])}return!0}function Vr(t,e,n,i,r){r=void 0!==r&&r;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=jr(t,e,s,i);(0===o?r&&a||!r&&!a:r&&!a||!r&&a)&&Br(t,e,s,i),e=s}return e}function Hr(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o)e=Vr(t,e,n[o],i,r);return e}function Wr(t,e){const n=[];let i,r=0,o=0;for(let s=0,a=e.length;s<a;++s){const a=e[s],l=jr(t,r,a,2);if(void 0===i&&(i=l),l===i)n.push(e.slice(o,s+1));else{if(0===n.length)continue;n[n.length-1].push(e[o])}o=s+1,r=a}return n}class Xr extends or{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?ee(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Xr(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<un(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}containsXY(t,e){return Mr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Sr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Vr(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,xr(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Tn(this.getExtent());this.flatInteriorPoint_=Lr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Tr(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Ir(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[];let r=0;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=new Ir(e.slice(r,s),t);i.push(a),r=s}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Gr(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Vr(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=vr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Xr(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return zr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=pr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const Ur=Xr;function $r(t,e,n,i){n=n||32;const r=[];for(let o=0;o<n;++o)ee(r,Ti(t,e,2*Math.PI*o/n,i));return r.push(r[0],r[1]),new Xr(r,"XY",[r.length])}function Yr(t){if(Bn(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],i=t[2],r=t[3],o=[e,n,e,r,i,r,i,n,e,n];return new Xr(o,"XY",[o.length])}function qr(t,e,n){e=e||32;const i=t.getStride(),r=t.getLayout(),o=t.getCenter(),s=i*(e+1),a=new Array(s);for(let h=0;h<s;h+=i){a[h]=0,a[h+1]=0;for(let t=2;t<i;t++)a[h+t]=o[t]}const l=[a.length],u=new Xr(a,r,l);return Zr(u,o,t.getRadius(),n),u}function Zr(t,e,n,i){const r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=i||0;for(let l=0;l<=s;++l){const t=l*o,i=a+2*hi(l,s)*Math.PI/s;r[t]=e[0]+n*Math.cos(i),r[t+1]=e[1]+n*Math.sin(i)}t.changed()}const Kr="prerender",Jr="postrender",Qr="precompose",to="postcompose",eo="rendercomplete";class no{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new no({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const io=no;function ro(t,e,n,i,r,o,s){let a,l;const u=(n-e)/i;if(1===u)a=e;else if(2===u)a=e,l=r;else if(0!==u){let o=t[e],s=t[e+1],u=0;const h=[0];for(let r=e+i;r<n;r+=i){const e=t[r],n=t[r+1];u+=Math.sqrt((e-o)*(e-o)+(n-s)*(n-s)),h.push(u),o=e,s=n}const c=r*u,d=function(t,e,n){let i,r;n=n||Jt;let o=0,s=t.length,a=!1;for(;o<s;)i=o+(s-o>>1),r=+n(t[i],e),r<0?o=i+1:(s=i,a=!r);return a?o:~o}(h,c);d<0?(l=(c-h[-d-2])/(h[-d-1]-h[-d-2]),a=e+(-d-2)*i):a=e+d*i}s=s>1?s:2,o=o||new Array(s);for(let h=0;h<s;++h)o[h]=void 0===a?NaN:void 0===l?t[a+h]:ci(t[a+h],t[a+i+h],l);return o}function oo(t,e,n,i,r,o){if(n==e)return null;let s;if(r<t[e+i-1])return o?(s=t.slice(e,e+i),s[i-1]=r,s):null;if(t[n-1]<r)return o?(s=t.slice(n-i,n),s[i-1]=r,s):null;if(r==t[e+i-1])return t.slice(e,e+i);let a=e/i,l=n/i;for(;a<l;){const e=a+l>>1;r<t[(e+1)*i-1]?l=e:a=e+1}const u=t[a*i-1];if(r==u)return t.slice((a-1)*i,(a-1)*i+i);const h=(r-u)/(t[(a+1)*i-1]-u);s=[];for(let c=0;c<i-1;++c)s.push(ci(t[(a-1)*i+c],t[a*i+c],h));return s.push(r),s}function so(t,e,n,i){let r=t[e],o=t[e+1],s=0;for(let a=e+i;a<n;a+=i){const e=t[a],n=t[a+1];s+=Math.sqrt((e-r)*(e-r)+(n-o)*(n-o)),r=e,o=n}return s}class ao extends or{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){ee(this.flatCoordinates,t),this.changed()}clone(){const t=new ao(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<un(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,i))}forEachSegment(t){return Or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,oo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return ro(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return so(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new ao(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=dr(this.flatCoordinates,0,t,this.stride),this.changed()}}const lo=ao;class uo{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new uo({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const ho=uo,co=0,po=1,fo=2,go=3,mo=4;function _o(t){return t[0]>0&&t[1]>0}function yo(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}class vo{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=yo(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new vo({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Ie()}getImage(t){return Ie()}getHitDetectionImage(){return Ie()}getPixelRatio(t){return 1}getImageState(){return Ie()}getImageSize(){return Ie()}getOrigin(){return Ie()}getSize(){return Ie()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=yo(t)}listenImageChange(t){Ie()}load(){Ie()}unlistenImageChange(t){Ie()}}const wo=vo,xo={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var bo={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};bo.max=bo.whitepoint[2].D65,bo.rgb=function(t,e){e=e||bo.whitepoint[2].E;var n,i,r,o=t[0]/e[0],s=t[1]/e[1],a=t[2]/e[2];return i=-.96924363628087*o+1.87596750150772*s+.041555057407175*a,r=.055630079696993*o+-.20397695888897*s+1.056971514242878*a,n=(n=3.240969941904521*o+-1.537383177570093*s+-.498610760293*a)>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},xo.xyz=function(t,e){var n=t[0]/255,i=t[1]/255,r=t[2]/255,o=.21263900587151*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.71516867876775*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.072192315360733*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),s=.019330818715591*n+.11919477979462*i+.95053215224966*r;return[(.41239079926595*n+.35758433938387*i+.18048078840183*r)*(e=e||bo.whitepoint[2].E)[0],o*e[1],s*e[2]]};const Co={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,n){var i,r,o,s,a,l,u,h,c;if(o=t[0],s=t[1],a=t[2],0===o)return[0,0,0];return e=e||"D65",n=n||2,i=s/(13*o)+4*(u=bo.whitepoint[n][e][0])/(u+15*(h=bo.whitepoint[n][e][1])+3*(c=bo.whitepoint[n][e][2]))||0,r=a/(13*o)+9*h/(u+15*h+3*c)||0,[9*(l=o>8?h*Math.pow((o+16)/116,3):h*o*.0011070564598794539)*i/(4*r)||0,l,l*(12-3*i-20*r)/(4*r)||0]}};bo.luv=function(t,e,n){var i,r,o,s,a,l,u,h,c,d,p;e=e||"D65",n=n||2,d=4*(u=bo.whitepoint[n][e][0])/(u+15*(h=bo.whitepoint[n][e][1])+3*(c=bo.whitepoint[n][e][2])),p=9*h/(u+15*h+3*c),i=4*(s=t[0])/(s+15*(a=t[1])+3*(l=t[2]))||0,r=9*a/(s+15*a+3*l)||0;var f=a/h;return[o=f<=.008856451679035631?903.2962962962961*f:116*Math.pow(f,1/3)-16,13*o*(i-d),13*o*(r-p)]};var So={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,n=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[n,i*Math.cos(e),i*Math.sin(e)]},xyz:function(t){return Co.xyz(So.luv(t))}};Co.lchuv=function(t){var e=t[0],n=t[1],i=t[2],r=Math.sqrt(n*n+i*i),o=360*Math.atan2(i,n)/2/Math.PI;return o<0&&(o+=360),[e,r,o]},bo.lchuv=function(t){return Co.lchuv(bo.luv(t))};const Eo=T({aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]});var Io={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Po={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,i,r,o,s=t[0]/360,a=t[1]/100,l=t[2]/100,u=0;if(0===a)return[o=255*l,o,o];for(e=2*l-(n=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];u<3;)(i=s+1/3*-(u-1))<0?i++:i>1&&i--,o=6*i<1?e+6*(n-e)*i:2*i<1?n:3*i<2?e+(n-e)*(2/3-i)*6:e,r[u++]=255*o;return r}};function To(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var n=function(t){var e,n,i,r,o=[],s=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),Eo[t])o=Eo[t].slice(),r="rgb";else if("transparent"===t)s=0,r="rgb",o=[0,0,0];else if("#"===t[0]){var a=t.slice(1),l=a.length;s=1,l<=4?(o=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],4===l&&(s=parseInt(a[3]+a[3],16)/255)):(o=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],8===l&&(s=parseInt(a[6]+a[7],16)/255)),o[0]||(o[0]=0),o[1]||(o[1]=0),o[2]||(o[2]=0),r="rgb"}else if(i=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var u=i[1],h="cmyk"===(r=u.replace(/a$/,""))?4:"gray"===r?1:3;o=i[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===r&&(r=o.shift()),s=(o=o.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===r?255*t:"h"===r[0]?100*t:"l"!==r[0]||e?"lab"===r?125*t:"lch"===r?e<2?150*t:360*t:"o"!==r[0]||e?"oklab"===r?.4*t:"oklch"===r?e<2?.4*t:360*t:t:t:100*t;if("h"===r[e]||2===e&&"h"===r[r.length-1]){if(void 0!==Io[t])return Io[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>h?o.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(o=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),r=(null==(n=null==(e=t.match(/([a-z])/gi))?void 0:e.join(""))?void 0:n.toLowerCase())||"rgb");return{space:r,values:o,alpha:s}}(t);if(!n.space)return[];const i="h"===n.space[0]?Po.min:xo.min,r="h"===n.space[0]?Po.max:xo.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],i[0]),r[0]),e[1]=Math.min(Math.max(n.values[1],i[1]),r[1]),e[2]=Math.min(Math.max(n.values[2],i[2]),r[2]),"h"===n.space[0]&&(e=Po.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}function ko(t){return"string"==typeof t?t:Bo(t)}xo.hsl=function(t){var e,n,i=t[0]/255,r=t[1]/255,o=t[2]/255,s=Math.min(i,r,o),a=Math.max(i,r,o),l=a-s;return a===s?e=0:i===a?e=(r-o)/l:r===a?e=2+(o-i)/l:o===a&&(e=4+(i-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(s+a)/2,[e,100*(a===s?0:n<=.5?l/(a+s):l/(2-a-s)),100*n]};const Do=1024,Mo={};let Lo=0;function Ro(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function Oo(t){const e=bo.lchuv(xo.xyz(t));return e[3]=t[3],e}function Fo(t){if(Mo.hasOwnProperty(t))return Mo[t];if(Lo>=Do){let t=0;for(const e in Mo)3&t++||(delete Mo[e],--Lo)}const e=To(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const n of e)if(isNaN(n))throw new Error('Failed to parse "'+t+'" as color');return zo(e),Mo[t]=e,++Lo,e}function Ao(t){return Array.isArray(t)?t:Fo(t)}function zo(t){return t[0]=oi(t[0]+.5|0,0,255),t[1]=oi(t[1]+.5|0,0,255),t[2]=oi(t[2]+.5|0,0,255),t[3]=oi(t[3],0,1),t}function Bo(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let n=t[1];n!=(0|n)&&(n=n+.5|0);let i=t[2];i!=(0|i)&&(i=i+.5|0);return"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function jo(t){return Array.isArray(t)?Bo(t):t}function Go(t,e,n,i){let r;return r=n&&n.length?n.shift():We?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",i)}function No(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Vo(t){let e=t.offsetWidth;const n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10),e}function Ho(t){let e=t.offsetHeight;const n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10),e}function Wo(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function Xo(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Uo(t){for(;t.lastChild;)t.removeChild(t.lastChild)}const $o="ol-hidden",Yo="ol-unselectable",qo="ol-control",Zo="ol-collapsed",Ko=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Jo=["style","variant","weight","size","lineHeight","family"],Qo=function(t){const e=t.match(Ko);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,r=Jo.length;i<r;++i){const t=e[i+1];void 0!==t&&(n[Jo[i]]=t)}return n.families=n.family.split(/,\s?/),n},ts="10px sans-serif",es="#000",ns="round",is=[],rs="round",os="#000",ss="center",as="middle",ls=[0,0,0,0],us=new De;let hs,cs=null;const ds={},ps=function(){const t="32px ",e=["monospace","serif"],n=e.length,i="wmytzilWMYTZIL@#/&?$%10";let r,o;function s(r,s,a){let l=!0;for(let u=0;u<n;++u){const n=e[u];if(o=ms(r+" "+s+" "+t+n,i),a!=n){const e=ms(r+" "+s+" "+t+a+","+n,i);l=l&&e!=o}}return!!l}function a(){let t=!0;const e=us.getKeys();for(let n=0,i=e.length;n<i;++n){const i=e[n];us.get(i)<100&&(s.apply(this,i.split("\n"))?(le(ds),cs=null,hs=void 0,us.set(i,100)):(us.set(i,us.get(i)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=Qo(t);if(!e)return;const n=e.families;for(let i=0,o=n.length;i<o;++i){const t=n[i],o=e.style+"\n"+e.weight+"\n"+t;void 0===us.get(o)&&(us.set(o,100,!0),s(e.style,e.weight,t)||(us.set(o,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),fs=function(){let t;return function(e){let n=ds[e];if(null==n){if(We){const t=Qo(e),i=gs(e,"Žg");n=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);ds[e]=n}return n}}();function gs(t,e){return cs||(cs=Go(1,1)),t!=hs&&(cs.font=t,hs=cs.font),cs.measureText(e)}function ms(t,e){return gs(t,e).width}function _s(t,e,n){if(e in n)return n[e];const i=e.split("\n").reduce(((e,n)=>Math.max(e,ms(t,n))),0);return n[e]=i,i}function ys(t,e,n,i,r,o,s,a,l,u,h){t.save(),1!==n&&(t.globalAlpha*=n),e&&t.transform.apply(t,e),i.contextInstructions?(t.translate(l,u),t.scale(h[0],h[1]),function(t,e){const n=t.contextInstructions;for(let i=0,r=n.length;i<r;i+=2)Array.isArray(n[i+1])?e[n[i]].apply(e,n[i+1]):e[n[i]]=n[i+1]}(i,t)):h[0]<0||h[1]<0?(t.translate(l,u),t.scale(h[0],h[1]),t.drawImage(i,r,o,s,a,0,0,s,a)):t.drawImage(i,r,o,s,a,l,u,s*h[0],a*h[1]),t.restore()}class vs extends wo{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const t=this.getScale(),e=new vs({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,i=Go(n.size*t,n.size*t);this.draw_(n,i,t),e=i.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return fo}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let i=this.radius_,r=void 0===this.radius2_?i:this.radius2_;if(i<r){const t=i;i=r,r=t}const o=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/o,a=r*Math.sin(s),l=i-Math.sqrt(r*r-a*a),u=Math.sqrt(a*a+l*l),h=u/a;if("miter"===t&&h<=n)return h*e;const c=e/2/h,d=e/2*(l/u),p=Math.sqrt((i+c)*(i+c)+d*d)-i;if(void 0===this.radius2_||"bevel"===t)return 2*p;const f=i*Math.sin(s),g=r-Math.sqrt(i*i-f*f),m=Math.sqrt(f*f+g*g)/f;if(m<=n){const t=m*e/2-r-i;return 2*Math.max(p,t)}return 2*p}createRenderOptions(){let t,e=ns,n=rs,i=0,r=null,o=0,s=0;this.stroke_&&(t=jo(this.stroke_.getColor()??os),s=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??rs,e=this.stroke_.getLineCap()??ns,i=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(n,s,i),l=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:s,size:Math.ceil(2*l+a),lineCap:e,lineDash:r,lineDashOffset:o,lineJoin:n,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=es),e.fillStyle=jo(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),i=0;"string"==typeof n&&(n=Ao(n)),null===n?i=1:Array.isArray(n)&&(i=4===n.length?n[3]:1),0===i&&(e=Go(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const i=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let s=0;s<e;s++){const e=r+s*o,a=s%2==0?n:i;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=es,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const ws=vs;class xs extends ws{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new xs({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const bs=xs;class Cs{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Ps,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Cs({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Ps,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let Ss=null;function Es(t,e){if(!Ss){const t=new io({color:"rgba(255,255,255,0.4)"}),e=new ho({color:"#3399CC",width:1.25});Ss=[new Cs({image:new bs({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Ss}function Is(){const t={},e=[255,255,255,1],n=[0,153,255,1];return t.Polygon=[new Cs({fill:new io({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new Cs({stroke:new ho({color:e,width:5})}),new Cs({stroke:new ho({color:n,width:3})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new Cs({image:new bs({radius:6,fill:new io({color:n}),stroke:new ho({color:e,width:1.5})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function Ps(t){return t.getGeometry()}const Ts=Cs;class ks{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=yo(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new io({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new ks({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=yo(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Ds=ks,Ms="opacity",Ls="visible",Rs="extent",Os="zIndex",Fs="maxResolution",As="minResolution",zs="maxZoom",Bs="minZoom",js="source",Gs="map";const Ns=class extends De{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[Ms]=void 0!==t.opacity?t.opacity:1,Ae("number"==typeof e[Ms],"Layer opacity must be a number"),e[Ls]=void 0===t.visible||t.visible,e[Os]=t.zIndex,e[Fs]=void 0!==t.maxResolution?t.maxResolution:1/0,e[As]=void 0!==t.minResolution?t.minResolution:0,e[Bs]=void 0!==t.minZoom?t.minZoom:-1/0,e[zs]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=oi(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return Ie()}getLayerStatesArray(t){return Ie()}getExtent(){return this.get(Rs)}getMaxResolution(){return this.get(Fs)}getMinResolution(){return this.get(As)}getMinZoom(){return this.get(Bs)}getMaxZoom(){return this.get(zs)}getOpacity(){return this.get(Ms)}getSourceState(){return Ie()}getVisible(){return this.get(Ls)}getZIndex(){return this.get(Os)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Rs,t)}setMaxResolution(t){this.set(Fs,t)}setMinResolution(t){this.set(As,t)}setMaxZoom(t){this.set(zs,t)}setMinZoom(t){this.set(Bs,t)}setOpacity(t){Ae("number"==typeof t,"Layer opacity must be a number"),this.set(Ms,t)}setVisible(t){this.set(Ls,t)}setZIndex(t){this.set(Os,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Vs=0,Hs=1,Ws={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Xs=42,Us=256;function $s(t,e,n){return function(i,r,o,s,a){if(!i)return;if(!r&&!e)return i;const l=e?0:o[0]*r,u=e?0:o[1]*r,h=a?a[0]:0,c=a?a[1]:0;let d=t[0]+l/2+h,p=t[2]-l/2+h,f=t[1]+u/2+c,g=t[3]-u/2+c;d>p&&(d=(p+d)/2,p=d),f>g&&(f=(g+f)/2,g=f);let m=oi(i[0],d,p),_=oi(i[1],f,g);if(s&&n&&r){const t=30*r;m+=-t*Math.log(1+Math.max(0,d-i[0])/t)+t*Math.log(1+Math.max(0,i[0]-p)/t),_+=-t*Math.log(1+Math.max(0,f-i[1])/t)+t*Math.log(1+Math.max(0,i[1]-g)/t)}return[m,_]}}function Ys(t){return t}function qs(t,e,n,i){const r=An(e)/n[0],o=Ln(e)/n[1];return i?Math.min(t,Math.max(r,o)):Math.min(t,Math.min(r,o))}function Zs(t,e,n){let i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),oi(i,n/2,2*e)}function Ks(t,e,n,i,r){return n=void 0===n||n,function(o,s,a,l){if(void 0!==o){const s=i?qs(t,i,a,r):t;return n&&l?Zs(o,s,e):oi(o,e,s)}}}function Js(t){if(void 0!==t)return 0}function Qs(t){if(void 0!==t)return t}function ta(t){return Math.pow(t,3)}function ea(t){return 1-ta(1-t)}function na(t){return 3*t*t-2*t*t*t}function ia(t){return t}function ra(t,e){setTimeout((function(){t(e)}),0)}function oa(t){return!(t.sourceCenter&&t.targetCenter&&!_i(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function sa(t,e,n,i,r){const o=Math.cos(-r);let s=Math.sin(-r),a=t[0]*o-t[1]*s,l=t[1]*o+t[0]*s;a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,s=-s;return[a*o-l*s,l*o+a*s]}const aa=class extends De{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ji(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Li(),t.center&&(t.center=$i(t.center,this.projection_)),t.extent&&(t.extent=qi(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const s in Ws)delete e[s];this.setProperties(e,!0);const n=function(t){let e,n,i;const r=28,o=2;let s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:r;const l=void 0!==t.zoomFactor?t.zoomFactor:o,u=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,d=ji(t.projection,"EPSG:3857"),p=d.getExtent();let f=t.constrainOnlyCenter,g=t.extent;u||g||!d.isGlobal()||(f=!1,g=p);if(void 0!==t.resolutions){const r=t.resolutions;n=r[s],i=void 0!==r[a]?r[a]:r[r.length-1],e=t.constrainResolution?function(t,e,n,i){return e=void 0===e||e,function(r,o,s,a){if(void 0!==r){const l=t[0],u=t[t.length-1],h=n?qs(l,n,s,i):l;if(a)return e?Zs(r,h,u):oi(r,u,h);const c=Math.min(h,r),d=Math.floor(Qt(t,c,o));return t[d]>h&&d<t.length-1?t[d+1]:t[d]}}}(r,h,!f&&g,c):Ks(n,i,h,!f&&g,c)}else{const u=(p?Math.max(An(p),Ln(p)):360*Nn.degrees/d.getMetersPerUnit())/Us/Math.pow(o,0),m=u/Math.pow(o,r-0);n=t.maxResolution,void 0!==n?s=0:n=u/Math.pow(l,s),i=t.minResolution,void 0===i&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(l,a):u/Math.pow(l,a):m),a=s+Math.floor(Math.log(n/i)/Math.log(l)),i=n/Math.pow(l,a-s),e=t.constrainResolution?function(t,e,n,i,r,o){return i=void 0===i||i,n=void 0!==n?n:0,function(s,a,l,u){if(void 0!==s){const h=r?qs(e,r,l,o):e;if(u)return i?Zs(s,h,n):oi(s,n,h);const c=1e-9,d=Math.ceil(Math.log(e/h)/Math.log(t)-c),p=-a*(.5-c)+.5,f=Math.min(h,s),g=Math.floor(Math.log(e/f)/Math.log(t)+p),m=Math.max(d,g);return oi(e/Math.pow(t,m),n,h)}}}(l,n,i,h,!f&&g,c):Ks(n,i,h,!f&&g,c)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:s,zoomFactor:l}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const i=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return $s(t.extent,t.constrainOnlyCenter,e)}const e=ji(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,$s(t,!1,!1)}return Ys}(t),r=n.constraint,o=function(t){const e=void 0===t.enableRotation||t.enableRotation;if(e){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=void 0===t?ui(5):t;return function(t,n){return n||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?Qs:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Qs}return Js}(t);this.constraints_={center:i,resolution:r,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const i=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(i[3]-e[3]+e[1]-i[1]),s=r/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([n[0]+o,n[1]-s])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let t=arguments[n];t.center&&(t=Object.assign({},t),t.center=$i(t.center,this.getProjection())),t.anchor&&(t=Object.assign({},t),t.anchor=$i(t.anchor,this.getProjection())),e[n]=t}this.animateInternal.apply(this,e)}animateInternal(t){let e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const t=arguments[i];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(i===n)return void(e&&ra(e,!0));let r=Date.now(),o=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_;const l=[];for(;i<n;++i){const t=arguments[i],n={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||na,callback:e};if(t.center&&(n.sourceCenter=o,n.targetCenter=t.center.slice(),o=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=s,n.targetResolution=this.getResolutionForZoom(t.zoom),s=n.targetResolution):t.resolution&&(n.sourceResolution=s,n.targetResolution=t.resolution,s=n.targetResolution),void 0!==t.rotation){n.sourceRotation=a;const e=hi(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=a+e,a=n.targetRotation}oa(n)?n.complete=!0:r+=n.duration,l.push(n)}this.animations_.push(l),this.setHint(Vs,1),this.updateAnimations_()}getAnimating(){return this.hints_[Vs]>0}getInteracting(){return this.hints_[Hs]>0}cancelAnimations(){let t;this.setHint(Vs,-this.hints_[Vs]);for(let e=0,n=this.animations_.length;e<n;++e){const n=this.animations_[e];if(n[0].callback&&ra(n[0].callback,!1),!t)for(let e=0,i=n.length;e<i;++e){const i=n[e];if(!i.complete){t=i.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const i=this.animations_[n];let r=!0;for(let n=0,o=i.length;n<o;++n){const o=i[n];if(o.complete)continue;const s=t-o.start;let a=o.duration>0?s/o.duration:1;a>=1?(o.complete=!0,a=1):r=!1;const l=o.easing(a);if(o.sourceCenter){const t=o.sourceCenter[0],e=o.sourceCenter[1],n=o.targetCenter[0],i=o.targetCenter[1];this.nextCenter_=o.targetCenter;const r=t+l*(n-t),s=e+l*(i-e);this.targetCenter_=[r,s]}if(o.sourceResolution&&o.targetResolution){const t=1===l?o.targetResolution:o.sourceResolution+l*(o.targetResolution-o.sourceResolution);if(o.anchor){const e=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(n,o.anchor)}this.nextResolution_=o.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==o.sourceRotation&&void 0!==o.targetRotation){const t=1===l?hi(o.targetRotation+Math.PI,2*Math.PI)-Math.PI:o.sourceRotation+l*(o.targetRotation-o.sourceRotation);if(o.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,o.anchor)}this.nextRotation_=o.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!o.complete)break}if(r){this.animations_[n]=null,this.setHint(Vs,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=i[0].callback;t&&ra(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const i=this.getCenterInternal();var r,o;return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],yi(n,t-this.getRotation()),o=e,(r=n)[0]+=+o[0],r[1]+=+o[1]),n}calculateCenterZoom(t,e){let n;const i=this.getCenterInternal(),r=this.getResolution();if(void 0!==i&&void 0!==r){n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Ui(t,this.getProjection()):t}getCenterInternal(){return this.get(Ws.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Yi(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();Ae(e,"The view center is not defined");const n=this.getResolution();Ae(void 0!==n,"The view resolution is not defined");const i=this.getRotation();return Ae(void 0!==i,"The view rotation is not defined"),Dn(e,n,i,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Ws.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(qi(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=An(t)/e[0],i=Ln(t)/e[1];return Math.max(n,i)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*i)}}getRotation(){return this.get(Ws.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/e;return function(t){return Math.log(n/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let i=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();i=sa(i,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,n)}return{center:i.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,n,i=this.minZoom_||0;if(this.resolutions_){const r=Qt(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=oi(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,oi(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(Ae(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){Ae(!Bn(t),"Cannot fit empty extent provided as `geometry`");n=Yr(qi(t,this.getProjection()))}else if("Circle"===t.getType()){const e=qi(t.getExtent(),this.getProjection());n=Yr(e),n.rotate(this.getRotation(),Tn(e))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let s=1/0,a=1/0,l=-1/0,u=-1/0;for(let h=0,c=r.length;h<c;h+=o){const t=r[h]*n-r[h+1]*i,e=r[h]*i+r[h+1]*n;s=Math.min(s,t),a=Math.min(a,e),l=Math.max(l,t),u=Math.max(u,e)}return[s,a,l,u]}fitInternal(t,e){let n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());const i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let o;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const s=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(s,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);a=isNaN(a)?o:Math.max(a,o),a=this.getConstrainedResolution(a,r?0:1);const l=this.getRotation(),u=Math.sin(l),h=Math.cos(l),c=Tn(s);c[0]+=(i[1]-i[3])/2*a,c[1]+=(i[0]-i[2])/2*a;const d=c[0]*h-c[1]*u,p=c[1]*h+c[0]*u,f=this.getConstrainedCenter([d,p],a),g=e.callback?e.callback:oe;void 0!==e.duration?this.animateInternal({resolution:a,center:f,duration:e.duration,easing:e.easing},g):(this.targetResolution_=a,this.targetCenter_=f,this.applyTargetState_(!1,!0),ra(g,!0))}centerOn(t,e,n){this.centerOnInternal($i(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(sa(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,i){let r;const o=this.padding_;if(o&&t){const s=this.getViewportSizeMinusPadding_(-n),a=sa(t,i,[s[0]/2+o[3],s[1]/2+o[0]],e,n);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Ui(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&$i(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=$i(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?$i(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,r,n),s=this.constraints_.center(this.targetCenter_,o,r,n,this.calculateCenterShift(this.targetCenter_,o,i,r));this.get(Ws.ROTATION)!==i&&this.set(Ws.ROTATION,i),this.get(Ws.RESOLUTION)!==o&&(this.set(Ws.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),s&&this.get(Ws.CENTER)&&_i(this.get(Ws.CENTER),s)||this.set(Ws.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=void 0!==t?t:200;const i=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,i,o),a=this.constraints_.center(this.targetCenter_,s,o,!1,this.calculateCenterShift(this.targetCenter_,s,r,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=s,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===s&&this.getRotation()===r&&this.getCenterInternal()&&_i(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:s,duration:t,easing:ea,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Hs,1)}endInteraction(t,e,n){n=n&&$i(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(Hs,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function la(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}const ua=class extends Ns{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(js,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(js)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ce(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=xe(t,ce,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const n=this.getMapInternal();let i;!t&&n&&(t=n.getView()),e=t instanceof aa?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray()),i=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return la(i,e.viewState)&&(!r||zn(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let i=e(t instanceof aa?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(Gs,t)}getMapInternal(){return this.get(Gs)}setMap(t){this.mapPrecomposeKey_&&(Ce(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ce(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=xe(t,Qr,(function(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);Ae(!e.some((function(t){return t.layer===n.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}),this),this.mapRenderKey_=xe(this,ce,t.render,t),this.changed())}setSource(t){this.set(js,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function ha(t,e,n,i,r){ca(t,e,n||0,i||t.length-1,r||pa)}function ca(t,e,n,i,r){for(;i>n;){if(i-n>600){var o=i-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);ca(t,e,Math.max(n,Math.floor(e-s*l/o+u)),Math.min(i,Math.floor(e+(o-s)*l/o+u)),r)}var h=t[e],c=n,d=i;for(da(t,n,e),r(t[i],h)>0&&da(t,n,i);c<d;){for(da(t,c,d),c++,d--;r(t[c],h)<0;)c++;for(;r(t[d],h)>0;)d--}0===r(t[n],h)?da(t,n,d):da(t,++d,i),d<=e&&(n=d+1),e<=d&&(i=d-1)}}function da(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function pa(t,e){return t<e?-1:t>e?1:0}let fa=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!Ea(t,e))return n;const i=this.toBBox,r=[];for(;e;){for(let o=0;o<e.children.length;o++){const s=e.children[o],a=e.leaf?i(s):s;Ea(t,a)&&(e.leaf?n.push(s):Sa(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n}collides(t){let e=this.data;if(!Ea(t,e))return!1;const n=[];for(;e;){for(let i=0;i<e.children.length;i++){const r=e.children[i],o=e.leaf?this.toBBox(r):r;if(Ea(t,o)){if(e.leaf||Sa(t,o))return!0;n.push(r)}}e=n.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Ia([]),this}remove(t,e){if(!t)return this;let n=this.data;const i=this.toBBox(t),r=[],o=[];let s,a,l;for(;n||r.length;){if(n||(n=r.pop(),a=r[r.length-1],s=o.pop(),l=!0),n.leaf){const i=ga(t,n.children,e);if(-1!==i)return n.children.splice(i,1),r.push(n),this._condense(r),this}l||n.leaf||!Sa(n,i)?a?(s++,n=a.children[s],l=!1):n=null:(r.push(n),o.push(s),s=0,a=n,n=n.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,i){const r=n-e+1;let o,s=this._maxEntries;if(r<=s)return o=Ia(t.slice(e,n+1)),ma(o,this.toBBox),o;i||(i=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/Math.pow(s,i-1))),o=Ia([]),o.leaf=!1,o.height=i;const a=Math.ceil(r/s),l=a*Math.ceil(Math.sqrt(s));Pa(t,e,n,l,this.compareMinX);for(let u=e;u<=n;u+=l){const e=Math.min(u+l-1,n);Pa(t,u,e,a,this.compareMinY);for(let n=u;n<=e;n+=a){const r=Math.min(n+a-1,e);o.children.push(this._build(t,n,r,i-1))}}return ma(o,this.toBBox),o}_chooseSubtree(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){let n,i=1/0,s=1/0;for(let a=0;a<e.children.length;a++){const l=e.children[a],u=xa(l),h=(r=t,o=l,(Math.max(o.maxX,r.maxX)-Math.min(o.minX,r.minX))*(Math.max(o.maxY,r.maxY)-Math.min(o.minY,r.minY))-u);h<s?(s=h,i=u<i?u:i,n=l):h===s&&u<i&&(i=u,n=l)}e=n||e.children[0]}var r,o;return e}_insert(t,e,n){const i=n?t:this.toBBox(t),r=[],o=this._chooseSubtree(i,this.data,e,r);for(o.children.push(t),ya(o,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)}_split(t,e){const n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const o=this._chooseSplitIndex(n,r,i),s=Ia(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,ma(n,this.toBBox),ma(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)}_splitRoot(t,e){this.data=Ia([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ma(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let i,r=1/0,o=1/0;for(let s=e;s<=n-e;s++){const e=_a(t,0,s,this.toBBox),a=_a(t,s,n,this.toBBox),l=Ca(e,a),u=xa(e)+xa(a);l<r?(r=l,i=s,o=u<o?u:o):l===r&&u<o&&(o=u,i=s)}return i||n-e}_chooseSplitAxis(t,e,n){const i=t.leaf?this.compareMinX:va,r=t.leaf?this.compareMinY:wa;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)}_allDistMargin(t,e,n,i){t.children.sort(i);const r=this.toBBox,o=_a(t,0,e,r),s=_a(t,n-e,n,r);let a=ba(o)+ba(s);for(let l=e;l<n-e;l++){const e=t.children[l];ya(o,t.leaf?r(e):e),a+=ba(o)}for(let l=n-e-1;l>=e;l--){const e=t.children[l];ya(s,t.leaf?r(e):e),a+=ba(s)}return a}_adjustParentBBoxes(t,e,n){for(let i=n;i>=0;i--)ya(e[i],t)}_condense(t){for(let e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children,e.splice(e.indexOf(t[n]),1)):this.clear():ma(t[n],this.toBBox)}};function ga(t,e,n){if(!n)return e.indexOf(t);for(let i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function ma(t,e){_a(t,0,t.children.length,e,t)}function _a(t,e,n,i,r){r||(r=Ia(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let o=e;o<n;o++){const e=t.children[o];ya(r,t.leaf?i(e):e)}return r}function ya(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function va(t,e){return t.minX-e.minX}function wa(t,e){return t.minY-e.minY}function xa(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function ba(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ca(t,e){const n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}function Sa(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ea(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Ia(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Pa(t,e,n,i,r){const o=[e,n];for(;o.length;){if((n=o.pop())-(e=o.pop())<=i)continue;const s=e+Math.ceil((n-e)/i/2)*i;ha(t,s,e,n,r),o.push(e,s,s,n)}}function Ta(t,e){return e&&(t.src=e),t.src&&Xe?new Promise(((e,n)=>t.decode().then((()=>e(t))).catch((i=>t.complete&&t.width?e(t):n(i))))):function(t,e){return new Promise(((n,i)=>{function r(){s(),n(t)}function o(){s(),i(new Error("Image load error"))}function s(){t.removeEventListener("load",r),t.removeEventListener("error",o)}t.addEventListener("load",r),t.addEventListener("error",o),e&&(t.src=e)}))}(t)}function ka(t,e){return e&&(t.src=e),t.src&&Xe&&Ue?t.decode().then((()=>createImageBitmap(t))).catch((e=>{if(t.complete&&t.width)return t;throw e})):Ta(t)}const Da=class extends he{constructor(t,e,n,i){super(),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state="function"==typeof i?co:i,this.image_=null,this.loader="function"==typeof i?i:null}changed(){this.dispatchEvent(ce)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==co&&this.loader){this.state=po,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;ae((()=>this.loader(this.getExtent(),e,this.getPixelRatio()))).then((t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=fo})).catch((t=>{this.state=go})).finally((()=>this.changed()))}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}};function Ma(t,e,n){return e+":"+t+":"+(n?ko(n):"null")}const La=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];3&t++||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){const i=Ma(t,e,n);return i in this.cache_?this.cache_[i]:null}set(t,e,n,i){const r=Ma(t,e,n);this.cache_[r]=i,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let Ra=null;class Oa extends he{constructor(t,e,n,i,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=r,this.imageState_=void 0===i?co:i,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===fo){Ra||(Ra=Go(1,1,void 0,{willReadFrequently:!0})),Ra.drawImage(this.image_,0,0);try{Ra.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Ra=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(ce)}handleImageError_(){this.imageState_=go,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=fo,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Go(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===co){this.image_||this.initializeImage_(),this.imageState_=po;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&Ta(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==fo)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const i=n.getContext("2d");i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=ko(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}}function Fa(t,e,n,i){return void 0!==n&&void 0!==i?[n/t,i/e]:void 0!==n?n/t:void 0!==i?i/e:1}class Aa extends wo{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,n=void 0!==t.rotation?t.rotation:0,i=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:n,scale:i,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const o=void 0!==t.img?t.img:null;let s,a=t.src;if(Ae(!(void 0!==a&&o),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!o||(a=o.src||Te(o)),Ae(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Ae(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?s=co:void 0!==o&&(s=o instanceof HTMLImageElement?o.complete?o.src?fo:co:po:fo),this.color_=void 0!==t.color?Ao(t.color):null,this.iconImage_=function(t,e,n,i,r){let o=void 0===e?void 0:La.get(e,n,r);return o||(o=new Oa(t,t instanceof HTMLImageElement?t.src||void 0:e,n,i,r),La.set(e,n,r,o)),o}(o,a,this.crossOrigin_,s,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,n;if(t.size)[e,n]=t.size;else{const i=this.getImage(1);if(i.width&&i.height)e=i.width,n=i.height;else if(i instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const n=this.iconImage_.getSize();this.setScale(Fa(n[0],n[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Fa(e,n,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Aa({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=n[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==fo?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==fo?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(ce,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(ce,t)}}const za=Aa;let Ba=0;const ja=0,Ga=1<<Ba++,Na=1<<Ba++,Va=1<<Ba++,Ha=1<<Ba++,Wa=1<<Ba++,Xa=Math.pow(2,5)-1,Ua={[Ga]:"boolean",[Na]:"number",[Va]:"string",[Ha]:"color",[Wa]:"number[]"},$a=Object.keys(Ua).map(Number).sort(Jt);function Ya(t){const e=[];for(const i of $a)(t&(n=i))===n&&e.push(Ua[i]);var n;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function qa(t,e){return!!(t&e)}function Za(t,e){return t===e}class Ka{constructor(t,e){this.type=t,this.value=e}}class Ja{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function Qa(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function tl(t,e,n){switch(typeof t){case"boolean":return new Ka(Ga,t);case"number":return new Ka(Na,t);case"string":{let e=Va;return function(t){try{return Fo(t),!0}catch(e){return!1}}(t)&&(e|=Ha),Za(e&n,ja)||(e&=n),new Ka(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,n){const i=t[0],r=nl[i];if(!r)throw new Error(`Unknown operator: ${i}`);return r(t,e,n)}(t,e,n);for(const r of t)if("number"!=typeof r)throw new Error("Expected an array of numbers");let i=Wa;return 3!==t.length&&4!==t.length||(i|=Ha),n&&(i&=n),new Ka(i,t)}const el={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},nl={[el.Get]:ll((([t,e])=>void 0!==e?function(t){switch(t){case"string":return Va;case"color":return Ha;case"number":return Na;case"boolean":return Ga;case"number[]":return Wa;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):Xa),rl(1,2),(function(t,e){const n=tl(t[1],e);if(!(n instanceof Ka))throw new Error("Expected a literal argument for get operation");if("string"!=typeof n.value)throw new Error("Expected a string argument for get operation");if(e.properties.add(n.value),3===t.length){return[n,tl(t[2],e)]}return[n]})),[el.Var]:ll((([t])=>t.type),rl(1,1),(function(t,e,n,i){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new Ka(Xa,r)];const o=tl(e.style.variables[r],e);if(o.value=r,i&&!qa(i,o.type))throw new Error(`The variable ${r} has type ${Ya(o.type)} but the following type was expected: ${Ya(i)}`);return[o]})),[el.Id]:ll(Na|Va,il,(function(t,e){e.featureId=!0})),[el.Concat]:ll(Va,rl(2,1/0),ol(Xa)),[el.GeometryType]:ll(Va,il),[el.Resolution]:ll(Na,il),[el.Zoom]:ll(Na,il),[el.Time]:ll(Na,il),[el.Any]:ll(Ga,rl(2,1/0),ol(Ga)),[el.All]:ll(Ga,rl(2,1/0),ol(Ga)),[el.Not]:ll(Ga,rl(1,1),ol(Ga)),[el.Equal]:ll(Ga,rl(2,2),ol(Xa),sl),[el.NotEqual]:ll(Ga,rl(2,2),ol(Xa),sl),[el.GreaterThan]:ll(Ga,rl(2,2),ol(Xa),sl),[el.GreaterThanOrEqualTo]:ll(Ga,rl(2,2),ol(Xa),sl),[el.LessThan]:ll(Ga,rl(2,2),ol(Xa),sl),[el.LessThanOrEqualTo]:ll(Ga,rl(2,2),ol(Xa),sl),[el.Multiply]:ll((t=>{let e=Na|Ha;for(let n=0;n<t.length;n++)e&=t[n].type;return e}),rl(2,1/0),ol(Na|Ha),sl),[el.Divide]:ll(Na,rl(2,2),ol(Na)),[el.Add]:ll(Na,rl(2,1/0),ol(Na)),[el.Subtract]:ll(Na,rl(2,2),ol(Na)),[el.Clamp]:ll(Na,rl(3,3),ol(Na)),[el.Mod]:ll(Na,rl(2,2),ol(Na)),[el.Pow]:ll(Na,rl(2,2),ol(Na)),[el.Abs]:ll(Na,rl(1,1),ol(Na)),[el.Floor]:ll(Na,rl(1,1),ol(Na)),[el.Ceil]:ll(Na,rl(1,1),ol(Na)),[el.Round]:ll(Na,rl(1,1),ol(Na)),[el.Sin]:ll(Na,rl(1,1),ol(Na)),[el.Cos]:ll(Na,rl(1,1),ol(Na)),[el.Atan]:ll(Na,rl(1,2),ol(Na)),[el.Sqrt]:ll(Na,rl(1,1),ol(Na)),[el.Match]:ll((t=>{let e=Xa;for(let n=2;n<t.length;n+=2)e&=t[n].type;return e&=t[t.length-1].type,e}),rl(4,1/0),al,(function(t,e,n,i){const r=t.length-1;let o=tl(t[1],e).type;const s=tl(t[t.length-1],e);let a=void 0!==i?i&s.type:s.type;const l=new Array(r-2);for(let h=0;h<r-2;h+=2){const n=tl(t[h+2],e),i=tl(t[h+3],e);o&=n.type,a&=i.type,l[h]=n,l[h+1]=i}const u=Va|Na|Ga;if(!qa(u,o))throw new Error(`Expected an input of type ${Ya(u)} for the interpolate operation, got ${Ya(o)} instead`);if(Za(a,ja))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let h=0;h<r-2;h+=2){const n=tl(t[h+2],e,o),i=tl(t[h+3],e,a);l[h]=n,l[h+1]=i}return[tl(t[1],e,o),...l,tl(t[t.length-1],e,a)]})),[el.Between]:ll(Ga,rl(3,3),ol(Na)),[el.Interpolate]:ll((t=>{let e=Ha|Na;for(let n=3;n<t.length;n+=2)e&=t[n].type;return e}),rl(6,1/0),al,(function(t,e,n,i){const r=t[1];let o;switch(r[0]){case"linear":o=1;break;case"exponential":if(o=r[1],"number"!=typeof o)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(o)} instead`);break;default:o=null}if(!o)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);o=tl(o,e);let s=tl(t[2],e);if(!qa(Na,s.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${Ya(s.type)} instead`);s=tl(t[2],e,Na);const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){let n=tl(t[l+3],e);if(!qa(Na,n.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${Ya(n.type)} at position ${l+2} instead`);let i=tl(t[l+4],e);if(!qa(Na|Ha,i.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${Ya(i.type)} at position ${l+3} instead`);n=tl(t[l+3],e,Na),i=tl(t[l+4],e,Na|Ha),a[l]=n,a[l+1]=i}return[o,s,...a]})),[el.Case]:ll((t=>{let e=Xa;for(let n=1;n<t.length;n+=2)e&=t[n].type;return e&=t[t.length-1].type,e}),rl(3,1/0),(function(t,e){const n=t[0],i=t.length-1;if(i%2==0)throw new Error(`An odd amount of arguments was expected for operation ${n}, got ${JSON.stringify(i)} instead`)}),(function(t,e,n,i){const r=tl(t[t.length-1],e);let o=void 0!==i?i&r.type:r.type;const s=new Array(t.length-1);for(let a=0;a<s.length-1;a+=2){const n=tl(t[a+1],e),i=tl(t[a+2],e);if(!qa(Ga,n.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${Ya(n.type)} at position ${a} instead`);o&=i.type,s[a]=n,s[a+1]=i}if(Za(o,ja))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let a=0;a<s.length-1;a+=2)s[a+1]=tl(t[a+2],e,o);return s[s.length-1]=tl(t[t.length-1],e,o),s})),[el.In]:ll(Ga,rl(2,2),(function(t,e){let n=t[2];if(!Array.isArray(n))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof n[0]){if("literal"!==n[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(n[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');n=n[1]}let i=Va|Na;const r=new Array(n.length);for(let o=0;o<r.length;o++){const t=tl(n[o],e);i&=t.type,r[o]=t}if(Za(i,ja))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[tl(t[1],e,i),...r]})),[el.Number]:ll(Na,rl(1,1/0),ol(Xa)),[el.String]:ll(Va,rl(1,1/0),ol(Xa)),[el.Array]:ll((t=>3===t.length||4===t.length?Wa|Ha:Wa),rl(1,1/0),ol(Na)),[el.Color]:ll(Ha,rl(3,4),ol(Na)),[el.Band]:ll(Na,rl(1,3),ol(Na)),[el.Palette]:ll(Ha,rl(2,2),(function(t,e){const n=tl(t[1],e,Na);if(n.type!==Na)throw new Error(`The first argument of palette must be an number, got ${Ya(n.type)} instead`);const i=t[2];if(!Array.isArray(i))throw new Error("The second argument of palette must be an array");const r=new Array(i.length);for(let o=0;o<r.length;o++){const t=tl(i[o],e,Ha);if(!(t instanceof Ka))throw new Error(`The palette color at index ${o} must be a literal value`);if(!qa(t.type,Ha))throw new Error(`The palette color at index ${o} should be of type color, got ${Ya(t.type)} instead`);r[o]=t}return[n,...r]}))};function il(t,e){const n=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${n} operation`);return[]}function rl(t,e){return function(n,i){const r=n[0],o=n.length-1;if(t===e){if(o!==t){throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${o}`)}}else if(o<t||o>e){throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${o}`)}}}function ol(t){return function(e,n){const i=e[0],r=e.length-1,o=new Array(r);for(let s=0;s<r;++s){const r=tl(e[s+1],n);if(!qa(t,r.type)){const e=Ya(t),n=Ya(r.type);throw new Error(`Unexpected type for argument ${s} of ${i} operation, got ${e} but expected ${n}`)}r.type&=t,o[s]=r}return o}}function sl(t,e,n){const i=t[0],r=t.length-1;let o=Xa;for(let a=0;a<n.length;++a)o&=n[a].type;if(o===ja)throw new Error(`No common type could be found for arguments of ${i} operation`);const s=new Array(r);for(let a=0;a<r;++a)s[a]=tl(t[a+1],e,o);return s}function al(t,e){const n=t[0],i=t.length-1;if(i%2==1)throw new Error(`An even amount of arguments was expected for operation ${n}, got ${JSON.stringify(i)} instead`)}function ll(t,...e){return function(n,i,r){const o=n[0];let s=[];for(let t=0;t<e.length;t++)s=e[t](n,i,s,r)||s;let a="function"==typeof t?t(s):t;if(void 0!==r){if(!qa(a,r))throw new Error(`The following expression was expected to return ${Ya(r)}, but returns ${Ya(a)} instead: ${JSON.stringify(n)}`);a&=r}if(a===ja)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(n)}`);return new Ja(a,o,...s)}}function ul(t,e,n){const i=tl(t,n);if(!qa(e,i.type)){const t=Ya(e),n=Ya(i.type);throw new Error(`Expected expression to be of type ${t}, got ${n}`)}return hl(i)}function hl(t,e){if(t instanceof Ka){if(t.type===Ha&&"string"==typeof t.value){const e=Fo(t.value);return function(){return e}}return function(){return t.value}}const n=t.operator;switch(n){case el.Number:case el.String:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=hl(t.args[o]);switch(n){case el.Number:case el.String:return t=>{for(let e=0;e<i;++e){const i=r[e](t);if(typeof i===n)return i}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}(t);case el.Get:case el.Var:return function(t,e){const n=t.args[0],i=n.value;switch(t.operator){case el.Get:return t=>t.properties[i];case el.Var:return t=>t.variables[i];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case el.Id:return t=>t.featureId;case el.Concat:{const e=t.args.map((t=>hl(t)));return t=>"".concat(...e.map((e=>e(t).toString())))}case el.Resolution:return t=>t.resolution;case el.Any:case el.All:case el.Not:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=hl(t.args[o]);switch(n){case el.Any:return t=>{for(let e=0;e<i;++e)if(r[e](t))return!0;return!1};case el.All:return t=>{for(let e=0;e<i;++e)if(!r[e](t))return!1;return!0};case el.Not:return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${n}`)}}(t);case el.Equal:case el.NotEqual:case el.LessThan:case el.LessThanOrEqualTo:case el.GreaterThan:case el.GreaterThanOrEqualTo:return function(t,e){const n=t.operator,i=hl(t.args[0]),r=hl(t.args[1]);switch(n){case el.Equal:return t=>i(t)===r(t);case el.NotEqual:return t=>i(t)!==r(t);case el.LessThan:return t=>i(t)<r(t);case el.LessThanOrEqualTo:return t=>i(t)<=r(t);case el.GreaterThan:return t=>i(t)>r(t);case el.GreaterThanOrEqualTo:return t=>i(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${n}`)}}(t);case el.Multiply:case el.Divide:case el.Add:case el.Subtract:case el.Clamp:case el.Mod:case el.Pow:case el.Abs:case el.Floor:case el.Ceil:case el.Round:case el.Sin:case el.Cos:case el.Atan:case el.Sqrt:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let o=0;o<i;++o)r[o]=hl(t.args[o]);switch(n){case el.Multiply:return t=>{let e=1;for(let n=0;n<i;++n)e*=r[n](t);return e};case el.Divide:return t=>r[0](t)/r[1](t);case el.Add:return t=>{let e=0;for(let n=0;n<i;++n)e+=r[n](t);return e};case el.Subtract:return t=>r[0](t)-r[1](t);case el.Clamp:return t=>{const e=r[0](t),n=r[1](t);if(e<n)return n;const i=r[2](t);return e>i?i:e};case el.Mod:return t=>r[0](t)%r[1](t);case el.Pow:return t=>Math.pow(r[0](t),r[1](t));case el.Abs:return t=>Math.abs(r[0](t));case el.Floor:return t=>Math.floor(r[0](t));case el.Ceil:return t=>Math.ceil(r[0](t));case el.Round:return t=>Math.round(r[0](t));case el.Sin:return t=>Math.sin(r[0](t));case el.Cos:return t=>Math.cos(r[0](t));case el.Atan:return 2===i?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case el.Sqrt:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${n}`)}}(t);case el.Match:return function(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=hl(t.args[r]);return t=>{const e=i[0](t);for(let r=1;r<n;r+=2)if(e===i[r](t))return i[r+1](t);return i[n-1](t)}}(t);case el.Interpolate:return function(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=hl(t.args[r]);return t=>{const e=i[0](t),r=i[1](t);let o,s;for(let a=2;a<n;a+=2){const n=i[a](t);let l=i[a+1](t);const u=Array.isArray(l);if(u&&(l=Ro(l)),n>=r)return 2===a?l:u?dl(e,r,o,s,n,l):cl(e,r,o,s,n,l);o=n,s=l}return s}}(t);default:throw new Error(`Unsupported operator ${n}`)}}function cl(t,e,n,i,r,o){const s=r-n;if(0===s)return i;const a=e-n;return i+(1===t?a/s:(Math.pow(t,a)-1)/(Math.pow(t,s)-1))*(o-i)}function dl(t,e,n,i,r,o){if(0===r-n)return i;const s=Oo(i),a=Oo(o);let l=a[2]-s[2];l>180?l-=360:l<-180&&(l+=360);return zo(function(t){const e=bo.rgb(So.xyz(t));return e[3]=t[3],e}([cl(t,e,n,s[0],r,a[0]),cl(t,e,n,s[1],r,a[1]),s[2]+cl(t,e,n,0,r,l),cl(t,e,n,i[3],r,o[3])]))}function pl(t){return!0}function fl(t){const e=Qa(),n=function(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r){const n=t[r],o="filter"in n?ul(n.filter,Ga,e):pl;let s;if(Array.isArray(n.style)){const t=n.style.length;s=new Array(t);for(let i=0;i<t;++i)s[i]=ml(n.style[i],e)}else s=[ml(n.style,e)];i[r]={filter:o,styles:s}}return function(e){const r=[];let o=!1;for(let s=0;s<n;++s){if((0,i[s].filter)(e)&&(!t[s].else||!o)){o=!0;for(const t of i[s].styles){const n=t(e);n&&r.push(n)}}}return r}}(t,e),i={variables:{},properties:{},resolution:NaN,featureId:null};return function(t,r){if(i.properties=t.getPropertiesInternal(),i.resolution=r,e.featureId){const e=t.getId();i.featureId=void 0!==e?e:null}return n(i)}}function gl(t){const e=Qa(),n=t.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=ml(t[s],e);const r={variables:{},properties:{},resolution:NaN,featureId:null},o=new Array(n);return function(t,s){if(r.properties=t.getPropertiesInternal(),r.resolution=s,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let e=0;e<n;++e){const t=i[e](r);t&&(o[a]=t,a+=1)}return o.length=a,o}}function ml(t,e){const n=_l(t,"",e),i=yl(t,"",e),r=function(t,e){const n="text-",i=wl(t,n+"value",e);if(!i)return null;const r=_l(t,n,e),o=_l(t,n+"background-",e),s=yl(t,n,e),a=yl(t,n+"background-",e),l=wl(t,n+"font",e),u=vl(t,n+"max-angle",e),h=vl(t,n+"offset-x",e),c=vl(t,n+"offset-y",e),d=xl(t,n+"overflow",e),p=wl(t,n+"placement",e),f=vl(t,n+"repeat",e),g=El(t,n+"scale",e),m=xl(t,n+"rotate-with-view",e),_=vl(t,n+"rotation",e),y=wl(t,n+"align",e),v=wl(t,n+"justify",e),w=wl(t,n+"baseline",e),x=Cl(t,n+"padding",e),b=new Ds({});return function(t){if(b.setText(i(t)),r&&b.setFill(r(t)),o&&b.setBackgroundFill(o(t)),s&&b.setStroke(s(t)),a&&b.setBackgroundStroke(a(t)),l&&b.setFont(l(t)),u&&b.setMaxAngle(u(t)),h&&b.setOffsetX(h(t)),c&&b.setOffsetY(c(t)),d&&b.setOverflow(d(t)),p){const e=p(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");b.setPlacement(e)}if(f&&b.setRepeat(f(t)),g&&b.setScale(g(t)),m&&b.setRotateWithView(m(t)),_&&b.setRotation(_(t)),y){const e=y(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");b.setTextAlign(e)}if(v){const e=v(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");b.setJustify(e)}if(w){const e=w(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");b.setTextBaseline(e)}return x&&b.setPadding(x(t)),b}}(t,e),o=function(t,e){if("icon-src"in t)return function(t,e){const n="icon-",i=n+"src",r=Ml(t[i],i),o=Sl(t,n+"anchor",e),s=El(t,n+"scale",e),a=vl(t,n+"opacity",e),l=Sl(t,n+"displacement",e),u=vl(t,n+"rotation",e),h=xl(t,n+"rotate-with-view",e),c=Pl(t,n+"anchor-origin"),d=Tl(t,n+"anchor-x-units"),p=Tl(t,n+"anchor-y-units"),f=function(t,e){const n=t[e];if(void 0===n)return;return Rl(n,e)}(t,n+"color"),g=function(t,e){const n=t[e];if(void 0===n)return;if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);return n}(t,n+"cross-origin"),m=function(t,e){const n=t[e];if(void 0===n)return;return Dl(n,e)}(t,n+"offset"),_=Pl(t,n+"offset-origin"),y=Il(t,n+"width"),v=Il(t,n+"height"),w=function(t,e){const n=t[e];if(void 0===n)return;if("number"==typeof n)return yo(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])throw new Error(`Expected a number or size array for ${e}`);return n}(t,n+"size"),x=kl(t,n+"declutter"),b=new za({src:r,anchorOrigin:c,anchorXUnits:d,anchorYUnits:p,color:f,crossOrigin:g,offset:m,offsetOrigin:_,height:v,width:y,size:w,declutterMode:x});return function(t){return a&&b.setOpacity(a(t)),l&&b.setDisplacement(l(t)),u&&b.setRotation(u(t)),h&&b.setRotateWithView(h(t)),s&&b.setScale(s(t)),o&&b.setAnchor(o(t)),b}}(t,e);if("shape-points"in t)return function(t,e){const n="shape-",i=n+"points",r=Ll(t[i],i),o=_l(t,n,e),s=yl(t,n,e),a=El(t,n+"scale",e),l=Sl(t,n+"displacement",e),u=vl(t,n+"rotation",e),h=xl(t,n+"rotate-with-view",e),c=Il(t,n+"radius"),d=Il(t,n+"radius1"),p=Il(t,n+"radius2"),f=Il(t,n+"angle"),g=kl(t,n+"declutter-mode"),m=new ws({points:r,radius:c,radius1:d,radius2:p,angle:f,declutterMode:g});return function(t){return o&&m.setFill(o(t)),s&&m.setStroke(s(t)),l&&m.setDisplacement(l(t)),u&&m.setRotation(u(t)),h&&m.setRotateWithView(h(t)),a&&m.setScale(a(t)),m}}(t,e);if("circle-radius"in t)return function(t,e){const n="circle-",i=_l(t,n,e),r=yl(t,n,e),o=vl(t,n+"radius",e),s=El(t,n+"scale",e),a=Sl(t,n+"displacement",e),l=vl(t,n+"rotation",e),u=xl(t,n+"rotate-with-view",e),h=kl(t,n+"declutter-mode"),c=new bs({radius:5,declutterMode:h});return function(t){return o&&c.setRadius(o(t)),i&&c.setFill(i(t)),r&&c.setStroke(r(t)),a&&c.setDisplacement(a(t)),l&&c.setRotation(l(t)),u&&c.setRotateWithView(u(t)),s&&c.setScale(s(t)),c}}(t,e);return null}(t,e),s=vl(t,"z-index",e);if(!(n||i||r||o||ue(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Ts;return function(t){let e=!0;if(n){const i=n(t);i&&(e=!1),a.setFill(i)}if(i){const n=i(t);n&&(e=!1),a.setStroke(n)}if(r){const n=r(t);n&&(e=!1),a.setText(n)}if(o){const n=o(t);n&&(e=!1),a.setImage(n)}return s&&a.setZIndex(s(t)),e?null:a}}function _l(t,e,n){const i=bl(t,e+"fill-color",n);if(!i)return null;const r=new io;return function(t){const e=i(t);return"none"===e?null:(r.setColor(e),r)}}function yl(t,e,n){const i=vl(t,e+"stroke-width",n),r=bl(t,e+"stroke-color",n);if(!i&&!r)return null;const o=wl(t,e+"stroke-line-cap",n),s=wl(t,e+"stroke-line-join",n),a=Cl(t,e+"stroke-line-dash",n),l=vl(t,e+"stroke-line-dash-offset",n),u=vl(t,e+"stroke-miter-limit",n),h=new ho;return function(t){if(r){const e=r(t);if("none"===e)return null;h.setColor(e)}if(i&&h.setWidth(i(t)),o){const e=o(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");h.setLineCap(e)}if(s){const e=s(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(e)}return a&&h.setLineDash(a(t)),l&&h.setLineDashOffset(l(t)),u&&h.setMiterLimit(u(t)),h}}function vl(t,e,n){if(!(e in t))return;const i=ul(t[e],Na,n);return function(t){return Ll(i(t),e)}}function wl(t,e,n){if(!(e in t))return null;const i=ul(t[e],Va,n);return function(t){return Ml(i(t),e)}}function xl(t,e,n){if(!(e in t))return null;const i=ul(t[e],Ga,n);return function(t){const n=i(t);if("boolean"!=typeof n)throw new Error(`Expected a boolean for ${e}`);return n}}function bl(t,e,n){if(!(e in t))return null;const i=ul(t[e],Ha|Va,n);return function(t){return Rl(i(t),e)}}function Cl(t,e,n){if(!(e in t))return null;const i=ul(t[e],Wa,n);return function(t){return Dl(i(t),e)}}function Sl(t,e,n){if(!(e in t))return null;const i=ul(t[e],Wa,n);return function(t){const n=Dl(i(t),e);if(2!==n.length)throw new Error(`Expected two numbers for ${e}`);return n}}function El(t,e,n){if(!(e in t))return null;const i=ul(t[e],Wa|Na,n);return function(t){return function(t,e){if("number"==typeof t)return t;const n=Dl(t,e);if(2!==n.length)throw new Error(`Expected an array of two numbers for ${e}`);return n}(i(t),e)}}function Il(t,e){const n=t[e];if(void 0!==n){if("number"!=typeof n)throw new Error(`Expected a number for ${e}`);return n}}function Pl(t,e){const n=t[e];if(void 0!==n){if("bottom-left"!==n&&"bottom-right"!==n&&"top-left"!==n&&"top-right"!==n)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function Tl(t,e){const n=t[e];if(void 0!==n){if("pixels"!==n&&"fraction"!==n)throw new Error(`Expected pixels or fraction for ${e}`);return n}}function kl(t,e){const n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);if("declutter"!==n&&"obstacle"!==n&&"none"!==n)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function Dl(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let i=0;i<n;++i)if("number"!=typeof t[i])throw new Error(`Expected an array of numbers for ${e}`);return t}function Ml(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function Ll(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function Rl(t,e){if("string"==typeof t)return t;const n=Dl(t,e),i=n.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}const Ol="renderOrder";const Fl=class extends ua{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Ol)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new fa(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(Ol,t)}setStyle(t){this.style_=function(t){if(void 0===t)return Es;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Ts)return t;if(!Array.isArray(t))return gl([t]);if(0===t.length)return[];const e=t.length,n=t[0];if(n instanceof Ts){const n=new Array(e);for(let i=0;i<e;++i){const e=t[i];if(!(e instanceof Ts))throw new Error("Expected a list of style instances");n[i]=e}return n}if("style"in n){const n=new Array(e);for(let i=0;i<e;++i){const e=t[i];if(!("style"in e))throw new Error("Expected a list of rules with a style property");n[i]=e}return fl(n)}const i=t;return gl(i)}(t),this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let n;Array.isArray(t)?n=t:(Ae("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}(this.style_),this.changed()}},Al={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},zl=[Al.FILL],Bl=[Al.STROKE],jl=[Al.BEGIN_PATH],Gl=[Al.CLOSE_PATH],Nl=Al;const Vl=class{drawCustom(t,e,n,i){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}};const Hl=class extends Vl{constructor(t,e,n,i){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let s=0,a=t.length;s<a;s+=e)i[0]=t[s],i[1]=t[s+1],hn(n,i)&&(r[o++]=i[0],r[o++]=i[1]);return o}appendFlatLineCoordinates(t,e,n,i,r,o){const s=this.coordinates;let a=s.length;const l=this.getBufferedMaxExtent();o&&(e+=i);let u=t[e],h=t[e+1];const c=this.tmpCoordinate_;let d,p,f,g=!0;for(d=e+i;d<n;d+=i)c[0]=t[d],c[1]=t[d+1],f=pn(l,c),f!==p?(g&&(s[a++]=u,s[a++]=h,g=!1),s[a++]=c[0],s[a++]=c[1]):f===on.INTERSECTING?(s[a++]=c[0],s[a++]=c[1],g=!1):g=!0,u=c[0],h=c[1],p=f;return(r&&g||d===e+i)&&(s[a++]=u,s[a++]=h),a}drawCustomCoordinates_(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){const s=n[o],a=this.appendFlatLineCoordinates(t,e,s,i,!1,!1);r.push(a),e=s}return e}drawCustom(t,e,n,i){this.beginGeometry(t,e);const r=t.getType(),o=t.getStride(),s=this.coordinates.length;let a,l,u,h,c;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),h=[];const e=t.getEndss();c=0;for(let t=0,n=e.length;t<n;++t){const n=[];c=this.drawCustomCoordinates_(a,c,e[t],o,n),h.push(n)}this.instructions.push([Nl.CUSTOM,s,h,t,n,br]),this.hitDetectionInstructions.push([Nl.CUSTOM,s,h,t,i||n,br]);break;case"Polygon":case"MultiLineString":u=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),c=this.drawCustomCoordinates_(a,0,t.getEnds(),o,u),this.instructions.push([Nl.CUSTOM,s,u,t,n,xr]),this.hitDetectionInstructions.push([Nl.CUSTOM,s,u,t,i||n,xr]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),l=this.appendFlatLineCoordinates(a,0,a.length,o,!1,!1),this.instructions.push([Nl.CUSTOM,s,l,t,n,wr]),this.hitDetectionInstructions.push([Nl.CUSTOM,s,l,t,i||n,wr]);break;case"MultiPoint":a=t.getFlatCoordinates(),l=this.appendFlatPointCoordinates(a,o),l>s&&(this.instructions.push([Nl.CUSTOM,s,l,t,n,wr]),this.hitDetectionInstructions.push([Nl.CUSTOM,s,l,t,i||n,wr]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),l=this.coordinates.length,this.instructions.push([Nl.CUSTOM,s,l,t,n]),this.hitDetectionInstructions.push([Nl.CUSTOM,s,l,t,i||n])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Nl.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Nl.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let i,r,o=-1;for(e=0;e<n;++e)i=t[e],r=i[0],r==Nl.END_GEOMETRY?o=e:r==Nl.BEGIN_GEOMETRY&&(i[2]=e,te(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const e=t.getColor();n.fillStyle=jo(e||es)}else n.fillStyle=void 0;if(e){const t=e.getColor();n.strokeStyle=jo(t||os);const i=e.getLineCap();n.lineCap=void 0!==i?i:ns;const r=e.getLineDash();n.lineDash=r?r.slice():is;const o=e.getLineDashOffset();n.lineDashOffset=o||0;const s=e.getLineJoin();n.lineJoin=void 0!==s?s:rs;const a=e.getWidth();n.lineWidth=void 0!==a?a:1;const l=e.getMiterLimit();n.miterLimit=void 0!==l?l:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[Nl.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(!0),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Nl.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,i=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=i||r!=t.currentLineDash&&!ne(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=i,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Nl.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ln(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;an(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}};const Wl=class extends Hl{constructor(t,e,n,i){super(t,e,n,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(n,i);this.instructions.push([Nl.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Nl.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.appendFlatPointCoordinates(n,i);this.instructions.push([Nl.DRAW_IMAGE,r,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Nl.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),i=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=i[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}};const Xl=class extends Hl{constructor(t,e,n,i){super(t,e,n,i)}drawFlatCoordinates_(t,e,n,i){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,i,!1,!1),s=[Nl.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),n}drawLineString(t,e){const n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0===i||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Nl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,is,0],jl);const o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(Bl),this.endGeometry(e)}drawMultiLineString(t,e){const n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0===i||void 0===r)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Nl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,is,0],jl);const o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride();let l=0;for(let u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(Bl),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Bl),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Bl),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(jl)}};const Ul=class extends Hl{constructor(t,e,n,i){super(t,e,n,i)}drawFlatCoordinatess_(t,e,n,i){const r=this.state,o=void 0!==r.fillStyle,s=void 0!==r.strokeStyle,a=n.length;this.instructions.push(jl),this.hitDetectionInstructions.push(jl);for(let l=0;l<a;++l){const r=n[l],o=this.coordinates.length,a=this.appendFlatLineCoordinates(t,e,r,i,!0,!s),u=[Nl.MOVE_TO_LINE_TO,o,a];this.instructions.push(u),this.hitDetectionInstructions.push(u),s&&(this.instructions.push(Gl),this.hitDetectionInstructions.push(Gl)),e=r}return o&&(this.instructions.push(zl),this.hitDetectionInstructions.push(zl)),s&&(this.instructions.push(Bl),this.hitDetectionInstructions.push(Bl)),e}drawCircle(t,e){const n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0===i&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Nl.SET_FILL_STYLE,es]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Nl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,is,0]);const o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,s,!1,!1);const l=[Nl.CIRCLE,a];this.instructions.push(jl,l),this.hitDetectionInstructions.push(jl,l),void 0!==n.fillStyle&&(this.instructions.push(zl),this.hitDetectionInstructions.push(zl)),void 0!==n.strokeStyle&&(this.instructions.push(Bl),this.hitDetectionInstructions.push(Bl)),this.endGeometry(e)}drawPolygon(t,e){const n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0===i&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Nl.SET_FILL_STYLE,es]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Nl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,is,0]);const o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(e)}drawMultiPolygon(t,e){const n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0===i&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Nl.SET_FILL_STYLE,es]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Nl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,is,0]);const o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride();let l=0;for(let u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let n=0,i=e.length;n<i;++n)e[n]=_r(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function $l(t,e,n,i,r){const o=[];let s=n,a=0,l=e.slice(n,2);for(;a<t&&s+r<i;){const[n,i]=l.slice(-2),u=e[s+r],h=e[s+r+1],c=Math.sqrt((u-n)*(u-n)+(h-i)*(h-i));if(a+=c,a>=t){const e=(t-a+c)/c,d=ci(n,u,e),p=ci(i,h,e);l.push(d,p),o.push(l),l=[d,p],a==t&&(s+=r),a=0}else if(a<t)l.push(e[s+r],e[s+r+1]),s+=r;else{const t=c-a,e=ci(n,u,t/c),d=ci(i,h,t/c);l.push(e,d),o.push(l),l=[e,d],a=0,s+=r}}return a>0&&o.push(l),o}function Yl(t,e,n,i,r){let o,s,a,l,u,h,c,d,p,f,g=n,m=n,_=0,y=0,v=n;for(s=n;s<i;s+=r){const n=e[s],i=e[s+1];void 0!==u&&(p=n-u,f=i-h,l=Math.sqrt(p*p+f*f),void 0!==c&&(y+=a,o=Math.acos((c*p+d*f)/(a*l)),o>t&&(y>_&&(_=y,g=v,m=s),y=0,v=s-r)),a=l,c=p,d=f),u=n,h=i}return y+=l,y>_?[v,s]:[g,m]}const ql={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};const Zl={Circle:Ul,Default:Hl,Image:Wl,LineString:Xl,Polygon:Ul,Text:class extends Hl{constructor(t,e,n,i){super(t,e,n,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[es]={fillStyle:es},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const n=this.textFillState_,i=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!n&&!i)return;const o=this.coordinates;let s=o.length;const a=t.getType();let l=null,u=t.getStride();if("line"!==r.placement||"LineString"!=a&&"MultiLineString"!=a&&"Polygon"!=a&&"MultiPolygon"!=a){let n=r.overflow?null:[];switch(a){case"Point":case"MultiPoint":l=t.getFlatCoordinates();break;case"LineString":l=t.getFlatMidpoint();break;case"Circle":l=t.getCenter();break;case"MultiLineString":l=t.getFlatMidpoints(),u=2;break;case"Polygon":l=t.getFlatInteriorPoint(),r.overflow||n.push(l[2]/this.resolution),u=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();l=[];for(let t=0,i=e.length;t<i;t+=3)r.overflow||n.push(e[t+2]/this.resolution),l.push(e[t],e[t+1]);if(0===l.length)return;u=2}const i=this.appendFlatPointCoordinates(l,u);if(i===s)return;if(n&&(i-s)/2!=l.length/u){let t=s/2;n=n.filter(((e,n)=>{const i=o[2*(t+n)]===l[n*u]&&o[2*(t+n)+1]===l[n*u+1];return i||--t,i}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let h=r.padding;if(h!=ls&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],n=r.padding[2],i=r.padding[3];r.scale[0]<0&&(e=-e,i=-i),r.scale[1]<0&&(t=-t,n=-n),h=[t,e,n,i]}const c=this.pixelRatio;this.instructions.push([Nl.DRAW_IMAGE,s,i,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,h==ls?ls:h.map((function(t){return t*c})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]);const d=1/c,p=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=es,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Nl.DRAW_IMAGE,s,i,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[d,d],NaN,void 0,this.declutterImageWithText_,h,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?es:this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]),r.backgroundFill&&(this.state.fillStyle=p,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!zn(this.getBufferedMaxExtent(),t.getExtent()))return;let n;if(l=t.getFlatCoordinates(),"LineString"==a)n=[l.length];else if("MultiLineString"==a)n=t.getEnds();else if("Polygon"==a)n=t.getEnds().slice(0,1);else if("MultiPolygon"==a){const e=t.getEndss();n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t][0])}this.beginGeometry(t,e);const i=r.repeat,h=i?void 0:r.textAlign;let c=0;for(let t=0,e=n.length;t<e;++t){let e;e=i?$l(i*this.resolution,l,c,n[t],u):[l.slice(c,n[t])];for(let i=0,a=e.length;i<a;++i){const a=e[i];let l=0,d=a.length;if(null==h){const t=Yl(r.maxAngle,a,0,a.length,2);l=t[0],d=t[1]}for(let t=l;t<d;t+=u)o.push(a[t],a[t+1]);const p=o.length;c=n[t],this.drawChars_(s,p),s=p}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,i=this.strokeKey_;t&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||ss,justify:e.justify,textBaseline:e.textBaseline||as,scale:e.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,i=this.textState_,r=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=ql[i.textBaseline],u=this.textOffsetY_*a,h=this.text_,c=n?n.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Nl.DRAW_CHARS,t,e,l,i.overflow,s,i.maxAngle,a,u,r,c*a,h,o,1]),this.hitDetectionInstructions.push([Nl.DRAW_CHARS,t,e,l,i.overflow,s?es:s,i.maxAngle,a,u,r,c*a,h,o,1/a])}setTextStyle(t,e){let n,i,r;if(t){const e=t.getFill();e?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=jo(e.getColor()||es)):(i=null,this.textFillState_=i);const o=t.getStroke();if(o){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=o.getLineDash(),e=o.getLineDashOffset(),n=o.getWidth(),i=o.getMiterLimit();r.lineCap=o.getLineCap()||ns,r.lineDash=t?t.slice():is,r.lineDashOffset=void 0===e?0:e,r.lineJoin=o.getLineJoin()||rs,r.lineWidth=void 0===n?1:n,r.miterLimit=void 0===i?10:i,r.strokeStyle=jo(o.getColor()||os)}else r=null,this.textStrokeState_=r;n=this.textState_;const s=t.getFont()||ts;ps(s);const a=t.getScaleArray();n.overflow=t.getOverflow(),n.font=s,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||as,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||ls,n.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),u=t.getOffsetY(),h=t.getRotateWithView(),c=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===u?0:u,this.textRotateWithView_=void 0!==h&&h,this.textRotation_=void 0===c?0:c,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:Te(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=i?"string"==typeof i.fillStyle?i.fillStyle:"|"+Te(i.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}};const Kl=class{constructor(t,e,n,i){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=i,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const i in n){const r=n[i].finish();t[e][i]=r}}return t}getBuilder(t,e){const n=void 0!==t?t.toString():"0";let i=this.buildersByZIndex_[n];void 0===i&&(i={},this.buildersByZIndex_[n]=i);let r=i[e];if(void 0===r){r=new(0,Zl[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[e]=r}return r}};const Jl=class extends Ee{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return Ie()}getData(t){return null}prepareFrame(t){return Ie()}renderFrame(t,e){return Ie()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(i,r)=>{const o=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,o)}}forEachFeatureAtCoordinate(t,e,n,i,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;e.getState()!==fo&&e.getState()!==go||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=fo&&e!=go&&t.addEventListener(ce,this.boundHandleImageChange_),e==co&&(t.load(),e=t.getState()),e==fo}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}};const Ql=class extends qt{constructor(t,e,n,i){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=i}},tu=[];let eu=null;const nu=class extends Jl{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){let i;eu||(eu=Go(1,1,void 0,{willReadFrequently:!0})),eu.clearRect(0,0,1,1);try{eu.drawImage(t,e,n,1,1,0,0,1,1),i=eu.getImageData(0,0,1,1).data}catch(r){return eu=null,null}return i}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,n){const i=this.getLayer().getClassName();let r,o;if(t&&t.className===i&&(!n||t&&t.style.backgroundColor&&ne(Ao(t.style.backgroundColor),Ao(n)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(o=e.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=i;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",o=Go();const e=o.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=o}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const i=On(n),r=Fn(n),o=Pn(n),s=In(n);Je(e.coordinateToPixelTransform,i),Je(e.coordinateToPixelTransform,r),Je(e.coordinateToPixelTransform,o),Je(e.coordinateToPixelTransform,s);const a=this.inversePixelTransform;Je(a,i),Je(a,r),Je(a,o),Je(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()}dispatchRenderEvent_(t,e,n){const i=this.getLayer();if(i.hasListener(t)){const r=new Ql(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(Kr,t,e)}postRender(t,e){this.dispatchRenderEvent_(Jr,t,e)}getRenderTransform(t,e,n,i,r,o,s){const a=r/2,l=o/2,u=i/e,h=-u,c=-t[0]+s,d=-t[1];return tn(this.tempTransform,a,l,u,h,-n,c,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function iu(t,e,n,i,r,o,s,a,l,u,h,c){let d=t[e],p=t[e+1],f=0,g=0,m=0,_=0;function y(){f=d,g=p,d=t[e+=i],p=t[e+1],_+=m,m=Math.sqrt((d-f)*(d-f)+(p-g)*(p-g))}do{y()}while(e<n-i&&_+m<o);let v=0===m?0:(o-_)/m;const w=ci(f,d,v),x=ci(g,p,v),b=e-i,C=_,S=o+a*l(u,r,h);for(;e<n-i&&_+m<S;)y();v=0===m?0:(S-_)/m;const E=ci(f,d,v),I=ci(g,p,v);let P;if(c){const t=[w,x,E,I];tr(t,0,4,2,c,t,t),P=t[0]>t[2]}else P=w>E;const T=Math.PI,k=[],D=b+i===e;let M;if(m=0,_=C,d=t[e=b],p=t[e+1],D){y(),M=Math.atan2(p-g,d-f),P&&(M+=M>0?-T:T);const t=(E+w)/2,e=(I+x)/2;return k[0]=[t,e,(S-o)/2,M,r],k}for(let L=0,R=(r=r.replace(/\n/g," ")).length;L<R;){y();let t=Math.atan2(p-g,d-f);if(P&&(t+=t>0?-T:T),void 0!==M){let e=t-M;if(e+=e>T?-2*T:e<-T?2*T:0,Math.abs(e)>s)return null}M=t;const c=L;let w=0;for(;L<R;++L){const t=a*l(u,r[P?R-L-1:L],h);if(e+i<n&&_+m<o+w+t/2)break;w+=t}if(L===c)continue;const x=P?r.substring(R-c,R-L):r.substring(c,L);v=0===m?0:(o+w/2-_)/m;const b=ci(f,d,v),C=ci(g,p,v);k.push([b,C,w/2,t,x]),o+=w}return k}const ru=[1/0,1/0,-1/0,-1/0],ou=[],su=[],au=[],lu=[];function uu(t){return t[3].declutterBox}const hu=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function cu(t,e){return"start"===e?e=hu.test(t)?"right":"left":"end"===e&&(e=hu.test(t)?"left":"right"),ql[e]}function du(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}const pu=class{constructor(t,e,n,i){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,n,i){const r=t+e+n+i;if(this.labels_[r])return this.labels_[r];const o=i?this.strokeStates[i]:null,s=n?this.fillStates[n]:null,a=this.textStates[e],l=this.pixelRatio,u=[a.scale[0]*l,a.scale[1]*l],h=Array.isArray(t),c=a.justify?ql[a.justify]:cu(Array.isArray(t)?t[0]:t,a.textAlign||ss),d=i&&o.lineWidth?o.lineWidth:0,p=h?t:t.split("\n").reduce(du,[]),{width:f,height:g,widths:m,heights:_,lineWidths:y}=function(t,e){const n=[],i=[],r=[];let o=0,s=0,a=0,l=0;for(let u=0,h=e.length;u<=h;u+=2){const c=e[u];if("\n"===c||u===h){o=Math.max(o,s),r.push(s),s=0,a+=l;continue}const d=e[u+1]||t.font,p=ms(d,c);n.push(p),s+=p;const f=fs(d);i.push(f),l=Math.max(l,f)}return{width:o,height:a,widths:n,heights:i,lineWidths:r}}(a,p),v=f+d,w=[],x=(v+2)*u[0],b=(g+d)*u[1],C={width:x<0?Math.floor(x):Math.ceil(x),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:w};1==u[0]&&1==u[1]||w.push("scale",u),i&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",d),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),n&&w.push("fillStyle",s.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const S=.5-c;let E=c*v+S*d;const I=[],P=[];let T,k=0,D=0,M=0,L=0;for(let R=0,O=p.length;R<O;R+=2){const t=p[R];if("\n"===t){D+=k,k=0,E=c*v+S*d,++L;continue}const e=p[R+1]||a.font;e!==T&&(i&&I.push("font",e),n&&P.push("font",e),T=e),k=Math.max(k,_[M]);const r=[t,E+S*m[M]+c*(m[M]-y[L]),.5*(d+k)+D];E+=m[M],i&&I.push("strokeText",r),n&&P.push("fillText",r),++M}return Array.prototype.push.apply(w,I),Array.prototype.push.apply(w,P),this.labels_[r]=C,C}replayTextBackground_(t,e,n,i,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,i,r,o,s,a,l,u,h,c,d,p,f,g){let m=n-(s*=c[0]),_=i-(a*=c[1]);const y=r+l>t?t-l:r,v=o+u>e?e-u:o,w=p[3]+y*c[0]+p[1],x=p[0]+v*c[1]+p[2],b=m-p[3],C=_-p[0];let S;return(f||0!==h)&&(ou[0]=b,lu[0]=b,ou[1]=C,su[1]=C,su[0]=b+w,au[0]=su[0],au[1]=C+x,lu[1]=au[1]),0!==h?(S=tn([1,0,0,1,0,0],n,i,1,1,h,-n,-i),Je(S,ou),Je(S,su),Je(S,au),Je(S,lu),gn(Math.min(ou[0],su[0],au[0],lu[0]),Math.min(ou[1],su[1],au[1],lu[1]),Math.max(ou[0],su[0],au[0],lu[0]),Math.max(ou[1],su[1],au[1],lu[1]),ru)):gn(Math.min(b,b+w),Math.min(C,C+x),Math.max(b,b+w),Math.max(C,C+x),ru),d&&(m=Math.round(m),_=Math.round(_)),{drawImageX:m,drawImageY:_,drawImageW:y,drawImageH:v,originX:l,originY:u,declutterBox:{minX:ru[0],minY:ru[1],maxX:ru[2],maxY:ru[3],value:g},canvasTransform:S,scale:c}}replayImageOrLabel_(t,e,n,i,r,o,s){const a=!(!o&&!s),l=i.declutterBox,u=t.canvas,h=s?s[2]*i.scale[0]/2:0;return l.minX-h<=u.width/e&&l.maxX+h>=0&&l.minY-h<=u.height/e&&l.maxY+h>=0&&(a&&this.replayTextBackground_(t,ou,su,au,lu,o,s),ys(t,i.canvasTransform,r,n,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(t){if(this.alignFill_){const e=Je(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,i){const r=this.textStates[e],o=this.createLabel(t,e,i,n),s=this.strokeStates[n],a=this.pixelRatio,l=cu(Array.isArray(t)?t[0]:t,r.textAlign||ss),u=ql[r.textBaseline||as],h=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:l*(o.width/a-2*r.scale[0])+2*(.5-l)*h,anchorY:u*o.height/a+2*(.5-u)*h}}execute_(t,e,n,i,r,o,s,a){let l;this.pixelCoordinates_&&ne(n,this.renderedTransform_)?l=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),l=Qi(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),function(t,e){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]}(this.renderedTransform_,n));let u=0;const h=i.length;let c,d,p,f,g,m,_,y,v,w,x,b,C=0,S=0,E=0,I=null,P=null;const T=this.coordinateCache_,k=this.viewRotation_,D=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:k},L=this.instructions!=i||this.overlaps?0:200;let R,O,F,A;for(;u<h;){const n=i[u];switch(n[0]){case Nl.BEGIN_GEOMETRY:R=n[1],A=n[3],R.getGeometry()?void 0===s||zn(s,A.getExtent())?++u:u=n[2]+1:u=n[2];break;case Nl.BEGIN_PATH:S>L&&(this.fill_(t),S=0),E>L&&(t.stroke(),E=0),S||E||(t.beginPath(),f=NaN,g=NaN),++u;break;case Nl.CIRCLE:C=n[1];const i=l[C],h=l[C+1],z=l[C+2]-i,B=l[C+3]-h,j=Math.sqrt(z*z+B*B);t.moveTo(i+j,h),t.arc(i,h,j,0,2*Math.PI,!0),++u;break;case Nl.CLOSE_PATH:t.closePath(),++u;break;case Nl.CUSTOM:C=n[1],c=n[2];const G=n[3],N=n[4],V=6==n.length?n[5]:void 0;M.geometry=G,M.feature=R,u in T||(T[u]=[]);const H=T[u];V?V(l,C,c,2,H):(H[0]=l[C],H[1]=l[C+1],H.length=2),N(H,M),++u;break;case Nl.DRAW_IMAGE:C=n[1],c=n[2],y=n[3],d=n[4],p=n[5];let W=n[6];const X=n[7],U=n[8],$=n[9],Y=n[10];let q=n[11];const Z=n[12];let K=n[13];const J=n[14],Q=n[15];if(!y&&n.length>=20){v=n[19],w=n[20],x=n[21],b=n[22];const t=this.drawLabelWithPointPlacement_(v,w,x,b);y=t.label,n[3]=y;const e=n[23];d=(t.anchorX-e)*this.pixelRatio,n[4]=d;const i=n[24];p=(t.anchorY-i)*this.pixelRatio,n[5]=p,W=y.height,n[6]=W,K=y.width,n[13]=K}let tt,et,nt,it;n.length>25&&(tt=n[25]),n.length>17?(et=n[16],nt=n[17],it=n[18]):(et=ls,nt=!1,it=!1),Y&&D?q+=k:Y||D||(q-=k);let rt=0;for(;C<c;C+=2){if(tt&&tt[rt++]<K/this.pixelRatio)continue;const n=this.calculateImageOrLabelDimensions_(y.width,y.height,l[C],l[C+1],K,W,d,p,U,$,q,Z,r,et,nt||it,R),i=[t,e,y,n,X,nt?I:null,it?P:null];if(a){if("none"===J)continue;if("obstacle"===J){a.insert(n.declutterBox);continue}{let t,e;if(Q){const n=c-C;if(!Q[n]){Q[n]=i;continue}if(t=Q[n],delete Q[n],e=uu(t),a.collides(e))continue}if(a.collides(n.declutterBox))continue;t&&(a.insert(e),this.replayImageOrLabel_.apply(this,t)),a.insert(n.declutterBox)}}this.replayImageOrLabel_.apply(this,i)}++u;break;case Nl.DRAW_CHARS:const ot=n[1],st=n[2],at=n[3],lt=n[4];b=n[5];const ut=n[6],ht=n[7],ct=n[8];x=n[9];const dt=n[10];v=n[11],w=n[12];const pt=[n[13],n[13]],ft=this.textStates[w],gt=ft.font,mt=[ft.scale[0]*ht,ft.scale[1]*ht];let _t;gt in this.widths_?_t=this.widths_[gt]:(_t={},this.widths_[gt]=_t);const yt=so(l,ot,st,2),vt=Math.abs(mt[0])*_s(gt,v,_t);if(lt||vt<=yt){const n=iu(l,ot,st,2,v,(yt-vt)*cu(v,this.textStates[w].textAlign),ut,Math.abs(mt[0]),_s,gt,_t,D?0:this.viewRotation_);t:if(n){const i=[];let r,o,s,l,u;if(x)for(r=0,o=n.length;r<o;++r){u=n[r],s=u[4],l=this.createLabel(s,w,"",x),d=u[2]+(mt[0]<0?-dt:dt),p=at*l.height+2*(.5-at)*dt*mt[1]/mt[0]-ct;const o=this.calculateImageOrLabelDimensions_(l.width,l.height,u[0],u[1],l.width,l.height,d,p,0,0,u[3],pt,!1,ls,!1,R);if(a&&a.collides(o.declutterBox))break t;i.push([t,e,l,o,1,null,null])}if(b)for(r=0,o=n.length;r<o;++r){u=n[r],s=u[4],l=this.createLabel(s,w,b,""),d=u[2],p=at*l.height-ct;const o=this.calculateImageOrLabelDimensions_(l.width,l.height,u[0],u[1],l.width,l.height,d,p,0,0,u[3],pt,!1,ls,!1,R);if(a&&a.collides(o.declutterBox))break t;i.push([t,e,l,o,1,null,null])}a&&a.load(i.map(uu));for(let t=0,e=i.length;t<e;++t)this.replayImageOrLabel_.apply(this,i[t])}}++u;break;case Nl.END_GEOMETRY:if(void 0!==o){R=n[1];const t=o(R,A);if(t)return t}++u;break;case Nl.FILL:L?S++:this.fill_(t),++u;break;case Nl.MOVE_TO_LINE_TO:for(C=n[1],c=n[2],O=l[C],F=l[C+1],m=O+.5|0,_=F+.5|0,m===f&&_===g||(t.moveTo(O,F),f=m,g=_),C+=2;C<c;C+=2)O=l[C],F=l[C+1],m=O+.5|0,_=F+.5|0,C!=c-2&&m===f&&_===g||(t.lineTo(O,F),f=m,g=_);++u;break;case Nl.SET_FILL_STYLE:I=n,this.alignFill_=n[2],S&&(this.fill_(t),S=0,E&&(t.stroke(),E=0)),t.fillStyle=n[1],++u;break;case Nl.SET_STROKE_STYLE:P=n,E&&(t.stroke(),E=0),this.setStrokeStyle_(t,n),++u;break;case Nl.STROKE:L?E++:t.stroke(),++u;break;default:++u}}S&&this.fill_(t),E&&t.stroke()}execute(t,e,n,i,r,o){this.viewRotation_=i,this.execute_(t,e,n,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,n,i,r){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,i,r)}},fu=["Polygon","Circle","LineString","Image","Text","Default"];const gu={};const mu=class{constructor(t,e,n,i,r,o){this.maxExtent_=t,this.overlaps_=i,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t){for(const e in t){let n=this.executorsByZIndex_[e];void 0===n&&(n={},this.executorsByZIndex_[e]=n);const i=t[e];for(const t in i){const e=i[t];n[t]=new pu(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let e=0,i=t.length;e<i;++e)if(t[e]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,i,r,o){const s=2*(i=Math.round(i))+1,a=tn(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-n,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Go(s,s,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;let h;u.canvas.width!==s||u.canvas.height!==s?(u.canvas.width=s,u.canvas.height=s):l||u.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(h=[1/0,1/0,-1/0,-1/0],xn(h,t),an(h,e*(this.renderBuffer_+i),h));const c=function(t){if(void 0!==gu[t])return gu[t];const e=2*t+1,n=t*t,i=new Array(n+1);for(let o=0;o<=t;++o)for(let r=0;r<=t;++r){const s=o*o+r*r;if(s>n)break;let a=i[s];a||(a=[],i[s]=a),a.push(4*((t+o)*e+(t+r))+3),o>0&&a.push(4*((t-o)*e+(t+r))+3),r>0&&(a.push(4*((t+o)*e+(t-r))+3),o>0&&a.push(4*((t-o)*e+(t-r))+3))}const r=[];for(let o=0,s=i.length;o<s;++o)i[o]&&r.push(...i[o]);return gu[t]=r,r}(i);let d;function p(t,e){const n=u.getImageData(0,0,s,s).data;for(let a=0,l=c.length;a<l;a++)if(n[c[a]]>0){if(!o||"Image"!==d&&"Text"!==d||o.includes(t)){const n=(c[a]-3)/4,o=i-n%s,l=i-(n/s|0),u=r(t,e,o*o+l*l);if(u)return u}u.clearRect(0,0,s,s);break}}const f=Object.keys(this.executorsByZIndex_).map(Number);let g,m,_,y,v;for(f.sort(Jt),g=f.length-1;g>=0;--g){const t=f[g].toString();for(_=this.executorsByZIndex_[t],m=fu.length-1;m>=0;--m)if(d=fu[m],y=_[d],void 0!==y&&(v=y.executeHitDetection(u,a,n,p,h),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],i=e[1],r=e[2],o=e[3],s=[n,i,n,o,r,o,r,i];return Qi(s,0,8,2,t,s),s}isEmpty(){return ue(this.executorsByZIndex_)}execute(t,e,n,i,r,o,s){const a=Object.keys(this.executorsByZIndex_).map(Number);let l,u,h,c,d,p;for(a.sort(Jt),this.maxExtent_&&(t.save(),this.clip(t,n)),o=o||fu,s&&a.reverse(),l=0,u=a.length;l<u;++l){const u=a[l].toString();for(d=this.executorsByZIndex_[u],h=0,c=o.length;h<c;++h){p=d[o[h]],void 0!==p&&p.execute(t,e,n,i,r,s)}}this.maxExtent_&&t.restore()}};const _u=class extends Vl{constructor(t,e,n,i,r,o,s){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=i,this.transformRotation_=i?di(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=s,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,n,i){if(!this.image_)return;const r=Qi(t,e,n,i,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let u=0,h=r.length;u<h;u+=2){const t=r[u]-this.imageAnchorX_,e=r[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const n=t+this.imageAnchorX_,i=e+this.imageAnchorY_;tn(s,n,i,1,1,l,-n,-i),o.save(),o.transform.apply(o,s),o.translate(n,i),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,t,e,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}drawText_(t,e,n,i){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Qi(t,e,n,i,this.transform_,this.pixelCoordinates_),o=this.context_;let s=this.textRotation_;for(0===this.transformRotation_&&(s-=this.viewRotation_),this.textRotateWithView_&&(s+=this.viewRotation_);e<n;e+=i){const t=r[e]+this.textOffsetX_,n=r[e+1]+this.textOffsetY_;0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.save(),o.translate(t-this.textOffsetX_,n-this.textOffsetY_),o.rotate(s),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,t,n),this.textFillState_&&o.fillText(this.text_,t,n))}}moveToLineTo_(t,e,n,i,r){const o=this.context_,s=Qi(t,e,n,i,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);let a=s.length;r&&(a-=2);for(let l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return r&&o.closePath(),n}drawRings_(t,e,n,i){for(let r=0,o=n.length;r<o;++r)e=this.moveToLineTo_(t,e,n[r],i,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zn(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,n){const i=t.getFlatCoordinates();if(!i)return null;const r=t.getStride();return Qi(i,0,i.length,r,e,n)}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],i=e[3]-e[1],r=Math.sqrt(n*n+i*i),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,i=e.length;n<i;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zn(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(zn(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();let i=0;const r=t.getEnds(),o=t.getStride();e.beginPath();for(let t=0,s=r.length;t<s;++t)i=this.moveToLineTo_(n,i,r[t],o,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zn(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),zn(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let i=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let t=0,s=r.length;t<s;++t){const e=r[t];i=this.drawRings_(n,i,e,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),ne(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,i=t.textAlign?t.textAlign:ss;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=i&&(n.textAlign=i,e.textAlign=i),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=i,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:i,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:jo(e||es)}}else this.fillState_=null;if(e){const t=e.getColor(),n=e.getLineCap(),i=e.getLineDash(),r=e.getLineDashOffset(),o=e.getLineJoin(),s=e.getWidth(),a=e.getMiterLimit(),l=i||is;this.strokeState_={lineCap:void 0!==n?n:ns,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==o?o:rs,lineWidth:(void 0!==s?s:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:jo(t||os)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const n=t.getPixelRatio(this.pixelRatio_),i=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*n,this.imageAnchorY_=i[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:jo(t||es)}}else this.textFillState_=null;const n=t.getStroke();if(n){const t=n.getColor(),e=n.getLineCap(),i=n.getLineDash(),r=n.getLineDashOffset(),o=n.getLineJoin(),s=n.getWidth(),a=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:ns,lineDash:i||is,lineDashOffset:r||0,lineJoin:void 0!==o?o:rs,lineWidth:void 0!==s?s:1,miterLimit:void 0!==a?a:10,strokeStyle:jo(t||os)}}else this.textStrokeState_=null;const i=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),s=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),u=t.getText(),h=t.getTextAlign(),c=t.getTextBaseline();this.textState_={font:void 0!==i?i:ts,textAlign:void 0!==h?h:ss,textBaseline:void 0!==c?c:as},this.text_=void 0!==u?Array.isArray(u)?u.reduce(((t,e,n)=>t+(n%2?" ":e)),""):u:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==o?this.pixelRatio_*o:0,this.textRotateWithView_=void 0!==s&&s,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},yu=.5;function vu(t,e,n,i,r,o,s){const a=Go(t[0]*yu,t[1]*yu);a.imageSmoothingEnabled=!1;const l=a.canvas,u=new _u(a,yu,r,null,s),h=n.length,c=Math.floor(16777215/h),d={};for(let f=1;f<=h;++f){const t=n[f-1],e=t.getStyleFunction()||i;if(!e)continue;let s=e(t,o);if(!s)continue;Array.isArray(s)||(s=[s]);const a=(f*c).toString(16).padStart(7,"#00000");for(let n=0,i=s.length;n<i;++n){const e=s[n],i=e.getGeometryFunction()(t);if(!i||!zn(r,i.getExtent()))continue;const o=e.clone(),l=o.getFill();l&&l.setColor(a);const u=o.getStroke();u&&(u.setColor(a),u.setLineDash(null)),o.setText(void 0);const h=e.getImage();if(h){const t=h.getImageSize();if(!t)continue;const e=Go(t[0],t[1],void 0,{alpha:!1}),n=e.canvas;e.fillStyle=a,e.fillRect(0,0,n.width,n.height),o.setImage(new za({img:n,anchor:h.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:h.getOrigin(),opacity:1,size:h.getSize(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()}))}const c=o.getZIndex()||0;let p=d[c];p||(p={},d[c]=p,p.Polygon=[],p.Circle=[],p.LineString=[],p.Point=[]);const f=i.getType();if("GeometryCollection"===f){const t=i.getGeometriesArrayRecursive();for(let e=0,n=t.length;e<n;++e){const n=t[e];p[n.getType().replace("Multi","")].push(n,o)}}else p[f.replace("Multi","")].push(i,o)}}const p=Object.keys(d).map(Number).sort(Jt);for(let f=0,g=p.length;f<g;++f){const t=d[p[f]];for(const n in t){const i=t[n];for(let t=0,n=i.length;t<n;t+=2){u.setStyle(i[t+1]);for(let n=0,r=e.length;n<r;++n)u.setTransform(e[n]),u.drawGeometry(i[t])}}}return a.getImageData(0,0,l.width,l.height)}function wu(t,e,n){const i=[];if(n){const r=Math.floor(Math.round(t[0])*yu),o=Math.floor(Math.round(t[1])*yu),s=4*(oi(r,0,n.width-1)+oi(o,0,n.height-1)*n.width),a=n.data[s],l=n.data[s+1],u=n.data[s+2]+256*(l+256*a),h=Math.floor(16777215/e.length);u&&u%h==0&&i.push(e[u/h-1])}return i}const xu=.5,bu={Point:function(t,e,n,i,r){const o=n.getImage(),s=n.getText();let a;if(o){if(o.getImageState()!=fo)return;let l=t;if(r){const u=o.getDeclutterMode();if("none"!==u)if(l=r,"obstacle"===u){const r=t.getBuilder(n.getZIndex(),"Image");r.setImageStyle(o,a),r.drawPoint(e,i)}else s&&s.getText()&&(a={})}const u=l.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,a),u.drawPoint(e,i)}if(s&&s.getText()){let o=t;r&&(o=r);const l=o.getBuilder(n.getZIndex(),"Text");l.setTextStyle(s,a),l.drawText(e,i)}},LineString:function(t,e,n,i,r){const o=n.getStroke();if(o){const r=t.getBuilder(n.getZIndex(),"LineString");r.setFillStrokeStyle(null,o),r.drawLineString(e,i)}const s=n.getText();if(s&&s.getText()){const o=(r||t).getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,i)}},Polygon:function(t,e,n,i,r){const o=n.getFill(),s=n.getStroke();if(o||s){const r=t.getBuilder(n.getZIndex(),"Polygon");r.setFillStrokeStyle(o,s),r.drawPolygon(e,i)}const a=n.getText();if(a&&a.getText()){const o=(r||t).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,i)}},MultiPoint:function(t,e,n,i,r){const o=n.getImage(),s=n.getText();let a;if(o){if(o.getImageState()!=fo)return;let l=t;if(r){const u=o.getDeclutterMode();if("none"!==u)if(l=r,"obstacle"===u){const r=t.getBuilder(n.getZIndex(),"Image");r.setImageStyle(o,a),r.drawMultiPoint(e,i)}else s&&s.getText()&&(a={})}const u=l.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,a),u.drawMultiPoint(e,i)}if(s&&s.getText()){let o=t;r&&(o=r);const l=o.getBuilder(n.getZIndex(),"Text");l.setTextStyle(s,a),l.drawText(e,i)}},MultiLineString:function(t,e,n,i,r){const o=n.getStroke();if(o){const r=t.getBuilder(n.getZIndex(),"LineString");r.setFillStrokeStyle(null,o),r.drawMultiLineString(e,i)}const s=n.getText();if(s&&s.getText()){const o=(r||t).getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,i)}},MultiPolygon:function(t,e,n,i,r){const o=n.getFill(),s=n.getStroke();if(s||o){const r=t.getBuilder(n.getZIndex(),"Polygon");r.setFillStrokeStyle(o,s),r.drawMultiPolygon(e,i)}const a=n.getText();if(a&&a.getText()){const o=(r||t).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,i)}},GeometryCollection:function(t,e,n,i,r){const o=e.getGeometriesArray();let s,a;for(s=0,a=o.length;s<a;++s){(0,bu[o[s].getType()])(t,o[s],n,i,r)}},Circle:function(t,e,n,i,r){const o=n.getFill(),s=n.getStroke();if(o||s){const r=t.getBuilder(n.getZIndex(),"Circle");r.setFillStrokeStyle(o,s),r.drawCircle(e,i)}const a=n.getText();if(a&&a.getText()){const o=(r||t).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,i)}}};function Cu(t,e){return parseInt(Te(t),10)-parseInt(Te(e),10)}function Su(t,e){const n=Eu(t,e);return n*n}function Eu(t,e){return xu*t/e}function Iu(t,e,n,i,r,o,s){let a=!1;const l=n.getImage();if(l){const t=l.getImageState();t==fo||t==go?l.unlistenImageChange(r):(t==co&&l.load(),l.listenImageChange(r),a=!0)}return function(t,e,n,i,r,o){const s=n.getGeometryFunction()(e);if(!s)return;const a=s.simplifyTransformed(i,r),l=n.getRenderer();if(l)Pu(t,a,n,e);else{(0,bu[a.getType()])(t,a,n,e,o)}}(t,e,n,i,o,s),a}function Pu(t,e,n,i){if("GeometryCollection"==e.getType()){const r=e.getGeometries();for(let e=0,o=r.length;e<o;++e)Pu(t,r[e],n,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,i,n.getRenderer(),n.getHitDetectionRenderer())}const Tu=class extends nu{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,n){const i=e.extent,r=e.viewState,o=r.center,s=r.resolution,a=r.projection,l=r.rotation,u=a.getExtent(),h=this.getLayer().getSource(),c=e.pixelRatio,d=e.viewHints,p=!(d[Vs]||d[Hs]),f=this.compositionContext_,g=Math.round(e.size[0]*c),m=Math.round(e.size[1]*c),_=h.getWrapX()&&a.canWrapX(),y=_?An(u):null,v=_?Math.ceil((i[2]-u[2])/y)+1:1;let w=_?Math.floor((i[0]-u[0])/y):0;do{const e=this.getRenderTransform(o,s,l,c,g,m,w*y);t.execute(f,1,e,l,p,void 0,n)}while(++w<v)}setupCompositionContext_(){if(1!==this.opacity_){const t=Go(this.context.canvas.width,this.context.canvas.height,tu);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,No(this.compositionContext_),tu.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const n=t.pixelRatio,i=t.layerStatesArray[t.layerIndex];!function(t,e,n){Ke(t,e,0,0,n,0,0)}(this.pixelTransform,1/n,1/n),en(this.inversePixelTransform,this.pixelTransform);const r=rn(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const o=this.context,s=o.canvas,a=this.replayGroup_,l=this.declutterExecutorGroup;let u=a&&!a.isEmpty()||l&&!l.isEmpty();if(!u){if(!(this.getLayer().hasListener(Kr)||this.getLayer().hasListener(Jr)))return null}const h=Math.round(t.size[0]*n),c=Math.round(t.size[1]*n);s.width!=h||s.height!=c?(s.width=h,s.height=c,s.style.transform!==r&&(s.style.transform=r)):this.containerReused||o.clearRect(0,0,h,c),this.preRender(o,t);const d=t.viewState;d.projection,this.opacity_=i.opacity,this.setupCompositionContext_();let p=!1;if(u&&i.extent&&this.clipping){const e=qi(i.extent);u=zn(e,t.extent),p=u&&!cn(e,t.extent),p&&this.clipUnrotated(this.compositionContext_,t,e)}return u&&this.renderWorlds(a,t),p&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];Je(this.pixelTransform,t);const e=this.renderedCenter_,n=this.renderedResolution_,i=this.renderedRotation_,r=this.renderedProjection_,o=this.wrappedRenderedExtent_,s=this.getLayer(),a=[],l=t[0]*yu,u=t[1]*yu;a.push(this.getRenderTransform(e,n,i,yu,l,u,0).slice());const h=s.getSource(),c=r.getExtent();if(h.getWrapX()&&r.canWrapX()&&!cn(c,o)){let t=o[0];const r=An(c);let s,h=0;for(;t<c[0];)--h,s=r*h,a.push(this.getRenderTransform(e,n,i,yu,l,u,s).slice()),t+=r;for(h=0,t=o[2];t>c[2];)++h,s=r*h,a.push(this.getRenderTransform(e,n,i,yu,l,u,s).slice()),t-=r}this.hitDetectionImageData_=vu(t,a,this.renderedFeatures_,s.getStyleFunction(),o,n,i)}e(wu(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,n,i,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={},u=function(t,e,n){const o=Te(t),s=l[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return l[o]=!0,r.splice(r.lastIndexOf(s),1),i(t,a,e);s.geometry=e,s.distanceSq=n}}else{if(0===n)return l[o]=!0,i(t,a,e);r.push(l[o]={feature:t,layer:a,geometry:e,distanceSq:n,callback:i})}};let h;const c=[this.replayGroup_];return this.declutterExecutorGroup&&c.push(this.declutterExecutorGroup),c.some((i=>h=i.forEachFeatureAtCoordinate(t,o,s,n,u,i===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),h}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const i=t.viewHints[Vs],r=t.viewHints[Hs],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(this.ready&&!o&&i||!s&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,l=t.viewState,u=l.projection,h=l.resolution,c=t.pixelRatio,d=e.getRevision(),p=e.getRenderBuffer();let f=e.getRenderOrder();void 0===f&&(f=Cu);const g=l.center.slice(),m=an(a,p*h),_=m.slice(),y=[m.slice()],v=u.getExtent();if(n.getWrapX()&&u.canWrapX()&&!cn(v,t.extent)){const t=An(v),e=Math.max(An(m)/2,t);m[0]=v[0]-e,m[2]=v[2]+e,xi(g,u);const n=Gn(y[0],u);n[0]<v[0]&&n[2]<v[2]?y.push([n[0]+t,n[1],n[2]+t,n[3]]):n[0]>v[0]&&n[2]>v[2]&&y.push([n[0]-t,n[1],n[2]-t,n[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==d&&this.renderedRenderOrder_==f&&cn(this.wrappedRenderedExtent_,m))return ne(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new Kl(Eu(h,c),m,h,c);let x;this.getLayer().getDeclutter()&&(x=new Kl(Eu(h,c),m,h,c));for(let k=0,D=y.length;k<D;++k)n.loadFeatures(y[k],h,u);const b=Su(h,c);let C=!0;const S=t=>{let n;const i=t.getStyleFunction()||e.getStyleFunction();if(i&&(n=i(t,h)),n){const e=this.renderFeature(t,b,n,w,undefined,x);C=C&&!e}},E=Yi(m),I=n.getFeaturesInExtent(E);f&&I.sort(f);for(let k=0,D=I.length;k<D;++k)S(I[k]);this.renderedFeatures_=I,this.ready=C;const P=w.finish(),T=new mu(m,h,c,n.getOverlaps(),P,e.getRenderBuffer());return x&&(this.declutterExecutorGroup=new mu(m,h,c,n.getOverlaps(),x.finish(),e.getRenderBuffer())),this.renderedResolution_=h,this.renderedRevision_=d,this.renderedRenderOrder_=f,this.renderedExtent_=_,this.wrappedRenderedExtent_=m,this.renderedCenter_=g,this.renderedProjection_=u,this.replayGroup_=T,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,i,r,o){if(!n)return!1;let s=!1;if(Array.isArray(n))for(let a=0,l=n.length;a<l;++a)s=Iu(i,t,n[a],e,this.boundHandleStyleImageChange_,r,o)||s;else s=Iu(i,t,n,e,this.boundHandleStyleImageChange_,r,o);return s}};const ku=class extends Fl{constructor(t){super(t)}createRenderer(){return new Tu(this)}};const Du=class{constructor(t){this.rbush_=new fa(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[Te(e)]=n}load(t,e){const n=new Array(e.length);for(let i=0,r=e.length;i<r;i++){const r=t[i],o=e[i],s={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:o};n[i]=s,this.items_[Te(o)]=s}this.rbush_.load(n)}remove(t){const e=Te(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}update(t,e){const n=this.items_[Te(e)];vn([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let i=0,r=t.length;i<r;i++)if(n=e(t[i]),n)return n;return n}isEmpty(){return ue(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return gn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};class Mu extends or{constructor(t,e,n){super(),void 0!==n&&void 0===e?this.setFlatCoordinates(n,t):(e=e||0,this.setCenterAndRadius(t,e,n))}clone(){const t=new Mu(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){const r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<i){if(0===a)for(let t=0;t<this.stride;++t)n[t]=r[t];else{const t=this.getRadius()/Math.sqrt(a);n[0]=r[0]+t*o,n[1]=r[1]+t*s;for(let e=2;e<this.stride;++e)n[e]=r[e]}return n.length=this.stride,a}return i}containsXY(t,e){const n=this.flatCoordinates,i=t-n[0],r=e-n[1];return i*i+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,n=e[this.stride]-e[0];return gn(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){if(zn(t,this.getExtent())){const e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||Sn(t,this.intersectsCoordinate.bind(this)))}return!1}setCenter(t){const e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],i=t.slice();i[e]=i[0]+n;for(let r=1;r<e;++r)i[e+r]=t[r];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const i=this.flatCoordinates;let r=cr(i,0,t,this.stride);i[r++]=i[0]+e;for(let o=1,s=this.stride;o<s;++o)i[r++]=i[o];i.length=r,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const n=this.getCenter(),i=this.getStride();this.setCenter(tr(n,0,n.length,i,t,e,n)),this.changed()}}Mu.prototype.transform;const Lu=Mu;class Ru extends nr{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ce),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(xe(this.geometries_[t],ce,this.changed,this))}clone(){const t=new Ru(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<un(this.getExtent(),t,e))return i;const r=this.geometries_;for(let o=0,s=r.length;o<s;++o)i=r[o].closestPointXY(t,e,n,i);return i}containsXY(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)if(n[i].containsXY(t,e))return!0;return!1}computeExtent(t){mn(t);const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)wn(t,e[n].getExtent());return t}getGeometries(){return Ou(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let i=!1;for(let r=0,o=n.length;r<o;++r){const o=n[r],s=o.getSimplifiedGeometry(t);e.push(s),s!==o&&(i=!0)}if(i){const t=new Ru(null);return t.setGeometriesArray(e),t}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].rotate(t,e);this.changed()}scale(t,e,n){n||(n=Tn(this.getExtent()));const i=this.geometries_;for(let r=0,o=i.length;r<o;++r)i[r].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(Ou(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Ou(t){const e=[];for(let n=0,i=t.length;n<i;++n)e.push(t[n].clone());return e}const Fu=Ru;class Au extends or{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const e=t,n=[],i=[];for(let t=0,o=e.length;t<o;++t){ee(n,e[t].getFlatCoordinates()),i.push(n.length)}const r=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(r,n),this.ends_=i}}appendLineString(t){ee(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Au(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<un(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(lr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hr(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,i))}getCoordinateAtM(t,e,n){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,n=void 0!==n&&n,function(t,e,n,i,r,o,s){if(s)return oo(t,e,n[n.length-1],i,r,o);let a;if(r<t[i-1])return o?(a=t.slice(0,i),a[i-1]=r,a):null;if(t[t.length-1]<r)return o?(a=t.slice(t.length-i),a[i-1]=r,a):null;for(let l=0,u=n.length;l<u;++l){const o=n[l];if(e!=o){if(r<t[e+i-1])return null;if(r<=t[o-1])return oo(t,e,o,i,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return xr(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new lo(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,i=[];let r=0;for(let o=0,s=e.length;o<s;++o){const s=e[o],a=new lo(t.slice(r,s),n);i.push(a),r=s}return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const i=this.ends_,r=this.stride;for(let o=0,s=i.length;o<s;++o){const s=i[o];ee(t,ro(e,n,s,r,.5)),n=s}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=mr(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new Au(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){if(Fr(t,e,n[o],i,r))return!0;e=n[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=pr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const zu=Au;class Bu extends or{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){ee(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Bu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<un(this.getExtent(),t,e))return i;const r=this.flatCoordinates,o=this.stride;for(let s=0,a=r.length;s<a;s+=o){const a=ai(t,e,r[s],r[s+1]);if(a<i){i=a;for(let t=0;t<o;++t)n[t]=r[s+t];n.length=o}}return i}getCoordinates(){return wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Tr(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,i=[];for(let r=0,o=t.length;r<o;r+=n){const o=new Tr(t.slice(r,r+n),e);i.push(o)}return i}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let i=0,r=e.length;i<r;i+=n){if(dn(t,e[i],e[i+1]))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=dr(this.flatCoordinates,0,t,this.stride),this.changed()}}const ju=Bu;function Gu(t,e,n,i){const r=[];let o=[1/0,1/0,-1/0,-1/0];for(let s=0,a=n.length;s<a;++s){const a=n[s];o=yn(t,e,a[0],i),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=a[a.length-1]}return r}class Nu extends or{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const i=t,r=[],o=[];for(let t=0,e=i.length;t<e;++t){const e=i[t],n=r.length,s=e.getEnds();for(let t=0,i=s.length;t<i;++t)s[t]+=n;ee(r,e.getFlatCoordinates()),o.push(s)}e=0===i.length?this.getLayout():i[0].getLayout(),t=r,n=o}void 0!==e&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const n=this.flatCoordinates.length;ee(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,i=e.length;t<i;++t)e[t]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const n=new Nu(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,i){return i<un(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){const s=n[o];r=lr(t,e,s,i,r),e=s[s.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,o,s,a,l,u,h){h=h||[NaN,NaN];for(let c=0,d=n.length;c<d;++c){const d=n[c];u=hr(t,e,d,i,r,o,s,a,l,u,h),e=d[d.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,i))}containsXY(t,e){return function(t,e,n,i,r,o){if(0===n.length)return!1;for(let s=0,a=n.length;s<a;++s){const a=n[s];if(Mr(t,e,a,i,r,o))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,n,i){let r=0;for(let o=0,s=n.length;o<s;++o){const s=n[o];r+=Sr(t,e,s,i),e=s[s.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Hr(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,br(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Gu(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Rr(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ju(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Nr(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Hr(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,i,r,o,s,a){for(let l=0,u=n.length;l<u;++l){const u=n[l],h=[];s=vr(t,e,u,i,r,o,s,h),a.push(h),e=u[u.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new Nu(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const n=this.endss_[t-1];e=n[n.length-1]}const n=this.endss_[t].slice(),i=n[n.length-1];if(0!==e)for(let r=0,o=n.length;r<o;++r)n[r]-=e;return new Ur(this.flatCoordinates.slice(e,i),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,i=[];let r=0;for(let o=0,s=n.length;o<s;++o){const s=n[o].slice(),a=s[s.length-1];if(0!==r)for(let t=0,e=s.length;t<e;++t)s[t]-=r;const l=new Ur(e.slice(r,a),t,s);i.push(l),r=a}return i}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,n,i,r){for(let o=0,s=n.length;o<s;++o){const s=n[o];if(zr(t,e,s,i,r))return!0;e=s[s.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=fr(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{const t=n[n.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const Vu=Nu,Hu=[1,0,0,1,0,0];class Wu{constructor(t,e,n,i,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n,this.properties_=r,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?_n(this.flatCoordinates_):yn(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Tn(this.getExtent());this.flatInteriorPoints_=Lr(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Wr(this.flatCoordinates_,this.ends_),e=Gu(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Rr(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ro(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let i=0,r=n.length;i<r;++i){const r=n[i],o=ro(t,e,r,2,.5);ee(this.flatMidpoints_,o),e=r}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Ai(t)).getExtent(),n=t.getWorldExtent();if(e&&n){const t=Ln(n)/Ln(e);tn(Hu,n[0],n[3],t,-t,0,0,0),Qi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Hu,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Wu(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=se(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":n.length=gr(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),i=[n.length];break;case"MultiLineString":i=[],n.length=mr(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,i);break;case"Polygon":i=[],n.length=vr(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,i)}return i&&(this.simplifiedGeometry_=new Wu(this.type_,n,i,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}Wu.prototype.getFlatCoordinates=Wu.prototype.getOrientedFlatCoordinates;const Xu=Wu;function Uu(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const $u=class extends De{constructor(t){super(),this.projection=Ai(t.projection),this.attributions_=Uu(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,n){e.viewResolver=t,e.viewRejector=n}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Uu(t),this.changed()}setState(t){this.state_=t,this.changed()}},Yu="addfeature",qu="changefeature",Zu="clear",Ku="removefeature",Ju="featuresloadstart",Qu="featuresloadend",th="featuresloaderror";function eh(t,e){return[[-1/0,-1/0,1/0,1/0]]}function nh(t,e){return[t]}let ih=!1;function rh(t,e,n,i,r,o,s){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(n,i,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=ih,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let i;"json"==t?i=JSON.parse(a.responseText):"text"==t?i=a.responseText:"xml"==t?(i=a.responseXML,i||(i=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(i=a.response),i?o(e.readFeatures(i,{extent:n,featureProjection:r}),e.readProjection(i)):s()}else s()},a.onerror=s,a.send()}function oh(t,e){return function(n,i,r,o,s){const a=this;rh(t,e,n,i,r,(function(t,e){a.addFeatures(t),void 0!==o&&o(t)}),s||oe)}}class sh extends qt{constructor(t,e,n){super(t),this.feature=e,this.features=n}}const ah=class extends $u{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=oe,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(Ae(this.format_,"`format` must be set when `url` is set"),this.loader_=oh(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:eh;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let n,i;this.featuresRtree_=e?new Du:null,this.loadedExtentsRtree_=new Du,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?i=t.features:t.features&&(n=t.features,i=n.getArray()),e||void 0!==n||(n=new Fe(i)),void 0!==i&&this.addFeaturesInternal(i),void 0!==n&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Te(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new sh(Yu,t))}setupChangeEvents_(t,e){e instanceof Xu||(this.featureChangeKeys_[t]=[xe(e,ce,this.handleFeatureChange_,this),xe(e,Zt,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof Xu){const i=this.idIndex_[t];i instanceof Xu?Array.isArray(i)?i.push(e):this.idIndex_[t]=[i,e]:n=!1}else n=!1;else this.idIndex_[t]=e}return n&&(Ae(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],i=[];for(let r=0,o=t.length;r<o;r++){const e=t[r],i=Te(e);this.addToIndex_(i,e)&&n.push(e)}for(let r=0,o=n.length;r<o;r++){const t=n[r],o=Te(t);this.setupChangeEvents_(o,t);const s=t.getGeometry();if(s){const n=s.getExtent();e.push(n),i.push(t)}else this.nullGeometryFeatures_[o]=t}if(this.featuresRtree_&&this.featuresRtree_.load(e,i),this.hasListener(Yu))for(let r=0,o=n.length;r<o;r++)this.dispatchEvent(new sh(Yu,n[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Yu,(function(n){e||(e=!0,t.push(n.feature),e=!1)})),this.addEventListener(Ku,(function(n){e||(e=!0,t.remove(n.feature),e=!1)})),t.addEventListener(Me,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(Le,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(Ce)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const e in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[e])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new sh(Zu);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){const i=n.getGeometry();if(i instanceof Xu||i.intersectsCoordinate(t))return e(n)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(n){const i=n.getGeometry();if(i instanceof Xu||i.intersectsExtent(t)){const t=e(n);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),ue(this.nullGeometryFeatures_)||ee(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=function(t,e){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];Gn(t,e);const i=An(n);if(An(t)>i)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+i,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-i,t[3]]]}return[t]}(t,e);return[].concat(...n.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],i=t[1];let r=null;const o=[NaN,NaN];let s=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||ie,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),l=s;if(s=e instanceof Xu?0:e.closestPointXY(n,i,o,s),s<l){r=t;const e=Math.sqrt(s);a[0]=n-e,a[1]=i-e,a[2]=n+e,a[3]=i+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=Te(e),i=e.getGeometry();if(i){const t=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new sh(qu,e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:Te(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ue(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,n){const i=this.loadedExtentsRtree_,r=this.strategy_(t,e,n);for(let o=0,s=r.length;o<s;++o){const t=r[o];i.forEachInExtent(t,(function(e){return cn(e.extent,t)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new sh(Ju)),this.loader_.call(this,t,e,n,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new sh(Qu,void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new sh(th))})),i.insert(t,{extent:t.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,(function(e){if(vn(e.extent,t))return n=e,!0})),n&&e.remove(n)}removeFeature(t){if(!t)return;const e=Te(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Te(t),n=this.featureChangeKeys_[e];if(!n)return;n.forEach(Ce),delete this.featureChangeKeys_[e];const i=t.getId();return void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.dispatchEvent(new sh(Ku,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_){const i=this.idIndex_[n];if(t instanceof Xu&&Array.isArray(i)&&i.includes(t))i.splice(i.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){Ae(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(oh(t,this.format_))}};const lh=class extends Da{constructor(t,e,n,i,r){super(t,e,n,void 0!==r?co:fo),this.loader_=void 0!==r?r:null,this.canvas_=i,this.error_=null}getError(){return this.error_}handleLoad_(t){t?(this.error_=t,this.state=go):this.state=fo,this.changed()}load(){this.state==co&&(this.state=po,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}},uh={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};const hh=class extends he{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ce)}release(){this.state===uh.ERROR&&this.setState(uh.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==uh.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==uh.LOADED){t.interimTile=null;break}t.getState()==uh.LOADING?e=t:t.getState()==uh.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==uh.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){Ie()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;const i=e-n+1e3/60;return i>=this.transition_?1:ta(i/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}};const ch=class extends hh{constructor(t,e,n,i,r,o){super(t,e,o),this.crossOrigin_=i,this.src_=n,this.key=n,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=uh.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=uh.ERROR,this.unlistenImage_(),this.image_=function(){const t=Go(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=uh.LOADED:this.state=uh.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==uh.ERROR&&(this.state=uh.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==uh.IDLE&&(this.state=uh.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,n){const i=t;let r=!0,o=!1,s=!1;const a=[be(i,ye,(function(){s=!0,o||e()}))];return i.src&&Xe?(o=!0,i.decode().then((function(){r&&e()})).catch((function(t){r&&(s?e():n())}))):a.push(be(i,de,n)),function(){r=!1,a.forEach(Ce)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}};const dh=class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;const r=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}};function ph(t,e){La.expire()}const fh=class extends Kt{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){Ie()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;tn(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),en(i,n)}forEachFeatureAtCoordinate(t,e,n,i,r,o,s,a){let l;const u=e.viewState;function h(t,e,n,i){return r.call(o,e,t?n:null,i)}const c=u.projection,d=xi(t.slice(),c),p=[[0,0]];if(c.canWrapX()&&i){const t=An(c.getExtent());p.push([-t,0],[t,0])}const f=e.layerStatesArray,g=f.length,m=[],_=[];for(let v=0;v<p.length;v++)for(let i=g-1;i>=0;--i){const r=f[i],o=r.layer;if(o.hasRenderer()&&la(r,u)&&s.call(a,o)){const i=o.getRenderer(),s=o.getSource();if(i&&s){const o=s.getWrapX()?d:t,a=h.bind(null,r.managed);_[0]=o[0]+p[v][0],_[1]=o[1]+p[v][1],l=i.forEachFeatureAtCoordinate(_,e,n,a,m)}if(l)return l}}if(0===m.length)return;const y=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*y)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,n,i,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,ie,this,r,o)}getMap(){return this.map_}renderFrame(t){Ie()}flushDeclutterItems(t){}scheduleExpireIconCache(t){La.canExpireCache()&&t.postRenderFunctions.push(ph)}};const gh=class extends fh{constructor(t){super(t),this.fontChangeListenerKey_=xe(us,Zt,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Yo+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const i=new Ql(t,void 0,e);n.dispatchEvent(i)}}disposeInternal(){Ce(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(Qr,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=t.viewState;this.children_.length=0;const i=this.declutterLayers_;i.length=0;let r=null;for(let o=0,s=e.length;o<s;++o){const s=e[o];t.layerIndex=o;const a=s.layer,l=a.getSourceState();if(!la(s,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const u=a.render(t,r);u&&(u!==r&&(this.children_.push(u),r=u),"getDeclutter"in a&&i.push(a))}this.flushDeclutterItems(t),function(t,e){const n=t.childNodes;for(let i=0;;++i){const r=n[i],o=e[i];if(!r&&!o)break;r!==o&&(r?o?t.insertBefore(o,r):(t.removeChild(r),--i):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent(to,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let n=e.length-1;n>=0;--n)e[n].renderDeclutter(t);e.length=0}};class mh extends qt{constructor(t,e){super(t),this.layer=e}}const _h="layers";class yh extends Ns{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(_h,this.handleLayersChanged_),n?Array.isArray(n)?n=new Fe(n.slice(),{unique:!0}):Ae("function"==typeof n.getArray,"Expected `layers` to be an array or a `Collection`"):n=new Fe(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ce),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(xe(t,Me,this.handleLayersAdd_,this),xe(t,Le,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ce);le(this.listenerKeys_);const e=t.getArray();for(let n=0,i=e.length;n<i;n++){const t=e[n];this.registerLayerListeners_(t),this.dispatchEvent(new mh("addlayer",t))}this.changed()}registerLayerListeners_(t){const e=[xe(t,Zt,this.handleLayerChange_,this),xe(t,ce,this.handleLayerChange_,this)];t instanceof yh&&e.push(xe(t,"addlayer",this.handleLayerGroupAdd_,this),xe(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Te(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new mh("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new mh("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new mh("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=Te(e);this.listenerKeys_[n].forEach(Ce),delete this.listenerKeys_[n],this.dispatchEvent(new mh("removelayer",e)),this.changed()}getLayers(){return this.get(_h)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,n=t.length;e<n;++e)this.dispatchEvent(new mh("removelayer",t[e]))}this.set(_h,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const i=this.getLayerState();let r=i.zIndex;t||void 0!==i.zIndex||(r=0);for(let o=n,s=e.length;o<s;o++){const t=e[o];t.opacity*=i.opacity,t.visible=t.visible&&i.visible,t.maxResolution=Math.min(t.maxResolution,i.maxResolution),t.minResolution=Math.max(t.minResolution,i.minResolution),t.minZoom=Math.max(t.minZoom,i.minZoom),t.maxZoom=Math.min(t.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==t.extent?t.extent=Rn(t.extent,i.extent):t.extent=i.extent),void 0===t.zIndex&&(t.zIndex=r)}return e}getSourceState(){return"ready"}}const vh=yh;const wh=class extends qt{constructor(t,e,n){super(t),this.map=e,this.frameState=void 0!==n?n:null}};const xh=class extends wh{constructor(t,e,n,i,r,o){super(t,e,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==i&&i,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},bh={SINGLECLICK:"singleclick",CLICK:fe,DBLCLICK:ge,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Ch="pointermove",Sh="pointerdown";const Eh=class extends he{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=xe(n,Sh,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=xe(n,Ch,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ve,this.boundHandleTouchMove_,!!$e&&{passive:!1})}emulateClick_(t){let e=new xh(bh.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new xh(bh.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new xh(bh.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==bh.POINTERUP||e.type==bh.POINTERCANCEL){delete this.trackedTouches_[n];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=bh.POINTERDOWN&&e.type!=bh.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new xh(bh.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(Ce),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new xh(bh.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(xe(t,bh.POINTERMOVE,this.handlePointerMove_,this),xe(t,bh.POINTERUP,this.handlePointerUp_,this),xe(this.element_,bh.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(xe(this.element_.getRootNode(),bh.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new xh(bh.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new xh(bh.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ce(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ve,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ce(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ce),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Ih="postrender",Ph="movestart",Th="moveend",kh="loadstart",Dh="loadend",Mh="layergroup",Lh="size",Rh="target",Oh="view",Fh=1/0;const Ah=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,le(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const i=this.keyFunction_(n);return delete this.queuedElements_[i],n}enqueue(t){Ae(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Fh&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,i=e.length,r=e[t],o=n[t],s=t;for(;t<i>>1;){const r=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),s=o<i&&n[o]<n[r]?o:r;e[t]=e[s],n[t]=n[s],t=s}e[t]=r,n[t]=o,this.siftDown_(s,t)}siftDown_(t,e){const n=this.elements_,i=this.priorities_,r=n[e],o=i[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(i[t]>o))break;n[e]=n[t],i[e]=i[t],e=t}n[e]=r,i[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let i=0;const r=e.length;let o,s,a;for(s=0;s<r;++s)o=e[s],a=t(o),a==Fh?delete this.queuedElements_[this.keyFunction_(o)]:(n[i]=a,e[i++]=o);e.length=i,n.length=i,this.heapify_()}};const zh=class extends Ah{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);if(e){t[0].addEventListener(ce,this.boundHandleTileChange_)}return e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===uh.LOADED||n===uh.ERROR||n===uh.EMPTY){n!==uh.ERROR&&e.removeEventListener(ce,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n,i,r,o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;)i=this.dequeue()[0],r=i.getKey(),n=i.getState(),n!==uh.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,i.load())}};const Bh=class extends De{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Xo(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Xo(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)Ce(this.listenerKeys[e]);if(this.listenerKeys.length=0,this.map_=t,t){(this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==oe&&this.listenerKeys.push(xe(t,Ih,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}};const jh=class extends Bh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",n=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",o=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const s=void 0!==t.label?t.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s,this.label_.className=i):this.label_=s;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(fe,this.handleClick_.bind(this),!1);const l=e+" "+Yo+" "+qo+(this.collapsed_&&this.collapsible_?" "+Zo:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=l,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),n=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!ne(e,this.renderedAttributions_)){Uo(this.ulElement_);for(let t=0,n=e.length;t<n;++t){const n=document.createElement("li");n.innerHTML=e[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Zo),this.collapsed_?Wo(this.collapseLabel_,this.label_):Wo(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}};const Gh=class extends Bh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",n=void 0!==t.label?t.label:"⇧",i=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(i));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(fe,this.handleClick_.bind(this),!1);const s=e+" "+Yo+" "+qo,a=this.element;a.className=s,a.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add($o)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:ea}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const t="rotate("+n+"rad)";if(this.autoHide_){const t=this.element.classList.contains($o);t||0!==n?t&&0!==n&&this.element.classList.remove($o):this.element.classList.add($o)}this.label_.style.transform=t}this.rotation_=n}};const Nh=class extends Bh{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",n=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",o=void 0!==t.zoomInLabel?t.zoomInLabel:"+",s=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(fe,this.handleClick_.bind(this,n),!1);const h=document.createElement("button");h.className=r,h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(fe,this.handleClick_.bind(this,-n),!1);const c=e+" "+Yo+" "+qo,d=this.element;d.className=c,d.appendChild(u),d.appendChild(h),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const n=e.getZoom();if(void 0!==n){const i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:ea})):e.setZoom(i)}}};function Vh(t){t=t||{};const e=new Fe;(void 0===t.zoom||t.zoom)&&e.push(new Nh(t.zoomOptions));(void 0===t.rotate||t.rotate)&&e.push(new Gh(t.rotateOptions));return(void 0===t.attribution||t.attribution)&&e.push(new jh(t.attributionOptions)),e}const Hh="active";function Wh(t,e,n,i){const r=t.getZoom();if(void 0===r)return;const o=t.getConstrainedZoom(r+e),s=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:n,duration:void 0!==i?i:250,easing:ea})}const Xh=class extends De{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Hh)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Hh,t)}setMap(t){this.map_=t}};const Uh=class extends Xh{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==bh.DBLCLICK){const n=t.originalEvent,i=t.map,r=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;Wh(i.getView(),o,r,this.duration_),n.preventDefault(),e=!0}return!e}};function $h(t){const e=t.length;let n=0,i=0;for(let r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return{clientX:n/e,clientY:i/e}}const Yh=class extends Xh{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==bh.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==bh.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==bh.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==bh.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function qh(t){const e=arguments;return function(t){let n=!0;for(let i=0,r=e.length;i<r&&(n=n&&e[i](t),n);++i);return n}}const Zh=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Kh=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)}(t)},Jh=ie,Qh=function(t){const e=t.originalEvent;return 0==e.button&&!(Ne&&Ve&&e.ctrlKey)},tc=re,ec=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},nc=function(t){const e=t.originalEvent;return!e.altKey&&(Ve?e.metaKey:e.ctrlKey)&&!e.shiftKey},ic=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},rc=function(t){const e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},oc=function(t){const e=t.originalEvent;return Ae(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},sc=function(t){const e=t.originalEvent;return Ae(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button};const ac=class extends Yh{constructor(t){super({stopDown:re}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:qh(ec,sc);this.condition_=t.onFocusOnly?qh(Kh,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,i=e.getEventPixel($h(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],n=t.map.getView();r=e,o=n.getResolution(),r[0]*=o,r[1]*=o,yi(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,o;this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),r=n.getCenterInternal(),o=e.getPixelFromCoordinateInternal(r),s=e.getCoordinateFromPixelInternal([o[0]-t*Math.cos(i),o[1]-t*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(s),duration:500,easing:ea})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}};const lc=class extends Yh{constructor(t){t=t||{},super({stopDown:re}),this.condition_=t.condition?t.condition:Zh,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!oc(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Js)return;const i=e.getSize(),r=t.pixel,o=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){const t=o-this.lastAngle_;n.adjustRotationInternal(-t)}this.lastAngle_=o}handleUpEvent(t){if(!oc(t))return!0;return t.map.getView().endInteraction(this.duration_),!1}handleDownEvent(t){if(!oc(t))return!1;if(Qh(t)&&this.condition_(t)){return t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0}return!1}};const uc=class extends Kt{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",i=this.element_.style;i.left=Math.min(t[0],e[0])+n,i.top=Math.min(t[1],e[1])+n,i.width=Math.abs(e[0]-t[0])+n,i.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Ur([n])}getGeometry(){return this.geometry_}},hc="boxstart",cc="boxdrag",dc="boxend",pc="boxcancel";class fc extends qt{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}const gc=class extends Yh{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new uc(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Qh,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new fc(cc,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new fc(e?dc:pc,t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new fc(hc,t.coordinate,t)),!0)}onBoxEnd(t){}};const mc=class extends gc{constructor(t){super({condition:(t=t||{}).condition?t.condition:ic,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let n=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(t),r=e.getResolution()/i;n=n.clone(),n.scale(r*r)}e.fitInternal(n,{duration:this.duration_,easing:ea})}},_c="ArrowLeft",yc="ArrowUp",vc="ArrowRight",wc="ArrowDown";const xc=class extends Xh{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return ec(t)&&rc(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==me){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&(i==wc||i==_c||i==vc||i==yc)){const r=t.map.getView(),o=r.getResolution()*this.pixelDelta_;let s=0,a=0;i==wc?a=-o:i==_c?s=-o:i==vc?s=o:a=o;const l=[s,a];yi(l,r.getRotation()),function(t,e,n){const i=t.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:ia,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),n.preventDefault(),e=!0}}return!e}};const bc=class extends Xh{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return Ve?e.metaKey:e.ctrlKey}(t)&&rc(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==me||t.type==_e){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&("+"===i||"-"===i)){const r=t.map,o="+"===i?this.delta_:-this.delta_;Wh(r.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}};const Cc=class extends Xh{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Jh;this.condition_=t.onFocusOnly?qh(Kh,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==we)return!0;const e=t.map,n=t.originalEvent;let i;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==we&&(i=n.deltaY,Ge&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=He),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)),0===i)return!1;this.lastDelta_=i;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");const o=e.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=i;const s=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),s),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-oi(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Wh(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}};const Sc=class extends Yh{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=re),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const o=t.map,s=o.getView();s.getConstraints().rotation!==Js&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel($h(this.targetPointers))),this.rotating_&&(o.render(),s.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){if(this.targetPointers.length<2){return t.map.getView().endInteraction(this.duration_),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};const Ec=class extends Yh{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=re),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,o=n.clientY-i.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel($h(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function Ic(t){t=t||{};const e=new Fe,n=new dh(-.005,.05,100);(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new lc);(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Uh({delta:t.zoomDelta,duration:t.zoomDuration}));(void 0===t.dragPan||t.dragPan)&&e.push(new ac({onFocusOnly:t.onFocusOnly,kinetic:n}));(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Sc);(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Ec({duration:t.zoomDuration}));(void 0===t.keyboard||t.keyboard)&&(e.push(new xc),e.push(new bc({delta:t.zoomDelta,duration:t.zoomDuration})));(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new Cc({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration}));return(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new mc({duration:t.zoomDuration})),e}function Pc(t){t instanceof ua?t.setMapInternal(null):t instanceof vh&&t.getLayers().forEach(Pc)}function Tc(t,e){if(t instanceof ua)t.setMapInternal(e);else if(t instanceof vh){const n=t.getLayers().getArray();for(let t=0,i=n.length;t<i;++t)Tc(n[t],e)}}const kc=class extends De{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new vh({layers:t.layers});let r,o,s;n[Mh]=i,n[Rh]=t.target,n[Oh]=t.view instanceof aa?t.view:new aa,void 0!==t.controls&&(Array.isArray(t.controls)?r=new Fe(t.controls.slice()):(Ae("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?o=new Fe(t.interactions.slice()):(Ae("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),o=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?s=new Fe(t.overlays.slice()):(Ae("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),s=t.overlays):s=new Fe;return{controls:r,interactions:o,keyboardEventTarget:e,overlays:s,values:n}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:He,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||Vh(),this.interactions=e.interactions||Ic({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new zh(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Mh,this.handleLayerGroupChanged_),this.addChangeListener(Oh,this.handleViewChanged_),this.addChangeListener(Lh,this.handleSizeChanged_),this.addChangeListener(Rh,this.handleTargetChanged_),this.setProperties(e.values);const n=this;!t.view||t.view instanceof aa||t.view.then((function(t){n.setView(new aa(t))})),this.controls.addEventListener(Me,(t=>{t.element.setMap(this)})),this.controls.addEventListener(Le,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(Me,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(Le,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(Me,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(Le,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Tc(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:ie,s=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,s,e,null,o,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}getAllLayers(){const t=[];return function e(n){n.forEach((function(n){n instanceof vh?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:ie,r=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,o,i,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),n=this.getSize(),i=e.width/n[0],r=e.height/n[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/i,(o.clientY-e.top)/r]}getTarget(){return this.get(Rh)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ui(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Je(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Mh)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Fe)return void e.setLayers(t);const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e];if(!n.visible)continue;const i=n.layer.getRenderer();if(i&&!i.ready)return!0;const r=n.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=$i(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Je(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Lh)}getView(){return this.get(Oh)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,i){return function(t,e,n,i,r){if(!t||!(n in t.wantedTiles))return Fh;if(!t.wantedTiles[n][e.getKey()])return Fh;const o=t.viewState.center,s=i[0]-o[0],a=i[1]-o[1];return 65536*Math.log(r)+Math.sqrt(s*s+a*a)/r}(this.frameState_,t,e,n,i)}handleBrowserEvent(t,e){e=e||t.type;const n=new xh(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===Sh||n===we||n===me){const t=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():t,i=e.target;if(this.overlayContainerStopEvent_.contains(i)||!(n===t?t.documentElement:n).contains(i))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.getMap()!==this||!i.getActive()||!this.getTargetElement())continue;if(!i.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,i=n;if(t){const e=t.viewHints;if(e[Vs]||e[Hs]){const e=Date.now()-t.time>8;n=e?0:8,i=e?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(eo)&&this.renderer_.dispatchRenderEvent(eo,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new wh(Dh,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new wh(kh,this,t))));const n=this.postRenderFunctions_;for(let i=0,r=n.length;i<r;++i)n[i](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)Ce(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(pe,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(we,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Xo(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new gh(this)),this.mapBrowserEventHandler_=new Eh(this,this.moveTolerance_);for(const e in bh)this.mapBrowserEventHandler_.addEventListener(bh[e],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(pe,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(we,this.boundHandleBrowserEvent_,!!$e&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[xe(t,me,this.handleBrowserEvent,this),xe(t,_e,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ce(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ce(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=xe(t,Zt,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=xe(t,ce,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ce),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new mh("addlayer",t)),this.layerGroupPropertyListenerKeys_=[xe(t,Zt,this.render,this),xe(t,ce,this.render,this),xe(t,"addlayer",this.handleLayerAdd_,this),xe(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Pc(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),i=this.frameState_;let r=null;if(void 0!==e&&_o(e)&&n&&n.isDef()){const i=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Dn(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:i,wantedTiles:{},mapId:Te(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const t=isNaN(o.nextRotation)?o.rotation:o.nextRotation;r.nextExtent=Dn(o.nextCenter,o.nextResolution,t,e)}}if(this.frameState_=r,this.renderer_.renderFrame(r),r){if(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),i){(!this.previousExtent_||!Bn(this.previousExtent_)&&!vn(r.extent,this.previousExtent_))&&(this.dispatchEvent(new wh(Ph,this,i)),this.previousExtent_=mn(this.previousExtent_))}this.previousExtent_&&!r.viewHints[Vs]&&!r.viewHints[Hs]&&!vn(r.extent,this.previousExtent_)&&(this.dispatchEvent(new wh(Th,this,r)),ln(r.extent,this.previousExtent_))}this.dispatchEvent(new wh(Ih,this,r)),this.renderComplete_=this.hasListener(kh)||this.hasListener(Dh)||this.hasListener(eo)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new mh("removelayer",e)),this.set(Mh,t)}setSize(t){this.set(Lh,t)}setTarget(t){this.set(Rh,t)}setView(t){if(!t||t instanceof aa)return void this.set(Oh,t);this.set(Oh,new aa);const e=this;t.then((function(t){e.setView(new aa(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),i=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),r=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(i)||isNaN(r)||(e=[i,r],!_o(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Di())}const n=this.getSize();!e||n&&ne(e,n)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},Dc="element",Mc="map",Lc="offset",Rc="position",Oc="positioning";const Fc=class extends De{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Dc,this.handleElementChanged),this.addChangeListener(Mc,this.handleMapChanged),this.addChangeListener(Lc,this.handleOffsetChanged),this.addChangeListener(Rc,this.handlePositionChanged),this.addChangeListener(Oc,this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(Dc)}getId(){return this.id}getMap(){return this.get(Mc)||null}getOffset(){return this.get(Lc)}getPosition(){return this.get(Rc)}getPositioning(){return this.get(Oc)}handleElementChanged(){Uo(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(Xo(this.element),Ce(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=xe(t,Ih,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Dc,t)}setMap(t){this.set(Mc,t)}setOffset(t){this.set(Lc,t)}setPosition(t){this.set(Rc,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Rc))return;const n=this.getRect(e.getTargetElement(),e.getSize()),i=this.getElement(),r=this.getRect(i,[Vo(i),Ho(i)]),o=void 0===(t=t||{}).margin?20:t.margin;if(!cn(n,r)){const i=r[0]-n[0],s=n[2]-r[2],a=r[1]-n[1],l=n[3]-r[3],u=[0,0];if(i<0?u[0]=i-o:s<0&&(u[0]=Math.abs(s)+o),a<0?u[1]=a-o:l<0&&(u[1]=Math.abs(l)+o),0!==u[0]||0!==u[1]){const n=e.getView().getCenterInternal(),i=e.getPixelFromCoordinateInternal(n);if(!i)return;const r=[i[0]+u[0],i[1]+u[1]],o=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(r),duration:o.duration,easing:o.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),i=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[i,r,i+e[0],r+e[1]]}setPositioning(t){this.set(Oc,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const n=t.getPixelFromCoordinate(e),i=t.getSize();this.updateRenderedPosition(n,i)}updateRenderedPosition(t,e){const n=this.element.style,i=this.getOffset(),r=this.getPositioning();this.setVisible(!0);let o="0%",s="0%";"bottom-right"==r||"center-right"==r||"top-right"==r?o="-100%":"bottom-center"!=r&&"center-center"!=r&&"top-center"!=r||(o="-50%"),"bottom-left"==r||"bottom-center"==r||"bottom-right"==r?s="-100%":"center-left"!=r&&"center-center"!=r&&"center-right"!=r||(s="-50%");const a=`translate(${o}, ${s}) translate(${Math.round(t[0]+i[0])+"px"}, ${Math.round(t[1]+i[1])+"px"})`;this.rendered.transform_!=a&&(this.rendered.transform_=a,n.transform=a)}getOptions(){return this.options}};const Ac=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return Ae(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return Ae(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return null==(e=this.entries_[t])?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){Ae(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};function zc(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function Bc(t,e,n){return t+"/"+e+"/"+n}function jc(t){return Bc(t[0],t[1],t[2])}function Gc(t){return t.split("/").map(Number)}const Nc=class extends Ac{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}}pruneExceptNewestZ(){if(0===this.getCount())return;const t=Gc(this.peekFirstKey())[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(jc(e.tileCoord)),e.release())}))}};class Vc{constructor(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Hc(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new Vc(t,e,n,i)}const Wc=Vc,Xc=[];const Uc=class extends hh{constructor(t,e,n,i){super(t,e,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.wrappedTileCoord=n}getContext(t){const e=Te(t);return e in this.context_||(this.context_[e]=Go(1,1,Xc)),this.context_[e]}hasContext(t){return Te(t)in this.context_}getImage(t){return this.hasContext(t)?this.getContext(t).canvas:null}getReplayState(t){const e=Te(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){for(const t in this.context_){const e=this.context_[t];No(e),Xc.push(e.canvas),delete this.context_[t]}super.release()}};const $c=class extends hh{constructor(t,e,n,i,r,o){super(t,e,o),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=n,this.key=n}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==uh.IDLE&&(this.setState(uh.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(uh.ERROR)}setFeatures(t){this.features_=t,this.setState(uh.LOADED)}setLoader(t){this.loader_=t}},Yc="drawstart",qc="drawend",Zc="drawabort";class Kc extends qt{constructor(t,e){super(t),this.feature=e}}function Jc(t,e){return ai(t[0],t[1],e[0],e[1])}function Qc(t,e){const n=t.length;return e<0?t[e+n]:e>=n?t[e-n]:t[e]}function td(t,e,n){let i,r;e<n?(i=e,r=n):(i=n,r=e);const o=Math.ceil(i),s=Math.floor(r);if(o>s){return Jc(sd(t,i),sd(t,r))}let a=0;if(i<o){a+=Jc(sd(t,i),Qc(t,o))}if(s<r){a+=Jc(Qc(t,s),sd(t,r))}for(let l=o;l<s-1;++l){a+=Jc(Qc(t,l),Qc(t,l+1))}return a}function ed(t,e,n){if(e instanceof lo)id(t,e.getCoordinates(),!1,n);else if(e instanceof zu){const i=e.getCoordinates();for(let e=0,r=i.length;e<r;++e)id(t,i[e],!1,n)}else if(e instanceof Ur){const i=e.getCoordinates();for(let e=0,r=i.length;e<r;++e)id(t,i[e],!0,n)}else if(e instanceof Vu){const i=e.getCoordinates();for(let e=0,r=i.length;e<r;++e){const r=i[e];for(let e=0,i=r.length;e<i;++e)id(t,r[e],!0,n)}}else if(e instanceof Fu){const i=e.getGeometries();for(let e=0;e<i.length;++e)ed(t,i[e],n)}else;}const nd={index:-1,endIndex:NaN};function id(t,e,n,i){const r=t[0],o=t[1];for(let s=0,a=e.length-1;s<a;++s){const t=od(r,o,e[s],e[s+1]);if(0===t.squaredDistance){const r=s+t.along;return void i.push({coordinates:e,ring:n,startIndex:r,endIndex:r})}}}const rd={along:0,squaredDistance:0};function od(t,e,n,i){const r=n[0],o=n[1],s=i[0]-r,a=i[1]-o;let l=0,u=r,h=o;return 0===s&&0===a||(l=oi(((t-r)*s+(e-o)*a)/(s*s+a*a),0,1),u+=s*l,h+=a*l),rd.along=l,rd.squaredDistance=di(ai(t,e,u,h),10),rd}function sd(t,e){const n=t.length;let i=Math.floor(e);const r=e-i;i>=n?i-=n:i<0&&(i+=n);let o=i+1;o>=n&&(o-=n);const s=t[i],a=s[0],l=s[1],u=t[o];return[a+(u[0]-a)*r,l+(u[1]-l)*r]}function ad(){const t=Is();return function(e,n){return t[e.getGeometry().getType()]}}function ld(t,e){return function(n,i,r){const o=$i(n[0]),s=$i(n[n.length-1]),a=Math.sqrt(vi(o,s));i=i||qr(new Lu(o),t);let l=e;if(!e&&0!==e){const t=s[0]-o[0],e=s[1]-o[1];l=Math.atan2(e,t)}return Zr(i,o,a,l),i}}function ud(){return function(t,e,n){const i=sn([t[0],t[t.length-1]].map((function(t){return $i(t)}))),r=[[In(i),Pn(i),Fn(i),On(i),In(i)]];return e?e.setCoordinates(r):e=new Ur(r),e}}const hd=class extends Yh{constructor(t){const e=t;e.stopDown||(e.stopDown=re),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+t)}}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:ie,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let n=t.geometryFunction;if(!n){const t=this.mode_;if("Circle"===t)n=function(t,e,n){const i=e||new Lu([NaN,NaN]),r=$i(t[0]),o=vi(r,$i(t[t.length-1]));return i.setCenterAndRadius(r,Math.sqrt(o),this.geometryLayout_),i};else{let e;"Point"===t?e=Tr:"LineString"===t?e=lo:"Polygon"===t&&(e=Ur),n=function(n,i,r){return i?"Polygon"===t?n[0].length?i.setCoordinates([n[0].concat([n[0][0]])],this.geometryLayout_):i.setCoordinates([],this.geometryLayout_):i.setCoordinates(n,this.geometryLayout_):i=new e(n,this.geometryLayout_),i}}}this.geometryFunction_=n,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new ku({source:new ah({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:ad(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:ec,this.freehandCondition_,t.freehand?this.freehandCondition_=Jh:this.freehandCondition_=t.freehandCondition?t.freehandCondition:ic,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(Hh,this.updateState_)}setTrace(t){let e;e=t?!0===t?Jh:t:tc,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===pe&&t.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(t);let e=t.type===bh.POINTERMOVE,n=!0;if(!this.freehand_&&this.lastDragTime_&&t.type===bh.POINTERDRAG){Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&t.type===bh.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),n=!1):this.freehand_&&t.type===bh.POINTERDOWN?n=!1:e&&this.getPointerCount()<2?(n=t.type===bh.POINTERMOVE,n&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):("mouse"===t.originalEvent.pointerType||t.type===bh.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t)):t.type===bh.DBLCLICK&&(n=!1),super.handleEvent(t)&&n}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout((()=>{this.handlePointerMove_(new xh(bh.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active)return void this.deactivateTrace_();const e=this.getMap(),n=sn([e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_])]),i=this.traceSource_.getFeaturesInExtent(n);if(0===i.length)return;const r=function(t,e){const n=[];for(let i=0;i<e.length;++i)ed(t,e[i].getGeometry(),n);return n}(t.coordinate,i);r.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const n=t.startIndex<=t.endIndex;n===t.startIndex<=e?n&&e>t.endIndex||!n&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(n&&e<t.endIndex||!n&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let n=0;if(t<e){const i=Math.ceil(t);let r=Math.floor(e);r===e&&(r-=1),n=r-i+1}else{const i=Math.floor(t);let r=Math.ceil(e);r===e&&(r+=1),n=i-r+1}n>0&&this.removeLastPoints_(n)}addTracedCoordinates_(t,e,n){if(e===n)return;const i=[];if(e<n){const r=Math.ceil(e);let o=Math.floor(n);o===n&&(o-=1);for(let e=r;e<=o;++e)i.push(Qc(t.coordinates,e))}else{const r=Math.floor(e);let o=Math.ceil(n);o===n&&(o+=1);for(let e=r;e>=o;--e)i.push(Qc(t.coordinates,e))}i.length&&this.appendCoordinates(i)}updateTrace_(t){const e=this.traceState_;if(!e.active)return;if(-1===e.targetIndex&&wi(e.startPx,t.pixel)<this.snapTolerance_)return;const n=function(t,e,n,i){const r=t[0],o=t[1];let s=1/0,a=-1,l=NaN;for(let c=0;c<e.targets.length;++c){const t=e.targets[c],n=t.coordinates;let i,u=1/0;for(let e=0;e<n.length-1;++e){const t=od(r,o,n[e],n[e+1]);t.squaredDistance<u&&(u=t.squaredDistance,i=e+t.along)}u<s&&(s=u,t.ring&&e.targetIndex===c&&(t.endIndex>t.startIndex?i<t.startIndex&&(i+=n.length):t.endIndex<t.startIndex&&i>t.startIndex&&(i-=n.length)),l=i,a=c)}const u=e.targets[a];let h=u.ring;if(e.targetIndex===a&&h){const t=sd(u.coordinates,l);wi(n.getPixelFromCoordinate(t),e.startPx)>i&&(h=!1)}if(h){const t=u.coordinates,e=t.length,n=u.startIndex,i=l;if(n<i){const r=td(t,n,i);td(t,n,i-e)<r&&(l-=e)}else{const r=td(t,n,i);td(t,n,i+e)<r&&(l+=e)}}return nd.index=a,nd.endIndex=l,nd}(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==n.index){if(-1!==e.targetIndex){const t=e.targets[e.targetIndex];this.removeTracedCoordinates_(t.startIndex,t.endIndex)}const t=e.targets[n.index];this.addTracedCoordinates_(t,t.startIndex,n.endIndex)}else{const t=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(t,n.endIndex)}e.targetIndex=n.index;const i=e.targets[e.targetIndex];i.endIndex=n.endIndex;const r=sd(i.coordinates,i.endIndex),o=this.getMap().getPixelFromCoordinate(r);t.coordinate=r,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(t){let e=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const n=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const i=!this.finishCoordinate_;i&&this.startDrawing_(t.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&"Point"!==this.mode_||(this.atFinish_(t.pixel,n)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,n=t.pixel,i=e[0]-n[0],r=e[1]-n[1],o=i*i+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(t),this.modifyDrawing_(t.coordinate)):this.createOrUpdateSketchPoint_(t.coordinate.slice())}atFinish_(t,e){let n=!1;if(this.sketchFeature_){let i=!1,r=[this.finishCoordinate_];const o=this.mode_;if("Point"===o)n=!0;else if("Circle"===o)n=2===this.sketchCoords_.length;else if("LineString"===o)i=!e&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===o){const t=this.sketchCoords_;i=t[0].length>this.minPoints_,r=[t[0][0],t[0][t[0].length-2]],r=e?[t[0][0]]:[t[0][0],t[0][t[0].length-2]]}if(i){const e=this.getMap();for(let i=0,o=r.length;i<o;i++){const o=r[i],s=e.getPixelFromCoordinate(o),a=t[0]-s[0],l=t[1]-s[1],u=this.freehand_?1:this.snapTolerance_;if(n=Math.sqrt(a*a+l*l)<=u,n){this.finishCoordinate_=o;break}}}}return n}createOrUpdateSketchPoint_(t){if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(t)}else this.sketchPoint_=new Be(new Tr(t)),this.updateSketchFeatures_()}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new Be);const e=t.getLinearRing(0);let n=this.sketchLine_.getGeometry();n?(n.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),n.changed()):(n=new lo(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(n))}startDrawing_(t){const e=this.getMap().getView().getProjection(),n=rr(this.geometryLayout_);for(;t.length<n;)t.push(0);this.finishCoordinate_=t,"Point"===this.mode_?this.sketchCoords_=t.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Be(new lo(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new Be,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Kc(Yc,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),n=this.sketchFeature_.getGeometry(),i=e.getView().getProjection(),r=rr(this.geometryLayout_);let o,s;for(;t.length<r;)t.push(0);if("Point"===this.mode_?s=this.sketchCoords_:"Polygon"===this.mode_?(o=this.sketchCoords_[0],s=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,s=o[o.length-1]),s[0]=t[0],s[1]=t[1],this.geometryFunction_(this.sketchCoords_,n,i),this.sketchPoint_){this.sketchPoint_.getGeometry().setCoordinates(t)}if("Polygon"===n.getType()&&"Polygon"!==this.mode_)this.createOrUpdateCustomSketchLine_(n);else if(this.sketchLineCoords_){this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();let i,r;const o=this.mode_;"LineString"===o||"Circle"===o?(this.finishCoordinate_=t.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():i=!0),r.push(t.slice()),this.geometryFunction_(r,e,n)):"Polygon"===o&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():i=!0),r.push(t.slice()),i&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,e,n)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),i&&this.finishDrawing()}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection(),i=this.mode_;for(let r=0;r<t;++r){let t;if("LineString"===i||"Circle"===i){if(t=this.sketchCoords_,t.splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();const e=this.finishCoordinate_.slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}this.geometryFunction_(t,e,n),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if("Polygon"===i){t=this.sketchCoords_[0],t.splice(-2,1);const i=this.sketchLine_.getGeometry();if(t.length>=2){const e=t[t.length-2].slice();t[t.length-1]=e,this.createOrUpdateSketchPoint_(e)}i.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,n)}if(1===t.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return;let e=this.sketchCoords_;const n=t.getGeometry(),i=this.getMap().getView().getProjection();"LineString"===this.mode_?(e.pop(),this.geometryFunction_(e,n,i)):"Polygon"===this.mode_&&(e[0].pop(),this.geometryFunction_(e,n,i),e=n.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new ju([e])):"MultiLineString"===this.type_?t.setGeometry(new zu([e])):"MultiPolygon"===this.type_&&t.setGeometry(new Vu([e])),this.dispatchEvent(new Kc(qc,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new Kc(Zc,t))}appendCoordinates(t){const e=this.mode_,n=!this.sketchFeature_;let i;if(n&&this.startDrawing_(t[0]),"LineString"===e||"Circle"===e)i=this.sketchCoords_;else{if("Polygon"!==e)return;i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}n&&i.shift(),i.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const r=t[t.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}extend(t){const e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new Be(new Tr(n)),this.updateSketchFeatures_(),this.dispatchEvent(new Kc(Yc,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)}},cd=[0,0,0,0],dd=[],pd="modifystart",fd="modifyend";class gd extends qt{constructor(t,e,n){super(t),this.features=e,this.mapBrowserEvent=n}}function md(t,e){return t.index-e.index}function _d(t,e,n){const i=e.geometry;if("Circle"===i.getType()){let n=i;if(1===e.index){const e=vi(n.getCenter(),$i(t)),i=Math.sqrt(e)-n.getRadius();return i*i}}const r=$i(t);return dd[0]=$i(e.segment[0]),dd[1]=$i(e.segment[1]),function(t,e){return vi(t,mi(t,e))}(r,dd)}function yd(t,e,n){const i=e.geometry;if("Circle"===i.getType()&&1===e.index){return Ui(i.getClosestPoint($i(t)))}const r=$i(t);return dd[0]=$i(e.segment[0]),dd[1]=$i(e.segment[1]),Ui(mi(r,dd))}function vd(){const t=Is();return function(e,n){return t.Point}}const wd=class extends Yh{constructor(t){let e;if(super(t),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=t.condition?t.condition:sc,this.defaultDeleteCondition_=function(t){return function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&function(t){return t.type==bh.SINGLECLICK}(t)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Jh,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Du,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new ku({source:new ah({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:vd(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null,t.features?e=t.features:t.source&&(this.source_=t.source,e=new Fe(this.source_.getFeatures()),this.source_.addEventListener(Yu,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Ku,this.handleSourceRemove_.bind(this))),!e)throw new Error("The modify interaction requires features, a source or a layer");t.hitDetection&&(this.hitDetection_=t.hitDetection),this.features_=e,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(Me,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(Le,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=void 0===t.snapToPointer?!this.hitDetection_:t.snapToPointer}addFeature_(t){const e=t.getGeometry();if(e){const n=this.SEGMENT_WRITERS_[e.getType()];n&&n(t,e)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,n),t.addEventListener(ce,this.boundHandleFeatureChange_)}willModifyFeatures_(t,e){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Fe;const n=this.featuresBeingModified_.getArray();for(let t=0,i=e.length;t<i;++t){const i=e[t];for(let t=0,e=i.length;t<e;++t){const e=i[t].feature;e&&!n.includes(e)&&this.featuresBeingModified_.push(e)}}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new gd(pd,this.featuresBeingModified_,t))}}removeFeature_(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(ce,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(t){const e=this.rBush_,n=[];e.forEach((function(e){t===e.feature&&n.push(e)}));for(let i=n.length-1;i>=0;--i){const t=n[i];for(let e=this.dragSegments_.length-1;e>=0;--e)this.dragSegments_[e][0]===t&&this.dragSegments_.splice(e,1);e.remove(t)}}setActive(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(t)}setMap(t){this.overlay_.setMap(t),super.setMap(t)}getOverlay(){return this.overlay_}handleSourceAdd_(t){t.feature&&this.features_.push(t.feature)}handleSourceRemove_(t){t.feature&&this.features_.remove(t.feature)}handleFeatureAdd_(t){this.addFeature_(t.element)}handleFeatureChange_(t){if(!this.changingFeature_){const e=t.target;this.removeFeature_(e),this.addFeature_(e)}}handleFeatureRemove_(t){this.removeFeature_(t.element)}writePointGeometry_(t,e){const n=e.getCoordinates(),i={feature:t,geometry:e,segment:[n,n]};this.rBush_.insert(e.getExtent(),i)}writeMultiPointGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i],o={feature:t,geometry:e,depth:[i],index:i,segment:[r,r]};this.rBush_.insert(e.getExtent(),o)}}writeLineStringGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length-1;i<r;++i){const r=n.slice(i,i+2),o={feature:t,geometry:e,index:i,segment:r};this.rBush_.insert(sn(r),o)}}writeMultiLineStringGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let n=0,o=r.length-1;n<o;++n){const o=r.slice(n,n+2),s={feature:t,geometry:e,depth:[i],index:n,segment:o};this.rBush_.insert(sn(o),s)}}}writePolygonGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let n=0,o=r.length-1;n<o;++n){const o=r.slice(n,n+2),s={feature:t,geometry:e,depth:[i],index:n,segment:o};this.rBush_.insert(sn(o),s)}}}writeMultiPolygonGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let n=0,o=r.length;n<o;++n){const o=r[n];for(let r=0,s=o.length-1;r<s;++r){const s=o.slice(r,r+2),a={feature:t,geometry:e,depth:[n,i],index:r,segment:s};this.rBush_.insert(sn(s),a)}}}}writeCircleGeometry_(t,e){const n=e.getCenter(),i={feature:t,geometry:e,index:0,segment:[n,n]},r={feature:t,geometry:e,index:1,segment:[n,n]},o=[i,r];i.featureSegments=o,r.featureSegments=o,this.rBush_.insert(_n(n),i);let s=e;this.rBush_.insert(s.getExtent(),r)}writeGeometryCollectionGeometry_(t,e){const n=e.getGeometriesArray();for(let i=0;i<n.length;++i){const e=n[i];(0,this.SEGMENT_WRITERS_[e.getType()])(t,e)}}createOrUpdateVertexFeature_(t,e,n){let i=this.vertexFeature_;if(i){i.getGeometry().setCoordinates(t)}else i=new Be(new Tr(t)),this.vertexFeature_=i,this.overlay_.getSource().addFeature(i);return i.set("features",e),i.set("geometries",n),i}handleEvent(t){if(!t.originalEvent)return!0;let e;return this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=bh.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=!(t.type!=bh.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==bh.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(t)&&!e}handleDragEvent(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t,this.dragSegments_);const e=[t.coordinate[0]+this.delta_[0],t.coordinate[1]+this.delta_[1]],n=[],i=[];for(let r=0,o=this.dragSegments_.length;r<o;++r){const o=this.dragSegments_[r],s=o[0],a=s.feature;n.includes(a)||n.push(a);const l=s.geometry;i.includes(l)||i.push(l);const u=s.depth;let h;const c=s.segment,d=o[1];for(;e.length<l.getStride();)e.push(c[d][e.length]);switch(l.getType()){case"Point":h=e,c[0]=e,c[1]=e;break;case"MultiPoint":h=l.getCoordinates(),h[s.index]=e,c[0]=e,c[1]=e;break;case"LineString":h=l.getCoordinates(),h[s.index+d]=e,c[d]=e;break;case"MultiLineString":case"Polygon":h=l.getCoordinates(),h[u[0]][s.index+d]=e,c[d]=e;break;case"MultiPolygon":h=l.getCoordinates(),h[u[1]][u[0]][s.index+d]=e,c[d]=e;break;case"Circle":if(c[0]=e,c[1]=e,0===s.index)this.changingFeature_=!0,l.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,t.map.getView().getProjection();let n=wi($i(l.getCenter()),$i(e));l.setRadius(n),this.changingFeature_=!1}}h&&this.setGeometryCoordinates_(l,h)}this.createOrUpdateVertexFeature_(e,n,i)}handleDownEvent(t){if(!this.condition_(t))return!1;const e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(n){t.map.getView().getProjection();const i=[],r=n.getGeometry().getCoordinates(),o=sn([r]),s=this.rBush_.getInExtent(o),a={};s.sort(md);for(let n=0,l=s.length;n<l;++n){const o=s[n],l=o.segment;let u=Te(o.geometry);const h=o.depth;if(h&&(u+="-"+h.join("-")),a[u]||(a[u]=new Array(2)),"Circle"!==o.geometry.getType()||1!==o.index)if(!_i(l[0],r)||a[u][0])if(!_i(l[1],r)||a[u][1])Te(l)in this.vertexSegments_&&!a[u][0]&&!a[u][1]&&this.insertVertexCondition_(t)&&i.push(o);else{if(a[u][0]&&0===a[u][0].index){let t=o.geometry.getCoordinates();switch(o.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":t=t[h[1]];case"Polygon":if(o.index!==t[h[0]].length-2)continue}}this.dragSegments_.push([o,1]),a[u][1]=o}else this.dragSegments_.push([o,0]),a[u][0]=o;else{_i(yd(e,o),r)&&!a[u][0]&&(this.dragSegments_.push([o,0]),a[u][0]=o)}}i.length&&this.willModifyFeatures_(t,[i]);for(let t=i.length-1;t>=0;--t)this.insertVertex_(i[t],r)}return!!this.vertexFeature_}handleUpEvent(t){for(let e=this.dragSegments_.length-1;e>=0;--e){const t=this.dragSegments_[e][0],n=t.geometry;if("Circle"===n.getType()){const e=n.getCenter(),i=t.featureSegments[0],r=t.featureSegments[1];i.segment[0]=e,i.segment[1]=e,r.segment[0]=e,r.segment[1]=e,this.rBush_.update(_n(e),i);let o=n;this.rBush_.update(o.getExtent(),r)}else this.rBush_.update(sn(t.segment),t)}return this.featuresBeingModified_&&(this.dispatchEvent(new gd(fd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null),!1}handlePointerMove_(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}handlePointerAtPixel_(t,e,n){const i=n||e.getCoordinateFromPixel(t);e.getView().getProjection();const r=function(t,e){return _d(i,t)-_d(i,e)};let o,s;if(this.hitDetection_){const n="object"==typeof this.hitDetection_?t=>t===this.hitDetection_:void 0;e.forEachFeatureAtPixel(t,((t,e,n)=>{n&&"Point"===n.getType()&&(n=new Tr(Ui(n.getCoordinates())));const i=n||t.getGeometry();if(t instanceof Be&&this.features_.getArray().includes(t)){s=i;const e=t.getGeometry().getFlatCoordinates().slice(0,2);o=[{feature:t,geometry:s,segment:[e,e]}]}return!0}),{layerFilter:n})}if(!o){const t=Yi(an(qi(_n(i,cd)),e.getView().getResolution()*this.pixelTolerance_,cd));o=this.rBush_.getInExtent(t)}if(o&&o.length>0){const n=o.sort(r)[0],a=n.segment;let l=yd(i,n);const u=e.getPixelFromCoordinate(l);let h=wi(t,u);if(s||h<=this.pixelTolerance_){const t={};if(t[Te(a)]=!0,this.snapToPointer_||(this.delta_[0]=l[0]-i[0],this.delta_[1]=l[1]-i[1]),"Circle"===n.geometry.getType()&&1===n.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l,[n.feature],[n.geometry]);else{const i=e.getPixelFromCoordinate(a[0]),r=e.getPixelFromCoordinate(a[1]),s=vi(u,i),c=vi(u,r);h=Math.sqrt(Math.min(s,c)),this.snappedToVertex_=h<=this.pixelTolerance_,this.snappedToVertex_&&(l=s>c?a[1]:a[0]),this.createOrUpdateVertexFeature_(l,[n.feature],[n.geometry]);const d={};d[Te(n.geometry)]=!0;for(let e=1,n=o.length;e<n;++e){const n=o[e].segment;if(!(_i(a[0],n[0])&&_i(a[1],n[1])||_i(a[0],n[1])&&_i(a[1],n[0])))break;{const i=Te(o[e].geometry);i in d||(d[i]=!0,t[Te(n)]=!0)}}}return void(this.vertexSegments_=t)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(t,e){const n=t.segment,i=t.feature,r=t.geometry,o=t.depth,s=t.index;let a;for(;e.length<r.getStride();)e.push(0);switch(r.getType()){case"MultiLineString":case"Polygon":a=r.getCoordinates(),a[o[0]].splice(s+1,0,e);break;case"MultiPolygon":a=r.getCoordinates(),a[o[1]][o[0]].splice(s+1,0,e);break;case"LineString":a=r.getCoordinates(),a.splice(s+1,0,e);break;default:return}this.setGeometryCoordinates_(r,a);const l=this.rBush_;l.remove(t),this.updateSegmentIndices_(r,s,o,1);const u={segment:[n[0],e],feature:i,geometry:r,depth:o,index:s};l.insert(sn(u.segment),u),this.dragSegments_.push([u,1]);const h={segment:[e,n[1]],feature:i,geometry:r,depth:o,index:s+1};l.insert(sn(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=bh.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_);const e=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new gd(fd,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,e}return!1}removeVertex_(){const t=this.dragSegments_,e={};let n,i,r,o,s,a,l,u,h,c,d,p=!1;for(s=t.length-1;s>=0;--s)r=t[s],c=r[0],d=Te(c.feature),c.depth&&(d+="-"+c.depth.join("-")),d in e||(e[d]={}),0===r[1]?(e[d].right=c,e[d].index=c.index):1==r[1]&&(e[d].left=c,e[d].index=c.index+1);for(d in e){switch(h=e[d].right,l=e[d].left,a=e[d].index,u=a-1,c=void 0!==l?l:h,u<0&&(u=0),o=c.geometry,i=o.getCoordinates(),n=i,p=!1,o.getType()){case"MultiLineString":i[c.depth[0]].length>2&&(i[c.depth[0]].splice(a,1),p=!0);break;case"LineString":i.length>2&&(i.splice(a,1),p=!0);break;case"MultiPolygon":n=n[c.depth[1]];case"Polygon":n=n[c.depth[0]],n.length>4&&(a==n.length-1&&(a=0),n.splice(a,1),p=!0,0===a&&(n.pop(),n.push(n[0]),u=n.length-1))}if(p){this.setGeometryCoordinates_(o,i);const e=[];if(void 0!==l&&(this.rBush_.remove(l),e.push(l.segment[0])),void 0!==h&&(this.rBush_.remove(h),e.push(h.segment[1])),void 0!==l&&void 0!==h){const t={depth:c.depth,feature:c.feature,geometry:c.geometry,index:u,segment:e};this.rBush_.insert(sn(t.segment),t)}this.updateSegmentIndices_(o,a,c.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.length=0}}return p}setGeometryCoordinates_(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}updateSegmentIndices_(t,e,n,i){this.rBush_.forEachInExtent(t.getExtent(),(function(r){r.geometry===t&&(void 0===n||void 0===r.depth||ne(r.depth,n))&&r.index>e&&(r.index+=i)}))}},xd="snap";class bd extends qt{constructor(t,e){super(t),this.vertex=e.vertex,this.vertexPixel=e.vertexPixel,this.feature=e.feature,this.segment=e.segment}}function Cd(t){return t.feature?t.feature:t.element?t.element:null}const Sd=[];const Ed=class extends Yh{constructor(t){const e=t=t||{};e.handleDownEvent||(e.handleDownEvent=ie),e.stopDown||(e.stopDown=re),super(e),this.on,this.once,this.un,this.source_=t.source?t.source:null,this.vertex_=void 0===t.vertex||t.vertex,this.edge_=void 0===t.edge||t.edge,this.features_=t.features?t.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.rBush_=new Du,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(t,e){e=void 0===e||e;const n=Te(t),i=t.getGeometry();if(i){const e=this.GEOMETRY_SEGMENTERS_[i.getType()];if(e){this.indexedFeaturesExtents_[n]=i.getExtent([1/0,1/0,-1/0,-1/0]);const r=[];if(e(r,i),1===r.length)this.rBush_.insert(sn(r[0]),{feature:t,segment:r[0]});else if(r.length>1){const e=r.map((t=>sn(t))),n=r.map((e=>({feature:t,segment:e})));this.rBush_.load(e,n)}}}e&&(this.featureChangeListenerKeys_[n]=xe(t,ce,this.handleFeatureChange_,this))}getFeatures_(){let t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t}handleEvent(t){const e=this.snapTo(t.pixel,t.coordinate,t.map);return e&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel,this.dispatchEvent(new bd(xd,{vertex:t.coordinate,vertexPixel:t.pixel,feature:e.feature,segment:e.segment}))),super.handleEvent(t)}handleFeatureAdd_(t){const e=Cd(t);e&&this.addFeature(e)}handleFeatureRemove_(t){const e=Cd(t);e&&this.removeFeature(e)}handleFeatureChange_(t){const e=t.target;if(this.handlingDownUpSequence){const t=Te(e);t in this.pendingFeatures_||(this.pendingFeatures_[t]=e)}else this.updateFeature_(e)}handleUpEvent(t){const e=Object.values(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(t,e){const n=void 0===e||e,i=Te(t),r=this.indexedFeaturesExtents_[i];if(r){const e=this.rBush_,n=[];e.forEachInExtent(r,(function(e){t===e.feature&&n.push(e)}));for(let t=n.length-1;t>=0;--t)e.remove(n[t])}n&&(Ce(this.featureChangeListenerKeys_[i]),delete this.featureChangeListenerKeys_[i])}setMap(t){const e=this.getMap(),n=this.featuresListenerKeys_,i=this.getFeatures_();e&&(n.forEach(Ce),n.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(Ce),this.featureChangeListenerKeys_={}),super.setMap(t),t&&(this.features_?n.push(xe(this.features_,Me,this.handleFeatureAdd_,this),xe(this.features_,Le,this.handleFeatureRemove_,this)):this.source_&&n.push(xe(this.source_,Yu,this.handleFeatureAdd_,this),xe(this.source_,Ku,this.handleFeatureRemove_,this)),i.forEach((t=>this.addFeature(t))))}snapTo(t,e,n){n.getView().getProjection();const i=$i(e),r=Yi(an(sn([i]),n.getView().getResolution()*this.pixelTolerance_)),o=this.rBush_.getInExtent(r),s=o.length;if(0===s)return null;let a,l,u=1/0,h=null;const c=this.pixelTolerance_*this.pixelTolerance_,d=()=>{if(a){const e=n.getPixelFromCoordinate(a);if(vi(t,e)<=c)return{vertex:a,vertexPixel:[Math.round(e[0]),Math.round(e[1])],feature:l,segment:h}}return null};if(this.vertex_){for(let e=0;e<s;++e){const t=o[e];"Circle"!==t.feature.getGeometry().getType()&&t.segment.forEach((e=>{const n=$i(e),r=vi(i,n);r<u&&(a=e,u=r,l=t.feature)}))}const t=d();if(t)return t}if(this.edge_){for(let e=0;e<s;++e){let t=null;const n=o[e];if("Circle"===n.feature.getGeometry().getType()){let e=n.feature.getGeometry();t=gi(i,e)}else{const[e,r]=n.segment;r&&(Sd[0]=$i(e),Sd[1]=$i(r),t=mi(i,Sd))}if(t){const e=vi(i,t);e<u&&(a=Ui(t),h="Circle"===n.feature.getGeometry().getType()?null:n.segment,u=e)}}const t=d();if(t)return t}return null}updateFeature_(t){this.removeFeature(t,!1),this.addFeature(t,!1)}segmentCircleGeometry_(t,e){this.getMap().getView().getProjection();const n=qr(e).getCoordinates()[0];for(let i=0,r=n.length-1;i<r;++i)t.push(n.slice(i,i+2))}segmentGeometryCollectionGeometry_(t,e){const n=e.getGeometriesArray();for(let i=0;i<n.length;++i){const e=this.GEOMETRY_SEGMENTERS_[n[i].getType()];e&&e(t,n[i])}}segmentLineStringGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length-1;i<r;++i)t.push(n.slice(i,i+2))}segmentMultiLineStringGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const e=n[i];for(let n=0,i=e.length-1;n<i;++n)t.push(e.slice(n,n+2))}}segmentMultiPointGeometry_(t,e){e.getCoordinates().forEach((e=>{t.push([e])}))}segmentMultiPolygonGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const e=n[i];for(let n=0,i=e.length;n<i;++n){const i=e[n];for(let e=0,n=i.length-1;e<n;++e)t.push(i.slice(e,e+2))}}}segmentPointGeometry_(t,e){t.push([e.getCoordinates()])}segmentPolygonGeometry_(t,e){const n=e.getCoordinates();for(let i=0,r=n.length;i<r;++i){const e=n[i];for(let n=0,i=e.length-1;n<i;++n)t.push(e.slice(n,n+2))}}},Id="translatestart",Pd="translating",Td="translateend";class kd extends qt{constructor(t,e,n,i,r){super(t),this.features=e,this.coordinate=n,this.startCoordinate=i,this.mapBrowserEvent=r}}const Dd=class extends Yh{constructor(t){let e;if(super(t=t||{}),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=void 0!==t.features?t.features:null,t.layers&&!this.features_)if("function"==typeof t.layers)e=t.layers;else{const n=t.layers;e=function(t){return n.includes(t)}}else e=ie;this.layerFilter_=e,this.filter_=t.filter&&!this.features_?t.filter:ie,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.condition_=t.condition?t.condition:Jh,this.lastFeature_=null,this.addChangeListener(Hh,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new Fe([this.lastFeature_]);return this.dispatchEvent(new kd(Id,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new Fe([this.lastFeature_]);return this.dispatchEvent(new kd(Td,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate;t.map.getView().getProjection();const n=$i(e),i=$i(this.lastCoordinate_),r=n[0]-i[0],o=n[1]-i[1],s=this.features_||new Fe([this.lastFeature_]);s.forEach((function(t){const e=t.getGeometry();e.translate(r,o),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new kd(Pd,s,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,((t,e)=>{if(t instanceof Be&&this.filter_(t,e)&&(!this.features_||this.features_.getArray().includes(t)))return t}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const n=this.getActive();if((!e||!n)&&(e=e||t,e)){e.getViewport().classList.remove("ol-grab","ol-grabbing")}}};class Md{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Be,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?Ai(e.dataProjection):this.readProjection(t);e.extent&&n&&"tile-pixels"===n.getUnits()&&(n=Ai(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return Ie()}readFeature(t,e){return Ie()}readFeatures(t,e){return Ie()}readGeometry(t,e){return Ie()}readProjection(t){return Ie()}writeFeature(t,e){return Ie()}writeFeatures(t,e){return Ie()}writeGeometry(t,e){return Ie()}}function Ld(t,e,n){const i=n?Ai(n.featureProjection):null,r=n?Ai(n.dataProjection):null;let o=t;if(i&&r&&!Ni(i,r)){e&&(o=t.clone());const n=e?i:r,s=e?r:i;"tile-pixels"===n.getUnits()?o.transform(n,s):o.applyTransform(Hi(n,s))}if(e&&n&&void 0!==n.decimals){const e=Math.pow(10,n.decimals),i=function(t){for(let n=0,i=t.length;n<i;++n)t[n]=Math.round(t[n]*e)/e;return t};o===t&&(o=t.clone()),o.applyTransform(i)}return o}const Rd={Point:Tr,LineString:lo,Polygon:Ur,MultiPoint:ju,MultiLineString:zu,MultiPolygon:Vu};function Od(t,e){var n;const i=t.geometry;if(!i)return[];if(Array.isArray(i))return i.map((e=>Od({...t,geometry:e}))).flat();const r="MultiPolygon"===i.type?"Polygon":i.type;if("GeometryCollection"===r||"Circle"===r)throw new Error("Unsupported geometry type: "+r);const o=i.layout.length;return Ld(new Xu(r,"Polygon"===r?function(t,e,n){return Array.isArray(e[0])?(Nr(t,0,e,n)||Hr(t=t.slice(),0,e,n),t):(Gr(t,0,e,n)||Vr(t=t.slice(),0,e,n),t)}(i.flatCoordinates,i.ends,o):i.flatCoordinates,null==(n=i.ends)?void 0:n.flat(),o,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function Fd(t,e){if(!t)return null;if(Array.isArray(t)){const n=t.map((t=>Fd(t,e)));return new Fu(n)}return Ld(new(0,Rd[t.type])(t.flatCoordinates,t.layout,t.ends),!1,e)}function Ad(t){if("string"==typeof t){const e=JSON.parse(t);return e||null}return null!==t?t:null}const zd=class extends Md{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Ad(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Ad(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return Ie()}readFeaturesFromObject(t,e){return Ie()}readGeometry(t,e){return this.readGeometryFromObject(Ad(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return Ie()}readProjection(t){return this.readProjectionFromObject(Ad(t))}readProjectionFromObject(t){return Ie()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return Ie()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return Ie()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return Ie()}};function Bd(t,e){if(!t)return null;let n;switch(t.type){case"Point":n=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:ir(e.length)}}(t);break;case"LineString":n=function(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:ir(e[0].length)}}(t);break;case"Polygon":n=function(t){const e=t.coordinates,n=[],i=e[0][0].length,r=pr(n,0,e,i);return{type:"Polygon",flatCoordinates:n,ends:r,layout:ir(i)}}(t);break;case"MultiPoint":n=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:ir(e[0].length)}}(t);break;case"MultiLineString":n=function(t){const e=t.coordinates,n=e[0][0].length,i=[],r=pr(i,0,e,n);return{type:"MultiLineString",flatCoordinates:i,ends:r,layout:ir(n)}}(t);break;case"MultiPolygon":n=function(t){const e=t.coordinates,n=[],i=e[0][0][0].length,r=fr(n,0,e,i);return{type:"MultiPolygon",flatCoordinates:n,ends:r,layout:ir(i)}}(t);break;case"GeometryCollection":n=function(t,e){const n=t.geometries.map((function(t){return Bd(t)}));return n}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function jd(t,e){const n=(t=Ld(t,!0,e)).getType();let i;switch(n){case"Point":i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":i=function(t,e){let n;e&&(n=e.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"MultiPoint":i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":i=function(t,e){let n;e&&(n=e.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"GeometryCollection":i=function(t,e){e=Object.assign({},e),delete e.featureProjection;const n=t.getGeometriesArray().map((function(t){return jd(t,e)}));return{type:"GeometryCollection",geometries:n}}(t,e);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}const Gd=class extends zd{constructor(t){t=t||{},super(),this.dataProjection=Ai(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Ai(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;n="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const i=Bd(n.geometry);if(this.featureClass===Xu)return Od({geometry:i,id:n.id,properties:n.properties},e);const r=new Be;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&r.setGeometryName(n.geometry_name),r.setGeometry(Fd(i,e)),"id"in n&&r.setId(n.id),n.properties&&r.setProperties(n.properties,!0),r}readFeaturesFromObject(t,e){let n=null;if("FeatureCollection"===t.type){n=[];const i=t.features;for(let t=0,r=i.length;t<r;++t){const r=this.readFeatureFromObject(i[t],e);r&&n.push(r)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return function(t,e){const n=Bd(t);return Fd(n,e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if("name"==e.type)n=Ai(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");n=Ai("EPSG:"+e.properties.code)}else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},i=t.getId();if(void 0!==i&&(n.id=i),!t.hasProperties())return n;const r=t.getProperties(),o=t.getGeometry();return o&&(n.geometry=jd(o,e),delete r[t.getGeometryName()]),ue(r)||(n.properties=r),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let i=0,r=t.length;i<r;++i)n.push(this.writeFeatureObject(t[i],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return jd(t,this.adaptOptions(e))}};var Nd={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,n,i,r){var o,s,a=8*r-i-1,l=(1<<a)-1,u=l>>1,h=-7,c=n?r-1:0,d=n?-1:1,p=t[e+c];for(c+=d,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[e+c],c+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=i;h>0;s=256*s+t[e+c],c+=d,h-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=u}return(p?-1:1)*s*Math.pow(2,o-i)},write:function(t,e,n,i,r,o){var s,a,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*l-1)*Math.pow(2,r),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;t[n+p]=255&s,p+=f,s/=256,u-=8);t[n+p-f]|=128*g}},Vd=Wd,Hd=Nd;function Wd(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Wd.Varint=0,Wd.Fixed64=1,Wd.Bytes=2,Wd.Fixed32=5;var Xd=4294967296,Ud=1/Xd,$d="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Yd(t){return t.type===Wd.Bytes?t.readVarint()+t.pos:t.pos+1}function qd(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Zd(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function Kd(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function Jd(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function Qd(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function tp(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function ep(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function np(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function ip(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function rp(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function op(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function sp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function ap(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function lp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Wd.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,o=this.pos;this.type=7&i,t(r,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=sp(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=lp(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=sp(this.buf,this.pos)+sp(this.buf,this.pos+4)*Xd;return this.pos+=8,t},readSFixed64:function(){var t=sp(this.buf,this.pos)+lp(this.buf,this.pos+4)*Xd;return this.pos+=8,t},readFloat:function(){var t=Hd.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Hd.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,o=n.buf;if(r=o[n.pos++],i=(112&r)>>4,r<128)return qd(t,i,e);if(r=o[n.pos++],i|=(127&r)<<3,r<128)return qd(t,i,e);if(r=o[n.pos++],i|=(127&r)<<10,r<128)return qd(t,i,e);if(r=o[n.pos++],i|=(127&r)<<17,r<128)return qd(t,i,e);if(r=o[n.pos++],i|=(127&r)<<24,r<128)return qd(t,i,e);if(r=o[n.pos++],i|=(1&r)<<31,r<128)return qd(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&$d?function(t,e,n){return $d.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var i="",r=e;for(;r<n;){var o,s,a,l=t[r],u=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h>n)break;1===h?l<128&&(u=l):2===h?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===h?(o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&((u=(15&l)<<12|(63&o)<<6|63&s)<=2047||u>=55296&&u<=57343)&&(u=null)):4===h&&(o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,h=1):u>65535&&(u-=65536,i+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),i+=String.fromCharCode(u),r+=h}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Wd.Bytes)return t.push(this.readVarint(e));var n=Yd(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Wd.Bytes)return t.push(this.readSVarint());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Wd.Bytes)return t.push(this.readBoolean());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Wd.Bytes)return t.push(this.readFloat());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Wd.Bytes)return t.push(this.readDouble());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Wd.Bytes)return t.push(this.readFixed32());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Wd.Bytes)return t.push(this.readSFixed32());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Wd.Bytes)return t.push(this.readFixed64());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Wd.Bytes)return t.push(this.readSFixed64());var e=Yd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Wd.Varint)for(;this.buf[this.pos++]>127;);else if(e===Wd.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Wd.Fixed32)this.pos+=4;else{if(e!==Wd.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),ap(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),ap(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),ap(this.buf,-1&t,this.pos),ap(this.buf,Math.floor(t*Ud),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),ap(this.buf,-1&t,this.pos),ap(this.buf,Math.floor(t*Ud),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,o=0;o<e.length;o++){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){i>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Zd(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Hd.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Hd.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&Zd(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,Wd.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Kd,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Jd,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ep,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Qd,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,tp,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,np,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,ip,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,rp,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,op,e)},writeBytesField:function(t,e){this.writeTag(t,Wd.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Wd.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Wd.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Wd.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Wd.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Wd.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Wd.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Wd.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Wd.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Wd.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};const up=T(Vd);function hp(t,e,n){if(3===t){const t={keys:[],values:[],features:[]},i=n.readVarint()+n.pos;n.readFields(cp,t,i),t.length=t.features.length,t.length&&(e[t.name]=t)}}function cp(t,e,n){if(15===t)e.version=n.readVarint();else if(1===t)e.name=n.readString();else if(5===t)e.extent=n.readVarint();else if(2===t)e.features.push(n.pos);else if(3===t)e.keys.push(n.readString());else if(4===t){let i=null;const r=n.readVarint()+n.pos;for(;n.pos<r;)i=1===(t=n.readVarint()>>3)?n.readString():2===t?n.readFloat():3===t?n.readDouble():4===t?n.readVarint64():5===t?n.readVarint():6===t?n.readSVarint():7===t?n.readBoolean():null;e.values.push(i)}}function dp(t,e,n){if(1==t)e.id=n.readVarint();else if(2==t){const t=n.readVarint()+n.pos;for(;n.pos<t;){const t=e.layer.keys[n.readVarint()],i=e.layer.values[n.readVarint()];e.properties[t]=i}}else 3==t?e.type=n.readVarint():4==t&&(e.geometry=n.pos)}function pp(t,e,n){t.pos=e.features[n];const i=t.readVarint()+t.pos,r={layer:e,type:0,properties:{}};return t.readFields(dp,r,i),r}const fp=class extends Md{constructor(t){super(),t=t||{},this.dataProjection=new Vn({code:"",units:"tile-pixels"}),this.featureClass_=t.featureClass?t.featureClass:Xu,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,n,i){t.pos=e.geometry;const r=t.readVarint()+t.pos;let o=1,s=0,a=0,l=0,u=0,h=0;for(;t.pos<r;){if(!s){const e=t.readVarint();o=7&e,s=e>>3}if(s--,1===o||2===o)a+=t.readSVarint(),l+=t.readSVarint(),1===o&&u>h&&(i.push(u),h=u),n.push(a,l),u+=2;else{if(7!==o)throw new Error("Invalid command found in the PBF");u>h&&(n.push(n[h],n[h+1]),u+=2)}}u>h&&(i.push(u),h=u)}createFeature_(t,e,n){const i=e.type;if(0===i)return null;let r;const o=e.properties;let s;this.idProperty_?(s=o[this.idProperty_],delete o[this.idProperty_]):s=e.id,o[this.layerName_]=e.layer.name;const a=[],l=[];this.readRawGeometry_(t,e,a,l);const u=function(t,e){let n;1===t?n=1===e?"Point":"MultiPoint":2===t?n=1===e?"LineString":"MultiLineString":3===t&&(n="Polygon");return n}(i,l.length);if(this.featureClass_===Xu)r=new this.featureClass_(u,a,l,2,o,s),r.transform(n.dataProjection);else{let t;if("Polygon"==u){const e=Wr(a,l);t=e.length>1?new Vu(a,"XY",e):new Ur(a,"XY",l)}else t="Point"===u?new Tr(a,"XY"):"LineString"===u?new lo(a,"XY"):"MultiPoint"===u?new ju(a,"XY"):"MultiLineString"===u?new zu(a,"XY",l):null;r=new(0,this.featureClass_),this.geometryName_&&r.setGeometryName(this.geometryName_);const e=Ld(t,!1,n);r.setGeometry(e),void 0!==s&&r.setId(s),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(t,e){const n=this.layers_,i=Ai((e=this.adaptOptions(e)).dataProjection);i.setWorldExtent(e.extent),e.dataProjection=i;const r=new up(t),o=r.readFields(hp,{}),s=[];for(const a in o){if(n&&!n.includes(a))continue;const t=o[a],l=t?[0,0,t.extent,t.extent]:null;i.setExtent(l);for(let n=0,i=t.length;n<i;++n){const i=pp(r,t,n),o=this.createFeature_(r,i,e);null!==o&&s.push(o)}}return s}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}};var gp={exports:{}};!function(t){function e(){var t=1<=arguments.length?[].slice.call(arguments,0):[],e=t.shift(),n=t.shift();Error.apply(this,t),this.message=this.message||"Invalid Geometry: item: "+JSON.stringify(e)+", params: "+JSON.stringify(n)}t.version="0.5.0",t.defaults={doThrows:{invalidGeometry:!1}},e.prototype=Error,t.errors={InvalidGeometryError:e},t.isGeometryValid=function(t){return!(!t||!Object.keys(t).length)&&!!t.type&&!!t.coordinates&&Array.isArray(t.coordinates)&&!!t.coordinates.length},t.parse=function(t,e,s){var a,l,u=function(t,e){var n=t||{};for(var i in e)e.hasOwnProperty(i)&&!n[i]&&(n[i]=e[i]);return n}(e,this.defaults);if(i.length=0,function(t){for(var e in t.geom={},t)t.hasOwnProperty(e)&&-1!==n.indexOf(e)&&(t.geom[e]=t[e],delete t[e]);!function(t){for(var e in t)t.hasOwnProperty(e)&&("string"==typeof t[e]?i.push(t[e]):"object"==typeof t[e]&&(i.push(t[e][0]),i.push(t[e][1])));if(0===i.length)throw new Error("No geometry attributes specified")}(t.geom)}(u),l=function(t){var e;return t.exclude||t.include?t.include?e=function(e){t.include.forEach((function(t){e[t]=this[t]}),this)}:t.exclude&&(e=function(e){for(var n in this)this.hasOwnProperty(n)&&-1===i.indexOf(n)&&-1===t.exclude.indexOf(n)&&(e[n]=this[n])}):e=function(t){for(var e in this)this.hasOwnProperty(e)&&-1===i.indexOf(e)&&(t[e]=this[e])},function(){var n={};return e.call(this,n),t.extra&&function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}(n,t.extra),n}}(u),Array.isArray(t)?(a={type:"FeatureCollection",features:[]},t.forEach((function(t){a.features.push(o({item:t,params:u,propFunc:l}))})),r(a,u)):r(a=o({item:t,params:u,propFunc:l}),u),!s||"function"!=typeof s)return a;s(a)};var n=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeoJSON"],i=[];function r(t,e){if(e.crs&&function(t){if("name"===t.type){if(t.properties&&t.properties.name)return!0;throw new Error('Invalid CRS. Properties must contain "name" key')}if("link"===t.type){if(t.properties&&t.properties.href&&t.properties.type)return!0;throw new Error('Invalid CRS. Properties must contain "href" and "type" key')}throw new Error('Invald CRS. Type attribute must be "name" or "link"')}(e.crs)&&(e.isPostgres?t.geometry.crs=e.crs:t.crs=e.crs),e.bbox&&(t.bbox=e.bbox),e.extraGlobal)for(var n in t.properties={},e.extraGlobal)t.properties[n]=e.extraGlobal[n]}function o(t){var e=t.item,n=t.params,i=t.propFunc,r={type:"Feature"};return r.geometry=a(e,n),r.properties=i.call(e),r}function s(t){return/^.+\..+$/.test(t)}function a(n,i){var r={};for(var o in i.geom){var l=i.geom[o];if("string"==typeof l&&n.hasOwnProperty(l))"GeoJSON"===o?r=n[l]:(r.type=o,r.coordinates=n[l]);else if("object"!=typeof l||Array.isArray(l)){if(Array.isArray(l)&&n.hasOwnProperty(l[0])&&n.hasOwnProperty(l[1]))r.type=o,r.coordinates=[Number(n[l[1]]),Number(n[l[0]])];else if(Array.isArray(l)&&s(l[0])&&s(l[1])){for(var u=[],h=0;h<l.length;h++){for(var c=l[h].split("."),d=n,p=0;p<c.length;p++){if(!d.hasOwnProperty(c[p]))return!1;d=d[c[p]]}u[h]=d}r.type=o,r.coordinates=[Number(u[1]),Number(u[0])]}}else{var f=Object.keys(l).map((function(t){var e=l[t];return a(n[t],{geom:{Point:e}})}));r.type=o,r.coordinates=[].concat(f.map((function(t){return t.coordinates})))}}if(i.doThrows&&i.doThrows.invalidGeometry&&!t.isGeometryValid(r))throw new e(n,i);return r}}(gp.exports);const mp=T(gp.exports);function _p(t,e){let n=t;const i=e;if(n<-180||n>180){const t=Math.abs(n)+180,e=Math.floor(t/360);n<0?n+=360*e:n>0&&(n-=360*e)}return{longitude:n,latitude:i}}function yp(t){let e=180,n=-180,i=85,r=-85;if(t.length){const o=t[0];if(o.length)for(let t=0;t<o.length;t++){const s=o[t];s.length&&2==s.length&&(s[0]<e&&(e=s[0]),s[0]>=n&&(n=s[0]),s[1]<i&&(i=s[1]),s[1]>=r&&(r=s[1]))}}return[e,i,n,r]}function vp(t){if(t.length){let e=[];const n=t[0];return n.length&&n.length>=5&&(n[1][0]-n[0][0]>0?n[2][1]-n[1][1]>0?n[2][0]-n[3][0]>0&&(e=[[...n[0]],[...n[1]],[...n[2]],[...n[3]],[...n[0]]]):n[2][0]-n[3][0]>0&&(e=[[...n[3]],[...n[2]],[...n[1]],[...n[0]],[...n[3]]]):n[1][0]-n[0][0]<0?n[2][1]-n[1][1]>0?n[3][0]-n[2][0]>0&&(e=[[...n[1]],[...n[0]],[...n[3]],[...n[2]],[...n[1]]]):n[3][0]-n[2][0]>0&&(e=[[...n[2]],[...n[3]],[...n[0]],[...n[1]],[...n[2]]]):n[1][1]-n[0][1]>0?n[2][0]-n[1][0]>0?n[2][1]-n[3][1]>0&&(e=[[...n[0]],[...n[3]],[...n[2]],[...n[1]],[...n[0]]]):n[2][1]-n[3][1]>0&&(e=[[...n[3]],[...n[0]],[...n[1]],[...n[2]],[...n[3]]]):n[2][0]-n[1][0]>0?n[3][1]-n[2][1]>0&&(e=[[...n[1]],[...n[2]],[...n[3]],[...n[0]],[...n[1]]]):n[3][1]-n[2][1]>0&&(e=[[...n[2]],[...n[1]],[...n[0]],[...n[3]],[...n[2]]])),5!==e.length?[]:[e]}}function wp(t){const e=+t[0],n=+t[1],i=+t[2],r=+t[3];return[[[e,n],[i,n],[i,r],[e,r],[e,n]]]}function xp(t,e={}){const n={longitude:t[0],latitude:t[1],...e};return mp.parse(n,{Point:["latitude","longitude"]})}function bp(t,e={}){const n={multiPoint:t,...e};return mp.parse(n,{MultiPoint:"multiPoint"})}function Cp(t,e={}){const n={polygon:t,...e};return mp.parse(n,{Polygon:"polygon"})}function Sp(t,e={}){const n={multiPolygon:t,...e};return mp.parse(n,{MultiPolygon:"multiPolygon"})}function Ep(t,e={}){const n={line:t,...e};return mp.parse(n,{LineString:"line"})}function Ip(t,e={}){const n={multiLineString:t,...e};return mp.parse(n,{MultiLineString:"multiLineString"})}function Pp(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function Tp(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return Pp({type:"Polygon",coordinates:t},e,n)}function kp(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function Dp(t,e){var n,i,r,o,s,a,l,u,h,c,d=0,p="FeatureCollection"===t.type,f="Feature"===t.type,g=p?t.features.length:1;for(n=0;n<g;n++){for(a=p?t.features[n].geometry:f?t.geometry:t,u=p?t.features[n].properties:f?t.properties:{},h=p?t.features[n].bbox:f?t.bbox:void 0,c=p?t.features[n].id:f?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function Mp(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i,r=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),o="Feature"===(i=e).type?i.geometry:i,s=o.type,a=e.bbox,l=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===s&&(l=[l]);for(var u=!1,h=0;h<l.length&&!u;h++)if(Lp(r,l[h][0],n.ignoreBoundary)){for(var c=!1,d=1;d<l[h].length&&!c;)Lp(r,l[h][d],!n.ignoreBoundary)&&(c=!0),d++;c||(u=!0)}return u}function Lp(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(i=!i)}return i}var Rp=6378137;function Op(t){return function(t,e,n){var i=n;return Dp(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i}(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return Fp(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=Fp(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function Fp(t){var e=0;if(t&&t.length>0){e+=Math.abs(Ap(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(Ap(t[n]))}return e}function Ap(t){var e,n,i,r,o,s,a=0,l=t.length;if(l>2){for(s=0;s<l;s++)s===l-2?(i=l-2,r=l-1,o=0):s===l-1?(i=l-1,r=0,o=1):(i=s,r=s+1,o=s+2),e=t[i],n=t[r],a+=(zp(t[o][0])-zp(e[0]))*Math.sin(zp(n[1]));a=a*Rp*Rp/2}return a}function zp(t){return t*Math.PI/180}var Bp={exports:{}},jp={exports:{}};jp.exports=function(){function t(t,n,r,o,s){e(t,n,r||0,o||t.length-1,s||i)}function e(t,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=i-r+1,u=Math.log(a),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(a-h)/a)*(l-a/2<0?-1:1);e(t,i,Math.max(r,Math.floor(i-l*h/a+c)),Math.min(o,Math.floor(i+(a-l)*h/a+c)),s)}var d=t[i],p=r,f=o;for(n(t,r,i),s(t[o],d)>0&&n(t,r,o);p<f;){for(n(t,p,f),p++,f--;s(t[p],d)<0;)p++;for(;s(t[f],d)>0;)f--}0===s(t[r],d)?n(t,r,f):n(t,++f,o),f<=i&&(r=f+1),i<=f&&(o=f-1)}}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}return t}();var Gp=jp.exports;Bp.exports=Vp,Bp.exports.default=Vp;var Np=Gp;function Vp(t,e){if(!(this instanceof Vp))return new Vp(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Hp(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function Wp(t,e){Xp(t,0,t.children.length,e,t)}function Xp(t,e,n,i,r){r||(r=Qp(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],Up(r,t.leaf?i(o):o);return r}function Up(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function $p(t,e){return t.minX-e.minX}function Yp(t,e){return t.minY-e.minY}function qp(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Zp(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Kp(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Jp(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Qp(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function tf(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Np(t,o,e,n,r),s.push(e,o,o,n))}Vp.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Jp(t,e))return n;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],Jp(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):Kp(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Jp(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],Jp(t,s=e.leaf?n(o):o)){if(e.leaf||Kp(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Qp([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf&&-1!==(r=Hp(t,s.children,e)))return s.children.splice(r,1),l.push(s),this._condense(l),this;o||s.leaf||!Kp(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:$p,compareMinY:Yp,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return Wp(r=Qp(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=Qp([])).leaf=!1,r.height=i;var a,l,u,h,c=Math.ceil(o/s),d=c*Math.ceil(Math.sqrt(s));for(tf(t,e,n,d,this.compareMinX),a=e;a<=n;a+=d)for(tf(t,a,u=Math.min(a+d-1,n),c,this.compareMinY),l=a;l<=u;l+=c)h=Math.min(l+c-1,u),r.children.push(this._build(t,l,h,i-1));return Wp(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,l,u,h,c,d,p;i.push(e),!e.leaf&&i.length-1!==n;){for(h=c=1/0,r=0,o=e.children.length;r<o;r++)l=qp(s=e.children[r]),d=t,p=s,(u=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-l)<c?(c=u,h=l<h?l:h,a=s):u===c&&l<h&&(h=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Up(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=Qp(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,Wp(n,this.toBBox),Wp(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=Qp([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Wp(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,l,u,h,c,d,p,f,g,m;for(l=u=1/0,i=e;i<=n-e;i++)r=Xp(t,0,i,this.toBBox),o=Xp(t,i,n,this.toBBox),c=r,d=o,p=void 0,f=void 0,g=void 0,m=void 0,p=Math.max(c.minX,d.minX),f=Math.max(c.minY,d.minY),g=Math.min(c.maxX,d.maxX),m=Math.min(c.maxY,d.maxY),s=Math.max(0,g-p)*Math.max(0,m-f),a=qp(r)+qp(o),s<l?(l=s,h=i,u=a<u?a:u):s===l&&a<u&&(u=a,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:$p,r=t.leaf?this.compareMinY:Yp;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=Xp(t,0,e,s),l=Xp(t,n-e,n,s),u=Zp(a)+Zp(l);for(r=e;r<n-e;r++)o=t.children[r],Up(a,t.leaf?s(o):o),u+=Zp(a);for(r=n-e-1;r>=e;r--)o=t.children[r],Up(l,t.leaf?s(o):o),u+=Zp(l);return u},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)Up(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Wp(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};const ef=T(Bp.exports);function nf(t,e,n){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var i=t.geometry.coordinates,r=[],o={};if(n){for(var s=[],a=0;a<i.length;a++)for(var l=0;l<i[a].length-1;l++)s.push(g(a,l));var u=ef();u.load(s)}for(var h=0;h<i.length;h++)for(var c=0;c<i[h].length-1;c++){if(n)u.search(g(h,c)).forEach((function(t){var e=t.ring,n=t.edge;f(h,c,e,n)}));else for(var d=0;d<i.length;d++)for(var p=0;p<i[d].length-1;p++)f(h,c,d,p)}return e||(r={type:"Feature",geometry:{type:"MultiPoint",coordinates:r}}),r;function f(t,n,s,a){var l,u,h=i[t][n],c=i[t][n+1],d=i[s][a],p=i[s][a+1],f=function(t,e,n,i){if(rf(t,n)||rf(t,i)||rf(e,n)||rf(i,n))return null;var r=t[0],o=t[1],s=e[0],a=e[1],l=n[0],u=n[1],h=i[0],c=i[1],d=(r-s)*(u-c)-(o-a)*(l-h);return 0===d?null:[((r*a-o*s)*(l-h)-(r-s)*(l*c-u*h))/d,((r*a-o*s)*(u-c)-(o-a)*(l*c-u*h))/d]}(h,c,d,p);if(null!==f&&(l=c[0]!==h[0]?(f[0]-h[0])/(c[0]-h[0]):(f[1]-h[1])/(c[1]-h[1]),u=p[0]!==d[0]?(f[0]-d[0])/(p[0]-d[0]):(f[1]-d[1])/(p[1]-d[1]),!(l>=1||l<=0||u>=1||u<=0))){var g=f,m=!o[g];m&&(o[g]=!0),e?r.push(e(f,t,n,h,c,l,s,a,d,p,u,m)):r.push(f)}}function g(t,e){var n,r,o,s,a=i[t][e],l=i[t][e+1];return a[0]<l[0]?(n=a[0],r=l[0]):(n=l[0],r=a[0]),a[1]<l[1]?(o=a[1],s=l[1]):(o=l[1],s=a[1]),{minX:n,minY:o,maxX:r,maxY:s,ring:t,edge:e}}}function rf(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!rf(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function of(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],i=0;i<e;i++){var r=t.geometry.coordinates[i];hf(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(Object.prototype.hasOwnProperty.call(e,t[i])){n=0;break}e[t[i]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,s=nf(t,(function(t,e,n,i,r,o,s,a,l,u,h,c){return[t,e,n,i,r,o,s,a,l,u,h,c]})),a=s.length;if(0==a){var l=[];for(i=0;i<e;i++)l.push(Tp([t.geometry.coordinates[i]],{parent:-1,winding:uf(t.geometry.coordinates[i])}));var u=kp(l);return A(),z(),u}var h=[],c=[];for(i=0;i<e;i++){h.push([]);for(var d=0;d<t.geometry.coordinates[i].length-1;d++)h[i].push([new sf(t.geometry.coordinates[i][cf(d+1,t.geometry.coordinates[i].length-1)],1,[i,d],[i,cf(d+1,t.geometry.coordinates[i].length-1)],void 0)]),c.push(new af(t.geometry.coordinates[i][d],[i,cf(d-1,t.geometry.coordinates[i].length-1)],[i,d],void 0,void 0,!1,!0))}for(i=0;i<a;i++)h[s[i][1]][s[i][2]].push(new sf(s[i][0],s[i][5],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0)),s[i][11]&&c.push(new af(s[i][0],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0,void 0,!0,!0));var p=c.length;for(i=0;i<h.length;i++)for(d=0;d<h[i].length;d++)h[i][d].sort((function(t,e){return t.param<e.param?-1:1}));var f=[];for(i=0;i<p;i++)f.push({minX:c[i].coord[0],minY:c[i].coord[1],maxX:c[i].coord[0],maxY:c[i].coord[1],index:i});var g=ef();g.load(f);for(i=0;i<h.length;i++)for(d=0;d<h[i].length;d++)for(var m=0;m<h[i][d].length;m++){y=m==h[i][d].length-1?h[i][cf(d+1,t.geometry.coordinates[i].length-1)][0].coord:h[i][d][m+1].coord;var _=g.search({minX:y[0],minY:y[1],maxX:y[0],maxY:y[1]})[0];h[i][d][m].nxtIsectAlongEdgeIn=_.index}for(i=0;i<h.length;i++)for(d=0;d<h[i].length;d++)for(m=0;m<h[i][d].length;m++){var y=h[i][d][m].coord,v=(_=g.search({minX:y[0],minY:y[1],maxX:y[0],maxY:y[1]})[0]).index;v<o?c[v].nxtIsectAlongRingAndEdge2=h[i][d][m].nxtIsectAlongEdgeIn:hf(c[v].ringAndEdge1,h[i][d][m].ringAndEdgeIn)?c[v].nxtIsectAlongRingAndEdge1=h[i][d][m].nxtIsectAlongEdgeIn:c[v].nxtIsectAlongRingAndEdge2=h[i][d][m].nxtIsectAlongEdgeIn}var w=[];for(i=0,d=0;d<e;d++){var x=i;for(m=0;m<t.geometry.coordinates[d].length-1;m++)c[i].coord[0]<c[x].coord[0]&&(x=i),i++;var b=c[x].nxtIsectAlongRingAndEdge2;for(m=0;m<c.length;m++)if(c[m].nxtIsectAlongRingAndEdge1==x||c[m].nxtIsectAlongRingAndEdge2==x){var C=m;break}var S=lf([c[C].coord,c[x].coord,c[b].coord],!0)?1:-1;w.push({isect:x,parent:-1,winding:S})}w.sort((function(t,e){return c[t.isect].coord>c[e.isect].coord?-1:1}));for(l=[];w.length>0;){var E=w.pop(),I=E.isect,P=E.parent,T=E.winding,k=l.length,D=[c[I].coord],M=I;if(c[I].ringAndEdge1Walkable)var L=c[I].ringAndEdge1,R=c[I].nxtIsectAlongRingAndEdge1;else L=c[I].ringAndEdge2,R=c[I].nxtIsectAlongRingAndEdge2;for(;!hf(c[I].coord,c[R].coord);){D.push(c[R].coord);var O=void 0;for(i=0;i<w.length;i++)if(w[i].isect==R){O=i;break}if(null!=O&&w.splice(O,1),hf(L,c[R].ringAndEdge1)){if(L=c[R].ringAndEdge2,c[R].ringAndEdge2Walkable=!1,c[R].ringAndEdge1Walkable){var F={isect:R};lf([c[M].coord,c[R].coord,c[c[R].nxtIsectAlongRingAndEdge2].coord],1==T)?(F.parent=P,F.winding=-T):(F.parent=k,F.winding=T),w.push(F)}M=R,R=c[R].nxtIsectAlongRingAndEdge2}else{if(L=c[R].ringAndEdge1,c[R].ringAndEdge1Walkable=!1,c[R].ringAndEdge2Walkable){F={isect:R};lf([c[M].coord,c[R].coord,c[c[R].nxtIsectAlongRingAndEdge1].coord],1==T)?(F.parent=P,F.winding=-T):(F.parent=k,F.winding=T),w.push(F)}M=R,R=c[R].nxtIsectAlongRingAndEdge1}}D.push(c[R].coord),l.push(Tp([D],{index:k,parent:P,winding:T,netWinding:void 0}))}u=kp(l);function A(){for(var t=[],e=0;e<u.features.length;e++)-1==u.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,i=1/0,r=0;r<u.features.length;r++)t[e]!=r&&Mp(u.features[t[e]].geometry.coordinates[0][0],u.features[r],{ignoreBoundary:!0})&&Op(u.features[r])<i&&(n=r);u.features[t[e]].properties.parent=n}}function z(){for(var t=0;t<u.features.length;t++)if(-1==u.features[t].properties.parent){var e=u.features[t].properties.winding;u.features[t].properties.netWinding=e,B(t,e)}}function B(t,e){for(var n=0;n<u.features.length;n++)if(u.features[n].properties.parent==t){var i=e+u.features[n].properties.winding;u.features[n].properties.netWinding=i,B(n,i)}}return A(),z(),u}var sf=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},af=function(t,e,n,i,r,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};function lf(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function uf(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(lf([t[cf(e-1,t.length-1)],t[e],t[cf(e+1,t.length-1)]],!0))var i=1;else i=-1;return i}function hf(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!hf(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function cf(t,e){return(t%e+e)%e}function df(t){var e=[];return function(t,e){Dp(t,(function(t,n,i,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Pp(t,i,{bbox:r,id:o}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(Pp({type:s,coordinates:u},i),n,l))return!1}}))}(t,(function(t){"Polygon"===t.geometry.type&&function(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}(of(t),(function(n){e.push(Tp(n.geometry.coordinates,t.properties))}))})),kp(e)}function pf(t){return Gi(t,"EPSG:3857")}function ff(t){return Xi(t,"EPSG:4326","EPSG:3857")}function gf(t){return Wi(t,"EPSG:4326","EPSG:3857")}function mf(t){return Wi(t,"EPSG:3857","EPSG:4326")}function _f(t){let e=0;const n=vp(t);if(null==n?void 0:n.length){const t=n[0];if(t.length>=5){t[0]=gf(t[0]),t[1]=gf(t[1]),t[2]=gf(t[2]),t[3]=gf(t[3]),t[4]=gf(t[4]);let n=[(t[2][0]-t[0][0])/2+t[0][0],(t[2][1]-t[0][1])/2+t[0][1]];const i=[(t[3][0]-t[1][0])/2+t[1][0],(t[3][1]-t[1][1])/2+t[1][1]];n=[(n[0]+i[0])/2,(n[1]+i[1])/2];const r=[t[2][0]-n[0],t[2][1]-n[1]],o=[t[3][0]-n[0],t[3][1]-n[1]],s=(r[0]*o[0]+r[1]*o[1])/(Math.sqrt(r[0]*r[0]+r[1]*r[1])*Math.sqrt(o[0]*o[0]+o[1]*o[1])),a=Math.acos(s);if(a>=0&&a<=Math.PI){let i=a/2;i=Math.PI/2-i,n[0],n[1];const o=[Math.cos(i),Math.sin(i)],s=(r[0]*o[0]+r[1]*o[1])/(Math.sqrt(r[0]*r[0]+r[1]*r[1])*Math.sqrt(o[0]*o[0]+o[1]*o[1]));e=Math.acos(s),t[2][0]<t[1][0]&&(e=-e)}}}return e}function yf(t){const e=Wi(t,"EPSG:3857","EPSG:4326"),{longitude:n,latitude:i}=_p(e[0],e[1]);return{longitude:n,latitude:i}}function vf(t){const e=[];return t[0].forEach((t=>{const n=Wi(t,"EPSG:3857","EPSG:4326"),{longitude:i,latitude:r}=_p(n[0],n[1]);e.push([i,r])})),e}function wf(t,e="EPSG:3857"){let n=Pi(t,{projection:e});const i=t.getType();let r=!1,o=0;if("Polygon"==i){const e=Cp([vf(t.getCoordinates())],{});r=!1;try{const t=df(e);t&&t.features&&t.features.length>=2?(r=!0,o=0,t.features.forEach((t=>{o+=Op(t)}))):r=!1}catch(l){o=0,r=!1}}r&&(n=o);let s="";const a=Math.round(100*n)/100;if(n>1e4){s=Math.round(n/1e6*100)/100+" KM²"}else s=a+" M²";return{area:a,areaString:s}}function xf(t,e="EPSG:3857"){const n=Ei(t,{projection:e});let i="";const r=Math.round(100*n)/100;return i=n>100?Math.round(n/1e3*100)/100+" KM":r+" M",{length:r,lengthString:i}}function bf(t){return function(e,n,i){const r=t(e,n,i);if(r){const t=r.getCoordinates();if(t&&t.length)for(let e=0;e<t[0].length;e++){const n=Wi(t[0][e],i,"EPSG:4326");n.length&&(n[0]>180&&(n[0]=180),n[0]<-180&&(n[0]=-180),t[0][e]=Wi(n,"EPSG:4326",i))}r.setCoordinates(t)}return r}}const Cf=(t,e,n)=>{const i=e||new Lu([NaN,NaN]),r=$i(t[0]);let o=i.getLastCoordinate();const s=Wi(o,n,"EPSG:4326");let a=!1;s.length&&(s[0]>180&&(s[0]=180,a=!0),s[0]<-180&&(s[0]=-180,a=!0),o=Wi(s,"EPSG:4326",n)),a&&(t[1]=o);const l=vi(r,$i(t[t.length-1]));return i.setCenterAndRadius(r,Math.sqrt(l),"XY"),i};function Sf(t,e="EPSG:4326"){if(t){const n=t.getCoordinates();if(n&&n.length)for(let t=0;t<n[0].length;t++){let i=n[0][t];"EPSG:4326"!=e&&(i=Wi(n[0][t],e,"EPSG:4326")),i.length&&(i[0]>180&&(i[0]=180),i[0]<-180&&(i[0]=-180),"EPSG:4326"!=e&&(n[0][t]=Wi(i,"EPSG:4326",e)))}t.setCoordinates(n)}return t}class Ef{constructor(t,n,i=1,r=21){e(this,"handle",null),e(this,"viewHandle",null),e(this,"container",""),e(this,"originView",null),e(this,"constrainedView",null),e(this,"minLevel",1),e(this,"maxLevel",21),e(this,"pixelRatio",1),e(this,"projectionCode","EPSG:3857"),e(this,"__Is3857",!0),e(this,"__Is4326",!1),e(this,"__zIndex",10),e(this,"computedCenter",(t=>[t[0]+(t[2]-t[0])/2,t[1]+(t[3]-t[1])/2])),e(this,"getCanvasImage",(()=>{const t=document.getElementById(this.container).querySelector("canvas");return t?t.toDataURL("image/png"):null})),this.container=t,this.minLevel=i,this.maxLevel=r,this.pixelRatio=n||(window?window.devicePixelRatio:1),this.originView=new aa({center:pf([116,40]),zoom:this.minLevel,minZoom:this.minLevel,maxZoom:this.maxLevel});const o=Vh({attribution:!1,zoom:!1,rotate:!1}).extend([]);Ic({doubleClickZoom:!1,pinchRotate:!1,altShiftDragRotate:!1}),this.__removeOpenLayersViewport(this.container),this.handle=new kc({pixelRatio:n,moveTolerance:5*n,controls:o,target:this.container,view:this.originView}),this.viewHandle=this.handle.getView(),this.projectionCode=this.viewHandle.getProjection().getCode(),this.__Is3857="EPSG:3857"===this.projectionCode,this.__Is4326="EPSG:4326"===this.projectionCode}__removeOpenLayersViewport(t){const e=document.getElementById(t);if(e){const t=e.getElementsByClassName("ol-viewport");for(;t.length;){const n=t[0];null==e||e.removeChild(n)}}}__removeMoreOpenLayerViewport(t){const e=document.getElementById(t);if(e){const t=e.getElementsByClassName("ol-viewport");if(t.length>1){const n=t[0];null==e||e.removeChild(n)}}}destructor(){this.handle&&(this.handle.dispose(),this.handle=null,this.viewHandle=null,this.container="")}setConstrainedView(t=!0){this.handle&&(t?(this.constrainedView=new aa({center:pf(this.getViewCenter()),zoom:this.getViewZoom(),minZoom:this.minLevel,maxZoom:this.maxLevel,extent:ff([-177,-84.5,175,84.5])}),this.handle.setView(this.constrainedView)):this.originView&&this.handle.setView(this.originView),this.viewHandle=this.handle.getView())}getMap(){return this.handle}getView(){return this.viewHandle}getViewZoom(){return this.viewHandle?this.viewHandle.getZoom():this.minLevel}getViewExtent(){if(this.viewHandle){const t=this.viewHandle.calculateExtent(this.handle.getSize()),e=Xi(t,"EPSG:3857","EPSG:4326"),n=_p(e[0],e[1]),i=_p(e[2],e[3]);return[n.longitude,n.latitude,i.longitude,i.latitude]}return[]}getViewCenter(){if(this.viewHandle){const t=this.getViewExtent();return t.length?this.computedCenter(t):[]}return[]}getResolution(){return this.viewHandle?this.viewHandle.getResolution():0}getScale(){if(this.viewHandle){return"1:"+(3779.5275590551*this.viewHandle.getResolution()).toFixed(0)}return"1:1"}getCurrentzIndex(){return this.__zIndex++}setActiveInteraction(t,e=!0){if(this.handle){this.handle.getInteractions().forEach((n=>{n instanceof t&&n.setActive(e)}))}}disableMouseWheelZoom(){this.setActiveInteraction(Cc,!1)}fireMapEvent(t){return!!this.handle&&this.handle.dispatchEvent(t)}fireViewEvent(t){return!!this.viewHandle&&this.viewHandle.dispatchEvent(t)}getAllLayers(){return this.handle?this.handle.getLayers().getArray():[]}getLayerByID(t){const e=this.getAllLayers().filter((e=>e.get("id")===t));return e.length>0?e[0]:null}removeAllMapLayers(){const t=this.getAllLayers();for(;t.length;){const e=t[0];this.handle.removeLayer(e)}}removeLayerByID(t){const e=this.getLayerByID(t);e&&this.handle.removeLayer(e)}getLayerSourceByID(t){const e=this.getLayerByID(t);return e?e.getSource():null}getLayerFeaturesByID(t){const e=this.getLayerSourceByID(t);return e?e.getFeatures():[]}flyToPosition(t=0,e=0,n=1e3){if(this.viewHandle){let i=[t,e];this.__Is3857&&(i=pf(i)),this.viewHandle.animate({center:i,duration:n})}}flyToZoom(t=3,e=1e3){this.viewHandle&&this.viewHandle.animate({zoom:t,duration:e})}flyToPositionAndZoom(t=0,e=0,n=3,i=1e3){if(this.viewHandle){let r=[t,e];this.__Is3857&&(r=pf(r)),this.viewHandle.animate({center:r,duration:i},{zoom:n,duration:i})}}setPosition(t=0,e=0){if(this.viewHandle){let n=[t,e];this.__Is3857&&(n=pf(n)),this.viewHandle.setCenter(n)}}setPositionAndZoom(t=0,e=0,n=3){if(this.viewHandle){let i=[t,e];this.__Is3857&&(i=pf(i)),this.viewHandle.setCenter(i),this.viewHandle.setZoom(n)}}fitToExtent(t,e=[0,0,0,0],n=!1){if(this.viewHandle){let i=t;n||this.__Is3857&&(i=ff(t)),this.viewHandle.fit(i,{padding:e})}}fitToLayerSourceByID(t,e=[0,0,0,0]){const n=this.getLayerSourceByID(t);if(n){const t=n.getExtent();this.fitToExtent(t,e,!0)}}fitToFeature(t,e=[0,0,0,0]){const n=t.getGeometry();this.fitToExtent(n,e,!0)}fitToLDRU(t,e,n,i){if(t>n||e>i)return;const r=[t,e,n,i];this.fitToExtent(r)}getExtentCenter(t){return this.__Is3857?mf(Tn(t)):this.__Is4326?Tn(t):[]}zoomInOut(t=!0,e=1e3){let n=this.getViewZoom();n&&(t?(n+=1,n>=this.maxLevel&&(n=this.maxLevel)):(n-=1,n<=this.minLevel&&(n=this.minLevel)),this.flyToZoom(n,e))}setRotation(t){this.viewHandle.setRotation(t)}}const If=class{constructor(t,e,n,i,r,o){this.sourceProj_=t,this.targetProj_=e;let s={};const a=Hi(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return s[e]||(s[e]=a(t)),s[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&An(i)>=An(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?An(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?An(this.targetProj_.getExtent()):null;const l=On(n),u=Fn(n),h=Pn(n),c=In(n),d=this.transformInv_(l),p=this.transformInv_(u),f=this.transformInv_(h),g=this.transformInv_(c),m=10+(o?Math.max(0,Math.ceil(Math.log2(En(n)/(o*o*256*256)))):0);if(this.addQuad_(l,u,h,c,d,p,f,g,m),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,n,i){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const n=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];n[0][0]-t>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-t>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-t>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);const i=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-i<this.sourceWorldWidth_/2&&(e.source=n)}}))}s={}}addTriangle_(t,e,n,i,r,o){this.triangles_.push({source:[i,r,o],target:[t,e,n]})}addQuad_(t,e,n,i,r,o,s,a,l){const u=sn([r,o,s,a]),h=this.sourceWorldWidth_?An(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1;let p=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){p=An(sn([t,e,n,i]))/this.targetWorldWidth_>.25||p}!d&&this.sourceProj_.isGlobal()&&h&&(p=h>.25||p)}if(!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!zn(u,this.maxSourceExtent_))return;let f=0;if(!(p||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)p=!0;else if(f=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=f&&2!=f&&4!=f&&8!=f)return;if(l>0){if(!p){const e=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=this.transformInv_(e);let o;if(d){o=(hi(r[0],c)+hi(s[0],c))/2-hi(i[0],c)}else o=(r[0]+s[0])/2-i[0];const a=(r[1]+s[1])/2-i[1];p=o*o+a*a>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const u=[(e[0]+n[0])/2,(e[1]+n[1])/2],h=this.transformInv_(u),c=[(i[0]+t[0])/2,(i[1]+t[1])/2],d=this.transformInv_(c);this.addQuad_(t,e,u,c,r,o,h,d,l-1),this.addQuad_(c,u,n,i,d,h,s,a,l-1)}else{const u=[(t[0]+e[0])/2,(t[1]+e[1])/2],h=this.transformInv_(u),c=[(n[0]+i[0])/2,(n[1]+i[1])/2],d=this.transformInv_(c);this.addQuad_(t,u,c,i,r,h,d,a,l-1),this.addQuad_(u,e,n,c,h,o,s,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&f||this.addTriangle_(t,n,i,r,s,a),14&f||this.addTriangle_(t,n,e,r,s,o),f&&(13&f||this.addTriangle_(e,i,t,o,a,r),7&f||this.addTriangle_(e,i,n,o,a,s))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,i){const r=e.source;xn(t,r[0]),xn(t,r[1]),xn(t,r[2])})),t}getTriangles(){return this.triangles_}};let Pf;const Tf=[];function kf(t,e,n,i,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,r)),t.restore()}function Df(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Mf(t,e,n,i){const r=Wi(n,e,t);let o=zi(e,i,n);const s=e.getMetersPerUnit();void 0!==s&&(o*=s);const a=t.getMetersPerUnit();void 0!==a&&(o/=a);const l=t.getExtent();if(!l||hn(l,r)){const e=zi(t,o,r)/o;isFinite(e)&&e>0&&(o/=e)}return o}function Lf(t,e,n,i,r,o,s,a,l,u,h,c,d){const p=Go(Math.round(n*t),Math.round(n*e),Tf);if(c||(p.imageSmoothingEnabled=!1),0===l.length)return p.canvas;function f(t){return Math.round(t*n)/n}p.scale(n,n),p.globalCompositeOperation="lighter";const g=[1/0,1/0,-1/0,-1/0];let m;if(l.forEach((function(t,e,n){wn(g,t.extent)})),!d||1!==l.length||0!==u){const t=An(g),e=Ln(g);m=Go(Math.round(n*t/i),Math.round(n*e/i),Tf),c||(m.imageSmoothingEnabled=!1);const r=n/i;l.forEach((function(t,e,n){const i=t.extent[0]-g[0],o=-(t.extent[3]-g[3]),s=An(t.extent),a=Ln(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,i*r,o*r,s*r,a*r)}))}const _=On(s);return a.getTriangles().forEach((function(t,e,r){const s=t.source,a=t.target;let u=s[0][0],h=s[0][1],d=s[1][0],y=s[1][1],v=s[2][0],w=s[2][1];const x=f((a[0][0]-_[0])/o),b=f(-(a[0][1]-_[1])/o),C=f((a[1][0]-_[0])/o),S=f(-(a[1][1]-_[1])/o),E=f((a[2][0]-_[0])/o),I=f(-(a[2][1]-_[1])/o),P=u,T=h;u=0,h=0,d-=P,y-=T,v-=P,w-=T;const k=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>r&&(r=e,n=s)}if(0===r)return null;const o=t[n];t[n]=t[i],t[i]=o;for(let s=i+1;s<e;s++){const n=-t[s][i]/t[i][i];for(let r=i;r<e+1;r++)i==r?t[s][r]=0:t[s][r]+=n*t[i][r]}}const n=new Array(e);for(let i=e-1;i>=0;i--){n[i]=t[i][e]/t[i][i];for(let r=i-1;r>=0;r--)t[r][e]-=t[r][i]*n[i]}return n}([[d,y,0,0,C-x],[v,w,0,0,E-x],[0,0,d,y,S-b],[0,0,v,w,I-b]]);if(!k)return;if(p.save(),p.beginPath(),function(){if(void 0===Pf){const t=Go(6,6,Tf);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",kf(t,4,5,4,0),kf(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;Pf=Df(e,0)||Df(e,4)||Df(e,8),No(t),Tf.push(t.canvas)}return Pf}()||!c){p.moveTo(C,S);const t=4,e=x-C,n=b-S;for(let i=0;i<t;i++)p.lineTo(C+f((i+1)*e/t),S+f(i*n/(t-1))),i!=t-1&&p.lineTo(C+f((i+1)*e/t),S+f((i+1)*n/(t-1)));p.lineTo(E,I)}else p.moveTo(C,S),p.lineTo(x,b),p.lineTo(E,I);let D;if(p.clip(),p.transform(k[0],k[2],k[1],k[3],x,b),p.translate(g[0]-P,g[3]-T),m)D=m.canvas,p.scale(i/n,-i/n);else{const t=l[0],e=t.extent;D=t.image,p.scale(An(e)/D.width,-Ln(e)/D.height)}p.drawImage(D,0,0),p.restore()})),m&&(No(m),Tf.push(m.canvas)),h&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach((function(t,e,n){const i=t.target,r=(i[0][0]-_[0])/o,s=-(i[0][1]-_[1])/o,a=(i[1][0]-_[0])/o,l=-(i[1][1]-_[1])/o,u=(i[2][0]-_[0])/o,h=-(i[2][1]-_[1])/o;p.beginPath(),p.moveTo(a,l),p.lineTo(r,s),p.lineTo(u,h),p.closePath(),p.stroke()})),p.restore()),p.canvas}const Rf=class extends hh{constructor(t,e,n,i,r,o,s,a,l,u,h,c){super(r,uh.IDLE,c),this.renderEdges_=void 0!==h&&h,this.pixelRatio_=s,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=i.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent();let f=this.sourceTileGrid_.getExtent();const g=p?Rn(d,p):d;if(0===En(g))return void(this.state=uh.EMPTY);const m=t.getExtent();m&&(f=f?Rn(f,m):m);const _=i.getResolution(this.wrappedTileCoord_[0]),y=function(t,e,n,i){const r=Tn(n);let o=Mf(t,e,r,i);return(!isFinite(o)||o<=0)&&Sn(n,(function(n){return o=Mf(t,e,n,i),isFinite(o)&&o>0})),o}(t,n,g,_);if(!isFinite(y)||y<=0)return void(this.state=uh.EMPTY);const v=void 0!==u?u:.5;if(this.triangulation_=new If(t,n,g,f,y*v,_),0===this.triangulation_.getTriangles().length)return void(this.state=uh.EMPTY);this.sourceZ_=e.getZForResolution(y);let w=this.triangulation_.calculateSourceExtent();if(f&&(t.canWrapX()?(w[1]=oi(w[1],f[1],f[3]),w[3]=oi(w[3],f[1],f[3])):w=Rn(w,f)),En(w)){const t=e.getTileRangeForExtentAndZ(w,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let n=t.minY;n<=t.maxY;n++){const t=l(this.sourceZ_,e,n,s);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=uh.EMPTY)}else this.state=uh.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==uh.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=uh.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Lf(i,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=uh.LOADED}this.changed()}load(){if(this.state==uh.IDLE){this.state=uh.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const n=e.getState();if(n==uh.IDLE||n==uh.LOADING){t++;const n=xe(e,ce,(function(i){const r=e.getState();r!=uh.LOADED&&r!=uh.ERROR&&r!=uh.EMPTY||(Ce(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(n)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,n){t.getState()==uh.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ce),this.sourcesListenerKeys_=null}release(){this.canvas_&&(No(this.canvas_.getContext("2d")),Tf.push(this.canvas_),this.canvas_=null),super.release()}},Of="tileloadstart",Ff="tileloadend",Af="tileloaderror",zf=[0,0,0];const Bf=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Ae(function(t,e,n){const i=e||Jt;return t.every((function(e,r){if(0===r)return!0;const o=i(t[r-1],e);return!(o>0||n&&0===o)}))}(this.resolutions_,((t,e)=>e-t),!0),"`resolutions` must be sorted in descending order"),!t.origins)for(let i=0,r=this.resolutions_.length-1;i<r;++i)if(e){if(this.resolutions_[i]/this.resolutions_[i+1]!==e){e=void 0;break}}else e=this.resolutions_[i]/this.resolutions_[i+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Ae(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=On(n)),Ae(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Ae(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Us,Ae(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const i=new Wc(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);i.minX=Math.max(t.minX,i.minX),i.maxX=Math.min(t.maxX,i.maxX),i.minY=Math.max(t.minY,i.minY),i.maxY=Math.min(t.maxY,i.maxY)}return i})):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const i=this.getTileRangeForExtentAndZ(t,e);for(let r=i.minX,o=i.maxX;r<=o;++r)for(let t=i.minY,s=i.maxY;t<=s;++t)n([e,r,t])}forEachTileCoordParentTileRange(t,e,n,i){let r,o,s,a=null,l=t[0]-1;for(2===this.zoomFactor_?(o=t[1],s=t[2]):a=this.getTileCoordExtent(t,i);l>=this.minZoom;){if(void 0!==o&&void 0!==s?(o=Math.floor(o/2),s=Math.floor(s/2),r=Hc(o,o,s,s,n)):r=this.getTileRangeForExtentAndZ(a,l,n),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const n=2*t[1],i=2*t[2];return Hc(n,n+1,i,i+1,e)}const i=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const i=t[0],r=t[1],o=t[2];if(e===i)return Hc(r,o,r,o,n);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-i),s=Math.floor(r*t),a=Math.floor(o*t);if(e<i)return Hc(s,s,a,a,n);return Hc(s,Math.floor(t*(r+1))-1,a,Math.floor(t*(o+1))-1,n)}const s=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,zf);const i=zf[1],r=zf[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,zf);return Hc(i,zf[1],r,zf[2],n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=yo(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=yo(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i,s=n[1]-(t[2]+1)*r[1]*i;return gn(o,s,o+r[0]*i,s+r[1]*i,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,i,r){const o=this.getZForResolution(n),s=n/this.getResolution(o),a=this.getOrigin(o),l=yo(this.getTileSize(o),this.tmpSize_);let u=s*(t-a[0])/n/l[0],h=s*(a[1]-e)/n/l[1];return i?(u=fi(u,5)-1,h=fi(h,5)-1):(u=pi(u,5),h=pi(h,5)),zc(o,u,h,r)}getTileCoordForXYAndZ_(t,e,n,i,r){const o=this.getOrigin(n),s=this.getResolution(n),a=yo(this.getTileSize(n),this.tmpSize_);let l=(t-o[0])/s/a[0],u=(o[1]-e)/s/a[1];return i?(l=fi(l,5)-1,u=fi(u,5)-1):(l=pi(l,5),u=pi(u,5)),zc(n,l,u,r)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return oi(Qt(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Ar(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}};function jf(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,n,i){const r=Vf(t);return function(t,e,n,i){i=void 0!==i?i:"top-left";const r=Nf(t,e,n);return new Bf({extent:t,origin:kn(t,i),resolutions:r,tileSize:n})}(r,e,n,i)}(t),t.setDefaultTileGrid(e)),e}function Gf(t){const e=t||{},n=e.extent||Ai("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Nf(n,e.maxZoom,e.tileSize,e.maxResolution)};return new Bf(i)}function Nf(t,e,n,i){e=void 0!==e?e:Xs,n=yo(void 0!==n?n:Us);const r=Ln(t),o=An(t);i=i>0?i:Math.max(o/n[0],r/n[1]);const s=e+1,a=new Array(s);for(let l=0;l<s;++l)a[l]=i/Math.pow(2,l);return a}function Vf(t){let e=(t=Ai(t)).getExtent();if(!e){const n=180*Nn.degrees/t.getMetersPerUnit();e=gn(-n,-n,n,n)}return e}class Hf extends qt{constructor(t,e){super(t),this.tile=e}}const Wf=class extends $u{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;const e=[256,256];this.tileGrid&&yo(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new Nc(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,i){const r=this.getTileCacheForProjection(t);if(!r)return!1;let o,s,a,l=!0;for(let u=n.minX;u<=n.maxX;++u)for(let t=n.minY;t<=n.maxY;++t)s=Bc(e,u,t),a=!1,r.containsKey(s)&&(o=r.get(s),a=o.getState()===uh.LOADED,a&&(a=!1!==i(o))),a||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,i,r){return Ie()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:jf(t)}getTileCacheForProjection(t){const e=this.getProjection();return Ae(null===e||Ni(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const i=this.getTileGridForProjection(n),r=this.getTilePixelRatio(e),o=yo(i.getTileSize(t),this.tmpSize);return 1==r?o:(s=o,a=r,void 0===(l=this.tmpSize)&&(l=[0,0]),l[0]=s[0]*a+.5|0,l[1]=s[1]*a+.5|0,l);var s,a,l}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){const i=e[0],r=t.getTileCoordCenter(e),o=Vf(n);if(!hn(o,r)){const e=An(o),n=Math.ceil((o[0]-r[0])/e);return r[0]+=e*n,t.getTileCoordForCoordAndZ(r,i)}return e}(n,t,e)),function(t,e){const n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const o=e.getFullTileRange(n);return!o||o.containsXY(i,r)}(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,i){}};function Xf(t,e){const n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){if(s)return t.replace(n,s[0].toString()).replace(i,s[1].toString()).replace(r,s[2].toString()).replace(o,(function(){const t=s[0],n=e.getFullTileRange(t);if(!n)throw new Error("The {-y} placeholder requires a tile grid with extent");return(n.getHeight()-s[2]-1).toString()}))}}function Uf(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Xf(t[r],e);return $f(i)}function $f(t){return 1===t.length?t[0]:function(e,n,i){if(!e)return;const r=function(t){return(t[1]<<t[0])+t[2]}(e),o=hi(r,t.length);return t[o](e,n,i)}}function Yf(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const i=n[1].charCodeAt(0),r=n[2].charCodeAt(0);let o;for(o=i;o<=r;++o)e.push(t.replace(n[0],String.fromCharCode(o)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const i=parseInt(n[2],10);for(let r=parseInt(n[1],10);r<=i;r++)e.push(t.replace(n[0],r.toString()));return e}return e.push(t),e}class qf extends Wf{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===qf.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=Te(e),i=e.getState();let r;i==uh.LOADING?(this.tileLoadingKeys_[n]=!0,r=Of):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],r=i==uh.ERROR?Af:i==uh.LOADED?Ff:void 0),null!=r&&this.dispatchEvent(new Hf(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=Yf(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Uf(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const i=Bc(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)}}const Zf=qf;function Kf(t,e){t.getImage().src=e}const Jf=class extends Zf{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Kf,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:ch,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const i in this.tileCacheForProjection){const t=this.tileCacheForProjection[i];t.expireCache(t==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Ni(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!Ni(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Ni(e,t)))return this.tileGrid;const n=Te(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=jf(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Ni(e,t))return this.tileCache;const n=Te(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Nc(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,i,r,o){const s=[t,e,n],a=this.getTileCoordForTileUrlFunction(s,r),l=a?this.tileUrlFunction(a,i,r):void 0,u=new this.tileClass(s,void 0!==l?uh.IDLE:uh.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(ce,this.handleTileChange.bind(this)),u}getTile(t,e,n,i,r){const o=this.getProjection();if(!o||!r||Ni(o,r))return this.getTileInternal(t,e,n,i,o||r);const s=this.getTileCacheForProjection(r),a=[t,e,n];let l;const u=jc(a);s.containsKey(u)&&(l=s.get(u));const h=this.getKey();if(l&&l.key==h)return l;const c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),p=this.getTileCoordForTileUrlFunction(a,r),f=new Rf(o,c,r,d,a,p,this.getTilePixelRatio(i),this.getGutter(),((t,e,n,i)=>this.getTileInternal(t,e,n,i,o)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=h,l?(f.interimTile=l,f.refreshInterimChain(),s.replace(u,f)):s.set(u,f),f}getTileInternal(t,e,n,i,r){let o=null;const s=Bc(t,e,n),a=this.getKey();if(this.tileCache.containsKey(s)){if(o=this.tileCache.get(s),o.key!=a){const l=o;o=this.createTile_(t,e,n,i,r,a),l.getState()==uh.IDLE?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,n,i,r,a),this.tileCache.set(s,o);return o}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const n=Ai(t);if(n){const t=Te(n);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}};const Qf=class extends Jf{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Gf({extent:Vf(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},tg="preload",eg="useInterimTilesOnError";const ng=class extends ua{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(tg)}setPreload(t){this.set(tg,t)}getUseInterimTilesOnError(){return this.get(eg)}setUseInterimTilesOnError(t){this.set(eg,t)}getData(t){return super.getData(t)}};const ig=class extends nu{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new Wc(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return n==uh.LOADED||n==uh.EMPTY||n==uh.ERROR&&!i}getTile(t,e,n,i){const r=i.pixelRatio,o=i.viewState.projection,s=this.getLayer();let a=s.getSource().getTile(t,e,n,r,o);return a.getState()==uh.ERROR&&s.getUseInterimTilesOnError()&&s.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),i=Je(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!hn(r,i))return null;const o=e.pixelRatio,s=e.viewState.projection,a=e.viewState,l=n.getRenderSource(),u=l.getTileGridForProjection(a.projection),h=l.getTilePixelRatio(e.pixelRatio);for(let c=u.getZForResolution(a.resolution);c>=u.getMinZoom();--c){const t=u.getTileCoordForCoordAndZ(i,c),e=l.getTile(c,t[1],t[2],o,s);if(!(e instanceof ch||e instanceof Rf)||e instanceof Rf&&e.getState()===uh.EMPTY)return null;if(e.getState()!==uh.LOADED)continue;const n=u.getOrigin(c),r=yo(u.getTileSize(c)),d=u.getResolution(c),p=Math.floor(h*((i[0]-n[0])/d-t[1]*r[0])),f=Math.floor(h*((n[1]-i[1])/d-t[2]*r[1])),g=Math.round(h*l.getGutterForProjection(a.projection));return this.getImageData(e.getImage(),p+g,f+g)}return null}loadedTileCallback(t,e,n){return!!this.isDrawableTile(n)&&super.loadedTileCallback(t,e,n)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],i=t.viewState,r=i.projection,o=i.resolution,s=i.center,a=i.rotation,l=t.pixelRatio,u=this.getLayer(),h=u.getSource(),c=h.getRevision(),d=h.getTileGridForProjection(r),p=d.getZForResolution(o,h.zDirection),f=d.getResolution(p);let g=t.extent;const m=t.viewState.resolution,_=h.getTilePixelRatio(l),y=Math.round(An(g)/m*l),v=Math.round(Ln(g)/m*l),w=n.extent&&qi(n.extent);w&&(g=Rn(g,qi(n.extent)));const x=f*y/2/_,b=f*v/2/_,C=[s[0]-x,s[1]-b,s[0]+x,s[1]+b],S=d.getTileRangeForExtentAndZ(g,p),E={};E[p]={};const I=this.createLoadedTileFinder(h,r,E),P=this.tmpExtent,T=this.tmpTileRange_;this.newTiles_=!1;const k=a?Mn(i.center,m,a,t.size):void 0;for(let B=S.minX;B<=S.maxX;++B)for(let e=S.minY;e<=S.maxY;++e){if(a&&!d.tileCoordIntersectsViewport([p,B,e],k))continue;const i=this.getTile(p,B,e,t);if(this.isDrawableTile(i)){const e=Te(this);if(i.getState()==uh.LOADED){E[p][i.tileCoord.toString()]=i;let t=i.inTransition(e);t&&1!==n.opacity&&(i.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(i)||(this.newTiles_=!0)}if(1===i.getAlpha(e,t.time))continue}const r=d.getTileCoordChildTileRange(i.tileCoord,T,P);let o=!1;r&&(o=I(p+1,r)),o||d.forEachTileCoordParentTileRange(i.tileCoord,I,T,P)}const D=f/o*l/_;tn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/l,1/l,a,-y/2,-v/2);const M=rn(this.pixelTransform);this.useContainer(e,M,this.getBackground(t));const L=this.context,R=L.canvas;en(this.inversePixelTransform,this.pixelTransform),tn(this.tempTransform,y/2,v/2,D,D,0,-y/2,-v/2),R.width!=y||R.height!=v?(R.width=y,R.height=v):this.containerReused||L.clearRect(0,0,y,v),w&&this.clipUnrotated(L,t,w),h.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,t),this.renderedTiles.length=0;let O,F,A,z=Object.keys(E).map(Number);z.sort(Jt),1!==n.opacity||this.containerReused&&!h.getOpaque(t.viewState.projection)?(O=[],F=[]):z=z.reverse();for(let B=z.length-1;B>=0;--B){const e=z[B],n=h.getTilePixelSize(e,l,r),i=d.getResolution(e)/f,o=n[0]*i*D,s=n[1]*i*D,a=d.getTileCoordForCoordAndZ(On(C),e),u=d.getTileCoordExtent(a),c=Je(this.tempTransform,[_*(u[0]-C[0])/f,_*(C[3]-u[3])/f]),g=_*h.getGutterForProjection(r),m=E[e];for(const r in m){const n=m[r],i=n.tileCoord,l=a[1]-i[1],u=Math.round(c[0]-(l-1)*o),d=a[2]-i[2],f=Math.round(c[1]-(d-1)*s),_=Math.round(c[0]-l*o),y=Math.round(c[1]-d*s),v=u-_,w=f-y,x=p===e,b=x&&1!==n.getAlpha(Te(this),t.time);let C=!1;if(!b)if(O){A=[_,y,_+v,y,_+v,y+w,_,y+w];for(let t=0,n=O.length;t<n;++t)if(p!==e&&e<F[t]){const e=O[t];zn([_,y,_+v,y+w],[e[0],e[3],e[4],e[7]])&&(C||(L.save(),C=!0),L.beginPath(),L.moveTo(A[0],A[1]),L.lineTo(A[2],A[3]),L.lineTo(A[4],A[5]),L.lineTo(A[6],A[7]),L.moveTo(e[6],e[7]),L.lineTo(e[4],e[5]),L.lineTo(e[2],e[3]),L.lineTo(e[0],e[1]),L.clip())}O.push(A),F.push(e)}else L.clearRect(_,y,v,w);this.drawTileImage(n,t,_,y,v,w,g,x),O&&!b?(C&&L.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,h,n)}}return this.renderedRevision=c,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!vn(this.renderedExtent_,C),this.renderedExtent_=C,this.renderedPixelRatio=l,this.renderedProjection=r,this.manageTilePyramid(t,h,d,l,r,g,p,u.getPreload()),this.scheduleExpireCache(t,h),this.postRender(L,t),n.extent&&L.restore(),L.imageSmoothingEnabled=!0,M!==R.style.transform&&(R.style.transform=M),this.container}drawTileImage(t,e,n,i,r,o,s,a){const l=this.getTileImage(t);if(!l)return;const u=Te(this),h=e.layerStatesArray[e.layerIndex],c=h.opacity*(a?t.getAlpha(u,e.time):1),d=c!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(l,s,s,l.width-2*s,l.height-2*s,n,i,r,o),d&&this.context.restore(),c!==h.opacity?e.animate=!0:a&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=function(t,e,n){const i=Te(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const i=Te(e);i in t||(t[i]={}),t[i][n.getKey()]=!0}manageTilePyramid(t,e,n,i,r,o,s,a,l){const u=Te(e);u in t.wantedTiles||(t.wantedTiles[u]={});const h=t.wantedTiles[u],c=t.tileQueue,d=n.getMinZoom(),p=t.viewState.rotation,f=p?Mn(t.viewState.center,t.viewState.resolution,p,t.size):void 0;let g,m,_,y,v,w,x=0;for(w=d;w<=s;++w)for(m=n.getTileRangeForExtentAndZ(o,w,m),_=n.getResolution(w),y=m.minX;y<=m.maxX;++y)for(v=m.minY;v<=m.maxY;++v)p&&!n.tileCoordIntersectsViewport([w,y,v],f)||(s-w<=a?(++x,g=e.getTile(w,y,v,i,r),g.getState()==uh.IDLE&&(h[g.getKey()]=!0,c.isKeyQueued(g.getKey())||c.enqueue([g,u,n.getTileCoordCenter(g.tileCoord),_])),void 0!==l&&l(g)):e.useTile(w,y,v,r));e.updateCacheSize(x,r)}};const rg=class extends ng{constructor(t){super(t)}createRenderer(){return new ig(this)}};let og=class{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"__layers",null),e(this,"__layerIdPrefix","XYZ_"),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map}destructor(){this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}createLayer(t={url:"",id:"",name:"",zIndex:0,extent:[],wrapX:!0,opacity:1,minZoom:0,maxZoom:21}){if(!t.url||!t.id)return null;let e=n;t.extent&&t.extent.length&&4===t.extent.length&&(e=t.extent),e=ff(e);const i=t.opacity?t.opacity:1,r=t.minZoom?t.minZoom:1,o=t.maxZoom?t.maxZoom:21,s={url:t.url,wrapX:t.wrapX,minZoom:r,maxZoom:o,crossOrigin:null},a=new Qf(s),l=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),u=new rg({source:a,zIndex:l,opacity:i}),h=t.name?t.name:Yt(10);u.set("id",this.__Id(t.id)),u.set("name",this.__Name(h));return{options:t,xyzOptions:s,source:a,layer:u}}addLayer(t){if(this.handle){const e=this.createLayer(t);return!!e&&(this.handle.addLayer(e.layer),this.__layers.set(this.__Id(t.id),e),!0)}return!1}fitToView(t){return!!this.olBaseHandle&&(t.extent?(this.olBaseHandle.fitToExtent(t.extent),!0):void 0)}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeLayer(t.layer)})),this.__layers.clear(),!0)}setLayerOpacity(t,e){return this.setLayerOpacityByID(t.id,e)}setLayerOpacityByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setOpacity(e),!0)}return!1}showHiddenLayer(t,e){return this.showHiddenLayerByID(t.id,e)}showHiddenLayerByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setVisible(e),!0)}return!1}};const sg=class extends Jf{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:Ai("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(n).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],n=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,i=Vf(this.getProjection()),r=this.hidpi_?2:1,o=e.imageWidth==e.imageHeight?e.imageWidth/r:[e.imageWidth/r,e.imageHeight/r],s=Gf({extent:i,minZoom:e.zoomMin,maxZoom:n,tileSize:o});this.tileGrid=s;const a=this.culture_,l=this.hidpi_,u=this.placeholderTiles_;if(this.tileUrlFunction=$f(e.imageUrlSubdomains.map((function(t){const n=[0,0,0],i=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,r){if(!t)return;zc(t[0],t[1],t[2],n);const o=new URL(i.replace("{quadkey}",function(t){const e=t[0],n=new Array(e);let i,r,o=1<<e-1;for(i=0;i<e;++i)r=48,t[1]&o&&(r+=1),t[2]&o&&(r+=2),n[i]=String.fromCharCode(r),o>>=1;return n.join("")}(n))),s=o.searchParams;return l&&(s.set("dpi","d1"),s.set("device","mobile")),!0===u?s.delete("n"):!1===u&&s.set("n","z"),o.toString()}}))),e.imageryProviders){const t=Vi(Ai("EPSG:4326"),this.getProjection());this.setAttributions((n=>{const i=[],r=n.viewState,o=this.getTileGrid(),s=o.getZForResolution(r.resolution,this.zDirection),a=o.getTileCoordForCoordAndZ(r.center,s)[0];return e.imageryProviders.map((function(e){let r=!1;const o=e.coverageAreas;for(let i=0,s=o.length;i<s;++i){const e=o[i];if(a>=e.zoomMin&&a<=e.zoomMax){const i=e.bbox;if(zn(jn([i[1],i[0],i[3],i[2]],t),n.extent)){r=!0;break}}}r&&i.push(e.attribution)})),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),i}))}this.setState("ready")}},ag=i.tiandituKey,lg={aMap_img:"http://webst0{1-4}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",aMap_vec:"http://webrd0{1-4}.is.autonavi.com/appmaptile?size=1&scale=1&style=8&x={x}&y={y}&z={z}",aMap_roadLabel:"http://webst0{1-4}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",aMap_cs_img:"http://webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",aMap_cs_vec:"http://webrd0{s}.is.autonavi.com/appmaptile?size=1&scale=1&style=8&x={x}&y={y}&z={z}",aMap_cs_roadLabel:"http://webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",aMap_subdomains:["1","2","3","4"],aMap_img_single:"http://webst01.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",aMap_vec_single:"http://webrd01.is.autonavi.com/appmaptile?size=1&scale=1&style=8&x={x}&y={y}&z={z}",aMap_roadLabel_single:"http://webst01.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}",tiandi_lnglat_vec:`http://t{0-7}.tianditu.gov.cn/DataServer?T=vec_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_vec_zh_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cva_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_vec_en_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=eva_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_img:`http://t{0-7}.tianditu.gov.cn/DataServer?T=img_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_img_zh_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cia_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_img_en_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=eia_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_vec:`http://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_vec_zh_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_vec_en_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=eva_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_img:`http://t{0-7}.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_img_zh_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_img_en_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=eia_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_ter:`http://t{0-7}.tianditu.gov.cn/DataServer?T=ter_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_ter_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cta_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_ter:`http://t{0-7}.tianditu.gov.cn/DataServer?T=ter_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_ter_label:`http://t{0-7}.tianditu.gov.cn/DataServer?T=cta_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_lnglat_ibo:`http://t{0-7}.tianditu.gov.cn/DataServer?T=ibo_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_spm_ibo:`http://t{0-7}.tianditu.gov.cn/DataServer?T=ibo_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_vec:`http://t{s}.tianditu.gov.cn/DataServer?T=vec_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_vec_zh_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cva_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_vec_en_label:`http://t{s}.tianditu.gov.cn/DataServer?T=eva_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_img:`http://t{s}.tianditu.gov.cn/DataServer?T=img_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_img_zh_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cia_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_img_en_label:`http://t{s}.tianditu.gov.cn/DataServer?T=eia_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_vec:`http://t{s}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_vec_zh_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_vec_en_label:`http://t{s}.tianditu.gov.cn/DataServer?T=eva_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_img:`http://t{s}.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_img_zh_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_img_en_label:`http://t{s}.tianditu.gov.cn/DataServer?T=eia_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_ter:`http://t{s}.tianditu.gov.cn/DataServer?T=ter_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_ter_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cta_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_ter:`http://t{s}.tianditu.gov.cn/DataServer?T=ter_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_ter_label:`http://t{s}.tianditu.gov.cn/DataServer?T=cta_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_lnglat_ibo:`http://t{s}.tianditu.gov.cn/DataServer?T=ibo_c&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_cs_spm_ibo:`http://t{s}.tianditu.gov.cn/DataServer?T=ibo_w&x={x}&y={y}&l={z}&tk=${ag}`,tiandi_subdomains:["0","1","2","3","4","5","6","7"],geoq_vec:"http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",geoq_gray:"http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",geoq_blue:"http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",geoq_warm:"http://cache1.arcgisonline.cn/arcgis/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}",geoq_line:"http://cache1.arcgisonline.cn/arcgis/rest/services/SimpleFeature/ChinaBoundaryLine/MapServer/tile/{z}/{y}/{x}",geoq_china:"http://thematic.geoq.cn/arcgis/rest/services/ThematicMaps/administrative_division_boundaryandlabel/MapServer/tile/{z}/{y}/{x}",geoq_Hydro:"http://thematic.geoq.cn/arcgis/rest/services/ThematicMaps/WorldHydroMap/MapServer/tile/{z}/{y}/{x}",geoq_green:"http://thematic.geoq.cn/arcgis/rest/services/ThematicMaps/vegetation/MapServer/tile/{z}/{y}/{x}",google_vec:"http://www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}",google_img:"http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",google_maps:"https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}",google_terrain:"https://mt1.google.com/vt/lyrs=t&x={x}&y={y}&z={z}",google_roads:"https://mt1.google.com/vt/lyrs=h&x={x}&y={y}&z={z}",google_satellite:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",google_streets:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",cartocdn_dark_nolabel:"http://basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png",cartocdn_light_nolabels:"http://basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",cartocdn_voyager_nolabels:"https://basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}.png",esri_world_imagery:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",esri_world_streets:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",esri_world_light_gray_base:"https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",esri_world_topo_map:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",memomaps_tilegen:"http://tileserver.memomaps.de/tilegen/{z}/{x}/{y}.png",openstreetmap:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",openstreetmap_br:"https://tile.openstreetmap.bzh/br/{z}/{x}/{y}.png",openstreetmap_cyclosm:"https://a.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png",openstreetmap_hot:"https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",openstreetmap_cycle:"http://tile.thunderforest.com/cycle/{z}/{x}/{y}.png",wmflabs_bw_mapnik:"http://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",stamen_terrain:"http://a.tile.stamen.com/terrain/{z}/{x}/{y}.png",stamen_terrain_background:"http//a.tile.stamen.com/terrain-background/{z}/{x}/{y}.png",stamen_terrain_high:"http://a.tile.stamen.com/terrain/{z}/{x}/{y}@2x.png",stamen_watercolor:"https://stamen-tiles-c.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg",stamen_watercolor2:"http://a.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg",thunderforest_cycle:"https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=",thunderforest_pioneer:"https://tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey=",carto_positron:"https://cartodb-basemaps-a.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",mapTiler:"'https://api.maptiler.com/tiles/satellite/{z}/{x}/{y}.jpg?key=Nnf5WLkCvc7B6d5i5PSw'",mapBox_online:"https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token=<mapbox key>",mapbox_local_basic:"/map/styles/basic/{z}/{x}/{y}.png",mapbox_local_allblue:"/map/styles/allblue/{z}/{x}/{y}.png",mapbox_local_low_pixel_satellite:"/map/styles/satelliteofflinestyle/{z}/{x}/{y}.png",mapbox_local_dark:"/map/styles/dark/{z}/{x}/{y}.png",mapbox_local_darklight:"/map/styles/darklight/{z}/{x}/{y}.png"},ug="/map/styles/basic/style.json",hg="/map/styles/allblue/style.json",cg="/map/styles/dark/style.json",dg="/map/styles/darklight/style.json",pg="AerialWithLabelsOnDemand",fg="CanvasDark",gg="CanvasLight",mg="CanvasGray",_g=i.bingmapKey;class yg{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"__layers",null),e(this,"__layerIdPrefix","BINGMAP_"),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map}destructor(){this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}createLayer(t={id:"",imagerySet:gg,hidpi:!1,name:"",zIndex:0,extent:[],wrapX:!0,opacity:1,minZoom:0,maxZoom:21}){if(!t.id)return null;let e=n;t.extent&&t.extent.length&&4===t.extent.length&&(e=t.extent),e=ff(e);const i=t.opacity?t.opacity:1,r=t.minZoom?t.minZoom:1,o=t.maxZoom?t.maxZoom:21,s={key:_g,imagerySet:t.imagerySet,hidpi:t.hidpi,wrapX:t.wrapX,minZoom:r,maxZoom:o},a=new sg(s),l=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),u=new rg({source:a,visible:!0,preload:1/0,zIndex:l,opacity:i,minZoom:r,maxZoom:o}),h=t.name?t.name:Yt(10);u.set("id",this.__Id(t.id)),u.set("name",this.__Name(h));return{options:t,bingmapOptions:s,source:a,layer:u}}addLayer(t){if(this.handle){const e=this.createLayer(t);return!!e&&(this.handle.addLayer(e.layer),this.__layers.set(this.__Id(t.id),e),!0)}return!1}fitToView(t){return!!this.olBaseHandle&&(t.extent?(this.olBaseHandle.fitToExtent(t.extent),!0):void 0)}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeLayer(t.layer)})),this.__layers.clear(),!0)}setLayerOpacity(t,e){return this.setLayerOpacityByID(t.id,e)}setLayerOpacityByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setOpacity(e),!0)}return!1}showHiddenLayer(t,e){return this.showHiddenLayerByID(t.id,e)}showHiddenLayerByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setVisible(e),!0)}return!1}}const vg=class extends ua{constructor(t){super(t=t||{})}};const wg=class extends nu{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,r=i.resolution,o=this.getLayer().getSource(),s=t.viewHints;let a=t.extent;if(void 0!==e.extent&&(a=Rn(a,qi(e.extent,i.projection))),!s[Vs]&&!s[Hs]&&!Bn(a))if(o){const t=i.projection,e=o.getImage(a,r,n,t);e&&(this.loadImage(e)?this.image_=e:e.getState()===mo&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),i=Je(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!hn(r,i))return null;const o=this.image_.getExtent(),s=this.image_.getImage(),a=An(o),l=Math.floor(s.width*((i[0]-o[0])/a));if(l<0||l>=s.width)return null;const u=Ln(o),h=Math.floor(s.height*((o[3]-i[1])/u));return h<0||h>=s.height?null:this.getImageData(s,l,h)}renderFrame(t,e){const n=this.image_,i=n.getExtent(),r=n.getResolution(),[o,s]=Array.isArray(r)?r:[r,r],a=n.getPixelRatio(),l=t.layerStatesArray[t.layerIndex],u=t.pixelRatio,h=t.viewState,c=h.center,d=h.resolution,p=u*o/(d*a),f=u*s/(d*a),g=t.extent,m=h.resolution,_=h.rotation,y=Math.round(An(g)/m*u),v=Math.round(Ln(g)/m*u);tn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/u,1/u,_,-y/2,-v/2),en(this.inversePixelTransform,this.pixelTransform);const w=rn(this.pixelTransform);this.useContainer(e,w,this.getBackground(t));const x=this.context,b=x.canvas;b.width!=y||b.height!=v?(b.width=y,b.height=v):this.containerReused||x.clearRect(0,0,y,v);let C=!1,S=!0;if(l.extent){const e=qi(l.extent,h.projection);S=zn(e,t.extent),C=S&&!cn(e,t.extent),C&&this.clipUnrotated(x,t,e)}const E=n.getImage(),I=tn(this.tempTransform,y/2,v/2,p,f,0,a*(i[0]-c[0])/o,a*(c[1]-i[3])/s);this.renderedResolution=s*u/a;const P=E.width*I[0],T=E.height*I[3];if(this.getLayer().getSource().getInterpolate()||(x.imageSmoothingEnabled=!1),this.preRender(x,t),S&&P>=.5&&T>=.5){const t=I[4],e=I[5],n=l.opacity;let i;1!==n&&(i=x.globalAlpha,x.globalAlpha=n),x.drawImage(E,0,0,+E.width,+E.height,t,e,P,T),1!==n&&(x.globalAlpha=i)}return this.postRender(x,t),C&&x.restore(),x.imageSmoothingEnabled=!0,w!==b.style.transform&&(b.style.transform=w),this.container}};const xg=class extends vg{constructor(t){super(t)}createRenderer(){return new wg(this)}getData(t){return super.getData(t)}};function bg(t){return Array.isArray(t)?Math.min(...t):t}const Cg=class extends Da{constructor(t,e,n,i,r,o,s){let a=t.getExtent();a&&t.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);const u=l?Rn(n,l):n,h=Mf(t,e,Tn(u),i),c=new If(t,e,u,a,.5*h,i),d=c.calculateSourceExtent(),p=Bn(d)?null:o(d,h,r),f=p?co:mo,g=p?p.getPixelRatio():1;super(n,i,g,f),this.targetProj_=e,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=i,this.targetExtent_=n,this.sourceImage_=p,this.sourcePixelRatio_=g,this.interpolate_=s,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==po&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==fo){const t=An(this.targetExtent_)/this.targetResolution_,e=Ln(this.targetExtent_)/this.targetResolution_;this.canvas_=Lf(t,e,this.sourcePixelRatio_,bg(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==co){this.state=po,this.changed();const t=this.sourceImage_.getState();t==fo||t==go?this.reproject_():(this.sourceListenerKey_=xe(this.sourceImage_,ce,(function(t){const e=this.sourceImage_.getState();e!=fo&&e!=go||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}}unlistenSource_(){Ce(this.sourceListenerKey_),this.sourceListenerKey_=null}},Sg="imageloadstart",Eg="imageloadend",Ig="imageloaderror";class Pg extends qt{constructor(t,e){super(t),this.image=e}}function Tg(t,e){t.getImage().src=e}const kg=class extends $u{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();if(e){t=e[Qt(e,t,0)]}return t}getImage(t,e,n,i){const r=this.getProjection();if(!r||!i||Ni(r,i))return r&&(i=r),this.getImageInternal(t,e,n,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ni(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&vn(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Cg(r,i,t,e,n,((t,e,n)=>this.getImageInternal(t,e,n,r)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,n,i){if(this.loader){const r=function(t,e,n,i){const r=e/n,o=Tn(t),s=fi(An(t)/r,4),a=fi(Ln(t)/r,4),l=fi((i-1)*s/2,4),u=s+2*l,h=fi((i-1)*a/2,4);return Dn(o,r,0,[u,a+2*h])}(t,e,n,1),o=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&cn(this.wantedExtent_,r)||cn(this.image.getExtent(),r))&&(this.wantedResolution_&&bg(this.wantedResolution_)===o||bg(this.image.getResolution())===o)))return this.image;this.wantedProjection_=i,this.wantedExtent_=r,this.wantedResolution_=o,this.image=new Da(r,o,n,this.loader),this.image.addEventListener(ce,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let n;switch(e.getState()){case po:this.loading=!0,n=Sg;break;case fo:this.loading=!1,n=Eg;break;case go:this.loading=!1,n=Ig;break;default:return}this.hasListener(n)&&this.dispatchEvent(new Pg(n,e))}};let Dg,Mg=!0;try{new ImageData(10,10)}catch(Vj){Mg=!1}function Lg(t){let e=!0;try{new ImageData(10,10)}catch(Vj){e=!1}function n(t,n,i){return e?new ImageData(t,n,i):{data:t,width:n,height:i}}return function(e){const i=e.buffers,r=e.meta,o=e.imageOps,s=e.width,a=e.height,l=i.length,u=i[0].byteLength;if(o){const e=new Array(l);for(let t=0;t<l;++t)e[t]=n(new Uint8ClampedArray(i[t]),s,a);return t(e,r).data.buffer}const h=new Uint8ClampedArray(u),c=new Array(l),d=new Array(l);for(let t=0;t<l;++t)c[t]=new Uint8ClampedArray(i[t]),d[t]=[0,0,0,0];for(let n=0;n<u;n+=4){for(let t=0;t<l;++t){const e=c[t];d[t][0]=e[n],d[t][1]=e[n+1],d[t][2]=e[n+2],d[t][3]=e[n+3]}const e=t(d,r);h[n]=e[0],h[n+1]=e[1],h[n+2]=e[2],h[n+3]=e[3]}return h.buffer}}function Rg(t,e){const n=Object.keys(t.lib||{}).map((function(e){return"const "+e+" = "+t.lib[e].toString()+";"})).concat(["const __minion__ = ("+Lg.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),i=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+Buffer.from(n.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(n,{type:"text/javascript"})));return i.addEventListener("message",e),i}class Og extends Kt{constructor(t){let e;super(),this._imageOps=!!t.imageOps,e=0===t.threads?0:this._imageOps?1:t.threads||1;const n=new Array(e);if(e)for(let i=0;i<e;++i)n[i]=Rg(t,this._onWorkerMessage.bind(this,i));else n[0]=function(t,e){const n=Lg(t.operation);let i=!1;return{postMessage:function(t){setTimeout((function(){i||e({data:{buffer:n(t),meta:t.meta}})}),0)},terminate:function(){i=!0}}}(t,this._onWorkerMessage.bind(this,0));this._workers=n,this._queue=[],this._maxQueueLength=t.queue||1/0,this._running=0,this._dataLookup={},this._job=null}process(t,e,n){this._enqueue({inputs:t,meta:e,callback:n}),this._dispatch()}_enqueue(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}_dispatch(){if(this._running||0===this._queue.length)return;const t=this._queue.shift();this._job=t;const e=t.inputs[0].width,n=t.inputs[0].height,i=t.inputs.map((function(t){return t.data.buffer})),r=this._workers.length;if(this._running=r,1===r)return void this._workers[0].postMessage({buffers:i,meta:t.meta,imageOps:this._imageOps,width:e,height:n},i);const o=t.inputs[0].data.length,s=4*Math.ceil(o/4/r);for(let a=0;a<r;++a){const r=a*s,o=[];for(let t=0,e=i.length;t<e;++t)o.push(i[t].slice(r,r+s));this._workers[a].postMessage({buffers:o,meta:t.meta,imageOps:this._imageOps,width:e,height:n},o)}}_onWorkerMessage(t,e){this.disposed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())}_resolveJob(){const t=this._job,e=this._workers.length;let n,i;if(1===e)n=new Uint8ClampedArray(this._dataLookup[0].buffer),i=this._dataLookup[0].meta;else{const r=t.inputs[0].data.length;n=new Uint8ClampedArray(r),i=new Array(e);const o=4*Math.ceil(r/4/e);for(let t=0;t<e;++t){const e=this._dataLookup[t].buffer,r=t*o;n.set(new Uint8ClampedArray(e),r),i[t]=this._dataLookup[t].meta}}this._job=null,this._dataLookup={},t.callback(null,function(t,e,n){if(Mg)return new ImageData(t,e,n);Dg||(Dg=document.createElement("canvas").getContext("2d"));const i=Dg.createImageData(e,n);return i.data.set(t),i}(n,t.inputs[0].width,t.inputs[0].height),i),this._dispatch()}disposeInternal(){for(let t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0}}const Fg="beforeoperations",Ag="afteroperations";class zg extends qt{constructor(t,e,n){super(t),this.extent=e.extent,this.resolution=e.viewState.resolution/e.pixelRatio,this.data=n}}class Bg extends kg{constructor(t){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=void 0!==t.operationType?t.operationType:"pixel",this.threads_=void 0!==t.threads?t.threads:1,this.layers_=function(t){const e=t.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=Ng(t[i]);return n}(t.sources);const e=this.changed.bind(this);for(let i=0,r=this.layers_.length;i<r;++i)this.layers_[i].addEventListener(ce,e);var n;this.useResolutions_=null!==t.resolutions,this.tileQueue_=new zh((function(){return 1}),this.processSources_.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:(n=this.layers_,n.map((function(t){return t.getLayerState()}))),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:Te(this),renderTargets:{}},this.setAttributions((function(e){const n=[];for(let i=0,r=t.sources.length;i<r;++i){const r=t.sources[i],o=r instanceof $u?r:r.getSource();if(!o)continue;const s=o.getAttributions();if("function"==typeof s){const t=s(e);n.push.apply(n,t)}}return 0!==n.length?n:null})),void 0!==t.operation&&this.setOperation(t.operation,t.lib)}setOperation(t,e){this.processor_&&this.processor_.dispose(),this.processor_=new Og({operation:t,imageOps:"image"===this.operationType_,queue:1,lib:e,threads:this.threads_}),this.changed()}updateFrameState_(t,e,n){const i=Object.assign({},this.frameState_);i.viewState=Object.assign({},i.viewState);const r=Tn(t);i.size[0]=Math.ceil(An(t)/e),i.size[1]=Math.ceil(Ln(t)/e),i.extent=[r[0]-i.size[0]*e/2,r[1]-i.size[1]*e/2,r[0]+i.size[0]*e/2,r[1]+i.size[1]*e/2],i.time=Date.now();const o=i.viewState;return o.center=r,o.projection=n,o.resolution=e,i}allSourcesReady_(){let t,e=!0;for(let n=0,i=this.layers_.length;n<i;++n)if(t=this.layers_[n].getSource(),!t||"ready"!==t.getState()){e=!1;break}return e}getImage(t,e,n,i){if(!this.allSourcesReady_())return null;this.tileQueue_.loadMoreTiles(16,16),e=this.findNearestResolution(e);const r=this.updateFrameState_(t,e,i);if(this.requestedFrameState_=r,this.renderedImageCanvas_){const t=this.renderedImageCanvas_.getResolution(),n=this.renderedImageCanvas_.getExtent();e===t&&vn(r.extent,n)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),r.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){const t=this.requestedFrameState_,e=this.layers_.length,n=new Array(e);for(let r=0;r<e;++r){t.layerIndex=r,t.renderTargets={};const e=Gg(this.layers_[r],t);if(!e)return;n[r]=e}const i={};this.dispatchEvent(new zg(Fg,t,i)),this.processor_.process(n,i,this.onWorkerComplete_.bind(this,t))}onWorkerComplete_(t,e,n,i){if(e||!n)return;const r=t.extent,o=t.viewState.resolution;if(o!==this.requestedFrameState_.viewState.resolution||!vn(r,this.requestedFrameState_.extent))return;let s;if(this.renderedImageCanvas_)s=this.renderedImageCanvas_.getImage().getContext("2d");else{s=Go(Math.round(An(r)/o),Math.round(Ln(r)/o)),this.renderedImageCanvas_=new lh(r,o,1,s.canvas)}s.putImageData(n,0,0),t.animate?requestAnimationFrame(this.changed.bind(this)):this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new zg(Ag,t,i))}getResolutions(t){if(!this.useResolutions_)return null;let e=super.getResolutions();if(!e)for(let n=0,i=this.layers_.length;n<i;++n){if(e=this.layers_[n].getSource().getResolutions(t),e)break}return e}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}Bg.prototype.dispose;let jg=null;function Gg(t,e){const n=t.getRenderer();if(!n)throw new Error("Unsupported layer type: "+t);if(!n.prepareFrame(e))return null;const i=e.size[0],r=e.size[1];if(0===i||0===r)return null;const o=n.renderFrame(e,null);let s;if(o instanceof HTMLCanvasElement)s=o;else{if(o&&(s=o.firstElementChild),!(s instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+s);if(s.width===i&&s.height===r){return s.getContext("2d").getImageData(0,0,i,r)}}if(jg){const t=jg.canvas;t.width!==i||t.height!==r?jg=Go(i,r,void 0,{willReadFrequently:!0}):jg.clearRect(0,0,i,r)}else jg=Go(i,r,void 0,{willReadFrequently:!0});return jg.drawImage(s,0,0,i,r),jg.getImageData(0,0,i,r)}function Ng(t){let e;return t instanceof $u?t instanceof Wf?e=new rg({source:t}):t instanceof kg&&(e=new xg({source:t})):e=t,e}const Vg=Bg;const Hg=class extends Jf{constructor(t){if(super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:Ai("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)!function(t,e,n,i){const r=document.createElement("script"),o="olc_"+Te(e);function s(){delete window[o],r.parentNode.removeChild(r)}r.async=!0,r.src=t+(t.includes("?")?"&":"?")+(i||"callback")+"="+o;const a=setTimeout((function(){s(),n&&n()}),1e4);window[o]=function(t){clearTimeout(a),s(),e(t)},document.head.appendChild(r)}(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else{if(!t.tileJSON)throw new Error("Either `url` or `tileJSON` options must be provided");this.handleTileJSONResponse(t.tileJSON)}}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let t;try{t=JSON.parse(e.responseText)}catch(n){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=Ai("EPSG:4326"),n=this.getProjection();let i;if(void 0!==t.bounds){const r=Vi(e,n);i=jn(t.bounds,r)}const r=Vf(n),o=t.minzoom||0,s=Gf({extent:r,maxZoom:t.maxzoom||22,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=s,this.tileUrlFunction=Uf(t.tiles,s),t.attribution&&!this.getAttributions()){const e=void 0!==i?i:r;this.setAttributions((function(n){return zn(e,n.extent)?[t.attribution]:null}))}this.tileJSON_=t,this.setState("ready")}handleTileJSONError(){this.setState("error")}},Wg={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Xg={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};const Ug=class extends ig{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=[1,0,0,1,0,0]}prepareTile(t,e,n){let i;const r=t.getState();return r!==uh.LOADED&&r!==uh.ERROR||(this.updateExecutorGroup_(t,e,n),this.tileImageNeedsRender_(t)&&(i=!0)),i}getTile(t,e,n,i){const r=i.pixelRatio,o=i.viewState,s=o.resolution,a=o.projection,l=this.getLayer(),u=l.getSource().getTile(t,e,n,r,a),h=i.viewHints,c=!(h[Vs]||h[Hs]);!c&&u.wantedResolution||(u.wantedResolution=s);return this.prepareTile(u,r,a)&&(c||Date.now()-i.time<8)&&"vector"!==l.getRenderMode()&&this.renderTileImage_(u,i),super.getTile(t,e,n,i)}isDrawableTile(t){const e=this.getLayer();return super.isDrawableTile(t)&&("vector"===e.getRenderMode()?Te(e)in t.executorGroups:t.hasContext(e))}getTileImage(t){return t.getImage(this.getLayer())}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,n){const i=this.getLayer(),r=i.getRevision(),o=i.getRenderOrder()||null,s=t.wantedResolution,a=t.getReplayState(i);if(!a.dirty&&a.renderedResolution===s&&a.renderedRevision==r&&a.renderedRenderOrder==o)return;const l=i.getSource(),u=i.getDeclutter(),h=l.getTileGrid(),c=l.getTileGridForProjection(n).getTileCoordExtent(t.wrappedTileCoord),d=l.getSourceTiles(e,n,t),p=Te(i);delete t.hitDetectionImageData[p],t.executorGroups[p]=[],u&&(t.declutterExecutorGroups[p]=[]),a.dirty=!1;for(let f=0,g=d.length;f<g;++f){const n=d[f];if(n.getState()!=uh.LOADED)continue;const r=n.tileCoord,g=h.getTileCoordExtent(r),m=Rn(c,g),_=an(m,i.getRenderBuffer()*s,this.tmpExtent),y=vn(g,m)?null:_,v=new Kl(0,_,s,e),w=u?new Kl(0,m,s,e):void 0,x=Su(s,e),b=function(t){let e;const n=t.getStyleFunction()||i.getStyleFunction();if(n&&(e=n(t,s)),e){const n=this.renderFeature(t,x,e,v,w);a.dirty=a.dirty||n}},C=n.getFeatures();o&&o!==a.renderedRenderOrder&&C.sort(o);for(let t=0,e=C.length;t<e;++t){const e=C[t];y&&!zn(y,e.getGeometry().getExtent())||b.call(this,e)}const S=v.finish(),E="vector"!==i.getRenderMode()&&u&&1===d.length?null:m,I=new mu(E,s,e,l.getOverlaps(),S,i.getRenderBuffer());if(t.executorGroups[p].push(I),w){const n=new mu(null,s,e,l.getOverlaps(),w.finish(),i.getRenderBuffer());t.declutterExecutorGroups[p].push(n)}}a.renderedRevision=r,a.renderedRenderOrder=o,a.renderedResolution=s}forEachFeatureAtCoordinate(t,e,n,i,r){const o=e.viewState.resolution,s=e.viewState.rotation;n=null==n?0:n;const a=this.getLayer(),l=a.getSource().getTileGridForProjection(e.viewState.projection),u=sn([t]);an(u,o*n,u);const h={},c=function(t,e,n){let o=t.getId();void 0===o&&(o=Te(t));const s=h[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return h[o]=!0,r.splice(r.lastIndexOf(s),1),i(t,a,e);s.geometry=e,s.distanceSq=n}}else{if(0===n)return h[o]=!0,i(t,a,e);r.push(h[o]={feature:t,layer:a,geometry:e,distanceSq:n,callback:i})}},d=this.renderedTiles;let p;for(let f=0,g=d.length;!p&&f<g;++f){const i=d[f];if(!zn(l.getTileCoordExtent(i.wrappedTileCoord),u))continue;const r=Te(a),h=[i.executorGroups[r]],g=i.declutterExecutorGroups[r];g&&h.push(g),h.some((i=>{const r=i===g?e.declutterTree.all().map((t=>t.value)):null;for(let e=0,a=i.length;e<a;++e){const a=i[e];if(p=a.forEachFeatureAtCoordinate(t,o,s,n,c,r),p)return!0}}))}return p}getFeatures(t){return new Promise(((e,n)=>{const i=this.getLayer(),r=Te(i),o=i.getSource(),s=this.renderedProjection,a=s.getExtent(),l=this.renderedResolution,u=o.getTileGridForProjection(s),h=Je(this.renderedPixelToCoordinateTransform_,t.slice()),c=u.getTileCoordForCoordAndResolution(h,l);let d;for(let t=0,_=this.renderedTiles.length;t<_;++t)if(c.toString()===this.renderedTiles[t].tileCoord.toString()){if(d=this.renderedTiles[t],d.getState()===uh.LOADED){const t=u.getTileCoordExtent(d.tileCoord);o.getWrapX()&&s.canWrapX()&&!cn(a,t)&&xi(h,s);break}d=void 0}if(!d||d.loadingSourceTiles>0)return void e([]);const p=On(u.getTileCoordExtent(d.wrappedTileCoord)),f=[(h[0]-p[0])/l,(p[1]-h[1])/l],g=d.getSourceTiles().reduce((function(t,e){return t.concat(e.getFeatures())}),[]);let m=d.hitDetectionImageData[r];if(!m){const t=yo(u.getTileSize(u.getZForResolution(l,o.zDirection))),e=this.renderedRotation_;m=vu(t,[this.getRenderTransform(u.getTileCoordCenter(d.wrappedTileCoord),l,0,yu,t[0]*yu,t[1]*yu,0)],g,i.getStyleFunction(),u.getTileCoordExtent(d.wrappedTileCoord),d.getReplayState(i).renderedResolution,e),d.hitDetectionImageData[r]=m}e(wu(f,g,m))}))}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&void 0!==this.renderedLayerRevision_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t){const e=this.context,n=e.globalAlpha;e.globalAlpha=this.getLayer().getOpacity();const i=t.viewHints,r=!(i[Vs]||i[Hs]),o=this.renderedTiles;for(let s=0,a=o.length;s<a;++s){const e=o[s],n=e.declutterExecutorGroups[Te(this.getLayer())];if(n)for(let i=n.length-1;i>=0;--i)n[i].execute(this.context,1,this.getTileRenderTransform(e,t),t.viewState.rotation,r,void 0,t.declutterTree)}e.globalAlpha=n}getTileRenderTransform(t,e){const n=e.pixelRatio,i=e.viewState,r=i.center,o=i.resolution,s=i.rotation,a=e.size,l=Math.round(a[0]*n),u=Math.round(a[1]*n),h=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),c=t.tileCoord,d=h.getTileCoordExtent(t.wrappedTileCoord),p=h.getTileCoordExtent(c,this.tmpExtent)[0]-d[0];return Ze(Qe(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(r,o,s,n,l,u,p))}postRender(t,e){const n=e.viewHints,i=!(n[Vs]||n[Hs]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation;const r=this.getLayer(),o=r.getRenderMode(),s=t.globalAlpha;t.globalAlpha=r.getOpacity();const a=Xg[o],l=e.viewState,u=l.rotation,h=r.getSource(),c=h.getTileGridForProjection(l.projection).getZForResolution(l.resolution,h.zDirection),d=this.renderedTiles,p=[],f=[];let g=!0;for(let m=d.length-1;m>=0;--m){const n=d[m];g=g&&!n.getReplayState(r).dirty;const o=n.executorGroups[Te(r)].filter((t=>t.hasExecutors(a)));if(0===o.length)continue;const s=this.getTileRenderTransform(n,e),l=n.tileCoord[0];let h=!1;const _=o[0].getClipCoords(s);if(_){for(let e=0,n=p.length;e<n;++e)if(c!==l&&l<f[e]){const n=p[e];zn([_[0],_[3],_[4],_[7]],[n[0],n[3],n[4],n[7]])&&(h||(t.save(),h=!0),t.beginPath(),t.moveTo(_[0],_[1]),t.lineTo(_[2],_[3]),t.lineTo(_[4],_[5]),t.lineTo(_[6],_[7]),t.moveTo(n[6],n[7]),t.lineTo(n[4],n[5]),t.lineTo(n[2],n[3]),t.lineTo(n[0],n[1]),t.clip())}p.push(_),f.push(l)}for(let e=0,r=o.length;e<r;++e){o[e].execute(t,1,s,u,i,a)}h&&t.restore()}t.globalAlpha=s,this.ready=g,super.postRender(t,e)}renderFeature(t,e,n,i,r){if(!n)return!1;let o=!1;if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)o=Iu(i,t,n[s],e,this.boundHandleStyleImageChange_,void 0,r)||o;else o=Iu(i,t,n,e,this.boundHandleStyleImageChange_,void 0,r);return o}tileImageNeedsRender_(t){const e=this.getLayer();if("vector"===e.getRenderMode())return!1;const n=t.getReplayState(e),i=e.getRevision(),r=t.wantedResolution;return n.renderedTileResolution!==r||n.renderedTileRevision!==i}renderTileImage_(t,e){const n=this.getLayer(),i=t.getReplayState(n),r=n.getRevision(),o=t.executorGroups[Te(n)];i.renderedTileRevision=r;const s=t.wrappedTileCoord,a=s[0],l=n.getSource();let u=e.pixelRatio;const h=e.viewState.projection,c=l.getTileGridForProjection(h),d=c.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*d,f=c.getResolution(a),g=t.getContext(n);u=Math.round(Math.max(u,p/u));const m=l.getTilePixelSize(a,u,h);g.canvas.width=m[0],g.canvas.height=m[1];const _=u/p;if(1!==_){const t=qe(this.tmpTransform_);Qe(t,_,_),g.setTransform.apply(g,t)}const y=c.getTileCoordExtent(s,this.tmpExtent),v=p/f,w=qe(this.tmpTransform_);Qe(w,v,-v),function(t,e,n){Ze(t,Ke(Ye,1,0,0,1,e,n))}(w,-y[0],-y[3]);for(let x=0,b=o.length;x<b;++x){o[x].execute(g,_,w,0,!0,Wg[n.getRenderMode()])}i.renderedTileResolution=t.wantedResolution}};const $g=class extends Fl{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un;const n=t.renderMode||"hybrid";Ae("hybrid"==n||"vector"==n,"`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),this.getBackground,this.setBackground}createRenderer(){return new Ug(this)}getFeatures(t){return super.getFeatures(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(tg)}getUseInterimTilesOnError(){return this.get(eg)}setPreload(t){this.set(tg,t)}setUseInterimTilesOnError(t){this.set(eg,t)}};const Yg=class extends Zf{constructor(t){const e=t.projection||"EPSG:3857",n=t.extent||Vf(e),i=t.tileGrid||Gf({extent:n,maxResolution:t.maxResolution,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,opaque:!1,projection:e,state:t.state,tileGrid:i,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:qg,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache=new Nc(this.tileCache.highWaterMark),this.overlaps_=null==t.overlaps||t.overlaps,this.tileClass=t.tileClass?t.tileClass:$c,this.tileGrids_={}}getFeaturesInExtent(t){const e=[],n=this.tileCache;if(0===n.getCount())return e;const i=Gc(n.peekFirstKey())[0],r=this.tileGrid;return n.forEach((function(n){if(n.tileCoord[0]!==i||n.getState()!==uh.LOADED)return;const o=n.getSourceTiles();for(let i=0,s=o.length;i<s;++i){const n=o[i],s=n.tileCoord;if(zn(t,r.getTileCoordExtent(s))){const i=n.getFeatures();if(i)for(let n=0,r=i.length;n<r;++n){const r=i[n],o=r.getGeometry();zn(t,o.getExtent())&&e.push(r)}}}})),e}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(t,e){const n=this.getTileCacheForProjection(t),i=Object.keys(e).reduce(((t,e)=>{const i=function(t){const[e,n,i]=t.substring(t.lastIndexOf("/")+1,t.length).split(",").map(Number);return Bc(e,n,i)}(e),r=n.peek(i);if(r){const e=r.sourceTiles;for(let n=0,i=e.length;n<i;++n)t[e[n].getKey()]=!0}return t}),{});super.expireCache(t,e),this.sourceTileCache.expireCache(i)}getSourceTiles(t,e,n){if(n.getState()===uh.IDLE){n.setState(uh.LOADING);const i=n.wrappedTileCoord,r=this.getTileGridForProjection(e),o=r.getTileCoordExtent(i),s=i[0],a=r.getResolution(s);an(o,-a,o);const l=this.tileGrid,u=l.getExtent();u&&Rn(o,u,o);const h=l.getZForResolution(a,this.zDirection);l.forEachTileCoord(o,h,(i=>{const r=this.tileUrlFunction(i,t,e),o=this.sourceTileCache.containsKey(r)?this.sourceTileCache.get(r):new this.tileClass(i,r?uh.IDLE:uh.EMPTY,r,this.format_,this.tileLoadFunction);n.sourceTiles.push(o);const s=o.getState();if(s<uh.LOADED){const t=e=>{this.handleTileChange(e);const i=o.getState();if(i===uh.LOADED||i===uh.ERROR){const e=o.getKey();e in n.errorTileKeys?o.getState()===uh.LOADED&&delete n.errorTileKeys[e]:n.loadingSourceTiles--,i===uh.ERROR?n.errorTileKeys[e]=!0:o.removeEventListener(ce,t),0===n.loadingSourceTiles&&n.setState(ue(n.errorTileKeys)?uh.LOADED:uh.ERROR)}};o.addEventListener(ce,t),n.loadingSourceTiles++}s===uh.IDLE&&(o.extent=l.getTileCoordExtent(i),o.projection=e,o.resolution=l.getResolution(i[0]),this.sourceTileCache.set(r,o),o.load())})),n.loadingSourceTiles||n.setState(n.sourceTiles.some((t=>t.getState()===uh.ERROR))?uh.ERROR:uh.LOADED)}return n.sourceTiles}getTile(t,e,n,i,r){const o=Bc(t,e,n),s=this.getKey();let a;if(this.tileCache.containsKey(o)&&(a=this.tileCache.get(o),a.key===s))return a;const l=[t,e,n];let u=this.getTileCoordForTileUrlFunction(l,r);const h=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(r);if(u&&h){const e=c.getTileCoordExtent(u);an(e,-c.getResolution(t),e),zn(h,e)||(u=null)}let d=!0;if(null!==u){const e=this.tileGrid,n=c.getResolution(t),o=e.getZForResolution(n,1),s=c.getTileCoordExtent(u);an(s,-n,s),e.forEachTileCoord(s,o,(t=>{d=d&&!this.tileUrlFunction(t,i,r)}))}const p=new Uc(l,d?uh.EMPTY:uh.IDLE,u,this.getSourceTiles.bind(this,i,r));return p.key=s,a?(p.interimTile=a,p.refreshInterimChain(),this.tileCache.replace(o,p)):this.tileCache.set(o,p),p}getTileGridForProjection(t){const e=t.getCode();let n=this.tileGrids_[e];if(!n){const t=this.tileGrid,i=t.getResolutions().slice(),r=i.map((function(e,n){return t.getOrigin(n)})),o=i.map((function(e,n){return t.getTileSize(n)})),s=Xs+1;for(let e=i.length;e<s;++e)i.push(i[e-1]/2),r.push(r[e-1]),o.push(o[e-1]);n=new Bf({extent:t.getExtent(),origins:r,resolutions:i,tileSizes:o}),this.tileGrids_[e]=n}return n}getTilePixelRatio(t){return t}getTilePixelSize(t,e,n){const i=yo(this.getTileGridForProjection(n).getTileSize(t),this.tmpSize);return[Math.round(i[0]*e),Math.round(i[1]*e)]}updateCacheSize(t,e){super.updateCacheSize(2*t,e),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(e).highWaterMark}};function qg(t,e){t.setLoader((function(n,i,r){rh(e,t.getFormat(),n,i,r,t.onLoad.bind(t),t.onError.bind(t))}))}function Zg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kg,Jg={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Qg(t){return(t=Math.round(t))<0?0:t>255?255:t}function tm(t){return t<0?0:t>1?1:t}function em(t){return"%"===t[t.length-1]?Qg(parseFloat(t)/100*255):Qg(parseInt(t))}function nm(t){return"%"===t[t.length-1]?tm(parseFloat(t)/100):tm(parseFloat(t))}function im(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Kg={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Jg)return Jg[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var o=n.substr(0,i),s=n.substr(i+1,r-(i+1)).split(","),a=1;switch(o){case"rgba":if(4!==s.length)return null;a=nm(s.pop());case"rgb":return 3!==s.length?null:[em(s[0]),em(s[1]),em(s[2]),a];case"hsla":if(4!==s.length)return null;a=nm(s.pop());case"hsl":if(3!==s.length)return null;var l=(parseFloat(s[0])%360+360)%360/360,u=nm(s[1]),h=nm(s[2]),c=h<=.5?h*(u+1):h+u-h*u,d=2*h-c;return[Qg(255*im(d,c,l+1/3)),Qg(255*im(d,c,l)),Qg(255*im(d,c,l-1/3)),a];default:return null}}return null}}catch(Hj){}class rm{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static parse(t){if(!t)return;if(t instanceof rm)return t;if("string"!=typeof t)return;const e=Kg(t);return e?new rm(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,i]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${i})`}toArray(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]}toArray01(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[t/i,e/i,n/i,i]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:n,a:i}=this;return[t,e,n,i]}}rm.black=new rm(0,0,0,1),rm.white=new rm(1,1,1,1),rm.transparent=new rm(0,0,0,0),rm.red=new rm(1,0,0,1),rm.blue=new rm(0,0,1,1);var om=rm;function sm(t){return"object"==typeof t?["literal",t]:t}function am(t,e){let n=t.stops;if(!n)return function(t,e){const n=["get",t.property];if(void 0===t.default)return"string"===e.type?["string",n]:n;if("enum"===e.type)return["match",n,Object.keys(e.values),n,t.default];{const i=["color"===e.type?"to-color":e.type,n,sm(t.default)];return"array"===e.type&&i.splice(1,0,e.value,e.length||null),i}}(t,e);const i=n&&"object"==typeof n[0][0],r=i||void 0!==t.property,o=i||!r;return n=n.map((t=>!r&&e.tokens&&"string"==typeof t[1]?[t[0],fm(t[1])]:[t[0],sm(t[1])])),i?function(t,e,n){const i={},r={},o=[];for(let a=0;a<n.length;a++){const e=n[a],s=e[0].zoom;void 0===i[s]&&(i[s]={zoom:s,type:t.type,property:t.property,default:t.default},r[s]=[],o.push(s)),r[s].push([e[0].value,e[1]])}const s=pm({},e);if("exponential"===s){const n=[lm(t),["linear"],["zoom"]];for(const t of o){dm(n,t,hm(i[t],e,r[t]),!1)}return n}{const t=["step",["zoom"]];for(const n of o){dm(t,n,hm(i[n],e,r[n]),!0)}return cm(t),t}}(t,e,n):o?function(t,e,n,i=["zoom"]){const r=pm(t,e);let o,s=!1;if("interval"===r)o=["step",i],s=!0;else{if("exponential"!==r)throw new Error(`Unknown zoom function type "${r}"`);{const e=void 0!==t.base?t.base:1;o=[lm(t),1===e?["linear"]:["exponential",e],i]}}for(const a of n)dm(o,a[0],a[1],s);return cm(o),o}(t,e,n):hm(t,e,n)}function lm(t){switch(t.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function um(t,e){const n=sm((i=t.default,r=e.default,void 0!==i?i:void 0!==r?r:void 0));var i,r;return void 0===n&&"resolvedImage"===e.type?"":n}function hm(t,e,n){const i=pm(t,e),r=["get",t.property];if("categorical"===i&&"boolean"==typeof n[0][0]){const i=["case"];for(const t of n)i.push(["==",r,t[0]],t[1]);return i.push(um(t,e)),i}if("categorical"===i){const i=["match",r];for(const t of n)dm(i,t[0],t[1],!1);return i.push(um(t,e)),i}if("interval"===i){const e=["step",["number",r]];for(const t of n)dm(e,t[0],t[1],!0);return cm(e),void 0===t.default?e:["case",["==",["typeof",r],"number"],e,sm(t.default)]}if("exponential"===i){const e=void 0!==t.base?t.base:1,i=[lm(t),1===e?["linear"]:["exponential",e],["number",r]];for(const t of n)dm(i,t[0],t[1],!1);return void 0===t.default?i:["case",["==",["typeof",r],"number"],i,sm(t.default)]}throw new Error(`Unknown property function type ${i}`)}function cm(t){"step"===t[0]&&3===t.length&&(t.push(0),t.push(t[3]))}function dm(t,e,n,i){t.length>3&&e===t[t.length-2]||(i&&2===t.length||t.push(e),t.push(n))}function pm(t,e){return t.type?t.type:e.expression.interpolated?"exponential":"interval"}function fm(t){const e=["concat"],n=/{([^{}]+)}/g;let i=0;for(let r=n.exec(t);null!==r;r=n.exec(t)){const o=t.slice(i,n.lastIndex-r[0].length);i=n.lastIndex,o.length>0&&e.push(o),e.push(["get",r[1]])}if(1===e.length)return t;if(i<t.length)e.push(t.slice(i));else if(2===e.length)return["to-string",e[1]];return e}class gm extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var mm=gm;class _m{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[n,i]of e)this.bindings[n]=i}concat(t){return new _m(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ym=_m;const vm={kind:"null"},wm={kind:"number"},xm={kind:"string"},bm={kind:"boolean"},Cm={kind:"color"},Sm={kind:"object"},Em={kind:"value"},Im={kind:"collator"},Pm={kind:"formatted"},Tm={kind:"resolvedImage"};function km(t,e){return{kind:"array",itemType:t,N:e}}function Dm(t){if("array"===t.kind){const e=Dm(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Mm=[vm,wm,xm,bm,Cm,Pm,Sm,km(Em),Tm];function Lm(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Lm(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Mm)if(!Lm(t,e))return null}return`Expected ${Dm(t)} but found ${Dm(e)} instead.`}function Rm(t,e){return e.some((e=>e.kind===t.kind))}function Om(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}class Fm{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Am{constructor(t,e,n,i,r){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}}class zm{constructor(t){this.sections=t}static fromString(t){return new zm([new Am(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof zm?t:zm.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class Bm{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Bm({name:t,available:!1}):null}serialize(){return["image",this.name]}}function jm(t,e,n,i){if(!("number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255)){return`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}return void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`}function Gm(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof om)return!0;if(t instanceof Fm)return!0;if(t instanceof zm)return!0;if(t instanceof Bm)return!0;if(Array.isArray(t)){for(const e of t)if(!Gm(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Gm(t[e]))return!1;return!0}return!1}function Nm(t){if(null===t)return vm;if("string"==typeof t)return xm;if("boolean"==typeof t)return bm;if("number"==typeof t)return wm;if(t instanceof om)return Cm;if(t instanceof Fm)return Im;if(t instanceof zm)return Pm;if(t instanceof Bm)return Tm;if(Array.isArray(t)){const e=t.length;let n;for(const i of t){const t=Nm(i);if(n){if(n===t)continue;n=Em;break}n=t}return km(n||Em,e)}return Sm}function Vm(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof om||t instanceof zm||t instanceof Bm?t.toString():JSON.stringify(t)}class Hm{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Gm(t[1]))return e.error("invalid value");const n=t[1];let i=Nm(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new Hm(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof om?["rgba"].concat(this.value.toArray()):this.value instanceof zm?this.value.serialize():this.value}}var Wm=Hm;var Xm=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Um={string:xm,number:wm,boolean:bm,object:Sm};class $m{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,o;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in Um)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=Um[n],i++}else r=Em;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],i++}n=km(r,o)}else n=Um[r];const o=[];for(;i<t.length;i++){const n=e.parse(t[i],i,Em);if(!n)return null;o.push(n)}return new $m(n,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!Lm(this.type,Nm(n)))return n;if(e===this.args.length-1)throw new Xm(`Expected value to be of type ${Dm(this.type)}, but found ${Dm(Nm(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((t=>t.serialize())))}}var Ym=$m;class qm{constructor(t){this.type=Pm,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let o=1;o<=t.length-1;++o){const n=t[o];if(r&&"object"==typeof n&&!Array.isArray(n)){r=!1;let t=null;if(n["font-scale"]&&(t=e.parse(n["font-scale"],1,wm),!t))return null;let o=null;if(n["text-font"]&&(o=e.parse(n["text-font"],1,km(xm)),!o))return null;let s=null;if(n["text-color"]&&(s=e.parse(n["text-color"],1,Cm),!s))return null;const a=i[i.length-1];a.scale=t,a.font=o,a.textColor=s}else{const n=e.parse(t[o],1,Em);if(!n)return null;const s=n.type.kind;if("string"!==s&&"value"!==s&&"null"!==s&&"resolvedImage"!==s)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:n,scale:null,font:null,textColor:null})}}return new qm(i)}evaluate(t){return new zm(this.sections.map((e=>{const n=e.content.evaluate(t);return Nm(n)===Tm?new Am("",n,null,null,null):new Am(Vm(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class Zm{constructor(t){this.type=Tm,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,xm);return n?new Zm(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=Bm.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Km={"to-boolean":bm,"to-color":Cm,"to-number":wm,"to-string":xm};class Jm{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=Km[n],r=[];for(let o=1;o<t.length;o++){const n=e.parse(t[o],o,Em);if(!n)return null;r.push(n)}return new Jm(i,r)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof om)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:jm(e[0],e[1],e[2],e[3]),!n))return new om(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Xm(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new Xm(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?zm.fromString(Vm(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Bm.fromString(Vm(this.args[0].evaluate(t))):Vm(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new qm([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Zm(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize())})),t}}var Qm=Jm;const t_=["Unknown","Point","LineString","Polygon"];var e_=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?t_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord,r=n*e-t[0],o=i*e-t[1];return this.featureDistanceData.bearing[0]*r+this.featureDistanceData.bearing[1]*o}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=om.parse(t)),e}};class n_{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const n=t[0],i=n_.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,o=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=o.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let a=null;for(const[l,u]of s){a=new D_(e.registry,e.path,null,e.scope);const i=[];let o=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(l)?l[e-1]:l.type,s=a.parse(n,1+i.length,r);if(!s){o=!0;break}i.push(s)}if(!o)if(Array.isArray(l)&&l.length!==i.length)a.error(`Expected ${l.length} arguments, but found ${i.length} instead.`);else{for(let t=0;t<i.length;t++){const e=Array.isArray(l)?l[t]:l.type,n=i[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new n_(n,r,u,i)}}if(1===s.length)e.errors.push(...a.errors);else{const n=(s.length?s:o).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(Dm).join(", ")})`:`(${Dm(e.type)}...)`;var e})).join(" | "),i=[];for(let r=1;r<t.length;r++){const n=e.parse(t[r],1+i.length);if(!n)return null;i.push(Dm(n.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){n_.definitions=e;for(const n in e)t[n]=n_}}var i_=n_;class r_{constructor(t,e,n){this.type=Im,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,bm);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,bm);if(!r)return null;let o=null;return n.locale&&(o=e.parse(n.locale,1,xm),!o)?null:new r_(i,r,o)}evaluate(t){return new Fm(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const o_=8192;function s_(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function a_(t,e){return!(t[0]<=e[0])&&(!(t[2]>=e[2])&&(!(t[1]<=e[1])&&!(t[3]>=e[3])))}function l_(t,e){const n=(180+t[0])/360;const i=(r=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360);var r;const o=Math.pow(2,e.z);return[Math.round(n*o*o_),Math.round(i*o*o_)]}function u_(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],o=t[0]-n[0],s=t[1]-n[1];return i*s-o*r==0&&i*o<=0&&r*s<=0}function h_(t,e){let n=!1;for(let s=0,a=e.length;s<a;s++){const a=e[s];for(let e=0,s=a.length;e<s-1;e++){if(u_(t,a[e],a[e+1]))return!1;i=t,r=a[e],o=a[e+1],r[1]>i[1]!=o[1]>i[1]&&i[0]<(o[0]-r[0])*(i[1]-r[1])/(o[1]-r[1])+r[0]&&(n=!n)}}var i,r,o;return n}function c_(t,e){for(let n=0;n<e.length;n++)if(h_(t,e[n]))return!0;return!1}function d_(t,e,n,i){const r=t[0]-n[0],o=t[1]-n[1],s=e[0]-n[0],a=e[1]-n[1],l=i[0]-n[0],u=i[1]-n[1],h=r*u-l*o,c=s*u-l*a;return h>0&&c<0||h<0&&c>0}function p_(t,e,n,i){const r=[e[0]-t[0],e[1]-t[1]],o=[i[0]-n[0],i[1]-n[1]];return 0!=(s=o)[0]*(a=r)[1]-s[1]*a[0]&&!(!d_(t,e,n,i)||!d_(n,i,t,e));var s,a}function f_(t,e,n){for(const i of n)for(let n=0;n<i.length-1;++n)if(p_(t,e,i[n],i[n+1]))return!0;return!1}function g_(t,e){for(let n=0;n<t.length;++n)if(!h_(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(f_(t[n],t[n+1],e))return!1;return!0}function m_(t,e){for(let n=0;n<e.length;n++)if(g_(t,e[n]))return!0;return!1}function __(t,e,n){const i=[];for(let r=0;r<t.length;r++){const o=[];for(let i=0;i<t[r].length;i++){const s=l_(t[r][i],n);s_(e,s),o.push(s)}i.push(o)}return i}function y_(t,e,n){const i=[];for(let r=0;r<t.length;r++){const o=__(t[r],e,n);i.push(o)}return i}function v_(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}s_(e,t)}function w_(t,e,n,i){const r=Math.pow(2,i.z)*o_,o=[i.x*o_,i.y*o_],s=[];if(!t)return s;for(const a of t)for(const t of a){const i=[t.x+o[0],t.y+o[1]];v_(i,e,n,r),s.push(i)}return s}function x_(t,e,n,i){const r=Math.pow(2,i.z)*o_,o=[i.x*o_,i.y*o_],s=[];if(!t)return s;for(const l of t){const t=[];for(const n of l){const i=[n.x+o[0],n.y+o[1]];s_(e,i),t.push(i)}s.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of s)for(const i of t)v_(i,e,n,r)}var a;return s}class b_{constructor(t,e){this.type=bm,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Gm(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new b_(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new b_(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new b_(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const o=__(e.coordinates,i,r),s=w_(t.geometry(),n,i,r);if(!a_(n,i))return!1;for(const t of s)if(!h_(t,o))return!1}if("MultiPolygon"===e.type){const o=y_(e.coordinates,i,r),s=w_(t.geometry(),n,i,r);if(!a_(n,i))return!1;for(const t of s)if(!c_(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const o=__(e.coordinates,i,r),s=x_(t.geometry(),n,i,r);if(!a_(n,i))return!1;for(const t of s)if(!g_(t,o))return!1}if("MultiPolygon"===e.type){const o=y_(e.coordinates,i,r),s=x_(t.geometry(),n,i,r);if(!a_(n,i))return!1;for(const t of s)if(!m_(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var C_=b_;function S_(t){if(t instanceof i_){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof C_)return!1;let e=!0;return t.eachChild((t=>{e&&!S_(t)&&(e=!1)})),e}function E_(t){if(t instanceof i_&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!E_(t)&&(e=!1)})),e}function I_(t,e){if(t instanceof i_&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!I_(t,e)&&(n=!1)})),n}class P_{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new P_(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var T_=P_;class k_{constructor(t,e=[],n,i=new ym,r=[]){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=i,this.errors=r,this.expectedType=n}parse(t,e,n,i,r={}){return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new Ym(e,[t]):"coerce"===n?new Qm(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof Wm)&&"resolvedImage"!==i.type.kind&&M_(i)){const t=new e_;try{i=new Wm(i.type,i.evaluate(t))}catch(Hj){return this.error(Hj.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new k_(this.registry,i,e||null,r,this.errors)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new mm(n,t))}checkSubtype(t,e){const n=Lm(t,e);return n&&this.error(n),n}}var D_=k_;function M_(t){if(t instanceof T_)return M_(t.boundExpression);if(t instanceof i_&&"error"===t.name)return!1;if(t instanceof r_)return!1;if(t instanceof C_)return!1;const e=t instanceof Qm||t instanceof Ym;let n=!0;return t.eachChild((t=>{n=e?n&&M_(t):n&&t instanceof Wm})),!!n&&(S_(t)&&I_(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]))}function L_(t,e){const n=t.length-1;let i,r,o=0,s=n,a=0;for(;o<=s;)if(a=Math.floor((o+s)/2),i=t[a],r=t[a+1],i<=e){if(a===n||e<r)return a;o=a+1}else{if(!(i>e))throw new Xm("Input is not a number.");s=a-1}return 0}class R_{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[i,r]of n)this.labels.push(i),this.outputs.push(r)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,wm);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let o=1;o<t.length;o+=2){const n=1===o?-1/0:t[o],s=t[o+1],a=o,l=o+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const u=e.parse(s,l,r);if(!u)return null;r=r||u.type,i.push([n,u])}return new R_(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);return n[L_(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var O_=R_,F_=A_;function A_(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}A_.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},A_.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},A_.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},A_.prototype.solveCurveX=function(t,e){var n,i,r,o,s;for(void 0===e&&(e=1e-6),r=t,s=0;s<8;s++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?n=r:i=r,r=.5*(i-n)+n}return r},A_.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var z_=Zg(F_);function B_(t,e,n){return t*(1-n)+e*n}var j_=Object.freeze({__proto__:null,number:B_,color:function(t,e,n){return new om(B_(t.r,e.r,n),B_(t.g,e.g,n),B_(t.b,e.b,n),B_(t.a,e.a,n))},array:function(t,e,n){return t.map(((t,i)=>B_(t,e[i],n)))}});const G_=.95047,N_=1,V_=1.08883,H_=4/29,W_=6/29,X_=3*W_*W_,U_=W_*W_*W_,$_=Math.PI/180,Y_=180/Math.PI;function q_(t){return t>U_?Math.pow(t,1/3):t/X_+H_}function Z_(t){return t>W_?t*t*t:X_*(t-H_)}function K_(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function J_(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Q_(t){const e=J_(t.r),n=J_(t.g),i=J_(t.b),r=q_((.4124564*e+.3575761*n+.1804375*i)/G_),o=q_((.2126729*e+.7151522*n+.072175*i)/N_);return{l:116*o-16,a:500*(r-o),b:200*(o-q_((.0193339*e+.119192*n+.9503041*i)/V_)),alpha:t.a}}function ty(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=N_*Z_(e),n=G_*Z_(n),i=V_*Z_(i),new om(K_(3.2404542*n-1.5371385*e-.4985314*i),K_(-.969266*n+1.8760108*e+.041556*i),K_(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function ey(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const ny={forward:Q_,reverse:ty,interpolate:function(t,e,n){return{l:B_(t.l,e.l,n),a:B_(t.a,e.a,n),b:B_(t.b,e.b,n),alpha:B_(t.alpha,e.alpha,n)}}},iy={forward:function(t){const{l:e,a:n,b:i}=Q_(t),r=Math.atan2(i,n)*Y_;return{h:r<0?r+360:r,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*$_,n=t.c;return ty({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:ey(t.h,e.h,n),c:B_(t.c,e.c,n),l:B_(t.l,e.l,n),alpha:B_(t.alpha,e.alpha,n)}}};class ry{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[o,s]of r)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(t,e,n,i){let r=0;if("exponential"===t.name)r=oy(e,t.base,n,i);else if("linear"===t.name)r=oy(e,1,n,i);else if("cubic-bezier"===t.name){const o=t.controlPoints;r=new z_(o[0],o[1],o[2],o[3]).solve(oy(e,1,n,i))}return r}static parse(t,e){let[n,i,r,...o]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,wm),!r)return null;const s=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=Cm:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let l=0;l<o.length;l+=2){const t=o[l],n=o[l+1],i=l+3,r=l+4;if("number"!=typeof t)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(s.length&&s[s.length-1][0]>=t)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);const u=e.parse(n,r,a);if(!u)return null;a=a||u.type,s.push([t,u])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new ry(a,n,i,r,s):e.error(`Type ${Dm(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const o=L_(e,i),s=e[o],a=e[o+1],l=ry.interpolationFactor(this.interpolation,i,s,a),u=n[o].evaluate(t),h=n[o+1].evaluate(t);return"interpolate"===this.operator?j_[this.type.kind.toLowerCase()](u,h,l):"interpolate-hcl"===this.operator?iy.reverse(iy.interpolate(iy.forward(u),iy.forward(h),l)):ny.reverse(ny.interpolate(ny.forward(u),ny.forward(h),l))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e}}function oy(t,e,n,i){const r=i-n,o=t-n;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}var sy=ry;class ay{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const s of t.slice(1)){const t=e.parse(s,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}const o=i&&r.some((t=>Lm(i,t.type)));return new ay(o?Em:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args){if(i++,n=r.evaluate(t),n&&n instanceof Bm&&!n.available&&(e||(e=n),n=null,i===this.args.length))return e;if(null!==n)break}return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var ly=ay;class uy{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let r=1;r<t.length-1;r+=2){const i=t[r];if("string"!=typeof i)return e.error(`Expected string, but found ${typeof i} instead.`,r);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const o=e.parse(t[r+1],r+1);if(!o)return null;n.push([i,o])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new uy(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}var hy=uy;var cy=class t{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=n.parse(e[1],1,wm),r=n.parse(e[2],2,km(n.expectedType||Em));if(!i||!r)return null;const o=r.type;return new t(o.itemType,i,r)}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new Xm(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new Xm(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new Xm(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}};class dy{constructor(t,e){this.type=bm,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Em),i=e.parse(t[2],2,Em);return n&&i?Rm(n.type,[bm,xm,wm,vm,Em])?new dy(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dm(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!Om(e,["boolean","string","number","null"]))throw new Xm(`Expected first argument to be of type boolean, string, number or null, but found ${Dm(Nm(e))} instead.`);if(!Om(n,["string","array"]))throw new Xm(`Expected second argument to be of type array or string, but found ${Dm(Nm(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var py=dy;class fy{constructor(t,e,n){this.type=wm,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Em),i=e.parse(t[2],2,Em);if(!n||!i)return null;if(!Rm(n.type,[bm,xm,wm,vm,Em]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dm(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,wm);return r?new fy(n,i,r):null}return new fy(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Om(e,["boolean","string","number","null"]))throw new Xm(`Expected first argument to be of type boolean, string, number or null, but found ${Dm(Nm(e))} instead.`);if(!Om(n,["string","array"]))throw new Xm(`Expected second argument to be of type array or string, but found ${Dm(Nm(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var gy=fy;class my{constructor(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},o=[];for(let l=2;l<t.length-1;l+=2){let s=t[l];const a=t[l+1];Array.isArray(s)||(s=[s]);const u=e.concat(l);if(0===s.length)return u.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,Nm(t)))return null}else n=Nm(t);if(void 0!==r[String(t)])return u.error("Branch labels must be unique.");r[String(t)]=o.length}const h=e.parse(a,l,i);if(!h)return null;i=i||h.type,o.push(h)}const s=e.parse(t[1],1,Em);if(!s)return null;const a=e.parse(t[t.length-1],t.length-1,i);return a?"value"!==s.type.kind&&e.concat(1).checkSubtype(n,s.type)?null:new my(n,i,s,r,o,a):null}evaluate(t){const e=this.input.evaluate(t);return(Nm(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],i={};for(const o of e){const t=i[this.cases[o]];void 0===t?(i[this.cases[o]]=n.length,n.push([this.cases[o],[o]])):n[t][1].push(o)}const r=t=>"number"===this.inputType.kind?Number(t):t;for(const[o,s]of n)1===s.length?t.push(r(s[0])):t.push(s.map(r)),t.push(this.outputs[o].serialize());return t.push(this.otherwise.serialize()),t}}var _y=my;class yy{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let o=1;o<t.length-1;o+=2){const r=e.parse(t[o],o,bm);if(!r)return null;const s=e.parse(t[o+1],o+1,n);if(!s)return null;i.push([r,s]),n=n||s.type}const r=e.parse(t[t.length-1],t.length-1,n);return r?new yy(n,i,r):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var vy=yy;class wy{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,Em),i=e.parse(t[2],2,wm);if(!n||!i)return null;if(!Rm(n.type,[km(Em),xm,Em]))return e.error(`Expected first argument to be of type array or string, but found ${Dm(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,wm);return r?new wy(n.type,n,i,r):null}return new wy(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Om(e,["string","array"]))throw new Xm(`Expected first argument to be of type array or string, but found ${Dm(Nm(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var xy=wy;function by(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Cy(t,e,n,i){return 0===i.compare(e,n)}function Sy(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=bm,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let o=e.parse(t[1],1,Em);if(!o)return null;if(!by(n,o.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${Dm(o.type)}'.`);let s=e.parse(t[2],2,Em);if(!s)return null;if(!by(n,s.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${Dm(s.type)}'.`);if(o.type.kind!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error(`Cannot compare types '${Dm(o.type)}' and '${Dm(s.type)}'.`);i&&("value"===o.type.kind&&"value"!==s.type.kind?o=new Ym(s.type,[o]):"value"!==o.type.kind&&"value"===s.type.kind&&(s=new Ym(o.type,[s])));let a=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==s.type.kind&&"value"!==o.type.kind&&"value"!==s.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,Im),!a)return null}return new r(o,s,a)}evaluate(r){const o=this.lhs.evaluate(r),s=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=Nm(o),n=Nm(s);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new Xm(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=Nm(o),n=Nm(s);if("string"!==t.kind||"string"!==n.kind)return e(r,o,s)}return this.collator?n(r,o,s,this.collator.evaluate(r)):e(r,o,s)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const Ey=Sy("==",(function(t,e,n){return e===n}),Cy),Iy=Sy("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!Cy(0,e,n,i)})),Py=Sy("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),Ty=Sy(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),ky=Sy("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),Dy=Sy(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0}));class My{constructor(t,e,n,i,r,o){this.type=xm,this.number=t,this.locale=e,this.currency=n,this.unit=i,this.minFractionDigits=r,this.maxFractionDigits=o}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,wm);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,xm),!r))return null;let o=null;if(i.currency&&(o=e.parse(i.currency,1,xm),!o))return null;let s=null;if(i.unit&&(s=e.parse(i.unit,1,xm),!s))return null;let a=null;if(i["min-fraction-digits"]&&(a=e.parse(i["min-fraction-digits"],1,wm),!a))return null;let l=null;return i["max-fraction-digits"]&&(l=e.parse(i["max-fraction-digits"],1,wm),!l)?null:new My(n,r,o,s,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Ly{constructor(t){this.type=wm,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${Dm(n.type)} instead.`):new Ly(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new Xm(`Expected value to be of type string or array, but found ${Dm(Nm(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}const Ry={"==":Ey,"!=":Iy,">":Ty,"<":Py,">=":Dy,"<=":ky,array:Ym,at:cy,boolean:Ym,case:vy,coalesce:ly,collator:r_,format:qm,image:Zm,in:py,"index-of":gy,interpolate:sy,"interpolate-hcl":sy,"interpolate-lab":sy,length:Ly,let:hy,literal:Wm,match:_y,number:Ym,"number-format":My,object:Ym,slice:xy,step:O_,string:Ym,"to-boolean":Qm,"to-color":Qm,"to-number":Qm,"to-string":Qm,var:T_,within:C_};function Oy(t,[e,n,i,r]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const o=r?r.evaluate(t):1,s=jm(e,n,i,o);if(s)throw new Xm(s);return new om(e/255*o,n/255*o,i/255*o,o)}function Fy(t,e){return t in e}function Ay(t,e){const n=e[t];return void 0===n?null:n}function zy(t){return{type:t}}i_.register(Ry,{error:[{kind:"error"},[xm],(t,[e])=>{throw new Xm(e.evaluate(t))}],typeof:[xm,[Em],(t,[e])=>Dm(Nm(e.evaluate(t)))],"to-rgba":[km(wm,4),[Cm],(t,[e])=>e.evaluate(t).toArray()],rgb:[Cm,[wm,wm,wm],Oy],rgba:[Cm,[wm,wm,wm,wm],Oy],has:{type:bm,overloads:[[[xm],(t,[e])=>Fy(e.evaluate(t),t.properties())],[[xm,Sm],(t,[e,n])=>Fy(e.evaluate(t),n.evaluate(t))]]},get:{type:Em,overloads:[[[xm],(t,[e])=>Ay(e.evaluate(t),t.properties())],[[xm,Sm],(t,[e,n])=>Ay(e.evaluate(t),n.evaluate(t))]]},"feature-state":[Em,[xm],(t,[e])=>Ay(e.evaluate(t),t.featureState||{})],properties:[Sm,[],t=>t.properties()],"geometry-type":[xm,[],t=>t.geometryType()],id:[Em,[],t=>t.id()],zoom:[wm,[],t=>t.globals.zoom],pitch:[wm,[],t=>t.globals.pitch||0],"distance-from-center":[wm,[],t=>t.distanceFromCenter()],"heatmap-density":[wm,[],t=>t.globals.heatmapDensity||0],"line-progress":[wm,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[wm,[],t=>t.globals.skyRadialProgress||0],accumulated:[Em,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[wm,zy(wm),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[wm,zy(wm),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:wm,overloads:[[[wm,wm],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[wm],(t,[e])=>-e.evaluate(t)]]},"/":[wm,[wm,wm],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[wm,[wm,wm],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[wm,[],()=>Math.LN2],pi:[wm,[],()=>Math.PI],e:[wm,[],()=>Math.E],"^":[wm,[wm,wm],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[wm,[wm],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[wm,[wm],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[wm,[wm],(t,[e])=>Math.log(e.evaluate(t))],log2:[wm,[wm],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[wm,[wm],(t,[e])=>Math.sin(e.evaluate(t))],cos:[wm,[wm],(t,[e])=>Math.cos(e.evaluate(t))],tan:[wm,[wm],(t,[e])=>Math.tan(e.evaluate(t))],asin:[wm,[wm],(t,[e])=>Math.asin(e.evaluate(t))],acos:[wm,[wm],(t,[e])=>Math.acos(e.evaluate(t))],atan:[wm,[wm],(t,[e])=>Math.atan(e.evaluate(t))],min:[wm,zy(wm),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[wm,zy(wm),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[wm,[wm],(t,[e])=>Math.abs(e.evaluate(t))],round:[wm,[wm],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[wm,[wm],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[wm,[wm],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[bm,[xm,Em],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[bm,[Em],(t,[e])=>t.id()===e.value],"filter-type-==":[bm,[xm],(t,[e])=>t.geometryType()===e.value],"filter-<":[bm,[xm,Em],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[bm,[Em],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[bm,[xm,Em],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[bm,[Em],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[bm,[xm,Em],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[bm,[Em],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[bm,[xm,Em],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[bm,[Em],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[bm,[Em],(t,[e])=>e.value in t.properties()],"filter-has-id":[bm,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[bm,[km(xm)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[bm,[km(Em)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[bm,[xm,km(Em)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[bm,[xm,km(Em)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:bm,overloads:[[[bm,bm],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[zy(bm),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:bm,overloads:[[[bm,bm],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[zy(bm),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[bm,[bm],(t,[e])=>!e.evaluate(t)],"is-supported-script":[bm,[xm],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[xm,[xm],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[xm,[xm],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[xm,zy(Em),(t,e)=>e.map((e=>Vm(e.evaluate(t)))).join("")],"resolved-locale":[xm,[Im],(t,[e])=>e.evaluate(t).resolvedLocale()]});var By=Ry;function jy(t){return{result:"success",value:t}}function Gy(t){return{result:"error",value:t}}function Ny(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}class Vy{constructor(t,e){var n;this.expression=t,this._warningHistory={},this._evaluator=new e_,this._defaultValue=e?"color"===(n=e).type&&(Ny(n.default)||Array.isArray(n.default))?new om(0,0,0,0):"color"===n.type?om.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,i,r,o,s,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,r,o,s,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new Xm(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(Hj){return this._warningHistory[Hj.message]||(this._warningHistory[Hj.message]=!0),this._defaultValue}}}function Hy(t,e){const n=new D_(By,[],e?function(t){const e={color:Cm,string:xm,number:wm,enum:xm,boolean:bm,formatted:Pm,resolvedImage:Tm};if("array"===t.type)return km(e[t.value]||Em,t.length);return e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?jy(new Vy(i,e)):Gy(n.errors)}class Wy{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!E_(e.expression)}evaluateWithoutErrorHandling(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)}evaluate(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)}}class Xy{constructor(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!E_(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,n,i,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,o)}evaluate(t,e,n,i,r,o){return this._styleExpression.evaluate(t,e,n,i,r,o)}interpolationFactor(t,e,n){return this.interpolationType?sy.interpolationFactor(this.interpolationType,t,e,n):0}}function Uy(t,e){if("error"===(t=Hy(t,e)).result)return t;const n=t.value.expression,i=S_(n);if(!i&&"data-driven"!==e["property-type"])return Gy([new mm("","data expressions not supported")]);const r=I_(n,["zoom","pitch","distance-from-center"]);if(!r&&!function(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}(e))return Gy([new mm("","zoom expressions not supported")]);const o=$y(n);if(!o&&!r)return Gy([new mm("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof mm)return Gy([o]);if(o instanceof sy&&!function(t){return!!t.expression&&t.expression.interpolated}(e))return Gy([new mm("",'"interpolate" expressions cannot be used with this property')]);if(!o)return jy(new Wy(i?"constant":"source",t.value));const s=o instanceof sy?o.interpolation:void 0;return jy(new Xy(i?"camera":"composite",t.value,o.labels,s))}function $y(t){let e=null;if(t instanceof hy)e=$y(t.result);else if(t instanceof ly){for(const n of t.args)if(e=$y(n),e)break}else(t instanceof O_||t instanceof sy)&&t.input instanceof i_&&"zoom"===t.input.name&&(e=t);return e instanceof mm||t.eachChild((t=>{const n=$y(t);n instanceof mm?e=n:!e&&n?e=new mm("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new mm("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Yy(t){if(Array.isArray(t))return t.map(Yy);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Yy(t[n]);return e}return function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}(t)}var qy={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["fill-extrusion-edge-radius"]}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function Zy(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Zy(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Ky(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zy(t)||(t=rv(t));const n=t;let i=!0;try{i=function(t){if(!tv(t))return t;let e=Yy(t);return Qy(e),e=Jy(e),e}(n)}catch(Hj){}const r=qy[`filter_${e}`],o=Hy(i,r);let s=null;if("error"===o.result)throw new Error(o.value.map((t=>`${t.key}: ${t.message}`)).join(", "));s=(t,e,n)=>o.value.evaluate(t,e,{},n);let a=null,l=null;if(i!==n){const t=Hy(n,r);if("error"===t.result)throw new Error(t.value.map((t=>`${t.key}: ${t.message}`)).join(", "));a=(e,n,i,r,o)=>t.value.evaluate(e,n,{},i,void 0,void 0,r,o),l=!S_(t.value.expression)}return{filter:s,dynamicFilter:a||void 0,needGeometry:iv(i),needFeature:!!l}}function Jy(t){if(!Array.isArray(t))return t;const e=function(t){if(ev.has(t[0]))for(let e=1;e<t.length;e++){if(tv(t[e]))return!0}return t}(t);return!0===e?e:e.map((t=>Jy(t)))}function Qy(t){let e=!1;const n=[];if("case"===t[0]){for(let i=1;i<t.length-1;i+=2)e=e||tv(t[i]),n.push(t[i+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||tv(t[1]);for(let e=2;e<t.length-1;e+=2)n.push(t[e+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||tv(t[1]);for(let e=1;e<t.length-1;e+=2)n.push(t[e+1])}e&&(t.length=0,t.push("any",...n));for(let i=1;i<t.length;i++)Qy(t[i])}function tv(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++){if(tv(t[n]))return!0}return!1}const ev=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function nv(t,e){return t<e?-1:t>e?1:0}function iv(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(iv(t[e]))return!0;return!1}function rv(t){if(!t)return!0;const e=t[0];if(t.length<=1)return"any"!==e;var n;return"=="===e?ov(t[1],t[2],"=="):"!="===e?lv(ov(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?ov(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(rv))):"all"===e?["all"].concat(t.slice(1).map(rv)):"none"===e?["all"].concat(t.slice(1).map(rv).map(lv)):"in"===e?sv(t[1],t.slice(2)):"!in"===e?lv(sv(t[1],t.slice(2))):"has"===e?av(t[1]):"!has"===e?lv(av(t[1])):"within"!==e||t}function ov(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function sv(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(nv)]]:["filter-in-small",t,["literal",e]]}}function av(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function lv(t){return["!",t]}var uv=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hv(t,e){const n={};for(const i in t)"ref"!==i&&(n[i]=t[i]);return uv.forEach((t=>{t in e&&(n[t]=e[t])})),n}function cv(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=hv(t[n],e[t[n].ref]));return t}var dv={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},pv=" ",fv=/(italic|oblique)$/i,gv={},mv=Zg((function(t,e,n){var i=gv[t];if(!i){Array.isArray(t)||(t=[t]);for(var r=400,o="normal",s=[],a=0,l=t.length;a<l;++a){var u=t[a].split(" "),h=u[u.length-1].toLowerCase();for(var c in"normal"==h||"italic"==h||"oblique"==h?(o=h,u.pop(),h=u[u.length-1].toLowerCase()):fv.test(h)&&(h=h.replace(fv,""),o=u[u.length-1].replace(h,"")),dv){var d=u.length>1?u[u.length-2].toLowerCase():"";if(h==c||h==c.replace("-","")||d+"-"+h==c){r=dv[c],u.pop(),d&&c.startsWith(d)&&u.pop();break}}"number"==typeof h&&(r=h);var p=u.join(pv).replace("Klokantech Noto Sans","Noto Sans");-1!==p.indexOf(pv)&&(p='"'+p+'"'),s.push(p)}i=gv[t]=[o,r,s]}return i[0]+pv+i[1]+pv+e+"px"+(n?"/"+n:"")+pv+i[2]}));const _v="https://api.mapbox.com";function yv(t){const e="mapbox://";return 0!==t.indexOf(e)?"":t.slice(9)}function vv(t,e){const n=yv(t);if(!n)return decodeURI(new URL(t,location.href).href);const i="styles/";if(0!==n.indexOf(i))throw new Error(`unexpected style url: ${t}`);const r=n.slice(7);return`${_v}/styles/v1/${r}?&access_token=${e}`}function wv(t,e,n,i){const r=new URL(t,i),o=yv(t);if(!o)return e?(r.searchParams.has(n)||r.searchParams.set(n,e),decodeURI(r.href)):decodeURI(r.href);if("mapbox.satellite"===o){return`https://api.mapbox.com/v4/${o}/{z}/{x}/{y}${window.devicePixelRatio>=1.5?"@2x":""}.webp?access_token=${e}`}return`https://{a-d}.tiles.mapbox.com/v4/${o}/{z}/{x}/{y}.vector.pbf?access_token=${e}`}const xv={},bv={};let Cv=0;function Sv(t){return t.id||(t.id=Cv++),t.id}function Ev(t){let e=xv[t.id];return e||(e={},xv[Sv(t)]=e),e}function Iv(t){return t*Math.PI/180}const Pv=function(){const t=[];for(let e=78271.51696402048;t.length<=24;e/=2)t.push(e);return t}(),Tv=new Bf({extent:Ai("EPSG:3857").getExtent(),resolutions:Pv});function kv(t,e){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(t,e);const n=document.createElement("canvas");return n.width=t,n.height=e,n}function Dv(t,e){let n=0;const i=e.length;for(;n<i;++n){if(e[n]<t&&n+1<i){const i=e[n]/e[n+1];return n+Math.log(e[n]/t)/Math.log(i)}}return i-1}const Mv={};function Lv(t,e,n={},i){if(e in Mv)return i&&(i.request=Mv[e][0]),Mv[e][1];const r=n.transformRequest&&n.transformRequest(e,t)||e,o=ae((()=>r)).then((t=>(t instanceof Request||(t=new Request(t)),t.headers.get("Accept")||t.headers.set("Accept","application/json"),i&&(i.request=t),fetch(t).then((function(t){return delete Mv[e],t.ok?t.json():Promise.reject(new Error("Error fetching source "+e))})).catch((function(t){return delete Mv[e],Promise.reject(new Error("Error fetching source "+e))})))));return Mv[e]=[r,o],o}function Rv(t,e){if("string"!=typeof t)return Promise.resolve(t);if(!t.trim().startsWith("{"))return Lv("Style",t=vv(t,e.accessToken),e);try{const e=JSON.parse(t);return Promise.resolve(e)}catch(n){return Promise.reject(n)}}const Ov={};function Fv(t,e,n={}){const i=[e,JSON.stringify(t)].toString();let r=Ov[i];if(!r||n.transformRequest){let o;n.transformRequest&&(o=(t,e)=>{const i=n.transformRequest&&n.transformRequest(e,"Tiles")||e;if(t instanceof $c)t.setLoader(((e,n,r)=>{ae((()=>i)).then((n=>{fetch(n).then((t=>t.arrayBuffer())).then((n=>{const i=t.getFormat().readFeatures(n,{extent:e,featureProjection:r});t.setFeatures(i)})).catch((e=>t.setState(uh.ERROR)))}))}));else{const e=t.getImage();ae((()=>i)).then((n=>{n instanceof Request?fetch(n).then((t=>t.blob())).then((t=>{const n=URL.createObjectURL(t);e.addEventListener("load",(()=>URL.revokeObjectURL(n))),e.addEventListener("error",(()=>URL.revokeObjectURL(n))),e.src=n})).catch((e=>t.setState(uh.ERROR))):e.src=n}))}});const s=t.url;if(s&&!t.tiles){const i=wv(s,n.accessToken,n.accessTokenParam||"access_token",e||location.href);if(s.startsWith("mapbox://"))r=Promise.resolve({tileJson:Object.assign({},t,{url:void 0,tiles:Yf(i)}),tileLoadFunction:o});else{const t={};r=Lv("Source",i,n,t).then((function(e){return e.tiles=e.tiles.map((function(i){return"tms"===e.scheme&&(i=i.replace("{y}","{-y}")),wv(i,n.accessToken,n.accessTokenParam||"access_token",t.request.url)})),Promise.resolve({tileJson:e,tileLoadFunction:o})}))}}else t=Object.assign({},t,{tiles:t.tiles.map((function(i){return"tms"===t.scheme&&(i=i.replace("{y}","{-y}")),wv(i,n.accessToken,n.accessTokenParam||"access_token",e||location.href)}))}),r=Promise.resolve({tileJson:Object.assign({},t),tileLoadFunction:o});Ov[i]=r}return r}function Av(t,e,n,i){const r=document.createElement("canvas"),o=[2*n*e.pixelRatio+e.width,2*n*e.pixelRatio+e.height];r.width=o[0],r.height=o[1];const s=r.getContext("2d");s.drawImage(t,e.x,e.y,e.width,e.height,n*e.pixelRatio,n*e.pixelRatio,e.width,e.height);const a=s.getImageData(0,0,o[0],o[1]);s.globalCompositeOperation="destination-over",s.fillStyle=`rgba(${255*i.r},${255*i.g},${255*i.b},${i.a})`;const l=a.data;for(let u=0,h=a.width;u<h;++u)for(let t=0,i=a.height;t<i;++t){l[4*(t*h+u)+3]>0&&s.arc(u,t,n*e.pixelRatio,0,2*Math.PI)}return s.fill(),r}function zv(t,e,n){const i=Math.max(0,Math.min(1,(n-t)/(e-t)));return i*i*(3-2*i)}function Bv(t,e,n){const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const r=i.getContext("2d");r.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height);const o=r.getImageData(0,0,e.width,e.height),s=o.data;for(let a=0,l=o.width;a<l;++a)for(let t=0,e=o.height;t<e;++t){const e=4*(t*l+a),i=.75,r=.1,o=zv(i-r,i+r,s[e+3]/255);o>0?(s[e+0]=Math.round(255*n.r*o),s[e+1]=Math.round(255*n.g*o),s[e+2]=Math.round(255*n.b*o),s[e+3]=Math.round(255*o)):s[e+3]=0}return r.putImageData(o,0,0),i}const jv=Array(256).join(" ");function Gv(t,e){if(e>=.05){let n="";const i=t.split("\n"),r=jv.slice(0,Math.round(e/.1));for(let t=0,e=i.length;t<e;++t)t>0&&(n+="\n"),n+=i[t].split("").join(r);return n}return t}let Nv;function Vv(){return Nv||(Nv=kv(1,1).getContext("2d")),Nv}function Hv(t,e){return Vv().measureText(t).width+(t.length-1)*e}const Wv={};function Xv(t,e,n,i){if(-1!==t.indexOf("\n")){const r=t.split("\n"),o=[];for(let t=0,s=r.length;t<s;++t)o.push(Xv(r[t],e,n,i));return o.join("\n")}const r=n+","+e+","+t+","+i;let o=Wv[r];if(!o){const s=t.split(" ");if(s.length>1){const t=Vv();t.font=e;const r=t.measureText("M").width*n;let a="";const l=[];for(let e=0,n=s.length;e<n;++e){const t=s[e],n=a+(a?" ":"")+t;Hv(n,i)<=r?a=n:(a&&l.push(a),a=t)}a&&l.push(a);for(let e=0,n=l.length;e<n&&n>1;++e){const t=l[e];if(Hv(t,i)<.35*r){const r=e>0?Hv(l[e-1],i):1/0,o=e<n-1?Hv(l[e+1],i):1/0;l.splice(e,1),n-=1,r<o?(l[e-1]+=" "+t,e-=1):l[e]=t+" "+l[e]}}for(let e=0,n=l.length-1;e<n;++e){const t=l[e],o=l[e+1];if(Hv(t,i)>.7*r&&Hv(o,i)<.6*r){const s=t.split(" "),a=s.pop();Hv(a,i)<.2*r&&(l[e]=s.join(" "),l[e+1]=a+" "+o),n-=1}}o=l.join("\n")}else o=t;o=Gv(o,i),Wv[r]=o}return o}const Uv=/font-family: ?([^;]*);/,$v=/("|')/g;let Yv;function qv(t){if(!Yv){Yv={};const t=document.styleSheets;for(let e=0,n=t.length;e<n;++e){const n=t[e];try{const t=n.rules||n.cssRules;if(t)for(let e=0,n=t.length;e<n;++e){const n=t[e];if(5==n.type){const t=n.cssText.match(Uv);Yv[t[1].replace($v,"")]=!0}}}catch(Hj){}}}return t in Yv}const Zv={};function Kv(t,e="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const n=t.toString();if(n in Zv)return Zv[n];const i=[];for(let r=0,o=t.length;r<o;++r){t[r]=t[r].replace("Arial Unicode MS","Arial");const e=t[r],n=mv(e,1);ps(n);const o=n.split(" ");i.push([o.slice(3).join(" ").replace(/"/g,""),o[1],o[0]])}for(let r=0,o=i.length;r<o;++r){const t=i[r],n=t[0];if(!qv(n)&&100!==us.get(`${t[2]}\n${t[1]} \n${n}`)){const i=e.replace("{font-family}",n.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",n.replace(/ /g,"+")).replace("{fontweight}",t[1]).replace("{-fontstyle}",t[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",t[2]);if(!document.querySelector('link[href="'+i+'"]')){const t=document.createElement("link");t.href=i,t.rel="stylesheet",document.head.appendChild(t)}}}return Zv[n]=t,t}const Jv={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},Qv={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},tw=function(t,e){const n=Uy(t,e);if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return n.value},ew={},nw={zoom:0};let iw,rw;function ow(t,e,n,i,r,o,s){const a=t.id;o||(o={}),o[a]||(o[a]={});const l=o[a];if(!l[n]){let i=(t[e]||ew)[n];const r=qy[`${e}_${t.type}`][n];void 0===i&&(i=r.default);let o=(u=i,Array.isArray(u)&&u.length>0&&"string"==typeof u[0]&&u[0]in By);if(!o&&Ny(i)&&(i=am(i,r),o=!0),o){const t=tw(i,r);l[n]=t.evaluate.bind(t)}else"color"==r.type&&(i=om.parse(i)),l[n]=function(){return i}}var u;return nw.zoom=i,l[n](nw,r,s)}function sw(t,e,n,i){if(!ow(t,"layout","icon-allow-overlap",e,n,i))return"declutter";return ow(t,"layout","icon-ignore-placement",e,n,i)?"none":"obstacle"}function aw(t,e,n,i,r){return t in r||(r[t]=Ky(e).filter),nw.zoom=i,r[t](nw,n)}function lw(t,e){if(t){if(0===t.a||0===e)return;const n=t.a;return e=void 0===e?1:e,0===n?"transparent":"rgba("+Math.round(255*t.r/n)+","+Math.round(255*t.g/n)+","+Math.round(255*t.b/n)+","+n*e+")"}return t}const uw=/\{[^{}}]*\}/g;function hw(t,e){return t.replace(uw,(function(t){return e[t.slice(1,-1)]||""}))}const cw={};function dw(t,e,n,i=Pv,r=void 0,o=void 0,s=void 0,a=void 0){if("string"==typeof e&&(e=JSON.parse(e)),8!=e.version)throw new Error("glStyle version 8 required.");let l,u,h;if(cw[function(t,e){return Sv(t)+"."+Te(e)}(e,t)]=Array.from(arguments),o)if("undefined"!=typeof Image){const e=new Image;let n;ae((()=>o)).then((t=>{t instanceof Request?fetch(t).then((t=>t.blob())).then((t=>{n=URL.createObjectURL(t),e.src=n})).catch((()=>{})):(e.crossOrigin="anonymous",e.src=t,n&&URL.revokeObjectURL(n))})),e.onload=function(){l=e,u=[e.width,e.height],t.changed(),e.onload=null}}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){const t=self;t.postMessage({action:"loadImage",src:o}),t.addEventListener("message",(function(t){"imageLoaded"===t.data.action&&t.data.src===o&&(l=t.data.image,u=[l.width,l.height])}))}const c=cv(e.layers),d={},p=[],f={},g={},m=Ev(e),_=function(t){let e=bv[t.id];return e||(e={},bv[Sv(t)]=e),e}(e);let y;for(let C=0,S=c.length;C<S;++C){const t=c[C],i=t.id;if("string"==typeof n&&t.source==n||-1!==n.indexOf(i)){const n=t["source-layer"];if(y){if(t.source!==y)throw new Error(`Layer "${i}" does not use source "${y}`)}else{y=t.source;const n=e.sources[y];if(!n)throw new Error(`Source "${y}" is not defined`);const i=n.type;if("vector"!==i&&"geojson"!==i)throw new Error(`Source "${y}" is not of type "vector" or "geojson", but "${i}"`)}let r=d[n];r||(r=[],d[n]=r),r.push({layer:t,index:C}),p.push(i)}}const v=new ho,w=new io,x=[],b=function(n,o,c){const p=n.getProperties(),y=d[p.layer];if(!y)return;let b=i.indexOf(o);-1==b&&(b=Dv(o,i));const C=Jv[n.getGeometry().getType()],S={id:n.getId(),properties:p,type:C},E=t.get("mapbox-featurestate")[n.getId()];let I=-1;for(let i=0,d=y.length;i<d;++i){const d=y[i],P=d.layer,T=P.id;if(void 0!==c&&c!==T)continue;const k=P.layout||ew,D=P.paint||ew;if("none"===k.visibility||"minzoom"in P&&b<P.minzoom||"maxzoom"in P&&b>=P.maxzoom)continue;const M=P.filter;if(!M||aw(T,M,S,b,_)){let i,c,_,y,T,M;const L=d.index;if(3==C&&("fill"==P.type||"fill-extrusion"==P.type))if(c=ow(P,"paint",P.type+"-opacity",b,S,m,E),P.type+"-pattern"in D){const t=ow(P,"paint",P.type+"-pattern",b,S,m,E);if(t){const e="string"==typeof t?hw(t,p):t.toString();if(l&&r&&r[e]){++I,M=x[I],M&&M.getFill()&&!M.getStroke()&&!M.getText()||(M=new Ts({fill:new io}),x[I]=M),_=M.getFill(),M.setZIndex(L);const t=e+"."+c;let n=g[t];if(!n){const i=r[e],o=kv(i.width,i.height),s=o.getContext("2d");s.globalAlpha=c,s.drawImage(l,i.x,i.y,i.width,i.height,0,0,i.width,i.height),n=s.createPattern(o,"repeat"),g[t]=n}_.setColor(n)}}}else i=lw(ow(P,"paint",P.type+"-color",b,S,m,E),c),P.type+"-outline-color"in D&&(T=lw(ow(P,"paint",P.type+"-outline-color",b,S,m,E),c)),T||(T=i),(i||T)&&(++I,M=x[I],(!M||i&&!M.getFill()||!i&&M.getFill()||T&&!M.getStroke()||!T&&M.getStroke()||M.getText())&&(M=new Ts({fill:i?new io:void 0,stroke:T?new ho:void 0}),x[I]=M),i&&(_=M.getFill(),_.setColor(i)),T&&(y=M.getStroke(),y.setColor(T),y.setWidth(.5)),M.setZIndex(L));if(1!=C&&"line"==P.type){i=!("line-pattern"in D)&&"line-color"in D?lw(ow(P,"paint","line-color",b,S,m,E),ow(P,"paint","line-opacity",b,S,m,E)):void 0;const t=ow(P,"paint","line-width",b,S,m,E);i&&t>0&&(++I,M=x[I],M&&M.getStroke()&&!M.getFill()&&!M.getText()||(M=new Ts({stroke:new ho}),x[I]=M),y=M.getStroke(),y.setLineCap(ow(P,"layout","line-cap",b,S,m,E)),y.setLineJoin(ow(P,"layout","line-join",b,S,m,E)),y.setMiterLimit(ow(P,"layout","line-miter-limit",b,S,m,E)),y.setColor(i),y.setWidth(t),y.setLineDash(D["line-dasharray"]?ow(P,"paint","line-dasharray",b,S,m,E).map((function(e){return e*t})):null),M.setZIndex(L))}let R,O,F,A,z,B,j,G,N,V=!1,H=null,W=0;if((1==C||2==C)&&"icon-image"in k){const e=ow(P,"layout","icon-image",b,S,m,E);if(e){let i;R="string"==typeof e?hw(e,p):e.toString();const s=a?a(t,R):void 0;if(l&&r&&r[R]||s){const t=ow(P,"layout","icon-rotation-alignment",b,S,m,E);if(2==C){const e=n.getGeometry();if(e.getFlatMidpoint||e.getFlatMidpoints){const n=e.getExtent();if(Math.sqrt(Math.max(Math.pow((n[2]-n[0])/o,2),Math.pow((n[3]-n[1])/o,2)))>150){const n="MultiLineString"===e.getType()?e.getFlatMidpoints():e.getFlatMidpoint();rw||(iw=[NaN,NaN],rw=new Xu("Point",iw,[],{},null)),i=rw,iw[0]=n[0],iw[1]=n[1];if("line"===ow(P,"layout","symbol-placement",b,S,m,E)&&"map"===t){const t=e.getStride(),i=e.getFlatCoordinates();for(let e=0,r=i.length-t;e<r;e+=t){const r=i[e],o=i[e+1],s=i[e+t],a=i[e+t+1],l=Math.min(r,s),u=Math.min(o,a),h=Math.max(r,s),c=Math.max(o,a);if(n[0]>=l&&n[0]<=h&&n[1]>=u&&n[1]<=c){W=Math.atan2(o-a,s-r);break}}}}}}if(2!==C||i){const e=ow(P,"layout","icon-size",b,S,m,E),n=void 0!==D["icon-color"]?ow(P,"paint","icon-color",b,S,m,E):null;if(!n||0!==n.a){const i=ow(P,"paint","icon-halo-color",b,S,m,E),o=ow(P,"paint","icon-halo-width",b,S,m,E);let a=`${R}.${e}.${o}.${i}`;if(null!==n&&(a+=`.${n}`),O=f[a],!O){const c=sw(P,b,S,m);let d;"icon-offset"in k&&(d=ow(P,"layout","icon-offset",b,S,m,E).slice(0),d[1]*=-1);let p=n?[255*n.r,255*n.g,255*n.b,n.a]:void 0;if(s){const n={color:p,rotateWithView:"map"===t,displacement:d,declutterMode:c,scale:e};"string"==typeof s?n.src=s:(n.img=s,n.imgSize=[s.width,s.height]),O=new za(n)}else{const s=r[R];let a,f,g;o?s.sdf?(a=Av(Bv(l,s,n),{x:0,y:0,width:s.width,height:s.height,pixelRatio:s.pixelRatio},o,i),p=void 0):a=Av(l,s,o,i):(s.sdf?(h||(h=Bv(l,{x:0,y:0,width:u[0],height:u[1]},{r:1,g:1,b:1,a:1})),a=h):a=l,f=[s.width,s.height],g=[s.x,s.y]),O=new za({color:p,img:a,imgSize:u,size:f,offset:g,rotateWithView:"map"===t,scale:e/s.pixelRatio,displacement:d,declutterMode:c})}f[a]=O}}O&&(++I,M=x[I],M&&M.getImage()&&!M.getFill()&&!M.getStroke()||(M=new Ts,x[I]=M),M.setGeometry(i),O.setRotation(W+Iv(ow(P,"layout","icon-rotate",b,S,m,E))),O.setOpacity(ow(P,"paint","icon-opacity",b,S,m,E)),O.setAnchor(Qv[ow(P,"layout","icon-anchor",b,S,m,E)]),M.setImage(O),H=M.getText(),M.setText(void 0),M.setZIndex(L),V=!0,F=!1)}else F=!0}}}if(1==C&&"circle"===P.type){++I,M=x[I],M&&M.getImage()&&!M.getFill()&&!M.getStroke()||(M=new Ts,x[I]=M);const t="circle-radius"in D?ow(P,"paint","circle-radius",b,S,m,E):5,e=lw(ow(P,"paint","circle-stroke-color",b,S,m,E),ow(P,"paint","circle-stroke-opacity",b,S,m,E)),n=lw(ow(P,"paint","circle-color",b,S,m,E),ow(P,"paint","circle-opacity",b,S,m,E)),i=ow(P,"paint","circle-stroke-width",b,S,m,E),r=t+"."+e+"."+n+"."+i;O=f[r],O||(O=new bs({radius:t,stroke:e&&i>0?new ho({width:i,color:e}):void 0,fill:n?new io({color:n}):void 0,declutterMode:"none"}),f[r]=O),M.setImage(O),H=M.getText(),M.setText(void 0),M.setGeometry(void 0),M.setZIndex(L),V=!0}if("text-field"in k){j=Math.round(ow(P,"layout","text-size",b,S,m,E));const t=ow(P,"layout","text-font",b,S,m,E);B=ow(P,"layout","text-line-height",b,S,m,E),z=mv(s?s(t,e.metadata?e.metadata["ol:webfonts"]:void 0):t,j,B),z.includes("sans-serif")||(z+=",sans-serif"),G=ow(P,"layout","text-letter-spacing",b,S,m,E),N=ow(P,"layout","text-max-width",b,S,m,E);const n=ow(P,"layout","text-field",b,S,m,E);A="object"==typeof n&&n.sections?1===n.sections.length?n.toString():n.sections.reduce(((e,n,i)=>{const r=n.fontStack?n.fontStack.split(","):t,o=mv(s?s(r):r,j*(n.scale||1),B);let a=n.text;if("\n"===a)return e.push("\n",""),e;if(2!=C){a=Xv(a,o,N,G).split("\n");for(let t=0,n=a.length;t<n;++t)t>0&&e.push("\n",""),e.push(a[t],o);return e}e.push(Gv(a,G),o)}),[]):hw(n,p).trim(),c=ow(P,"paint","text-opacity",b,S,m,E)}if(A&&c&&!F){V||(++I,M=x[I],M&&M.getText()&&!M.getFill()&&!M.getStroke()||(M=new Ts,x[I]=M),M.setImage(void 0),M.setGeometry(void 0)),M.getText()||M.setText(H||new Ds({padding:[2,2,2,2]})),H=M.getText();const t=k["text-transform"];"uppercase"==t?A=Array.isArray(A)?A.map(((t,e)=>e%2?t:t.toUpperCase())):A.toUpperCase():"lowercase"==t&&(A=Array.isArray(A)?A.map(((t,e)=>e%2?t:t.toLowerCase())):A.toLowerCase());const e=Array.isArray(A)?A:2==C?Gv(A,G):Xv(A,z,N,G);H.setText(e),H.setFont(z),H.setRotation(Iv(ow(P,"layout","text-rotate",b,S,m,E)));const n=ow(P,"layout","text-anchor",b,S,m,E),i=V||1==C?"point":ow(P,"layout","symbol-placement",b,S,m,E);let r;if("line-center"===i?(H.setPlacement("line"),r="center"):H.setPlacement(i),"line"===i&&"function"==typeof H.setRepeat){const t=ow(P,"layout","symbol-spacing",b,S,m,E);H.setRepeat(2*t)}H.setOverflow("point"===i);let o=ow(P,"paint","text-halo-width",b,S,m,E);const s=ow(P,"layout","text-offset",b,S,m,E),a=ow(P,"paint","text-translate",b,S,m,E);let l=0,u=0;if("point"==i){r="center",-1!==n.indexOf("left")?(r="left",u=o):-1!==n.indexOf("right")&&(r="right",u=-o);const t=ow(P,"layout","text-rotation-alignment",b,S,m,E);H.setRotateWithView("map"==t)}else H.setMaxAngle(Iv(ow(P,"layout","text-max-angle",b,S,m,E))*A.length/e.length),H.setRotateWithView(!1);H.setTextAlign(r);let h="middle";0==n.indexOf("bottom")?(h="bottom",l=-o-.5*(B-1)*j):0==n.indexOf("top")&&(h="top",l=o+.5*(B-1)*j),H.setTextBaseline(h);const d=ow(P,"layout","text-justify",b,S,m,E);H.setJustify("auto"===d?void 0:d),H.setOffsetX(s[0]*j+u+a[0]),H.setOffsetY(s[1]*j+l+a[1]),w.setColor(lw(ow(P,"paint","text-color",b,S,m,E),c)),H.setFill(w);const p=lw(ow(P,"paint","text-halo-color",b,S,m,E),c);if(p){v.setColor(p),o*=2;const t=.5*j;v.setWidth(o<=t?o:t),H.setStroke(v)}else H.setStroke(void 0);const f=ow(P,"layout","text-padding",b,S,m,E),g=H.getPadding();f!==g[0]&&(g[0]=f,g[1]=f,g[2]=f,g[3]=f),M.setZIndex(L)}}}return I>-1?(x.length=I+1,x):void 0};return t.setStyle(b),t.set("mapbox-source",y),t.set("mapbox-layers",p),t.set("mapbox-featurestate",t.get("mapbox-featurestate")||{}),b}function pw(t,e){const n=t[0],i=n.width,r=n.height,o=n.data,s=new Uint8ClampedArray(o.length),a=2*e.resolution,l=i-1,u=r-1,h=[0,0,0,0],c=2*Math.PI,d=Math.PI/2,p=Math.PI*e.sunEl/180,f=Math.PI*e.sunAz/180,g=Math.cos(p),m=Math.sin(p),_=e.highlightColor,y=e.shadowColor,v=e.accentColor,w=e.encoding;let x,b,C,S,E,I,P,T,k,D,M,L,R,O,F,A,z,B,j,G,N,V;function H(t,e="mapbox"){return"mapbox"===e?.1*(256*t[0]*256+256*t[1]+t[2])-1e4:"terrarium"===e?256*t[0]+t[1]+t[2]/256-32768:void 0}for(b=0;b<=u;++b)for(E=0===b?0:b-1,I=b===u?u:b+1,x=0;x<=l;++x)C=0===x?0:x-1,S=x===l?l:x+1,P=4*(b*i+C),h[0]=o[P],h[1]=o[P+1],h[2]=o[P+2],h[3]=o[P+3],T=e.vert*H(h,w),P=4*(b*i+S),h[0]=o[P],h[1]=o[P+1],h[2]=o[P+2],h[3]=o[P+3],k=e.vert*H(h,w),D=(k-T)/a,P=4*(E*i+x),h[0]=o[P],h[1]=o[P+1],h[2]=o[P+2],h[3]=o[P+3],T=e.vert*H(h,w),P=4*(I*i+x),h[0]=o[P],h[1]=o[P+1],h[2]=o[P+2],h[3]=o[P+3],k=e.vert*H(h,w),M=(k-T)/a,R=Math.atan2(M,-D),R=R<0?d-R:R>d?c-R+d:d-R,L=Math.atan(Math.sqrt(D*D+M*M)),V=m*Math.cos(L)+g*Math.sin(L)*Math.cos(f-R),O=Math.cos(L),F=255*V,j=Math.min(Math.max(2*e.sunEl,0),1),G=1.875-1.75*e.opacity,N=.5!==e.opacity?d*((Math.pow(G,L)-1)/(Math.pow(G,d)-1)):L,z={r:(1-O)*v.r*j*255,g:(1-O)*v.g*j*255,b:(1-O)*v.b*j*255,a:(1-O)*v.a*j*255},A=Math.abs(((R+f)/Math.PI+.5)%2-1),B={r:(_.r*(1-A)+y.r*A)*F,g:(_.g*(1-A)+y.g*A)*F,b:(_.b*(1-A)+y.b*A)*F,a:(_.a*(1-A)+y.a*A)*F},P=4*(b*i+x),s[P]=z.r*(1-A)+B.r,s[P+1]=z.g*(1-A)+B.g,s[P+2]=z.b*(1-A)+B.b,s[P+3]=o[P+3]*e.opacity*j*Math.sin(N);return new ImageData(s,i,r)}function fw(t,e=512){return t.getExtent()?Gf({extent:t.getExtent(),tileSize:e,maxZoom:22}).getResolutions():Pv}function gw(t,e){if(!e.accessToken){e=Object.assign({},e);new URL(t).searchParams.forEach(((t,n)=>{e.accessToken=t,e.accessTokenParam=n}))}return e}function mw(t,e,n="",i={},r=void 0){let o,s,a,l,u=!0;return"string"==typeof n||Array.isArray(n)?l=n:(a=n,l=a.source||a.layers,i=a),"string"==typeof i?(o=i,a={}):(o=i.styleUrl,a=i),!1===a.updateSource&&(u=!1),r||(r=a.resolutions),o||"string"!=typeof e||e.trim().startsWith("{")||(o=e),o&&(o=o.startsWith("data:")?location.href:vv(o,a.accessToken),a=gw(o,a)),new Promise((function(n,i){Rv(e,a).then((function(e){if(8!=e.version)return i(new Error("glStyle version 8 required."));if(!(t instanceof ku||t instanceof $g))return i(new Error("Can only apply to VectorLayer or VectorTileLayer"));const h=t instanceof $g?"vector":"geojson";if(l?s=Array.isArray(l)?e.layers.find((function(t){return t.id===l[0]})).source:l:(s=Object.keys(e.sources).find((function(t){return e.sources[t].type===h})),l=s),!s)return i(new Error(`No ${h} source found in the glStyle.`));function c(){if(!u)return Promise.resolve();if(t instanceof $g)return xw(e.sources[s],o,a).then((function(e){const n=t.getSource();if(n?e!==n&&(n.setTileUrlFunction(e.getTileUrlFunction()),"function"==typeof n.setUrls&&"function"==typeof e.getUrls&&n.setUrls(e.getUrls()),n.format_||(n.format_=e.format_),n.getAttributions()||n.setAttributions(e.getAttributions()),n.getTileLoadFunction()===qg&&n.setTileLoadFunction(e.getTileLoadFunction()),Ni(n.getProjection(),e.getProjection())&&(n.tileGrid=e.getTileGrid())):t.setSource(e),!isFinite(t.getMaxResolution())&&!isFinite(t.getMinZoom())){const e=t.getSource().getTileGrid();t.setMaxResolution(e.getResolution(e.getMinZoom()))}}));const n=e.sources[s];let i=t.getSource();i&&i.get("mapbox-source")===n||(i=Sw(n,o,a));const r=t.getSource();return r?i!==r&&(r.getAttributions()||r.setAttributions(i.getAttributions()),r.format_||(r.format_=i.getFormat()),r.url_=i.getUrl()):t.setSource(i),Promise.resolve()}let d,p,f,g;function m(){if(g||e.sprite&&!p)g?(t.setStyle(g),c().then(n).catch(i)):i(new Error("Something went wrong trying to apply style."));else{if(a.projection&&!r){const t=Ai(a.projection).getUnits();"m"!==t&&(r=Pv.map((e=>e/Nn[t])))}g=dw(t,e,l,r,p,f,Kv,a.getImage),t.getStyle()?c().then(n).catch(i):i(new Error(`Nothing to show for source [${s}]`))}}if(e.sprite){const t=new URL(function(t,e,n){const i=yv(t);if(!i)return decodeURI(new URL(t,n).href);const r="sprites/";if(0!==i.indexOf(r))throw new Error(`unexpected sprites url: ${t}`);const o=i.slice(8);return`${_v}/styles/v1/${o}/sprite?access_token=${e}`}(e.sprite,a.accessToken,o||location.href));d=window.devicePixelRatio>=1.5?.5:1;const n=.5==d?"@2x":"";let r=t.origin+t.pathname+n+".json"+t.search;new Promise((function(e,n){Lv("Sprite",r,a).then(e).catch((function(i){r=t.origin+t.pathname+".json"+t.search,Lv("Sprite",r,a).then(e).catch(n)}))})).then((function(e){if(void 0===e&&i(new Error("No sprites found.")),p=e,f=t.origin+t.pathname+n+".png"+t.search,a.transformRequest){const t=a.transformRequest(f,"SpriteImage")||f;(t instanceof Request||t instanceof Promise)&&(f=t)}m()})).catch((function(t){i(new Error(`Sprites cannot be loaded: ${r}: ${t.message}`))}))}else m()})).catch(i)}))}const _w={};function yw(t,e){let n;return t.some((function(t){if(t.id==e)return n=t.source,!0})),n}function vw(t,e,n){const i=new Hg({tileJSON:e,tileSize:t.tileSize||e.tileSize||512}),r=i.getTileJSON(),o=i.getTileGrid(),s=Ai(n.projection||"EPSG:3857"),a=function(t,e){const n=t.bounds;if(n){const t=Gi([n[0],n[1]],e),i=Gi([n[2],n[3]],e);return[t[0],t[1],i[0],i[1]]}return Ai(e).getExtent()}(r,s),l=s.getExtent(),u=r.minzoom||0,h=r.maxzoom||22,c={attributions:i.getAttributions(),projection:s,tileGrid:new Bf({origin:l?On(l):o.getOrigin(0),extent:a||o.getExtent(),minZoom:u,resolutions:fw(s,e.tileSize).slice(0,h+1),tileSize:o.getTileSize(0)})};return Array.isArray(r.tiles)?c.urls=r.tiles:c.url=r.tiles,c}function ww(t,e,n){const i=document.createElement("div");return i.className="ol-mapbox-style-background",i.style.position="absolute",i.style.width="100%",i.style.height="100%",new ua({source:new $u({}),render(r){const o=function(t,e,n,i){const r={id:t.id,type:t.type},o=t.layout||{},s=t.paint||{};r.paint=s;const a=Dv(e,n.resolutions||Pv);let l,u;return void 0!==s["background-color"]&&(l=ow(r,"paint","background-color",a,_w,i)),void 0!==s["background-opacity"]&&(u=ow(r,"paint","background-opacity",a,_w,i)),"none"==o.visibility?void 0:lw(l,u)}(t,r.viewState.resolution,e,n);return i.style.backgroundColor=o,i}})}function xw(t,e,n){return new Promise((function(i,r){Fv(t,e,n).then((function({tileJson:e,tileLoadFunction:r}){const o=vw(t,e,n);o.tileLoadFunction=r,o.format=new fp,i(new Yg(o))})).catch(r)}))}function bw(t){return`{bbox-${(t?t.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function Cw(t,e,n){const i=new rg;return function(t,e,n){return new Promise((function(i,r){Fv(t,e,n).then((function({tileJson:e,tileLoadFunction:r}){const o=new Hg({interpolate:void 0===n.interpolate||n.interpolate,transition:0,crossOrigin:"anonymous",tileJSON:e});o.tileGrid=vw(t,e,n).tileGrid,n.projection&&(o.projection=Ai(n.projection));const s=o.getTileUrlFunction();r&&o.setTileLoadFunction(r),o.setTileUrlFunction((function(t,e,n){const i=bw(n);let r=s(t,e,n);if(-1!=r.indexOf(i)){const e=o.getTileGrid().getTileCoordExtent(t);r=r.replace(i,e.toString())}return r})),o.set("mapbox-source",t),i(o)})).catch((function(t){r(t)}))}))}(t,e,n).then((function(t){i.setSource(t)})).catch((function(){i.setSource(void 0)})),i}function Sw(t,e,n){const i=n.projection?new Gd({dataProjection:n.projection}):new Gd,r=t.data,o={};if("string"==typeof r){const o=wv(r,n.accessToken,n.accessTokenParam||"access_token",e||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(o)){const e=(t,e,n)=>{const i=bw(n);return o.replace(i,`${t.join(",")}`)},r=new ah({attributions:t.attribution,format:i,loader:(t,i,o,s,a)=>{Lv("GeoJSON","function"==typeof e?e(t,i,o):e,n).then((t=>{const e=r.getFormat().readFeatures(t,{featureProjection:o});r.addFeatures(e),s(e)})).catch((e=>{r.removeLoadedExtent(t),a()}))},strategy:nh});return r.set("mapbox-source",t),r}const s=new ah({attributions:t.attribution,format:i,url:o,loader:(t,e,i,r,a)=>{Lv("GeoJSON",o,n).then((t=>{const e=s.getFormat().readFeatures(t,{featureProjection:i});s.addFeatures(e),r(e)})).catch((e=>{s.removeLoadedExtent(t),a()}))}});return s}o.features=i.readFeatures(r,{featureProjection:"EPSG:3857"});const s=new ah(Object.assign({attributions:t.attribution,format:i},o));return s.set("mapbox-source",t),s}function Ew(t,e,n){let i=null;return function(r){t.paint&&"raster-opacity"in t.paint&&r.frameState.viewState.zoom!==i&&(i=r.frameState.viewState.zoom,delete n[t.id],function(t,e,n,i){const r=ow(t,"paint","raster-opacity",n,_w,i);e.setOpacity(r)}(t,e,i,n))}}function Iw(t,e,n,i){const r=Ev(t),o=t.layers,s=n.type,a=n.source||yw(o,n.ref),l=t.sources[a];let u;if("background"==s)u=ww(n,i,r);else if("vector"==l.type)u=function(t,e,n){const i=new $g({declutter:!0,visible:!1});return xw(t,e,n).then((function(e){e.set("mapbox-source",t),i.setSource(e)})).catch((function(t){i.setSource(void 0)})),i}(l,e,i);else if("raster"==l.type)u=Cw(l,e,i),u.setVisible(!n.layout||"none"!==n.layout.visibility),u.on("prerender",Ew(n,u,r));else if("geojson"==l.type)u=function(t,e,n){return new ku({declutter:!0,source:Sw(t,e,n),visible:!1})}(l,e,i);else if("raster-dem"==l.type&&"hillshade"==n.type){const t=function(t,e,n){const i=Cw(t,e,n);return new xg({source:new Vg({operationType:"image",operation:pw,sources:[i]})})}(l,e,i);u=t,t.getSource().on("beforeoperations",(function(t){const e=t.data;e.resolution=t.resolution;const o=Dv(t.resolution,i.resolutions||Pv);e.encoding=l.encoding,e.vert=5*ow(n,"paint","hillshade-exaggeration",o,_w,r),e.sunAz=ow(n,"paint","hillshade-illumination-direction",o,_w,r),e.sunEl=35,e.opacity=.3,e.highlightColor=ow(n,"paint","hillshade-highlight-color",o,_w,r),e.shadowColor=ow(n,"paint","hillshade-shadow-color",o,_w,r),e.accentColor=ow(n,"paint","hillshade-accent-color",o,_w,r)})),u.setVisible(!n.layout||"none"!==n.layout.visibility)}const h=a;return u&&u.set("mapbox-source",h),u}function Pw(t,e,n,i){const r=[];let o=null;if(e instanceof kc){if(o=e.getView(),!o.isDef()&&!o.getRotation()&&!o.getResolutions()){const t=i.projection?Ai(i.projection):o.getProjection();o=new aa(Object.assign(o.getProperties(),{maxResolution:Pv[0]/Nn[t.getUnits()],projection:i.projection||o.getProjection()})),e.setView(o)}"center"in t&&!o.getCenter()&&o.setCenter(Gi(t.center,o.getProjection())),"zoom"in t&&void 0===o.getZoom()&&o.setResolution(Pv[0]/Nn[o.getProjection().getUnits()]/Math.pow(2,t.zoom)),o.getCenter()&&void 0!==o.getZoom()||o.fit(o.getProjection().getExtent(),{nearest:!0,size:e.getSize()})}e.set("mapbox-style",t),e.set("mapbox-metadata",{styleUrl:n,options:i});const s=t.layers;let a,l,u,h=[];for(let c=0,d=s.length;c<d;++c){const o=s[c],d=o.type;if("heatmap"==d)throw new Error(`${d} layers are not supported`);u=o.source||yw(s,o.ref),u&&u==l||(h.length&&(r.push(Tw(a,h,t,n,e,i)),h=[]),a=Iw(t,n,o,i),a instanceof ku||a instanceof $g||(h=[]),l=a.get("mapbox-source")),h.push(o.id)}return r.push(Tw(a,h,t,n,e,i)),Promise.all(r)}function Tw(t,e,n,i,r,o={}){let s=24,a=0;const l=n.layers;for(let u=0,h=l.length;u<h;++u){const t=l[u];-1!==e.indexOf(t.id)&&(s=Math.min("minzoom"in t?t.minzoom:0,s),a=Math.max("maxzoom"in t?t.maxzoom:24,a))}return new Promise((function(l,u){const h=function(){const h=t.getSource();if(h&&"error"!==h.getState()){if("getTileGrid"in h){const e=h.getTileGrid();if(e){const n=e.getMinZoom();(s>0||n>0)&&t.setMaxResolution(Math.min(Tv.getResolution(s),e.getResolution(n))+1e-9),a<24&&t.setMinResolution(Tv.getResolution(a)+1e-9)}}else s>0&&t.setMaxResolution(Tv.getResolution(s)+1e-9);h instanceof ah||h instanceof Yg?mw(t,n,e,Object.assign({styleUrl:i},o)).then((function(){!function(t,e){function n(){const n=e.get("mapbox-style");if(!n)return;const i=cv(n.layers),r=t.get("mapbox-layers"),o=i.filter((function(t){return r.includes(t.id)})).some((function(t){return!t.layout||!t.layout.visibility||"visible"===t.layout.visibility}));t.get("visible")!==o&&t.setVisible(o)}t.on("change",n),n()}(t,r),l()})).catch(u):l()}else u(new Error("Error accessing data for source "+t.get("mapbox-source")))};t.set("mapbox-layers",e);const c=r.getLayers();-1===c.getArray().indexOf(t)&&c.push(t),t.getSource()?h():t.once("change:source",h)}))}class kw{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"__layerIdentifier",["mapbox-style-source","mapbox-layers","mapbox-source"]),this.olBaseHandle=t,this.handle=t.handle}destructor(){this.clearLayer(),this.olBaseHandle=null,this.handle=null}addLayer(t={url:"",id:"",isRemoveOld:!0}){return!!this.handle&&(t.url&&t.id?(t.isRemoveOld&&this.clearLayer(),function(t,e,n={}){let i,r;if(r="string"==typeof t||t instanceof HTMLElement?new kc({target:t}):t,"string"==typeof e){const t=e.startsWith("data:")?location.href:vv(e,n.accessToken);n=gw(t,n),i=new Promise((function(i,o){Rv(e,n).then((function(e){Pw(e,r,t,n).then((function(){i(r)})).catch(o)})).catch((function(t){o(new Error(`Could not load ${e}: ${t.message}`))}))}))}else i=new Promise((function(t,i){Pw(e,r,!n.styleUrl||n.styleUrl.startsWith("data:")?location.href:vv(n.styleUrl,n.accessToken),n).then((function(){t(r)})).catch(i)}))}(this.handle,t.url),!0):null)}clearLayer(){this.handle&&this.__layerIdentifier.forEach((t=>{this.handle.getLayers().getArray().filter((e=>e.get(t))).forEach((t=>{this.handle.removeLayer(t)}))}))}}class Dw extends Ef{constructor(t,n,i=1,r=21){super(t,n,i,r),e(this,"__bgLayers",null),e(this,"XYZIns",null),e(this,"BingmapIns",null),e(this,"mapboxLayerIns",null),e(this,"__xyzMapOptions",{[D]:{url:lg.tiandi_spm_vec,id:D,name:D,zIndex:1,extent:[],wrapX:!0},[M]:{url:lg.tiandi_spm_vec_zh_label,id:M,name:M,zIndex:2,extent:[],wrapX:!0},[L]:{url:lg.tiandi_spm_vec_en_label,id:L,name:L,zIndex:2,extent:[],wrapX:!0},[R]:{url:lg.tiandi_spm_img,id:R,name:R,zIndex:1,extent:[],wrapX:!0},[O]:{url:lg.tiandi_spm_img_zh_label,id:O,name:O,zIndex:2,extent:[],wrapX:!0},[F]:{url:lg.tiandi_spm_img_en_label,id:F,name:F,zIndex:2,extent:[],wrapX:!0},[A]:{url:lg.tiandi_spm_ter,id:A,name:A,zIndex:1,extent:[],wrapX:!0},[z]:{url:lg.tiandi_spm_ter_label,id:z,name:z,zIndex:2,extent:[],wrapX:!0},[B]:{url:lg.google_vec,id:B,name:B,zIndex:1,extent:[],wrapX:!0},[j]:{url:lg.google_img,id:j,name:j,zIndex:1,extent:[],wrapX:!0},aMapZh:{url:lg.aMap_vec+"&lang=zh_cn",id:"aMapZh",name:"aMapZh",zIndex:1,extent:[],wrapX:!0},aMapEn:{url:lg.aMap_vec+"&lang=en",id:"aMapEn",name:"aMapEn",zIndex:1,extent:[],wrapX:!0},aMapSatZh:{url:lg.aMap_img+"&lang=zh_cn",id:"aMapSatZh",name:"aMapSatZh",zIndex:1,extent:[],wrapX:!0},aMapSatEn:{url:lg.aMap_img+"&lang=en",id:"aMapSatEn",name:"aMapSatEn",zIndex:1,extent:[],wrapX:!0}}),e(this,"__bingMapOptions",{[G]:{id:G,name:G,imagerySet:gg,zIndex:1,extent:[],wrapX:!0},[N]:{id:N,name:N,imagerySet:fg,zIndex:1,extent:[],wrapX:!0},[V]:{id:V,name:V,imagerySet:mg,zIndex:1,extent:[],wrapX:!0},[H]:{id:H,name:H,imagerySet:pg,zIndex:1,extent:[],wrapX:!0}}),e(this,"__mapboxStyleOptions",{[W]:{id:W,url:ug,isRemoveOld:!0},[X]:{id:X,url:cg,isRemoveOld:!0},[U]:{id:U,url:dg,isRemoveOld:!0},[$]:{id:$,url:hg,isRemoveOld:!0}}),this.__bgLayers=new Map,this.XYZIns=new og(this),this.BingmapIns=new yg(this),this.mapboxLayerIns=new kw(this)}destructor(){this.mapboxLayerIns.destructor(),this.BingmapIns.destructor(),this.XYZIns.destructor(),this.__bgLayers=null,super.destructor()}__addXYZLayer(t){if(this.__bgLayers.has(t))this.XYZIns.showHiddenLayerByID(t,!0);else{this.XYZIns.addLayer(this.__xyzMapOptions[t])&&this.__bgLayers.set(t,this.__xyzMapOptions[t])}}__hiddenXYZLayer(t){this.__bgLayers.has(t)&&this.XYZIns.showHiddenLayerByID(t,!1)}__addBingmapLayer(t){if(this.__bgLayers.has(t)){const e=this.__bingMapOptions[t].id;this.BingmapIns.showHiddenLayerByID(e,!0)}else{this.BingmapIns.addLayer(this.__bingMapOptions[t])&&this.__bgLayers.set(t,this.__bingMapOptions[t])}}__hiddenBingmapLayer(t){if(this.__bgLayers.has(t)){const e=this.__bingMapOptions[t].id;this.BingmapIns.showHiddenLayerByID(e,!1)}}__addMapboxStyleLayer(t){this.mapboxLayerIns.addLayer(this.__mapboxStyleOptions[t])}__hiddenMapboxStyleLayer(){var t;null==(t=this.mapboxLayerIns)||t.clearLayer()}hiddenBgLayer(){this.__hiddenXYZLayer(D),this.__hiddenXYZLayer(M),this.__hiddenXYZLayer(L),this.__hiddenXYZLayer(R),this.__hiddenXYZLayer(O),this.__hiddenXYZLayer(F),this.__hiddenXYZLayer(A),this.__hiddenXYZLayer(z),this.__hiddenXYZLayer("aMapZh"),this.__hiddenXYZLayer("aMapEn"),this.__hiddenXYZLayer("aMapSatZh"),this.__hiddenXYZLayer("aMapSatEn"),this.__hiddenXYZLayer(B),this.__hiddenXYZLayer(j),this.__hiddenBingmapLayer(G),this.__hiddenBingmapLayer(N),this.__hiddenBingmapLayer(V),this.__hiddenBingmapLayer(H),this.__hiddenMapboxStyleLayer()}addBgLayer(t,e){switch(this.hiddenBgLayer(),t){case W:this.__addMapboxStyleLayer(W);break;case X:this.__addMapboxStyleLayer(X);break;case U:this.__addMapboxStyleLayer(U);break;case $:this.__addMapboxStyleLayer($);break;case D:this.__addXYZLayer(D),e==q?this.__addXYZLayer(L):this.__addXYZLayer(M);break;case R:this.__addXYZLayer(R),e==q?this.__addXYZLayer(F):this.__addXYZLayer(O);break;case A:this.__addXYZLayer(A),e==q?this.__addXYZLayer(F):this.__addXYZLayer(z);break;case G:this.__addBingmapLayer(G);break;case N:this.__addBingmapLayer(N);break;case V:this.__addBingmapLayer(V);break;case H:this.__addBingmapLayer(H);break;case Z:e==q?this.__addXYZLayer("aMapEn"):this.__addXYZLayer("aMapZh");break;case Y:e==q?this.__addXYZLayer("aMapSatEn"):this.__addXYZLayer("aMapSatZh");break;case B:this.__addXYZLayer(B);break;case j:this.__addXYZLayer(j)}}}var Mw,Lw,Rw={exports:{}};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Mw=Rw,Lw=Rw.exports,function(){var t,e="Expected a function",n="__lodash_hash_undefined__",i="__lodash_placeholder__",r=16,o=32,s=64,a=128,l=256,u=1/0,h=9007199254740991,c=NaN,d=4294967295,p=[["ary",a],["bind",1],["bindKey",2],["curry",8],["curryRight",r],["flip",512],["partial",o],["partialRight",s],["rearg",l]],f="[object Arguments]",g="[object Array]",m="[object Boolean]",_="[object Date]",y="[object Error]",v="[object Function]",w="[object GeneratorFunction]",x="[object Map]",b="[object Number]",C="[object Object]",S="[object Promise]",E="[object RegExp]",I="[object Set]",P="[object String]",T="[object Symbol]",D="[object WeakMap]",M="[object ArrayBuffer]",L="[object DataView]",R="[object Float32Array]",O="[object Float64Array]",F="[object Int8Array]",A="[object Int16Array]",z="[object Int32Array]",B="[object Uint8Array]",j="[object Uint8ClampedArray]",G="[object Uint16Array]",N="[object Uint32Array]",V=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,X=/&(?:amp|lt|gt|quot|#39);/g,U=/[&<>"']/g,$=RegExp(X.source),Y=RegExp(U.source),q=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),it=/^\s+/,rt=/\s/,ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ut=/[()=,{}\[\]\/\s]/,ht=/\\(\\)?/g,ct=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,gt=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,_t=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vt=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,xt="\\ud800-\\udfff",bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ct="\\u2700-\\u27bf",St="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",It="\\ufe0e\\ufe0f",Pt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Tt="['’]",kt="["+xt+"]",Dt="["+Pt+"]",Mt="["+bt+"]",Lt="\\d+",Rt="["+Ct+"]",Ot="["+St+"]",Ft="[^"+xt+Pt+Lt+Ct+St+Et+"]",At="\\ud83c[\\udffb-\\udfff]",zt="[^"+xt+"]",Bt="(?:\\ud83c[\\udde6-\\uddff]){2}",jt="[\\ud800-\\udbff][\\udc00-\\udfff]",Gt="["+Et+"]",Nt="\\u200d",Vt="(?:"+Ot+"|"+Ft+")",Ht="(?:"+Gt+"|"+Ft+")",Wt="(?:['’](?:d|ll|m|re|s|t|ve))?",Xt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ut="(?:"+Mt+"|"+At+")?",$t="["+It+"]?",Yt=$t+Ut+"(?:"+Nt+"(?:"+[zt,Bt,jt].join("|")+")"+$t+Ut+")*",qt="(?:"+[Rt,Bt,jt].join("|")+")"+Yt,Zt="(?:"+[zt+Mt+"?",Mt,Bt,jt,kt].join("|")+")",Kt=RegExp(Tt,"g"),Jt=RegExp(Mt,"g"),Qt=RegExp(At+"(?="+At+")|"+Zt+Yt,"g"),te=RegExp([Gt+"?"+Ot+"+"+Wt+"(?="+[Dt,Gt,"$"].join("|")+")",Ht+"+"+Xt+"(?="+[Dt,Gt+Vt,"$"].join("|")+")",Gt+"?"+Vt+"+"+Wt,Gt+"+"+Xt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Lt,qt].join("|"),"g"),ee=RegExp("["+Nt+xt+bt+It+"]"),ne=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],re=-1,oe={};oe[R]=oe[O]=oe[F]=oe[A]=oe[z]=oe[B]=oe[j]=oe[G]=oe[N]=!0,oe[f]=oe[g]=oe[M]=oe[m]=oe[L]=oe[_]=oe[y]=oe[v]=oe[x]=oe[b]=oe[C]=oe[E]=oe[I]=oe[P]=oe[D]=!1;var se={};se[f]=se[g]=se[M]=se[L]=se[m]=se[_]=se[R]=se[O]=se[F]=se[A]=se[z]=se[x]=se[b]=se[C]=se[E]=se[I]=se[P]=se[T]=se[B]=se[j]=se[G]=se[N]=!0,se[y]=se[v]=se[D]=!1;var ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},le=parseFloat,ue=parseInt,he="object"==typeof k&&k&&k.Object===Object&&k,ce="object"==typeof self&&self&&self.Object===Object&&self,de=he||ce||Function("return this")(),pe=Lw&&!Lw.nodeType&&Lw,fe=pe&&Mw&&!Mw.nodeType&&Mw,ge=fe&&fe.exports===pe,me=ge&&he.process,_e=function(){try{var t=fe&&fe.require&&fe.require("util").types;return t||me&&me.binding&&me.binding("util")}catch(Hj){}}(),ye=_e&&_e.isArrayBuffer,ve=_e&&_e.isDate,we=_e&&_e.isMap,xe=_e&&_e.isRegExp,be=_e&&_e.isSet,Ce=_e&&_e.isTypedArray;function Se(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ee(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(i,s,n(s),t)}return i}function Ie(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function Pe(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Te(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function ke(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o}function De(t,e){return!(null==t||!t.length)&&Ge(t,e,0)>-1}function Me(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function Le(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function Re(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function Oe(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function Fe(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function Ae(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var ze=We("length");function Be(t,e,n){var i;return n(t,(function(t,n,r){if(e(t,n,r))return i=n,!1})),i}function je(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function Ge(t,e,n){return e==e?function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):je(t,Ve,n)}function Ne(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}function Ve(t){return t!=t}function He(t,e){var n=null==t?0:t.length;return n?$e(t,e)/n:c}function We(e){return function(n){return null==n?t:n[e]}}function Xe(e){return function(n){return null==e?t:e[n]}}function Ue(t,e,n,i,r){return r(t,(function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)})),n}function $e(e,n){for(var i,r=-1,o=e.length;++r<o;){var s=n(e[r]);s!==t&&(i=i===t?s:i+s)}return i}function Ye(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function qe(t){return t?t.slice(0,dn(t)+1).replace(it,""):t}function Ze(t){return function(e){return t(e)}}function Ke(t,e){return Le(e,(function(e){return t[e]}))}function Je(t,e){return t.has(e)}function Qe(t,e){for(var n=-1,i=t.length;++n<i&&Ge(e,t[n],0)>-1;);return n}function tn(t,e){for(var n=t.length;n--&&Ge(e,t[n],0)>-1;);return n}var en=Xe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),nn=Xe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rn(t){return"\\"+ae[t]}function on(t){return ee.test(t)}function sn(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function an(t,e){return function(n){return t(e(n))}}function ln(t,e){for(var n=-1,r=t.length,o=0,s=[];++n<r;){var a=t[n];a!==e&&a!==i||(t[n]=i,s[o++]=n)}return s}function un(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function hn(t){return on(t)?function(t){for(var e=Qt.lastIndex=0;Qt.test(t);)++e;return e}(t):ze(t)}function cn(t){return on(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.split("")}(t)}function dn(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var pn=Xe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),fn=function k(rt){var xt,bt=(rt=null==rt?de:fn.defaults(de.Object(),rt,fn.pick(de,ie))).Array,Ct=rt.Date,St=rt.Error,Et=rt.Function,It=rt.Math,Pt=rt.Object,Tt=rt.RegExp,kt=rt.String,Dt=rt.TypeError,Mt=bt.prototype,Lt=Et.prototype,Rt=Pt.prototype,Ot=rt["__core-js_shared__"],Ft=Lt.toString,At=Rt.hasOwnProperty,zt=0,Bt=(xt=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||""))?"Symbol(src)_1."+xt:"",jt=Rt.toString,Gt=Ft.call(Pt),Nt=de._,Vt=Tt("^"+Ft.call(At).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=ge?rt.Buffer:t,Wt=rt.Symbol,Xt=rt.Uint8Array,Ut=Ht?Ht.allocUnsafe:t,$t=an(Pt.getPrototypeOf,Pt),Yt=Pt.create,qt=Rt.propertyIsEnumerable,Zt=Mt.splice,Qt=Wt?Wt.isConcatSpreadable:t,ee=Wt?Wt.iterator:t,ae=Wt?Wt.toStringTag:t,he=function(){try{var t=co(Pt,"defineProperty");return t({},"",{}),t}catch(Hj){}}(),ce=rt.clearTimeout!==de.clearTimeout&&rt.clearTimeout,pe=Ct&&Ct.now!==de.Date.now&&Ct.now,fe=rt.setTimeout!==de.setTimeout&&rt.setTimeout,me=It.ceil,_e=It.floor,ze=Pt.getOwnPropertySymbols,Xe=Ht?Ht.isBuffer:t,gn=rt.isFinite,mn=Mt.join,_n=an(Pt.keys,Pt),yn=It.max,vn=It.min,wn=Ct.now,xn=rt.parseInt,bn=It.random,Cn=Mt.reverse,Sn=co(rt,"DataView"),En=co(rt,"Map"),In=co(rt,"Promise"),Pn=co(rt,"Set"),Tn=co(rt,"WeakMap"),kn=co(Pt,"create"),Dn=Tn&&new Tn,Mn={},Ln=No(Sn),Rn=No(En),On=No(In),Fn=No(Pn),An=No(Tn),zn=Wt?Wt.prototype:t,Bn=zn?zn.valueOf:t,jn=zn?zn.toString:t;function Gn(t){if(ra(t)&&!$s(t)&&!(t instanceof Wn)){if(t instanceof Hn)return t;if(At.call(t,"__wrapped__"))return Vo(t)}return new Hn(t)}var Nn=function(){function e(){}return function(n){if(!ia(n))return{};if(Yt)return Yt(n);e.prototype=n;var i=new e;return e.prototype=t,i}}();function Vn(){}function Hn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}function Wn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Un(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new $n;++e<n;)this.add(t[e])}function qn(t){var e=this.__data__=new Un(t);this.size=e.size}function Zn(t,e){var n=$s(t),i=!n&&Us(t),r=!n&&!i&&Ks(t),o=!n&&!i&&!r&&da(t),s=n||i||r||o,a=s?Ye(t.length,kt):[],l=a.length;for(var u in t)!e&&!At.call(t,u)||s&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||vo(u,l))||a.push(u);return a}function Kn(e){var n=e.length;return n?e[Yi(0,n-1)]:t}function Jn(t,e){return Fo(kr(t),ai(e,0,t.length))}function Qn(t){return Fo(kr(t))}function ti(e,n,i){(i!==t&&!Hs(e[n],i)||i===t&&!(n in e))&&oi(e,n,i)}function ei(e,n,i){var r=e[n];At.call(e,n)&&Hs(r,i)&&(i!==t||n in e)||oi(e,n,i)}function ni(t,e){for(var n=t.length;n--;)if(Hs(t[n][0],e))return n;return-1}function ii(t,e,n,i){return di(t,(function(t,r,o){e(i,t,n(t),o)})),i}function ri(t,e){return t&&Dr(e,Oa(e),t)}function oi(t,e,n){"__proto__"==e&&he?he(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function si(e,n){for(var i=-1,r=n.length,o=bt(r),s=null==e;++i<r;)o[i]=s?t:ka(e,n[i]);return o}function ai(e,n,i){return e==e&&(i!==t&&(e=e<=i?e:i),n!==t&&(e=e>=n?e:n)),e}function li(e,n,i,r,o,s){var a,l=1&n,u=2&n,h=4&n;if(i&&(a=o?i(e,r,o,s):i(e)),a!==t)return a;if(!ia(e))return e;var c=$s(e);if(c){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&At.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return kr(e,a)}else{var d=go(e),p=d==v||d==w;if(Ks(e))return Cr(e,l);if(d==C||d==f||p&&!o){if(a=u||p?{}:_o(e),!l)return u?function(t,e){return Dr(t,fo(t),e)}(e,function(t,e){return t&&Dr(e,Fa(e),t)}(a,e)):function(t,e){return Dr(t,po(t),e)}(e,ri(a,e))}else{if(!se[d])return o?e:{};a=function(t,e,n){var i,r=t.constructor;switch(e){case M:return Sr(t);case m:case _:return new r(+t);case L:return function(t,e){var n=e?Sr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case R:case O:case F:case A:case z:case B:case j:case G:case N:return Er(t,n);case x:return new r;case b:case P:return new r(t);case E:return function(t){var e=new t.constructor(t.source,dt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case I:return new r;case T:return i=t,Bn?Pt(Bn.call(i)):{}}}(e,d,l)}}s||(s=new qn);var g=s.get(e);if(g)return g;s.set(e,a),ua(e)?e.forEach((function(t){a.add(li(t,n,i,t,e,s))})):oa(e)&&e.forEach((function(t,r){a.set(r,li(t,n,i,r,e,s))}));var y=c?t:(h?u?ro:io:u?Fa:Oa)(e);return Ie(y||e,(function(t,r){y&&(t=e[r=t]),ei(a,r,li(t,n,i,r,e,s))})),a}function ui(e,n,i){var r=i.length;if(null==e)return!r;for(e=Pt(e);r--;){var o=i[r],s=n[o],a=e[o];if(a===t&&!(o in e)||!s(a))return!1}return!0}function hi(n,i,r){if("function"!=typeof n)throw new Dt(e);return Mo((function(){n.apply(t,r)}),i)}function ci(t,e,n,i){var r=-1,o=De,s=!0,a=t.length,l=[],u=e.length;if(!a)return l;n&&(e=Le(e,Ze(n))),i?(o=Me,s=!1):e.length>=200&&(o=Je,s=!1,e=new Yn(e));t:for(;++r<a;){var h=t[r],c=null==n?h:n(h);if(h=i||0!==h?h:0,s&&c==c){for(var d=u;d--;)if(e[d]===c)continue t;l.push(h)}else o(e,c,i)||l.push(h)}return l}Gn.templateSettings={escape:q,evaluate:Z,interpolate:K,variable:"",imports:{_:Gn}},Gn.prototype=Vn.prototype,Gn.prototype.constructor=Gn,Hn.prototype=Nn(Vn.prototype),Hn.prototype.constructor=Hn,Wn.prototype=Nn(Vn.prototype),Wn.prototype.constructor=Wn,Xn.prototype.clear=function(){this.__data__=kn?kn(null):{},this.size=0},Xn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Xn.prototype.get=function(e){var i=this.__data__;if(kn){var r=i[e];return r===n?t:r}return At.call(i,e)?i[e]:t},Xn.prototype.has=function(e){var n=this.__data__;return kn?n[e]!==t:At.call(n,e)},Xn.prototype.set=function(e,i){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=kn&&i===t?n:i,this},Un.prototype.clear=function(){this.__data__=[],this.size=0},Un.prototype.delete=function(t){var e=this.__data__,n=ni(e,t);return!(n<0||(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,0))},Un.prototype.get=function(e){var n=this.__data__,i=ni(n,e);return i<0?t:n[i][1]},Un.prototype.has=function(t){return ni(this.__data__,t)>-1},Un.prototype.set=function(t,e){var n=this.__data__,i=ni(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Xn,map:new(En||Un),string:new Xn}},$n.prototype.delete=function(t){var e=uo(this,t).delete(t);return this.size-=e?1:0,e},$n.prototype.get=function(t){return uo(this,t).get(t)},$n.prototype.has=function(t){return uo(this,t).has(t)},$n.prototype.set=function(t,e){var n=uo(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},Yn.prototype.add=Yn.prototype.push=function(t){return this.__data__.set(t,n),this},Yn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.clear=function(){this.__data__=new Un,this.size=0},qn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},qn.prototype.get=function(t){return this.__data__.get(t)},qn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Un){var i=n.__data__;if(!En||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new $n(i)}return n.set(t,e),this.size=n.size,this};var di=Rr(wi),pi=Rr(xi,!0);function fi(t,e){var n=!0;return di(t,(function(t,i,r){return n=!!e(t,i,r)})),n}function gi(e,n,i){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=n(s);if(null!=a&&(l===t?a==a&&!ca(a):i(a,l)))var l=a,u=s}return u}function mi(t,e){var n=[];return di(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function _i(t,e,n,i,r){var o=-1,s=t.length;for(n||(n=yo),r||(r=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?_i(a,e-1,n,i,r):Re(r,a):i||(r[r.length]=a)}return r}var yi=Or(),vi=Or(!0);function wi(t,e){return t&&yi(t,e,Oa)}function xi(t,e){return t&&vi(t,e,Oa)}function bi(t,e){return ke(e,(function(e){return ta(t[e])}))}function Ci(e,n){for(var i=0,r=(n=vr(n,e)).length;null!=e&&i<r;)e=e[Go(n[i++])];return i&&i==r?e:t}function Si(t,e,n){var i=e(t);return $s(t)?i:Re(i,n(t))}function Ei(e){return null==e?e===t?"[object Undefined]":"[object Null]":ae&&ae in Pt(e)?function(e){var n=At.call(e,ae),i=e[ae];try{e[ae]=t;var r=!0}catch(Hj){}var o=jt.call(e);return r&&(n?e[ae]=i:delete e[ae]),o}(e):function(t){return jt.call(t)}(e)}function Ii(t,e){return t>e}function Pi(t,e){return null!=t&&At.call(t,e)}function Ti(t,e){return null!=t&&e in Pt(t)}function ki(e,n,i){for(var r=i?Me:De,o=e[0].length,s=e.length,a=s,l=bt(s),u=1/0,h=[];a--;){var c=e[a];a&&n&&(c=Le(c,Ze(n))),u=vn(c.length,u),l[a]=!i&&(n||o>=120&&c.length>=120)?new Yn(a&&c):t}c=e[0];var d=-1,p=l[0];t:for(;++d<o&&h.length<u;){var f=c[d],g=n?n(f):f;if(f=i||0!==f?f:0,!(p?Je(p,g):r(h,g,i))){for(a=s;--a;){var m=l[a];if(!(m?Je(m,g):r(e[a],g,i)))continue t}p&&p.push(g),h.push(f)}}return h}function Di(e,n,i){var r=null==(e=To(e,n=vr(n,e)))?e:e[Go(Qo(n))];return null==r?t:Se(r,e,i)}function Mi(t){return ra(t)&&Ei(t)==f}function Li(e,n,i,r,o){return e===n||(null==e||null==n||!ra(e)&&!ra(n)?e!=e&&n!=n:function(e,n,i,r,o,s){var a=$s(e),l=$s(n),u=a?g:go(e),h=l?g:go(n),c=(u=u==f?C:u)==C,d=(h=h==f?C:h)==C,p=u==h;if(p&&Ks(e)){if(!Ks(n))return!1;a=!0,c=!1}if(p&&!c)return s||(s=new qn),a||da(e)?eo(e,n,i,r,o,s):function(t,e,n,i,r,o,s){switch(n){case L:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case M:return!(t.byteLength!=e.byteLength||!o(new Xt(t),new Xt(e)));case m:case _:case b:return Hs(+t,+e);case y:return t.name==e.name&&t.message==e.message;case E:case P:return t==e+"";case x:var a=sn;case I:var l=1&i;if(a||(a=un),t.size!=e.size&&!l)return!1;var u=s.get(t);if(u)return u==e;i|=2,s.set(t,e);var h=eo(a(t),a(e),i,r,o,s);return s.delete(t),h;case T:if(Bn)return Bn.call(t)==Bn.call(e)}return!1}(e,n,u,i,r,o,s);if(!(1&i)){var v=c&&At.call(e,"__wrapped__"),w=d&&At.call(n,"__wrapped__");if(v||w){var S=v?e.value():e,k=w?n.value():n;return s||(s=new qn),o(S,k,i,r,s)}}return!!p&&(s||(s=new qn),function(e,n,i,r,o,s){var a=1&i,l=io(e),u=l.length,h=io(n),c=h.length;if(u!=c&&!a)return!1;for(var d=u;d--;){var p=l[d];if(!(a?p in n:At.call(n,p)))return!1}var f=s.get(e),g=s.get(n);if(f&&g)return f==n&&g==e;var m=!0;s.set(e,n),s.set(n,e);for(var _=a;++d<u;){var y=e[p=l[d]],v=n[p];if(r)var w=a?r(v,y,p,n,e,s):r(y,v,p,e,n,s);if(!(w===t?y===v||o(y,v,i,r,s):w)){m=!1;break}_||(_="constructor"==p)}if(m&&!_){var x=e.constructor,b=n.constructor;x==b||!("constructor"in e)||!("constructor"in n)||"function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b||(m=!1)}return s.delete(e),s.delete(n),m}(e,n,i,r,o,s))}(e,n,i,r,Li,o))}function Ri(e,n,i,r){var o=i.length,s=o,a=!r;if(null==e)return!s;for(e=Pt(e);o--;){var l=i[o];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var u=(l=i[o])[0],h=e[u],c=l[1];if(a&&l[2]){if(h===t&&!(u in e))return!1}else{var d=new qn;if(r)var p=r(h,c,u,e,n,d);if(!(p===t?Li(c,h,3,r,d):p))return!1}}return!0}function Oi(t){return!(!ia(t)||(e=t,Bt&&Bt in e))&&(ta(t)?Vt:gt).test(No(t));var e}function Fi(t){return"function"==typeof t?t:null==t?sl:"object"==typeof t?$s(t)?Ni(t[0],t[1]):Gi(t):gl(t)}function Ai(t){if(!So(t))return _n(t);var e=[];for(var n in Pt(t))At.call(t,n)&&"constructor"!=n&&e.push(n);return e}function zi(t){if(!ia(t))return function(t){var e=[];if(null!=t)for(var n in Pt(t))e.push(n);return e}(t);var e=So(t),n=[];for(var i in t)("constructor"!=i||!e&&At.call(t,i))&&n.push(i);return n}function Bi(t,e){return t<e}function ji(t,e){var n=-1,i=qs(t)?bt(t.length):[];return di(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function Gi(t){var e=ho(t);return 1==e.length&&e[0][2]?Io(e[0][0],e[0][1]):function(n){return n===t||Ri(n,t,e)}}function Ni(e,n){return xo(e)&&Eo(n)?Io(Go(e),n):function(i){var r=ka(i,e);return r===t&&r===n?Da(i,e):Li(n,r,3)}}function Vi(e,n,i,r,o){e!==n&&yi(n,(function(s,a){if(o||(o=new qn),ia(s))!function(e,n,i,r,o,s,a){var l=ko(e,i),u=ko(n,i),h=a.get(u);if(h)ti(e,i,h);else{var c=s?s(l,u,i+"",e,n,a):t,d=c===t;if(d){var p=$s(u),f=!p&&Ks(u),g=!p&&!f&&da(u);c=u,p||f||g?$s(l)?c=l:Zs(l)?c=kr(l):f?(d=!1,c=Cr(u,!0)):g?(d=!1,c=Er(u,!0)):c=[]:aa(u)||Us(u)?(c=l,Us(l)?c=wa(l):ia(l)&&!ta(l)||(c=_o(u))):d=!1}d&&(a.set(u,c),o(c,u,r,s,a),a.delete(u)),ti(e,i,c)}}(e,n,a,i,Vi,r,o);else{var l=r?r(ko(e,a),s,a+"",e,n,o):t;l===t&&(l=s),ti(e,a,l)}}),Fa)}function Hi(e,n){var i=e.length;if(i)return vo(n+=n<0?i:0,i)?e[n]:t}function Wi(t,e,n){e=e.length?Le(e,(function(t){return $s(t)?function(e){return Ci(e,1===t.length?t[0]:t)}:t})):[sl];var i=-1;return e=Le(e,Ze(lo())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(ji(t,(function(t,n,r){return{criteria:Le(e,(function(e){return e(t)})),index:++i,value:t}})),(function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;++i<s;){var l=Ir(r[i],o[i]);if(l)return i>=a?l:l*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)}))}function Xi(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var s=e[i],a=Ci(t,s);n(a,s)&&Qi(o,vr(s,t),a)}return o}function Ui(t,e,n,i){var r=i?Ne:Ge,o=-1,s=e.length,a=t;for(t===e&&(e=kr(e)),n&&(a=Le(t,Ze(n)));++o<s;)for(var l=0,u=e[o],h=n?n(u):u;(l=r(a,h,l,i))>-1;)a!==t&&Zt.call(a,l,1),Zt.call(t,l,1);return t}function $i(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;vo(r)?Zt.call(t,r,1):cr(t,r)}}return t}function Yi(t,e){return t+_e(bn()*(e-t+1))}function qi(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=_e(e/2))&&(t+=t)}while(e);return n}function Zi(t,e){return Lo(Po(t,e,sl),t+"")}function Ki(t){return Kn(Ha(t))}function Ji(t,e){var n=Ha(t);return Fo(n,ai(e,0,n.length))}function Qi(e,n,i,r){if(!ia(e))return e;for(var o=-1,s=(n=vr(n,e)).length,a=s-1,l=e;null!=l&&++o<s;){var u=Go(n[o]),h=i;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var c=l[u];(h=r?r(c,u,l):t)===t&&(h=ia(c)?c:vo(n[o+1])?[]:{})}ei(l,u,h),l=l[u]}return e}var tr=Dn?function(t,e){return Dn.set(t,e),t}:sl,er=he?function(t,e){return he(t,"toString",{configurable:!0,enumerable:!1,value:il(e),writable:!0})}:sl;function nr(t){return Fo(Ha(t))}function ir(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var o=bt(r);++i<r;)o[i]=t[i+e];return o}function rr(t,e){var n;return di(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}function or(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var o=i+r>>>1,s=t[o];null!==s&&!ca(s)&&(n?s<=e:s<e)?i=o+1:r=o}return r}return sr(t,e,sl,n)}function sr(e,n,i,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(n=i(n))!=n,l=null===n,u=ca(n),h=n===t;o<s;){var c=_e((o+s)/2),d=i(e[c]),p=d!==t,f=null===d,g=d==d,m=ca(d);if(a)var _=r||g;else _=h?g&&(r||p):l?g&&p&&(r||!f):u?g&&p&&!f&&(r||!m):!f&&!m&&(r?d<=n:d<n);_?o=c+1:s=c}return vn(s,4294967294)}function ar(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n],a=e?e(s):s;if(!n||!Hs(a,l)){var l=a;o[r++]=0===s?0:s}}return o}function lr(t){return"number"==typeof t?t:ca(t)?c:+t}function ur(t){if("string"==typeof t)return t;if($s(t))return Le(t,ur)+"";if(ca(t))return jn?jn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function hr(t,e,n){var i=-1,r=De,o=t.length,s=!0,a=[],l=a;if(n)s=!1,r=Me;else if(o>=200){var u=e?null:qr(t);if(u)return un(u);s=!1,r=Je,l=new Yn}else l=e?[]:a;t:for(;++i<o;){var h=t[i],c=e?e(h):h;if(h=n||0!==h?h:0,s&&c==c){for(var d=l.length;d--;)if(l[d]===c)continue t;e&&l.push(c),a.push(h)}else r(l,c,n)||(l!==a&&l.push(c),a.push(h))}return a}function cr(t,e){return null==(t=To(t,e=vr(e,t)))||delete t[Go(Qo(e))]}function dr(t,e,n,i){return Qi(t,e,n(Ci(t,e)),i)}function pr(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?ir(t,i?0:o,i?o+1:r):ir(t,i?o+1:0,i?r:o)}function fr(t,e){var n=t;return n instanceof Wn&&(n=n.value()),Oe(e,(function(t,e){return e.func.apply(e.thisArg,Re([t],e.args))}),n)}function gr(t,e,n){var i=t.length;if(i<2)return i?hr(t[0]):[];for(var r=-1,o=bt(i);++r<i;)for(var s=t[r],a=-1;++a<i;)a!=r&&(o[r]=ci(o[r]||s,t[a],e,n));return hr(_i(o,1),e,n)}function mr(e,n,i){for(var r=-1,o=e.length,s=n.length,a={};++r<o;){var l=r<s?n[r]:t;i(a,e[r],l)}return a}function _r(t){return Zs(t)?t:[]}function yr(t){return"function"==typeof t?t:sl}function vr(t,e){return $s(t)?t:xo(t,e)?[t]:jo(xa(t))}var wr=Zi;function xr(e,n,i){var r=e.length;return i=i===t?r:i,!n&&i>=r?e:ir(e,n,i)}var br=ce||function(t){return de.clearTimeout(t)};function Cr(t,e){if(e)return t.slice();var n=t.length,i=Ut?Ut(n):new t.constructor(n);return t.copy(i),i}function Sr(t){var e=new t.constructor(t.byteLength);return new Xt(e).set(new Xt(t)),e}function Er(t,e){var n=e?Sr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ir(e,n){if(e!==n){var i=e!==t,r=null===e,o=e==e,s=ca(e),a=n!==t,l=null===n,u=n==n,h=ca(n);if(!l&&!h&&!s&&e>n||s&&a&&u&&!l&&!h||r&&a&&u||!i&&u||!o)return 1;if(!r&&!s&&!h&&e<n||h&&i&&o&&!r&&!s||l&&i&&o||!a&&o||!u)return-1}return 0}function Pr(t,e,n,i){for(var r=-1,o=t.length,s=n.length,a=-1,l=e.length,u=yn(o-s,0),h=bt(l+u),c=!i;++a<l;)h[a]=e[a];for(;++r<s;)(c||r<o)&&(h[n[r]]=t[r]);for(;u--;)h[a++]=t[r++];return h}function Tr(t,e,n,i){for(var r=-1,o=t.length,s=-1,a=n.length,l=-1,u=e.length,h=yn(o-a,0),c=bt(h+u),d=!i;++r<h;)c[r]=t[r];for(var p=r;++l<u;)c[p+l]=e[l];for(;++s<a;)(d||r<o)&&(c[p+n[s]]=t[r++]);return c}function kr(t,e){var n=-1,i=t.length;for(e||(e=bt(i));++n<i;)e[n]=t[n];return e}function Dr(e,n,i,r){var o=!i;i||(i={});for(var s=-1,a=n.length;++s<a;){var l=n[s],u=r?r(i[l],e[l],l,i,e):t;u===t&&(u=e[l]),o?oi(i,l,u):ei(i,l,u)}return i}function Mr(t,e){return function(n,i){var r=$s(n)?Ee:ii,o=e?e():{};return r(n,t,lo(i,2),o)}}function Lr(e){return Zi((function(n,i){var r=-1,o=i.length,s=o>1?i[o-1]:t,a=o>2?i[2]:t;for(s=e.length>3&&"function"==typeof s?(o--,s):t,a&&wo(i[0],i[1],a)&&(s=o<3?t:s,o=1),n=Pt(n);++r<o;){var l=i[r];l&&e(n,l,r,s)}return n}))}function Rr(t,e){return function(n,i){if(null==n)return n;if(!qs(n))return t(n,i);for(var r=n.length,o=e?r:-1,s=Pt(n);(e?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function Or(t){return function(e,n,i){for(var r=-1,o=Pt(e),s=i(e),a=s.length;a--;){var l=s[t?a:++r];if(!1===n(o[l],l,o))break}return e}}function Fr(e){return function(n){var i=on(n=xa(n))?cn(n):t,r=i?i[0]:n.charAt(0),o=i?xr(i,1).join(""):n.slice(1);return r[e]()+o}}function Ar(t){return function(e){return Oe(tl(Ua(e).replace(Kt,"")),t,"")}}function zr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Nn(t.prototype),i=t.apply(n,e);return ia(i)?i:n}}function Br(e){return function(n,i,r){var o=Pt(n);if(!qs(n)){var s=lo(i,3);n=Oa(n),i=function(t){return s(o[t],t,o)}}var a=e(n,i,r);return a>-1?o[s?n[a]:a]:t}}function jr(n){return no((function(i){var r=i.length,o=r,s=Hn.prototype.thru;for(n&&i.reverse();o--;){var a=i[o];if("function"!=typeof a)throw new Dt(e);if(s&&!l&&"wrapper"==so(a))var l=new Hn([],!0)}for(o=l?o:r;++o<r;){var u=so(a=i[o]),h="wrapper"==u?oo(a):t;l=h&&bo(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?l[so(h[0])].apply(l,h[3]):1==a.length&&bo(a)?l[u]():l.thru(a)}return function(){var t=arguments,e=t[0];if(l&&1==t.length&&$s(e))return l.plant(e).value();for(var n=0,o=r?i[n].apply(this,t):e;++n<r;)o=i[n].call(this,o);return o}}))}function Gr(e,n,i,r,o,s,l,u,h,c){var d=n&a,p=1&n,f=2&n,g=24&n,m=512&n,_=f?t:zr(e);return function a(){for(var y=arguments.length,v=bt(y),w=y;w--;)v[w]=arguments[w];if(g)var x=ao(a),b=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(v,x);if(r&&(v=Pr(v,r,o,g)),s&&(v=Tr(v,s,l,g)),y-=b,g&&y<c){var C=ln(v,x);return $r(e,n,Gr,a.placeholder,i,v,C,u,h,c-y)}var S=p?i:this,E=f?S[e]:e;return y=v.length,u?v=function(e,n){for(var i=e.length,r=vn(n.length,i),o=kr(e);r--;){var s=n[r];e[r]=vo(s,i)?o[s]:t}return e}(v,u):m&&y>1&&v.reverse(),d&&h<y&&(v.length=h),this&&this!==de&&this instanceof a&&(E=_||zr(E)),E.apply(S,v)}}function Nr(t,e){return function(n,i){return function(t,e,n,i){return wi(t,(function(t,r,o){e(i,n(t),r,o)})),i}(n,t,e(i),{})}}function Vr(e,n){return function(i,r){var o;if(i===t&&r===t)return n;if(i!==t&&(o=i),r!==t){if(o===t)return r;"string"==typeof i||"string"==typeof r?(i=ur(i),r=ur(r)):(i=lr(i),r=lr(r)),o=e(i,r)}return o}}function Hr(t){return no((function(e){return e=Le(e,Ze(lo())),Zi((function(n){var i=this;return t(e,(function(t){return Se(t,i,n)}))}))}))}function Wr(e,n){var i=(n=n===t?" ":ur(n)).length;if(i<2)return i?qi(n,e):n;var r=qi(n,me(e/hn(n)));return on(n)?xr(cn(r),0,e).join(""):r.slice(0,e)}function Xr(e){return function(n,i,r){return r&&"number"!=typeof r&&wo(n,i,r)&&(i=r=t),n=ma(n),i===t?(i=n,n=0):i=ma(i),function(t,e,n,i){for(var r=-1,o=yn(me((e-t)/(n||1)),0),s=bt(o);o--;)s[i?o:++r]=t,t+=n;return s}(n,i,r=r===t?n<i?1:-1:ma(r),e)}}function Ur(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=va(e),n=va(n)),t(e,n)}}function $r(e,n,i,r,a,l,u,h,c,d){var p=8&n;n|=p?o:s,4&(n&=~(p?s:o))||(n&=-4);var f=[e,n,a,p?l:t,p?u:t,p?t:l,p?t:u,h,c,d],g=i.apply(t,f);return bo(e)&&Do(g,f),g.placeholder=r,Ro(g,e,n)}function Yr(t){var e=It[t];return function(t,n){if(t=va(t),(n=null==n?0:vn(_a(n),292))&&gn(t)){var i=(xa(t)+"e").split("e");return+((i=(xa(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var qr=Pn&&1/un(new Pn([,-0]))[1]==u?function(t){return new Pn(t)}:cl;function Zr(t){return function(e){var n=go(e);return n==x?sn(e):n==I?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(e):function(t,e){return Le(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Kr(n,u,h,c,d,p,f,g){var m=2&u;if(!m&&"function"!=typeof n)throw new Dt(e);var _=c?c.length:0;if(_||(u&=-97,c=d=t),f=f===t?f:yn(_a(f),0),g=g===t?g:_a(g),_-=d?d.length:0,u&s){var y=c,v=d;c=d=t}var w=m?t:oo(n),x=[n,u,h,c,d,y,v,p,f,g];if(w&&function(t,e){var n=t[1],r=e[1],o=n|r,s=o<131,u=r==a&&8==n||r==a&&n==l&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!s&&!u)return t;1&r&&(t[2]=e[2],o|=1&n?0:4);var h=e[3];if(h){var c=t[3];t[3]=c?Pr(c,h,e[4]):h,t[4]=c?ln(t[3],i):e[4]}(h=e[5])&&(c=t[5],t[5]=c?Tr(c,h,e[6]):h,t[6]=c?ln(t[5],i):e[6]),(h=e[7])&&(t[7]=h),r&a&&(t[8]=null==t[8]?e[8]:vn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(x,w),n=x[0],u=x[1],h=x[2],c=x[3],d=x[4],!(g=x[9]=x[9]===t?m?0:n.length:yn(x[9]-_,0))&&24&u&&(u&=-25),u&&1!=u)b=8==u||u==r?function(e,n,i){var r=zr(e);return function o(){for(var s=arguments.length,a=bt(s),l=s,u=ao(o);l--;)a[l]=arguments[l];var h=s<3&&a[0]!==u&&a[s-1]!==u?[]:ln(a,u);return(s-=h.length)<i?$r(e,n,Gr,o.placeholder,t,a,h,t,t,i-s):Se(this&&this!==de&&this instanceof o?r:e,this,a)}}(n,u,g):u!=o&&33!=u||d.length?Gr.apply(t,x):function(t,e,n,i){var r=1&e,o=zr(t);return function e(){for(var s=-1,a=arguments.length,l=-1,u=i.length,h=bt(u+a),c=this&&this!==de&&this instanceof e?o:t;++l<u;)h[l]=i[l];for(;a--;)h[l++]=arguments[++s];return Se(c,r?n:this,h)}}(n,u,h,c);else var b=function(t,e,n){var i=1&e,r=zr(t);return function e(){return(this&&this!==de&&this instanceof e?r:t).apply(i?n:this,arguments)}}(n,u,h);return Ro((w?tr:Do)(b,x),n,u)}function Jr(e,n,i,r){return e===t||Hs(e,Rt[i])&&!At.call(r,i)?n:e}function Qr(e,n,i,r,o,s){return ia(e)&&ia(n)&&(s.set(n,e),Vi(e,n,t,Qr,s),s.delete(n)),e}function to(e){return aa(e)?t:e}function eo(e,n,i,r,o,s){var a=1&i,l=e.length,u=n.length;if(l!=u&&!(a&&u>l))return!1;var h=s.get(e),c=s.get(n);if(h&&c)return h==n&&c==e;var d=-1,p=!0,f=2&i?new Yn:t;for(s.set(e,n),s.set(n,e);++d<l;){var g=e[d],m=n[d];if(r)var _=a?r(m,g,d,n,e,s):r(g,m,d,e,n,s);if(_!==t){if(_)continue;p=!1;break}if(f){if(!Ae(n,(function(t,e){if(!Je(f,e)&&(g===t||o(g,t,i,r,s)))return f.push(e)}))){p=!1;break}}else if(g!==m&&!o(g,m,i,r,s)){p=!1;break}}return s.delete(e),s.delete(n),p}function no(e){return Lo(Po(e,t,Yo),e+"")}function io(t){return Si(t,Oa,po)}function ro(t){return Si(t,Fa,fo)}var oo=Dn?function(t){return Dn.get(t)}:cl;function so(t){for(var e=t.name+"",n=Mn[e],i=At.call(Mn,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function ao(t){return(At.call(Gn,"placeholder")?Gn:t).placeholder}function lo(){var t=Gn.iteratee||al;return t=t===al?Fi:t,arguments.length?t(arguments[0],arguments[1]):t}function uo(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function ho(t){for(var e=Oa(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Eo(r)]}return e}function co(e,n){var i=function(e,n){return null==e?t:e[n]}(e,n);return Oi(i)?i:t}var po=ze?function(t){return null==t?[]:(t=Pt(t),ke(ze(t),(function(e){return qt.call(t,e)})))}:yl,fo=ze?function(t){for(var e=[];t;)Re(e,po(t)),t=$t(t);return e}:yl,go=Ei;function mo(t,e,n){for(var i=-1,r=(e=vr(e,t)).length,o=!1;++i<r;){var s=Go(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&na(r)&&vo(s,r)&&($s(t)||Us(t))}function _o(t){return"function"!=typeof t.constructor||So(t)?{}:Nn($t(t))}function yo(t){return $s(t)||Us(t)||!!(Qt&&t&&t[Qt])}function vo(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&_t.test(t))&&t>-1&&t%1==0&&t<e}function wo(t,e,n){if(!ia(n))return!1;var i=typeof e;return!!("number"==i?qs(n)&&vo(e,n.length):"string"==i&&e in n)&&Hs(n[e],t)}function xo(t,e){if($s(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ca(t))||Q.test(t)||!J.test(t)||null!=e&&t in Pt(e)}function bo(t){var e=so(t),n=Gn[e];if("function"!=typeof n||!(e in Wn.prototype))return!1;if(t===n)return!0;var i=oo(n);return!!i&&t===i[0]}(Sn&&go(new Sn(new ArrayBuffer(1)))!=L||En&&go(new En)!=x||In&&go(In.resolve())!=S||Pn&&go(new Pn)!=I||Tn&&go(new Tn)!=D)&&(go=function(e){var n=Ei(e),i=n==C?e.constructor:t,r=i?No(i):"";if(r)switch(r){case Ln:return L;case Rn:return x;case On:return S;case Fn:return I;case An:return D}return n});var Co=Ot?ta:vl;function So(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Rt)}function Eo(t){return t==t&&!ia(t)}function Io(e,n){return function(i){return null!=i&&i[e]===n&&(n!==t||e in Pt(i))}}function Po(e,n,i){return n=yn(n===t?e.length-1:n,0),function(){for(var t=arguments,r=-1,o=yn(t.length-n,0),s=bt(o);++r<o;)s[r]=t[n+r];r=-1;for(var a=bt(n+1);++r<n;)a[r]=t[r];return a[n]=i(s),Se(e,this,a)}}function To(t,e){return e.length<2?t:Ci(t,ir(e,0,-1))}function ko(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Do=Oo(tr),Mo=fe||function(t,e){return de.setTimeout(t,e)},Lo=Oo(er);function Ro(t,e,n){var i=e+"";return Lo(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(ot,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return Ie(p,(function(n){var i="_."+n[0];e&n[1]&&!De(t,i)&&t.push(i)})),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(at):[]}(i),n)))}function Oo(e){var n=0,i=0;return function(){var r=wn(),o=16-(r-i);if(i=r,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(t,arguments)}}function Fo(e,n){var i=-1,r=e.length,o=r-1;for(n=n===t?r:n;++i<n;){var s=Yi(i,o),a=e[s];e[s]=e[i],e[i]=a}return e.length=n,e}var Ao,zo,Bo,jo=(Ao=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,i,r){e.push(i?r.replace(ht,"$1"):n||t)})),e},zo=zs(Ao,(function(t){return 500===Bo.size&&Bo.clear(),t})),Bo=zo.cache,zo);function Go(t){if("string"==typeof t||ca(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function No(t){if(null!=t){try{return Ft.call(t)}catch(Hj){}try{return t+""}catch(Hj){}}return""}function Vo(t){if(t instanceof Wn)return t.clone();var e=new Hn(t.__wrapped__,t.__chain__);return e.__actions__=kr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Ho=Zi((function(t,e){return Zs(t)?ci(t,_i(e,1,Zs,!0)):[]})),Wo=Zi((function(e,n){var i=Qo(n);return Zs(i)&&(i=t),Zs(e)?ci(e,_i(n,1,Zs,!0),lo(i,2)):[]})),Xo=Zi((function(e,n){var i=Qo(n);return Zs(i)&&(i=t),Zs(e)?ci(e,_i(n,1,Zs,!0),t,i):[]}));function Uo(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:_a(n);return r<0&&(r=yn(i+r,0)),je(t,lo(e,3),r)}function $o(e,n,i){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return i!==t&&(o=_a(i),o=i<0?yn(r+o,0):vn(o,r-1)),je(e,lo(n,3),o,!0)}function Yo(t){return null!=t&&t.length?_i(t,1):[]}function qo(e){return e&&e.length?e[0]:t}var Zo=Zi((function(t){var e=Le(t,_r);return e.length&&e[0]===t[0]?ki(e):[]})),Ko=Zi((function(e){var n=Qo(e),i=Le(e,_r);return n===Qo(i)?n=t:i.pop(),i.length&&i[0]===e[0]?ki(i,lo(n,2)):[]})),Jo=Zi((function(e){var n=Qo(e),i=Le(e,_r);return(n="function"==typeof n?n:t)&&i.pop(),i.length&&i[0]===e[0]?ki(i,t,n):[]}));function Qo(e){var n=null==e?0:e.length;return n?e[n-1]:t}var ts=Zi(es);function es(t,e){return t&&t.length&&e&&e.length?Ui(t,e):t}var ns=no((function(t,e){var n=null==t?0:t.length,i=si(t,e);return $i(t,Le(e,(function(t){return vo(t,n)?+t:t})).sort(Ir)),i}));function is(t){return null==t?t:Cn.call(t)}var rs=Zi((function(t){return hr(_i(t,1,Zs,!0))})),os=Zi((function(e){var n=Qo(e);return Zs(n)&&(n=t),hr(_i(e,1,Zs,!0),lo(n,2))})),ss=Zi((function(e){var n=Qo(e);return n="function"==typeof n?n:t,hr(_i(e,1,Zs,!0),t,n)}));function as(t){if(!t||!t.length)return[];var e=0;return t=ke(t,(function(t){if(Zs(t))return e=yn(t.length,e),!0})),Ye(e,(function(e){return Le(t,We(e))}))}function ls(e,n){if(!e||!e.length)return[];var i=as(e);return null==n?i:Le(i,(function(e){return Se(n,t,e)}))}var us=Zi((function(t,e){return Zs(t)?ci(t,e):[]})),hs=Zi((function(t){return gr(ke(t,Zs))})),cs=Zi((function(e){var n=Qo(e);return Zs(n)&&(n=t),gr(ke(e,Zs),lo(n,2))})),ds=Zi((function(e){var n=Qo(e);return n="function"==typeof n?n:t,gr(ke(e,Zs),t,n)})),ps=Zi(as),fs=Zi((function(e){var n=e.length,i=n>1?e[n-1]:t;return i="function"==typeof i?(e.pop(),i):t,ls(e,i)}));function gs(t){var e=Gn(t);return e.__chain__=!0,e}function ms(t,e){return e(t)}var _s=no((function(e){var n=e.length,i=n?e[0]:0,r=this.__wrapped__,o=function(t){return si(t,e)};return!(n>1||this.__actions__.length)&&r instanceof Wn&&vo(i)?((r=r.slice(i,+i+(n?1:0))).__actions__.push({func:ms,args:[o],thisArg:t}),new Hn(r,this.__chain__).thru((function(e){return n&&!e.length&&e.push(t),e}))):this.thru(o)})),ys=Mr((function(t,e,n){At.call(t,n)?++t[n]:oi(t,n,1)})),vs=Br(Uo),ws=Br($o);function xs(t,e){return($s(t)?Ie:di)(t,lo(e,3))}function bs(t,e){return($s(t)?Pe:pi)(t,lo(e,3))}var Cs=Mr((function(t,e,n){At.call(t,n)?t[n].push(e):oi(t,n,[e])})),Ss=Zi((function(t,e,n){var i=-1,r="function"==typeof e,o=qs(t)?bt(t.length):[];return di(t,(function(t){o[++i]=r?Se(e,t,n):Di(t,e,n)})),o})),Es=Mr((function(t,e,n){oi(t,n,e)}));function Is(t,e){return($s(t)?Le:ji)(t,lo(e,3))}var Ps=Mr((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Ts=Zi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&wo(t,e[0],e[1])?e=[]:n>2&&wo(e[0],e[1],e[2])&&(e=[e[0]]),Wi(t,_i(e,1),[])})),ks=pe||function(){return de.Date.now()};function Ds(e,n,i){return n=i?t:n,n=e&&null==n?e.length:n,Kr(e,a,t,t,t,t,n)}function Ms(n,i){var r;if("function"!=typeof i)throw new Dt(e);return n=_a(n),function(){return--n>0&&(r=i.apply(this,arguments)),n<=1&&(i=t),r}}var Ls=Zi((function(t,e,n){var i=1;if(n.length){var r=ln(n,ao(Ls));i|=o}return Kr(t,i,e,n,r)})),Rs=Zi((function(t,e,n){var i=3;if(n.length){var r=ln(n,ao(Rs));i|=o}return Kr(e,i,t,n,r)}));function Os(n,i,r){var o,s,a,l,u,h,c=0,d=!1,p=!1,f=!0;if("function"!=typeof n)throw new Dt(e);function g(e){var i=o,r=s;return o=s=t,c=e,l=n.apply(r,i)}function m(e){var n=e-h;return h===t||n>=i||n<0||p&&e-c>=a}function _(){var t=ks();if(m(t))return y(t);u=Mo(_,function(t){var e=i-(t-h);return p?vn(e,a-(t-c)):e}(t))}function y(e){return u=t,f&&o?g(e):(o=s=t,l)}function v(){var e=ks(),n=m(e);if(o=arguments,s=this,h=e,n){if(u===t)return function(t){return c=t,u=Mo(_,i),d?g(t):l}(h);if(p)return br(u),u=Mo(_,i),g(h)}return u===t&&(u=Mo(_,i)),l}return i=va(i)||0,ia(r)&&(d=!!r.leading,a=(p="maxWait"in r)?yn(va(r.maxWait)||0,i):a,f="trailing"in r?!!r.trailing:f),v.cancel=function(){u!==t&&br(u),c=0,o=h=s=u=t},v.flush=function(){return u===t?l:y(ks())},v}var Fs=Zi((function(t,e){return hi(t,1,e)})),As=Zi((function(t,e,n){return hi(t,va(e)||0,n)}));function zs(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new Dt(e);var i=function(){var e=arguments,r=n?n.apply(this,e):e[0],o=i.cache;if(o.has(r))return o.get(r);var s=t.apply(this,e);return i.cache=o.set(r,s)||o,s};return i.cache=new(zs.Cache||$n),i}function Bs(t){if("function"!=typeof t)throw new Dt(e);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}zs.Cache=$n;var js=wr((function(t,e){var n=(e=1==e.length&&$s(e[0])?Le(e[0],Ze(lo())):Le(_i(e,1),Ze(lo()))).length;return Zi((function(i){for(var r=-1,o=vn(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return Se(t,this,i)}))})),Gs=Zi((function(e,n){var i=ln(n,ao(Gs));return Kr(e,o,t,n,i)})),Ns=Zi((function(e,n){var i=ln(n,ao(Ns));return Kr(e,s,t,n,i)})),Vs=no((function(e,n){return Kr(e,l,t,t,t,n)}));function Hs(t,e){return t===e||t!=t&&e!=e}var Ws=Ur(Ii),Xs=Ur((function(t,e){return t>=e})),Us=Mi(function(){return arguments}())?Mi:function(t){return ra(t)&&At.call(t,"callee")&&!qt.call(t,"callee")},$s=bt.isArray,Ys=ye?Ze(ye):function(t){return ra(t)&&Ei(t)==M};function qs(t){return null!=t&&na(t.length)&&!ta(t)}function Zs(t){return ra(t)&&qs(t)}var Ks=Xe||vl,Js=ve?Ze(ve):function(t){return ra(t)&&Ei(t)==_};function Qs(t){if(!ra(t))return!1;var e=Ei(t);return e==y||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!aa(t)}function ta(t){if(!ia(t))return!1;var e=Ei(t);return e==v||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function ea(t){return"number"==typeof t&&t==_a(t)}function na(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function ia(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ra(t){return null!=t&&"object"==typeof t}var oa=we?Ze(we):function(t){return ra(t)&&go(t)==x};function sa(t){return"number"==typeof t||ra(t)&&Ei(t)==b}function aa(t){if(!ra(t)||Ei(t)!=C)return!1;var e=$t(t);if(null===e)return!0;var n=At.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ft.call(n)==Gt}var la=xe?Ze(xe):function(t){return ra(t)&&Ei(t)==E},ua=be?Ze(be):function(t){return ra(t)&&go(t)==I};function ha(t){return"string"==typeof t||!$s(t)&&ra(t)&&Ei(t)==P}function ca(t){return"symbol"==typeof t||ra(t)&&Ei(t)==T}var da=Ce?Ze(Ce):function(t){return ra(t)&&na(t.length)&&!!oe[Ei(t)]},pa=Ur(Bi),fa=Ur((function(t,e){return t<=e}));function ga(t){if(!t)return[];if(qs(t))return ha(t)?cn(t):kr(t);if(ee&&t[ee])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[ee]());var e=go(t);return(e==x?sn:e==I?un:Ha)(t)}function ma(t){return t?(t=va(t))===u||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function _a(t){var e=ma(t),n=e%1;return e==e?n?e-n:e:0}function ya(t){return t?ai(_a(t),0,d):0}function va(t){if("number"==typeof t)return t;if(ca(t))return c;if(ia(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ia(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=qe(t);var n=ft.test(t);return n||mt.test(t)?ue(t.slice(2),n?2:8):pt.test(t)?c:+t}function wa(t){return Dr(t,Fa(t))}function xa(t){return null==t?"":ur(t)}var ba=Lr((function(t,e){if(So(e)||qs(e))Dr(e,Oa(e),t);else for(var n in e)At.call(e,n)&&ei(t,n,e[n])})),Ca=Lr((function(t,e){Dr(e,Fa(e),t)})),Sa=Lr((function(t,e,n,i){Dr(e,Fa(e),t,i)})),Ea=Lr((function(t,e,n,i){Dr(e,Oa(e),t,i)})),Ia=no(si),Pa=Zi((function(e,n){e=Pt(e);var i=-1,r=n.length,o=r>2?n[2]:t;for(o&&wo(n[0],n[1],o)&&(r=1);++i<r;)for(var s=n[i],a=Fa(s),l=-1,u=a.length;++l<u;){var h=a[l],c=e[h];(c===t||Hs(c,Rt[h])&&!At.call(e,h))&&(e[h]=s[h])}return e})),Ta=Zi((function(e){return e.push(t,Qr),Se(za,t,e)}));function ka(e,n,i){var r=null==e?t:Ci(e,n);return r===t?i:r}function Da(t,e){return null!=t&&mo(t,e,Ti)}var Ma=Nr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),t[e]=n}),il(sl)),La=Nr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=jt.call(e)),At.call(t,e)?t[e].push(n):t[e]=[n]}),lo),Ra=Zi(Di);function Oa(t){return qs(t)?Zn(t):Ai(t)}function Fa(t){return qs(t)?Zn(t,!0):zi(t)}var Aa=Lr((function(t,e,n){Vi(t,e,n)})),za=Lr((function(t,e,n,i){Vi(t,e,n,i)})),Ba=no((function(t,e){var n={};if(null==t)return n;var i=!1;e=Le(e,(function(e){return e=vr(e,t),i||(i=e.length>1),e})),Dr(t,ro(t),n),i&&(n=li(n,7,to));for(var r=e.length;r--;)cr(n,e[r]);return n})),ja=no((function(t,e){return null==t?{}:function(t,e){return Xi(t,e,(function(e,n){return Da(t,n)}))}(t,e)}));function Ga(t,e){if(null==t)return{};var n=Le(ro(t),(function(t){return[t]}));return e=lo(e),Xi(t,n,(function(t,n){return e(t,n[0])}))}var Na=Zr(Oa),Va=Zr(Fa);function Ha(t){return null==t?[]:Ke(t,Oa(t))}var Wa=Ar((function(t,e,n){return e=e.toLowerCase(),t+(n?Xa(e):e)}));function Xa(t){return Qa(xa(t).toLowerCase())}function Ua(t){return(t=xa(t))&&t.replace(yt,en).replace(Jt,"")}var $a=Ar((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ya=Ar((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),qa=Fr("toLowerCase"),Za=Ar((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Ka=Ar((function(t,e,n){return t+(n?" ":"")+Qa(e)})),Ja=Ar((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Qa=Fr("toUpperCase");function tl(e,n,i){return e=xa(e),(n=i?t:n)===t?function(t){return ne.test(t)}(e)?function(t){return t.match(te)||[]}(e):function(t){return t.match(lt)||[]}(e):e.match(n)||[]}var el=Zi((function(e,n){try{return Se(e,t,n)}catch(Hj){return Qs(Hj)?Hj:new St(Hj)}})),nl=no((function(t,e){return Ie(e,(function(e){e=Go(e),oi(t,e,Ls(t[e],t))})),t}));function il(t){return function(){return t}}var rl=jr(),ol=jr(!0);function sl(t){return t}function al(t){return Fi("function"==typeof t?t:li(t,1))}var ll=Zi((function(t,e){return function(n){return Di(n,t,e)}})),ul=Zi((function(t,e){return function(n){return Di(t,n,e)}}));function hl(t,e,n){var i=Oa(e),r=bi(e,i);null!=n||ia(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=bi(e,Oa(e)));var o=!(ia(n)&&"chain"in n&&!n.chain),s=ta(t);return Ie(r,(function(n){var i=e[n];t[n]=i,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=kr(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,Re([this.value()],arguments))})})),t}function cl(){}var dl=Hr(Le),pl=Hr(Te),fl=Hr(Ae);function gl(t){return xo(t)?We(Go(t)):function(t){return function(e){return Ci(e,t)}}(t)}var ml=Xr(),_l=Xr(!0);function yl(){return[]}function vl(){return!1}var wl,xl=Vr((function(t,e){return t+e}),0),bl=Yr("ceil"),Cl=Vr((function(t,e){return t/e}),1),Sl=Yr("floor"),El=Vr((function(t,e){return t*e}),1),Il=Yr("round"),Pl=Vr((function(t,e){return t-e}),0);return Gn.after=function(t,n){if("function"!=typeof n)throw new Dt(e);return t=_a(t),function(){if(--t<1)return n.apply(this,arguments)}},Gn.ary=Ds,Gn.assign=ba,Gn.assignIn=Ca,Gn.assignInWith=Sa,Gn.assignWith=Ea,Gn.at=Ia,Gn.before=Ms,Gn.bind=Ls,Gn.bindAll=nl,Gn.bindKey=Rs,Gn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return $s(t)?t:[t]},Gn.chain=gs,Gn.chunk=function(e,n,i){n=(i?wo(e,n,i):n===t)?1:yn(_a(n),0);var r=null==e?0:e.length;if(!r||n<1)return[];for(var o=0,s=0,a=bt(me(r/n));o<r;)a[s++]=ir(e,o,o+=n);return a},Gn.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r},Gn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=bt(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Re($s(n)?kr(n):[n],_i(e,1))},Gn.cond=function(t){var n=null==t?0:t.length,i=lo();return t=n?Le(t,(function(t){if("function"!=typeof t[1])throw new Dt(e);return[i(t[0]),t[1]]})):[],Zi((function(e){for(var i=-1;++i<n;){var r=t[i];if(Se(r[0],this,e))return Se(r[1],this,e)}}))},Gn.conforms=function(t){return function(t){var e=Oa(t);return function(n){return ui(n,t,e)}}(li(t,1))},Gn.constant=il,Gn.countBy=ys,Gn.create=function(t,e){var n=Nn(t);return null==e?n:ri(n,e)},Gn.curry=function e(n,i,r){var o=Kr(n,8,t,t,t,t,t,i=r?t:i);return o.placeholder=e.placeholder,o},Gn.curryRight=function e(n,i,o){var s=Kr(n,r,t,t,t,t,t,i=o?t:i);return s.placeholder=e.placeholder,s},Gn.debounce=Os,Gn.defaults=Pa,Gn.defaultsDeep=Ta,Gn.defer=Fs,Gn.delay=As,Gn.difference=Ho,Gn.differenceBy=Wo,Gn.differenceWith=Xo,Gn.drop=function(e,n,i){var r=null==e?0:e.length;return r?ir(e,(n=i||n===t?1:_a(n))<0?0:n,r):[]},Gn.dropRight=function(e,n,i){var r=null==e?0:e.length;return r?ir(e,0,(n=r-(n=i||n===t?1:_a(n)))<0?0:n):[]},Gn.dropRightWhile=function(t,e){return t&&t.length?pr(t,lo(e,3),!0,!0):[]},Gn.dropWhile=function(t,e){return t&&t.length?pr(t,lo(e,3),!0):[]},Gn.fill=function(e,n,i,r){var o=null==e?0:e.length;return o?(i&&"number"!=typeof i&&wo(e,n,i)&&(i=0,r=o),function(e,n,i,r){var o=e.length;for((i=_a(i))<0&&(i=-i>o?0:o+i),(r=r===t||r>o?o:_a(r))<0&&(r+=o),r=i>r?0:ya(r);i<r;)e[i++]=n;return e}(e,n,i,r)):[]},Gn.filter=function(t,e){return($s(t)?ke:mi)(t,lo(e,3))},Gn.flatMap=function(t,e){return _i(Is(t,e),1)},Gn.flatMapDeep=function(t,e){return _i(Is(t,e),u)},Gn.flatMapDepth=function(e,n,i){return i=i===t?1:_a(i),_i(Is(e,n),i)},Gn.flatten=Yo,Gn.flattenDeep=function(t){return null!=t&&t.length?_i(t,u):[]},Gn.flattenDepth=function(e,n){return null!=e&&e.length?_i(e,n=n===t?1:_a(n)):[]},Gn.flip=function(t){return Kr(t,512)},Gn.flow=rl,Gn.flowRight=ol,Gn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},Gn.functions=function(t){return null==t?[]:bi(t,Oa(t))},Gn.functionsIn=function(t){return null==t?[]:bi(t,Fa(t))},Gn.groupBy=Cs,Gn.initial=function(t){return null!=t&&t.length?ir(t,0,-1):[]},Gn.intersection=Zo,Gn.intersectionBy=Ko,Gn.intersectionWith=Jo,Gn.invert=Ma,Gn.invertBy=La,Gn.invokeMap=Ss,Gn.iteratee=al,Gn.keyBy=Es,Gn.keys=Oa,Gn.keysIn=Fa,Gn.map=Is,Gn.mapKeys=function(t,e){var n={};return e=lo(e,3),wi(t,(function(t,i,r){oi(n,e(t,i,r),t)})),n},Gn.mapValues=function(t,e){var n={};return e=lo(e,3),wi(t,(function(t,i,r){oi(n,i,e(t,i,r))})),n},Gn.matches=function(t){return Gi(li(t,1))},Gn.matchesProperty=function(t,e){return Ni(t,li(e,1))},Gn.memoize=zs,Gn.merge=Aa,Gn.mergeWith=za,Gn.method=ll,Gn.methodOf=ul,Gn.mixin=hl,Gn.negate=Bs,Gn.nthArg=function(t){return t=_a(t),Zi((function(e){return Hi(e,t)}))},Gn.omit=Ba,Gn.omitBy=function(t,e){return Ga(t,Bs(lo(e)))},Gn.once=function(t){return Ms(2,t)},Gn.orderBy=function(e,n,i,r){return null==e?[]:($s(n)||(n=null==n?[]:[n]),$s(i=r?t:i)||(i=null==i?[]:[i]),Wi(e,n,i))},Gn.over=dl,Gn.overArgs=js,Gn.overEvery=pl,Gn.overSome=fl,Gn.partial=Gs,Gn.partialRight=Ns,Gn.partition=Ps,Gn.pick=ja,Gn.pickBy=Ga,Gn.property=gl,Gn.propertyOf=function(e){return function(n){return null==e?t:Ci(e,n)}},Gn.pull=ts,Gn.pullAll=es,Gn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Ui(t,e,lo(n,2)):t},Gn.pullAllWith=function(e,n,i){return e&&e.length&&n&&n.length?Ui(e,n,t,i):e},Gn.pullAt=ns,Gn.range=ml,Gn.rangeRight=_l,Gn.rearg=Vs,Gn.reject=function(t,e){return($s(t)?ke:mi)(t,Bs(lo(e,3)))},Gn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=lo(e,3);++i<o;){var s=t[i];e(s,i,t)&&(n.push(s),r.push(i))}return $i(t,r),n},Gn.rest=function(n,i){if("function"!=typeof n)throw new Dt(e);return Zi(n,i=i===t?i:_a(i))},Gn.reverse=is,Gn.sampleSize=function(e,n,i){return n=(i?wo(e,n,i):n===t)?1:_a(n),($s(e)?Jn:Ji)(e,n)},Gn.set=function(t,e,n){return null==t?t:Qi(t,e,n)},Gn.setWith=function(e,n,i,r){return r="function"==typeof r?r:t,null==e?e:Qi(e,n,i,r)},Gn.shuffle=function(t){return($s(t)?Qn:nr)(t)},Gn.slice=function(e,n,i){var r=null==e?0:e.length;return r?(i&&"number"!=typeof i&&wo(e,n,i)?(n=0,i=r):(n=null==n?0:_a(n),i=i===t?r:_a(i)),ir(e,n,i)):[]},Gn.sortBy=Ts,Gn.sortedUniq=function(t){return t&&t.length?ar(t):[]},Gn.sortedUniqBy=function(t,e){return t&&t.length?ar(t,lo(e,2)):[]},Gn.split=function(e,n,i){return i&&"number"!=typeof i&&wo(e,n,i)&&(n=i=t),(i=i===t?d:i>>>0)?(e=xa(e))&&("string"==typeof n||null!=n&&!la(n))&&!(n=ur(n))&&on(e)?xr(cn(e),0,i):e.split(n,i):[]},Gn.spread=function(t,n){if("function"!=typeof t)throw new Dt(e);return n=null==n?0:yn(_a(n),0),Zi((function(e){var i=e[n],r=xr(e,0,n);return i&&Re(r,i),Se(t,this,r)}))},Gn.tail=function(t){var e=null==t?0:t.length;return e?ir(t,1,e):[]},Gn.take=function(e,n,i){return e&&e.length?ir(e,0,(n=i||n===t?1:_a(n))<0?0:n):[]},Gn.takeRight=function(e,n,i){var r=null==e?0:e.length;return r?ir(e,(n=r-(n=i||n===t?1:_a(n)))<0?0:n,r):[]},Gn.takeRightWhile=function(t,e){return t&&t.length?pr(t,lo(e,3),!1,!0):[]},Gn.takeWhile=function(t,e){return t&&t.length?pr(t,lo(e,3)):[]},Gn.tap=function(t,e){return e(t),t},Gn.throttle=function(t,n,i){var r=!0,o=!0;if("function"!=typeof t)throw new Dt(e);return ia(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Os(t,n,{leading:r,maxWait:n,trailing:o})},Gn.thru=ms,Gn.toArray=ga,Gn.toPairs=Na,Gn.toPairsIn=Va,Gn.toPath=function(t){return $s(t)?Le(t,Go):ca(t)?[t]:kr(jo(xa(t)))},Gn.toPlainObject=wa,Gn.transform=function(t,e,n){var i=$s(t),r=i||Ks(t)||da(t);if(e=lo(e,4),null==n){var o=t&&t.constructor;n=r?i?new o:[]:ia(t)&&ta(o)?Nn($t(t)):{}}return(r?Ie:wi)(t,(function(t,i,r){return e(n,t,i,r)})),n},Gn.unary=function(t){return Ds(t,1)},Gn.union=rs,Gn.unionBy=os,Gn.unionWith=ss,Gn.uniq=function(t){return t&&t.length?hr(t):[]},Gn.uniqBy=function(t,e){return t&&t.length?hr(t,lo(e,2)):[]},Gn.uniqWith=function(e,n){return n="function"==typeof n?n:t,e&&e.length?hr(e,t,n):[]},Gn.unset=function(t,e){return null==t||cr(t,e)},Gn.unzip=as,Gn.unzipWith=ls,Gn.update=function(t,e,n){return null==t?t:dr(t,e,yr(n))},Gn.updateWith=function(e,n,i,r){return r="function"==typeof r?r:t,null==e?e:dr(e,n,yr(i),r)},Gn.values=Ha,Gn.valuesIn=function(t){return null==t?[]:Ke(t,Fa(t))},Gn.without=us,Gn.words=tl,Gn.wrap=function(t,e){return Gs(yr(e),t)},Gn.xor=hs,Gn.xorBy=cs,Gn.xorWith=ds,Gn.zip=ps,Gn.zipObject=function(t,e){return mr(t||[],e||[],ei)},Gn.zipObjectDeep=function(t,e){return mr(t||[],e||[],Qi)},Gn.zipWith=fs,Gn.entries=Na,Gn.entriesIn=Va,Gn.extend=Ca,Gn.extendWith=Sa,hl(Gn,Gn),Gn.add=xl,Gn.attempt=el,Gn.camelCase=Wa,Gn.capitalize=Xa,Gn.ceil=bl,Gn.clamp=function(e,n,i){return i===t&&(i=n,n=t),i!==t&&(i=(i=va(i))==i?i:0),n!==t&&(n=(n=va(n))==n?n:0),ai(va(e),n,i)},Gn.clone=function(t){return li(t,4)},Gn.cloneDeep=function(t){return li(t,5)},Gn.cloneDeepWith=function(e,n){return li(e,5,n="function"==typeof n?n:t)},Gn.cloneWith=function(e,n){return li(e,4,n="function"==typeof n?n:t)},Gn.conformsTo=function(t,e){return null==e||ui(t,e,Oa(e))},Gn.deburr=Ua,Gn.defaultTo=function(t,e){return null==t||t!=t?e:t},Gn.divide=Cl,Gn.endsWith=function(e,n,i){e=xa(e),n=ur(n);var r=e.length,o=i=i===t?r:ai(_a(i),0,r);return(i-=n.length)>=0&&e.slice(i,o)==n},Gn.eq=Hs,Gn.escape=function(t){return(t=xa(t))&&Y.test(t)?t.replace(U,nn):t},Gn.escapeRegExp=function(t){return(t=xa(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Gn.every=function(e,n,i){var r=$s(e)?Te:fi;return i&&wo(e,n,i)&&(n=t),r(e,lo(n,3))},Gn.find=vs,Gn.findIndex=Uo,Gn.findKey=function(t,e){return Be(t,lo(e,3),wi)},Gn.findLast=ws,Gn.findLastIndex=$o,Gn.findLastKey=function(t,e){return Be(t,lo(e,3),xi)},Gn.floor=Sl,Gn.forEach=xs,Gn.forEachRight=bs,Gn.forIn=function(t,e){return null==t?t:yi(t,lo(e,3),Fa)},Gn.forInRight=function(t,e){return null==t?t:vi(t,lo(e,3),Fa)},Gn.forOwn=function(t,e){return t&&wi(t,lo(e,3))},Gn.forOwnRight=function(t,e){return t&&xi(t,lo(e,3))},Gn.get=ka,Gn.gt=Ws,Gn.gte=Xs,Gn.has=function(t,e){return null!=t&&mo(t,e,Pi)},Gn.hasIn=Da,Gn.head=qo,Gn.identity=sl,Gn.includes=function(t,e,n,i){t=qs(t)?t:Ha(t),n=n&&!i?_a(n):0;var r=t.length;return n<0&&(n=yn(r+n,0)),ha(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Ge(t,e,n)>-1},Gn.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:_a(n);return r<0&&(r=yn(i+r,0)),Ge(t,e,r)},Gn.inRange=function(e,n,i){return n=ma(n),i===t?(i=n,n=0):i=ma(i),function(t,e,n){return t>=vn(e,n)&&t<yn(e,n)}(e=va(e),n,i)},Gn.invoke=Ra,Gn.isArguments=Us,Gn.isArray=$s,Gn.isArrayBuffer=Ys,Gn.isArrayLike=qs,Gn.isArrayLikeObject=Zs,Gn.isBoolean=function(t){return!0===t||!1===t||ra(t)&&Ei(t)==m},Gn.isBuffer=Ks,Gn.isDate=Js,Gn.isElement=function(t){return ra(t)&&1===t.nodeType&&!aa(t)},Gn.isEmpty=function(t){if(null==t)return!0;if(qs(t)&&($s(t)||"string"==typeof t||"function"==typeof t.splice||Ks(t)||da(t)||Us(t)))return!t.length;var e=go(t);if(e==x||e==I)return!t.size;if(So(t))return!Ai(t).length;for(var n in t)if(At.call(t,n))return!1;return!0},Gn.isEqual=function(t,e){return Li(t,e)},Gn.isEqualWith=function(e,n,i){var r=(i="function"==typeof i?i:t)?i(e,n):t;return r===t?Li(e,n,t,i):!!r},Gn.isError=Qs,Gn.isFinite=function(t){return"number"==typeof t&&gn(t)},Gn.isFunction=ta,Gn.isInteger=ea,Gn.isLength=na,Gn.isMap=oa,Gn.isMatch=function(t,e){return t===e||Ri(t,e,ho(e))},Gn.isMatchWith=function(e,n,i){return i="function"==typeof i?i:t,Ri(e,n,ho(n),i)},Gn.isNaN=function(t){return sa(t)&&t!=+t},Gn.isNative=function(t){if(Co(t))throw new St("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Oi(t)},Gn.isNil=function(t){return null==t},Gn.isNull=function(t){return null===t},Gn.isNumber=sa,Gn.isObject=ia,Gn.isObjectLike=ra,Gn.isPlainObject=aa,Gn.isRegExp=la,Gn.isSafeInteger=function(t){return ea(t)&&t>=-9007199254740991&&t<=h},Gn.isSet=ua,Gn.isString=ha,Gn.isSymbol=ca,Gn.isTypedArray=da,Gn.isUndefined=function(e){return e===t},Gn.isWeakMap=function(t){return ra(t)&&go(t)==D},Gn.isWeakSet=function(t){return ra(t)&&"[object WeakSet]"==Ei(t)},Gn.join=function(t,e){return null==t?"":mn.call(t,e)},Gn.kebabCase=$a,Gn.last=Qo,Gn.lastIndexOf=function(e,n,i){var r=null==e?0:e.length;if(!r)return-1;var o=r;return i!==t&&(o=(o=_a(i))<0?yn(r+o,0):vn(o,r-1)),n==n?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(e,n,o):je(e,Ve,o,!0)},Gn.lowerCase=Ya,Gn.lowerFirst=qa,Gn.lt=pa,Gn.lte=fa,Gn.max=function(e){return e&&e.length?gi(e,sl,Ii):t},Gn.maxBy=function(e,n){return e&&e.length?gi(e,lo(n,2),Ii):t},Gn.mean=function(t){return He(t,sl)},Gn.meanBy=function(t,e){return He(t,lo(e,2))},Gn.min=function(e){return e&&e.length?gi(e,sl,Bi):t},Gn.minBy=function(e,n){return e&&e.length?gi(e,lo(n,2),Bi):t},Gn.stubArray=yl,Gn.stubFalse=vl,Gn.stubObject=function(){return{}},Gn.stubString=function(){return""},Gn.stubTrue=function(){return!0},Gn.multiply=El,Gn.nth=function(e,n){return e&&e.length?Hi(e,_a(n)):t},Gn.noConflict=function(){return de._===this&&(de._=Nt),this},Gn.noop=cl,Gn.now=ks,Gn.pad=function(t,e,n){t=xa(t);var i=(e=_a(e))?hn(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return Wr(_e(r),n)+t+Wr(me(r),n)},Gn.padEnd=function(t,e,n){t=xa(t);var i=(e=_a(e))?hn(t):0;return e&&i<e?t+Wr(e-i,n):t},Gn.padStart=function(t,e,n){t=xa(t);var i=(e=_a(e))?hn(t):0;return e&&i<e?Wr(e-i,n)+t:t},Gn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),xn(xa(t).replace(it,""),e||0)},Gn.random=function(e,n,i){if(i&&"boolean"!=typeof i&&wo(e,n,i)&&(n=i=t),i===t&&("boolean"==typeof n?(i=n,n=t):"boolean"==typeof e&&(i=e,e=t)),e===t&&n===t?(e=0,n=1):(e=ma(e),n===t?(n=e,e=0):n=ma(n)),e>n){var r=e;e=n,n=r}if(i||e%1||n%1){var o=bn();return vn(e+o*(n-e+le("1e-"+((o+"").length-1))),n)}return Yi(e,n)},Gn.reduce=function(t,e,n){var i=$s(t)?Oe:Ue,r=arguments.length<3;return i(t,lo(e,4),n,r,di)},Gn.reduceRight=function(t,e,n){var i=$s(t)?Fe:Ue,r=arguments.length<3;return i(t,lo(e,4),n,r,pi)},Gn.repeat=function(e,n,i){return n=(i?wo(e,n,i):n===t)?1:_a(n),qi(xa(e),n)},Gn.replace=function(){var t=arguments,e=xa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Gn.result=function(e,n,i){var r=-1,o=(n=vr(n,e)).length;for(o||(o=1,e=t);++r<o;){var s=null==e?t:e[Go(n[r])];s===t&&(r=o,s=i),e=ta(s)?s.call(e):s}return e},Gn.round=Il,Gn.runInContext=k,Gn.sample=function(t){return($s(t)?Kn:Ki)(t)},Gn.size=function(t){if(null==t)return 0;if(qs(t))return ha(t)?hn(t):t.length;var e=go(t);return e==x||e==I?t.size:Ai(t).length},Gn.snakeCase=Za,Gn.some=function(e,n,i){var r=$s(e)?Ae:rr;return i&&wo(e,n,i)&&(n=t),r(e,lo(n,3))},Gn.sortedIndex=function(t,e){return or(t,e)},Gn.sortedIndexBy=function(t,e,n){return sr(t,e,lo(n,2))},Gn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=or(t,e);if(i<n&&Hs(t[i],e))return i}return-1},Gn.sortedLastIndex=function(t,e){return or(t,e,!0)},Gn.sortedLastIndexBy=function(t,e,n){return sr(t,e,lo(n,2),!0)},Gn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=or(t,e,!0)-1;if(Hs(t[n],e))return n}return-1},Gn.startCase=Ka,Gn.startsWith=function(t,e,n){return t=xa(t),n=null==n?0:ai(_a(n),0,t.length),e=ur(e),t.slice(n,n+e.length)==e},Gn.subtract=Pl,Gn.sum=function(t){return t&&t.length?$e(t,sl):0},Gn.sumBy=function(t,e){return t&&t.length?$e(t,lo(e,2)):0},Gn.template=function(e,n,i){var r=Gn.templateSettings;i&&wo(e,n,i)&&(n=t),e=xa(e),n=Sa({},n,r,Jr);var o,s,a=Sa({},n.imports,r.imports,Jr),l=Oa(a),u=Ke(a,l),h=0,c=n.interpolate||vt,d="__p += '",p=Tt((n.escape||vt).source+"|"+c.source+"|"+(c===K?ct:vt).source+"|"+(n.evaluate||vt).source+"|$","g"),f="//# sourceURL="+(At.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++re+"]")+"\n";e.replace(p,(function(t,n,i,r,a,l){return i||(i=r),d+=e.slice(h,l).replace(wt,rn),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),h=l+t.length,t})),d+="';\n";var g=At.call(n,"variable")&&n.variable;if(g){if(ut.test(g))throw new St("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(s?d.replace(V,""):d).replace(H,"$1").replace(W,"$1;"),d="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var m=el((function(){return Et(l,f+"return "+d).apply(t,u)}));if(m.source=d,Qs(m))throw m;return m},Gn.times=function(t,e){if((t=_a(t))<1||t>h)return[];var n=d,i=vn(t,d);e=lo(e),t-=d;for(var r=Ye(i,e);++n<t;)e(n);return r},Gn.toFinite=ma,Gn.toInteger=_a,Gn.toLength=ya,Gn.toLower=function(t){return xa(t).toLowerCase()},Gn.toNumber=va,Gn.toSafeInteger=function(t){return t?ai(_a(t),-9007199254740991,h):0===t?t:0},Gn.toString=xa,Gn.toUpper=function(t){return xa(t).toUpperCase()},Gn.trim=function(e,n,i){if((e=xa(e))&&(i||n===t))return qe(e);if(!e||!(n=ur(n)))return e;var r=cn(e),o=cn(n);return xr(r,Qe(r,o),tn(r,o)+1).join("")},Gn.trimEnd=function(e,n,i){if((e=xa(e))&&(i||n===t))return e.slice(0,dn(e)+1);if(!e||!(n=ur(n)))return e;var r=cn(e);return xr(r,0,tn(r,cn(n))+1).join("")},Gn.trimStart=function(e,n,i){if((e=xa(e))&&(i||n===t))return e.replace(it,"");if(!e||!(n=ur(n)))return e;var r=cn(e);return xr(r,Qe(r,cn(n))).join("")},Gn.truncate=function(e,n){var i=30,r="...";if(ia(n)){var o="separator"in n?n.separator:o;i="length"in n?_a(n.length):i,r="omission"in n?ur(n.omission):r}var s=(e=xa(e)).length;if(on(e)){var a=cn(e);s=a.length}if(i>=s)return e;var l=i-hn(r);if(l<1)return r;var u=a?xr(a,0,l).join(""):e.slice(0,l);if(o===t)return u+r;if(a&&(l+=u.length-l),la(o)){if(e.slice(l).search(o)){var h,c=u;for(o.global||(o=Tt(o.source,xa(dt.exec(o))+"g")),o.lastIndex=0;h=o.exec(c);)var d=h.index;u=u.slice(0,d===t?l:d)}}else if(e.indexOf(ur(o),l)!=l){var p=u.lastIndexOf(o);p>-1&&(u=u.slice(0,p))}return u+r},Gn.unescape=function(t){return(t=xa(t))&&$.test(t)?t.replace(X,pn):t},Gn.uniqueId=function(t){var e=++zt;return xa(t)+e},Gn.upperCase=Ja,Gn.upperFirst=Qa,Gn.each=xs,Gn.eachRight=bs,Gn.first=qo,hl(Gn,(wl={},wi(Gn,(function(t,e){At.call(Gn.prototype,e)||(wl[e]=t)})),wl),{chain:!1}),Gn.VERSION="4.17.21",Ie(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Gn[t].placeholder=Gn})),Ie(["drop","take"],(function(e,n){Wn.prototype[e]=function(i){i=i===t?1:yn(_a(i),0);var r=this.__filtered__&&!n?new Wn(this):this.clone();return r.__filtered__?r.__takeCount__=vn(i,r.__takeCount__):r.__views__.push({size:vn(i,d),type:e+(r.__dir__<0?"Right":"")}),r},Wn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ie(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=1==n||3==n;Wn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:lo(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}})),Ie(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Wn.prototype[t]=function(){return this[n](1).value()[0]}})),Ie(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Wn.prototype[t]=function(){return this.__filtered__?new Wn(this):this[n](1)}})),Wn.prototype.compact=function(){return this.filter(sl)},Wn.prototype.find=function(t){return this.filter(t).head()},Wn.prototype.findLast=function(t){return this.reverse().find(t)},Wn.prototype.invokeMap=Zi((function(t,e){return"function"==typeof t?new Wn(this):this.map((function(n){return Di(n,t,e)}))})),Wn.prototype.reject=function(t){return this.filter(Bs(lo(t)))},Wn.prototype.slice=function(e,n){e=_a(e);var i=this;return i.__filtered__&&(e>0||n<0)?new Wn(i):(e<0?i=i.takeRight(-e):e&&(i=i.drop(e)),n!==t&&(i=(n=_a(n))<0?i.dropRight(-n):i.take(n-e)),i)},Wn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Wn.prototype.toArray=function(){return this.take(d)},wi(Wn.prototype,(function(e,n){var i=/^(?:filter|find|map|reject)|While$/.test(n),r=/^(?:head|last)$/.test(n),o=Gn[r?"take"+("last"==n?"Right":""):n],s=r||/^find/.test(n);o&&(Gn.prototype[n]=function(){var n=this.__wrapped__,a=r?[1]:arguments,l=n instanceof Wn,u=a[0],h=l||$s(n),c=function(t){var e=o.apply(Gn,Re([t],a));return r&&d?e[0]:e};h&&i&&"function"==typeof u&&1!=u.length&&(l=h=!1);var d=this.__chain__,p=!!this.__actions__.length,f=s&&!d,g=l&&!p;if(!s&&h){n=g?n:new Wn(this);var m=e.apply(n,a);return m.__actions__.push({func:ms,args:[c],thisArg:t}),new Hn(m,d)}return f&&g?e.apply(this,a):(m=this.thru(c),f?r?m.value()[0]:m.value():m)})})),Ie(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Mt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);Gn.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply($s(r)?r:[],t)}return this[n]((function(n){return e.apply($s(n)?n:[],t)}))}})),wi(Wn.prototype,(function(t,e){var n=Gn[e];if(n){var i=n.name+"";At.call(Mn,i)||(Mn[i]=[]),Mn[i].push({name:e,func:n})}})),Mn[Gr(t,2).name]=[{name:"wrapper",func:t}],Wn.prototype.clone=function(){var t=new Wn(this.__wrapped__);return t.__actions__=kr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=kr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=kr(this.__views__),t},Wn.prototype.reverse=function(){if(this.__filtered__){var t=new Wn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Wn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=$s(t),i=e<0,r=n?t.length:0,o=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=vn(e,t+s);break;case"takeRight":t=yn(t,e-s)}}return{start:t,end:e}}(0,r,this.__views__),s=o.start,a=o.end,l=a-s,u=i?a:s-1,h=this.__iteratees__,c=h.length,d=0,p=vn(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return fr(t,this.__actions__);var f=[];t:for(;l--&&d<p;){for(var g=-1,m=t[u+=e];++g<c;){var _=h[g],y=_.iteratee,v=_.type,w=y(m);if(2==v)m=w;else if(!w){if(1==v)continue t;break t}}f[d++]=m}return f},Gn.prototype.at=_s,Gn.prototype.chain=function(){return gs(this)},Gn.prototype.commit=function(){return new Hn(this.value(),this.__chain__)},Gn.prototype.next=function(){this.__values__===t&&(this.__values__=ga(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},Gn.prototype.plant=function(e){for(var n,i=this;i instanceof Vn;){var r=Vo(i);r.__index__=0,r.__values__=t,n?o.__wrapped__=r:n=r;var o=r;i=i.__wrapped__}return o.__wrapped__=e,n},Gn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Wn){var n=e;return this.__actions__.length&&(n=new Wn(this)),(n=n.reverse()).__actions__.push({func:ms,args:[is],thisArg:t}),new Hn(n,this.__chain__)}return this.thru(is)},Gn.prototype.toJSON=Gn.prototype.valueOf=Gn.prototype.value=function(){return fr(this.__wrapped__,this.__actions__)},Gn.prototype.first=Gn.prototype.head,ee&&(Gn.prototype[ee]=function(){return this}),Gn}();fe?((fe.exports=fn)._=fn,pe._=fn):de._=fn}.call(k);const Ow=T(Rw.exports);class Fw{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"__events",null),e(this,"__eventIdPrefix","MAP_EVENT_"),e(this,"__eventTypePrefix",{change:"change","change:layerGroup":"change:layerGroup","change:size":"change:size","change:target":"change:target","change:view":"change:view",click:"click",dblclick:"dblclick",error:"error",loadend:"loadend",loadstart:"loadstart",moveend:"moveend",movestart:"movestart",pointerdrag:"pointerdrag",pointermove:"pointermove",postcompose:"postcompose",postrender:"postrender",precompose:"precompose",propertychange:"propertychange",rendercomplete:"rendercomplete",singleclick:"singleclick"}),e(this,"__debounceEvent",["pointerdrag","pointermove","precompose","postcompose","postrender","rendercomplete"]),this.olBaseHandle=t,this.handle=t.handle,this.__events=new Map}destructor(){this.clearEvent(),this.olBaseHandle=null,this.handle=null,this.__events=null}__Id(t){return`${this.__eventIdPrefix}${t}`}addEvent(t){if(this.handle){const e=t.type,n=this.__Id(t.id),i=t.delay??300,r=t.debounce??!0,o=t.debounceOption??{};let s=t.cb;r&&this.__debounceEvent.includes(e)&&(s=Ow.debounce(s,i,o));const a=t=>{s(t)};return this.handle.on(e,a),this.__events.set(n,{option:t,eventFunc:a}),!0}return!1}removeEvent(t){return this.removeEventByID(t.id)}removeEventByID(t){if(this.handle){const e=this.__events.get(this.__Id(t));if(e){const n=e.option.type;return this.handle.un(n,e.eventFunc),this.__events.delete(this.__Id(t)),!0}return!1}return!1}clearEvent(){return!(!this.handle||!this.__events.size)&&(this.__events.forEach((t=>{const e=t.option.type;this.handle.un(e,t.eventFunc)})),this.__events.clear(),!0)}}class Aw{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"mapDomContainner"),e(this,"__layers",null),e(this,"__DomMap",null),e(this,"__layerIdPrefix","VUE_OVERLAY_"),e(this,"__defaultTT",(t=>t)),e(this,"createVueDom",(t=>{var e;const n=t.vNodeData,i=t.id,r=t.vNode,o=t.name?t.name:Yt(10);let s=t.wrapX;(Ow.isNull(s)||Ow.isUndefined(s))&&(s=!0);let a=this.__defaultTT;t.customT&&(a=t.customT);const l=K(r,{...t,id:`${i}_inner`,name:o,vNodeData:n,wrapX:s,customT:a,destory:()=>{this.hiddenPopupByID(t.id)}}),u=document.createElement("div");u.id=i;const h=this.__DomMap.get(i);if(h){const t=null==h?void 0:h.parentNode;null==t||t.removeChild(h),this.__DomMap.delete(i)}return l.mount(u),null==(e=this.mapDomContainner)||e.appendChild(u),this.__DomMap.set(i,u),{overlayDomContainner:u,name:o}})),e(this,"updateLayer",(t=>{if(this.handle){const e=this.__layers.get(this.__Id(t.id));if(e){const{overlayDomContainner:n}=this.createVueDom(t);e.layer.setElement(n)}}})),e(this,"showPopup",((t,e)=>this.showPopupByID(t.id,e))),e(this,"showPopupByID",((t,e)=>{if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setPosition(e),!0)}return!1})),e(this,"hiddenPopup",(t=>this.hiddenPopupByID(t.id))),e(this,"hiddenPopupByID",(t=>{if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));return!!e&&(e.layer.setPosition(void 0),!0)}return!1})),this.olBaseHandle=t,this.handle=t.handle,this.mapDomContainner=this.handle.getTargetElement(),this.__layers=new Map,this.__DomMap=new Map}destructor(){this.clearLayer(),this.handle=null,this.olBaseHandle=null,this.__layers=null,this.__DomMap=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}createLayer(t){const{overlayDomContainner:e,name:n}=this.createVueDom(t),i=new Fc({element:e,autoPan:!0});i.set("id",this.__Id(t.id)),i.set("name",this.__Name(n));return{layer:i}}addLayer(t){if(this.handle){const e=this.createLayer(t);return!!e&&(this.handle.addOverlay(e.layer),this.__layers.set(this.__Id(t.id),e),!0)}return!1}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeOverlay(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeOverlay(t.layer)})),this.__layers.clear(),!0)}hiddenPopupAll(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{t.layer.setPosition(void 0)})),!0)}}const zw="dblclick",Bw="pointerdrag",jw="pointermove",Gw="rendercomplete",Nw="singleclick",Vw="geodesic_circle_modify_geo",Hw="geo_mask_modify_geometry_flag";function Ww(t){let e="rgba(255, 0, 0, 1)";return Ow.isString(t)?e=t:Ow.isArray(t)&&(4===t.length?e=`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`:3===t.length&&(e=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 1)`)),e}function Xw(t){const e=Ww(t);return new io({color:e})}function Uw(t){let e=t.fillColor||t.color;return e=Ww(e),new io({color:e})}function $w(t){const e=Ww(t.color);return new ho({color:e,lineDash:t.lineDash,width:t.width})}function Yw(t){const e=t.fontSize??12,n=t.font||`${e}px Calibri,sans-serif`,i=(t.rotation??0)*Math.PI/180;return new Ds({text:t.text??"",font:n,fill:Xw(t.color),backgroundFill:Uw(t),padding:t.padding??[3,3,3,3],textBaseline:t.textBaseline??"center",offsetY:t.offsetY??0,offsetX:t.offsetX??0,rotation:i})}function qw(t){return new bs({stroke:$w(t),fill:Uw(t),radius:t.radius??16})}function Zw(t){let e=t.color||t.fillColor;return e=Ww(e),new za({src:t.url,width:t.radius,height:t.radius2,color:e,anchor:t.iconAnchor,offset:t.iconOffset,rotation:t.rotation??0})}function Kw(t){return new Ts({image:Zw(t)})}const Jw=(t={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},e={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"})=>{t.radius=t.iconWidth,t.radius2=t.iconHeight,t.url=t.iconUrl;let n=null;if("pattern"==t.iconPattern)switch(t.iconUrl){case"circle":default:n=qw(t);break;case"square":n=new ws({stroke:$w(i=t),fill:Uw(i),points:4,radius:i.radius,angle:Math.PI/4});break;case"rectangle":n=function(t){return new ws({stroke:$w(t),fill:Uw(t),points:4,radius:t.radius/Math.SQRT2,radius2:t.radius,angle:0,scale:[1,.5]})}(t);break;case"triangle":n=function(t){return new ws({stroke:$w(t),fill:Uw(t),points:3,radius:t.radius,rotation:t.rotation??0,angle:0})}(t);break;case"star":n=function(t){return new ws({stroke:$w(t),fill:Uw(t),points:5,radius:t.radius,radius2:t.radius2,angle:0})}(t);break;case"cross":n=function(t){return new ws({stroke:$w(t),fill:Uw(t),points:4,radius:t.radius,radius2:0,angle:0})}(t);break;case"x":n=function(t){return new ws({stroke:$w(t),fill:Uw(t),points:4,radius:t.radius,radius2:0,angle:Math.PI/4})}(t)}else n="icons"==t.iconPattern&&t.url?Zw(t):qw(t);var i;return e.text?new Ts({geometry:t=>{const e=t.get(Vw),n=t.get(Hw);return e||(n&&n.geometry?n.geometry:t.getGeometry())},image:n,fill:Uw(t),stroke:$w(t),text:Yw(e)}):new Ts({geometry:t=>{const e=t.get(Vw),n=t.get(Hw);return e||(n&&n.geometry?n.geometry:t.getGeometry())},image:n,fill:Uw(t),stroke:$w(t)})},Qw={fontSize:12,color:"rgba(255, 255, 255, 1)",fillColor:"rgba(0, 0, 0, 0.4)"},tx=(t=Qw)=>new Ts({text:new Ds({font:`${t.fontSize}px Calibri,sans-serif`,fill:new io({color:t.color}),backgroundFill:new io({color:t.fillColor}),padding:[2,2,2,2],textBaseline:"bottom",offsetY:-12}),image:new ws({radius:6,points:3,angle:Math.PI,displacement:[0,8],fill:new io({color:t.fillColor})})}),ex={fontSize:14,color:"rgba(255, 255, 255, 1)",fillColor:"rgba(0, 0, 0, 0.7)"},nx=(t=ex)=>new Ts({text:new Ds({font:`${t.fontSize}px Calibri,sans-serif`,fill:new io({color:t.color}),backgroundFill:new io({color:t.fillColor}),padding:[3,3,3,3],textBaseline:"bottom",offsetY:-15}),image:new ws({radius:8,points:3,angle:Math.PI,displacement:[0,10],fill:new io({color:t.fillColor})})}),ix={fontSize:12,color:"rgba(255, 255, 255, 1)",fillColor:"rgba(0, 0, 0, 0.4)"},rx=(t=ix)=>new Ts({text:new Ds({font:`${t.fontSize}px Calibri,sans-serif`,fill:new io({color:t.color}),backgroundFill:new io({color:t.fillColor}),padding:[3,3,3,3],textBaseline:"bottom",offsetY:-15}),image:new ws({radius:8,points:3,angle:Math.PI,displacement:[0,10],fill:new io({color:t.fillColor})})}),ox=new Ts({stroke:new ho({color:"rgba(255, 255, 255, 0.0)",width:0}),fill:new io({color:"rgba(255, 255, 255, 0.0)"})}),sx=new bs({radius:5,fill:void 0,stroke:new ho({color:"red",width:1})}),ax={Point:new Ts({image:sx}),LineString:new Ts({stroke:new ho({color:"green",width:1})}),MultiLineString:new Ts({stroke:new ho({color:"green",width:1})}),MultiPoint:new Ts({image:sx}),MultiPolygon:new Ts({stroke:new ho({color:"yellow",width:1}),fill:new io({color:"rgba(255, 255, 0, 0.1)"})}),Polygon:new Ts({stroke:new ho({color:"blue",lineDash:[4],width:3}),fill:new io({color:"rgba(0, 0, 255, 0.1)"})}),GeometryCollection:new Ts({stroke:new ho({color:"magenta",width:2}),fill:new io({color:"magenta"}),image:new bs({radius:10,fill:void 0,stroke:new ho({color:"magenta"})})}),Circle:new Ts({stroke:new ho({color:"red",width:2}),fill:new io({color:"rgba(255,0,0,0.2)"})})},lx=function(t){return ax[t.getGeometry().getType()]},ux=J({name:"DrawCancelConfirm",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({name:"我是VueNode标题",longitude:"149.757575E",latitude:"30.435657N",satellite:"888",time:"2023-07-16 12:00:00",x:180,y:1620})}},setup:(t,e)=>({colseHandle:()=>{t&&t.destory()},cancelHandle:()=>{t&&t.vNodeData.cancelCb()}})}),hx=["id"],cx=[(t=>(nt("data-v-77ee2bf2"),t=t(),it(),t))((()=>rt("img",{class:"row_nw_center_center info_del",src:"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%3e%3cdefs%3e%3cstyle%3e.a{fill:none;}.b{fill:%23fff;}%3c/style%3e%3c/defs%3e%3cg%20transform='translate(-1486%20-443)'%3e%3crect%20class='a'%20width='20'%20height='20'%20rx='2'%20transform='translate(1486%20443)'/%3e%3cg%20transform='translate(1445.664%20401.834)'%3e%3cpath%20class='b'%20d='M14.121,16.9H4.3a2.3,2.3,0,0,1-2.3-2.3V6.421a.662.662,0,1,1,1.324,0V14.6a.976.976,0,0,0,.975.975h9.818A.976.976,0,0,0,15.1,14.6V6.421a.663.663,0,0,1,.663-.662.66.66,0,0,1,.657.662V14.6A2.3,2.3,0,0,1,14.121,16.9Zm3.72-11.893H.662a.662.662,0,0,1,0-1.325H4.5V1.889A1.891,1.891,0,0,1,6.388,0h5.729A1.891,1.891,0,0,1,14,1.889V3.682h3.838a.662.662,0,0,1,0,1.325ZM6.391,1.323a.567.567,0,0,0-.566.566V3.682h6.858V1.889a.567.567,0,0,0-.566-.566Z'%20transform='translate(41.085%2042.685)'/%3e%3cpath%20class='b'%20d='M4.641,6.089h0A.644.644,0,0,1,4,5.445V.644a.645.645,0,0,1,1.29,0v4.8A.649.649,0,0,1,4.641,6.089Zm-4,0A.644.644,0,0,1,0,5.445V.644a.643.643,0,1,1,1.286,0v4.8A.644.644,0,0,1,.644,6.089Z'%20transform='translate(47.659%2049.356)'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e"},null,-1)))];const dx=Q(ux,[["render",function(t,e,n,i,r,o){return tt(),et("div",{id:t.id,class:"col_nw_center_center panel_container",onClick:e[0]||(e[0]=(...e)=>t.cancelHandle&&t.cancelHandle(...e))},cx,8,hx)}],["__scopeId","data-v-77ee2bf2"]]),px=J({name:"DrawCancelConfirm",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({name:"我是VueNode标题",longitude:"149.757575E",latitude:"30.435657N",satellite:"888",time:"2023-07-16 12:00:00",x:180,y:1620})}},setup:(t,e)=>({})}),fx=["id"];const gx=Q(px,[["render",function(t,e,n,i,r,o){return tt(),et("div",{id:t.id,class:"col_nw_center_center panel_container"},[rt("div",{class:"row_nw_fs_center tip_title",onClick:e[0]||(e[0]=(...e)=>t.colseHandle&&t.colseHandle(...e))},ot(t.customT("common.draw.cs")),1),rt("div",{class:"row_nw_fs_center tip_title",onClick:e[1]||(e[1]=(...e)=>t.colseHandle&&t.colseHandle(...e))},ot(t.customT("common.draw.cdc")),1),rt("div",{class:"row_nw_fs_center tip_title",onClick:e[2]||(e[2]=(...e)=>t.colseHandle&&t.colseHandle(...e))},ot(t.customT("common.draw.escq")),1),rt("div",{class:"row_nw_fs_center tip_title",onClick:e[3]||(e[3]=(...e)=>t.colseHandle&&t.colseHandle(...e))},ot(t.customT("common.draw.qb")),1)],8,fx)}],["__scopeId","data-v-a72061e7"]]),mx="editProps";class _x{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"vuePopupIns",null),e(this,"mapEventIns",null),e(this,"__layers",null),e(this,"__layerIdPrefix","DRAW_"),e(this,"__drawData",{}),e(this,"__crurentSelDrawData",{}),e(this,"__currentFeature",null),e(this,"__currentOptions",null),e(this,"drawType",""),e(this,"drawTag",null),e(this,"snapTag",null),e(this,"drawModel",""),e(this,"modify",null),e(this,"interactionSource",null),e(this,"InteractionLayer",null),e(this,"drawLayerZIndex",20),e(this,"segmentStyles",null),e(this,"lableLngLatStyles",null),e(this,"labelStyles",null),e(this,"defaultModifyStyle",null),e(this,"sketchFeature",null),e(this,"listener",null),e(this,"dcPopupOptions",null),e(this,"dcEventSingleOptions",null),e(this,"dcEventDbclickOptions",null),e(this,"dcEventDragOptions",null),e(this,"dcEventPointMoveOptions",null),e(this,"isShowDcActionPopup",!1),e(this,"customCallbackFunc",null),e(this,"innerT",(t=>`${t}`)),e(this,"isShowTipPopup",!1),e(this,"drawTipPopupOptions",{id:`${this.__layerIdPrefix}_tip_popup`,name:`${this.__layerIdPrefix}_tipvnode_popup`,vNode:gx,customT:this.innerT,vNodeData:{},wrapX:!0}),e(this,"__oldTipPosition",[0,0]),e(this,"drawTipNodePopupCb",(t=>{var e;if(this.isShowTipPopup&&this.drawTag&&t.coordinate){this.__oldTipPosition=[...t.coordinate];const n=[...this.__oldTipPosition];if(n.length>=2){let t=3;this.olBaseHandle&&(t=this.olBaseHandle.getViewZoom());let i=262144;if(t>=3&&t<20){const e=21-t;i=Math.pow(2,e)}else t>=20&&(i=1);n[0]=n[0]+i,null==(e=this.vuePopupIns)||e.showPopupByID(this.drawTipPopupOptions.id,n)}}})),e(this,"drawTipEventPointMoveOptions",{id:`${this.__layerIdPrefix}_${Yt(10)}_tipmap_event`,type:jw,cb:this.drawTipNodePopupCb,delay:1,debounce:!1}),e(this,"drawTipEventZoomOptions",{id:`${this.__layerIdPrefix}_${Yt(10)}_tipmap_event`,type:Gw,cb:this.drawTipNodePopupCb,delay:1,debounce:!1}),e(this,"__removeSourceFeatureById",(t=>{const e=this.interactionSource.getFeatureById(t);e&&this.interactionSource.removeFeature(e)})),e(this,"cancelDraw",(t=>{(this.drawTag||this.modify)&&"Escape"==t.key&&this.removeallInteraction()})),e(this,"setCancelDrawCB",(()=>{window.addEventListener("keyup",this.cancelDraw)})),e(this,"removeCancelDrawCB",(()=>{window.removeEventListener("keyup",this.cancelDraw)})),e(this,"drawBackOnePoint",(t=>{this.drawTag&&("Q"!=t.key&&"q"!=t.key&&"Backspace"!=t.key&&"Delete"!=t.key||this.drawTag.removeLastPoint())})),e(this,"setDrawBackCB",(()=>{window.addEventListener("keyup",this.drawBackOnePoint)})),e(this,"removeDrawBackCB",(()=>{window.removeEventListener("keyup",this.drawBackOnePoint)})),e(this,"modifyBackOnePoint",(t=>{this.modify&&("Q"!=t.key&&"q"!=t.key&&"Backspace"!=t.key&&"Delete"!=t.key||this.modify.removePoint())})),e(this,"setModifyBackCB",(()=>{window.addEventListener("keyup",this.modifyBackOnePoint)})),e(this,"removeModifyBackCB",(()=>{window.removeEventListener("keyup",this.modifyBackOnePoint)})),e(this,"setMouseoutCb",(()=>{this.handle&&this.handle.getViewport().addEventListener("mouseout",this.removeallInteraction)})),e(this,"removeMouseoutCb",(()=>{this.handle&&this.handle.getViewport().removeEventListener("mouseout",this.removeallInteraction)})),e(this,"oldDcNodePopupFeature",null),e(this,"oldHoverNodePopupFeature",null),e(this,"hightLightPointMoveHandle",(t=>{let e=t.pixel;e.length||(e=this.handle.getEventPixel(t.originalEvent));const n=this.handle.forEachFeatureAtPixel(e,(function(t){const e=t.get(d),n=t.get(c),i=null==n?void 0:n.id;if(e&&i&&i.startsWith("draw_"))return t}));n?(this.handle.getTargetElement().style.cursor="pointer",this.setHoverFeatureStyle(n)):(this.handle.getTargetElement().style.cursor="",this.resetDcHoverFeatureStyle("hover"))})),e(this,"dcNodePopupCb",(t=>e=>{var n,i,r;if(this.isShowDcActionPopup){let o=e.pixel;o.length||(o=this.handle.getEventPixel(e.originalEvent));const s=this.handle.forEachFeatureAtPixel(o,(function(t){const e=t.get(d),n=t.get(c),i=null==n?void 0:n.id;if(e&&i&&i.startsWith("draw_"))return t}));if(s){t.callback&&(t.callback(s),null==(n=this.vuePopupIns)||n.updateLayer(this.dcPopupOptions));let r=e.coordinate;if(t.popupIsCenter){r=Tn(s.getGeometry().getExtent())}null==(i=this.vuePopupIns)||i.showPopupByID(this.dcPopupOptions.id,r),this.setDcFeatureStyle(s),"aiProcess"!=st.route.name&&(this.modify||this.intoModifyMode(this.__currentOptions))}else null==(r=this.vuePopupIns)||r.hiddenPopupByID(this.dcPopupOptions.id),this.resetDcHoverFeatureStyle("select")}})),e(this,"getDrawData",(t=>e=>{const n=t.shape;this.customCallbackFunc=t.callback;let i=null,l=null,v={area:0,areaString:"0 m2"},w={length:0,lengthString:"0 m"},x="",b=[],C=null,S=null;const E=`draw_${Yt(10)}`;if("drawend"==e.type)S=e.feature,C=e.feature.getGeometry(),C.getType();else if("modifyend"==e.type){const t=e.features.getArray();S=t[0],C=t[0].getGeometry(),C.getType()}if(S.setId(E),S.setProperties({[d]:!0,[c]:{...t,id:E}}),n==r||n==o){x=o;const t=C.getCoordinates(),e=C.getType();if("MultiPoint"==e){l=new ju(t).transform("EPSG:3857","EPSG:4326").getCoordinates();const e=yf(Tn(C.getExtent()));b=[e.longitude,e.latitude]}else l=yf(t),l=[l.longitude,l.latitude],b=[l[0],l[1]];this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiPoint"==e?bp(l,this.__drawData):xp(l,this.__drawData)}else if(n==p||n==f||n==s||n==g){x=s;const t=C.getCoordinates(),e=C.getType();l="MultiPolygon"==e?new Vu(t).transform("EPSG:3857","EPSG:4326").getCoordinates():[this.getCoordinatesLngLat(t)],v=wf(C);const r=yf(Tn(C.getExtent()));b=[r.longitude,r.latitude],this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiPolygon"==e?Sp(l,this.__drawData):Cp(l,this.__drawData)}else if(n==a||n==m){x=a;const t=C.getType(),e=[C.getCoordinates()];if("MultiLineString"==t){l=new zu(e).transform("EPSG:3857","EPSG:4326").getCoordinates();const t=yf(Tn(C.getExtent()));b=[t.longitude,t.latitude]}else{l=this.getCoordinatesLngLat(e);const t=l[Math.floor(l.length/2)];b=[t[0],t[1]]}w=xf(C),this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiLineString"==t?Ip(l,this.__drawData):Ep(l,this.__drawData)}else if(n==_){x=s;const t=qr(C,128),e=t.getCoordinates();l=[this.getCoordinatesLngLat(e)],v=wf(t);const r=yf(C.getCenter());b=[r.longitude,r.latitude],this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i=Cp(l,this.__drawData)}else if(n==y&&(x=s,C.getType()==u)){const t=C.getGeometries();if(2==t.length&&t[1].getType()==o){const e=yf(t[1].getCoordinates());b=[e.longitude,e.latitude]}for(let e=0;e<t.length;e++)if(t[e].getType()==s){const r=t[e].getCoordinates();if(l=[this.getCoordinatesLngLat(r)],v=wf(C),b&&2!==b.length){const t=yf(Tn(C.getExtent()));b=[t.longitude,t.latitude]}this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i=Cp(l,this.__drawData);break}}if(this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,geojson:i,area:v,length:w},this.__crurentSelDrawData=Ow.cloneDeep(this.__drawData),"drawend"==e.type){const e=t.isShowSegments??!1,n=t.isShowLngLat??!1,i=t.isShowLabel??!1,r=this.updateDrawStyleFunction(S,null,e,n,i,null);S.setStyle(r)}else if("modifyend"==e.type){const e=t.isShowSegments??!1,n=t.isShowLngLat??!1,i=t.isShowLabel??!1,r=S.get("__drawData");let o=null,s=null,a=null;r&&(o=r.geojson,o&&(s=o.properties,s&&(a=s.style)));const l=this.updateDrawStyleFunction(S,null,e,n,i,a);S.setStyle(l),a&&(this.__drawData.geojson.properties[mx]=r.geojson.properties[mx],this.__drawData.geojson.properties.style=a)}this.__drawData.oldDrawOptions=Ow.cloneDeep(t),this.__drawData.geojson.properties.__drawData=Ow.cloneDeep(this.__drawData),S.set("__drawData",this.__drawData),this.customCallbackFunc&&("drawend"==e.type?this.customCallbackFunc(h.draw,this.__drawData):"modifyend"==e.type&&this.customCallbackFunc(h.modify,this.__drawData))})),e(this,"intoModifyMode",(t=>{this.modify||(this.removeCancelDrawCB(),this.setCancelDrawCB(),this.modify=new wd({source:this.interactionSource,style:t=>this.modifyStyleFunction(t)}),this.modify.on("modifystart",(t=>{var e;this.olBaseHandle.setConstrainedView(!0),this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),t.features.forEach((t=>{const e=t.getGeometry();e.getType()===u&&t.set(Vw,e.clone(),!0)}))})),this.modify.on("modifyend",(e=>{this.olBaseHandle.setConstrainedView(!1),e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0))}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))})),this.handle.addInteraction(this.snapTag),this.handle.addInteraction(this.modify),this.modify.setActive(!0))})),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map,this.vuePopupIns=new Aw(t),this.mapEventIns=new Fw(t),this.segmentStyles=[tx()],this.lableLngLatStyles=[rx()],this.labelStyles=nx(),this.interactionSource=new ah,this.InteractionLayer=new ku({source:this.interactionSource,zIndex:this.olBaseHandle.getCurrentzIndex()});const n="CUSTOM_INTER_"+Yt(10);this.InteractionLayer.set("id",this.__Id(n)),this.InteractionLayer.set("name",this.__Name(n)),this.defaultModifyStyle=new wd({source:this.interactionSource}).getOverlay().getStyleFunction(),this.snapTag=new Ed({source:this.interactionSource});const i={source:this.interactionSource,layer:this.InteractionLayer};this.handle&&(this.handle.addLayer(this.InteractionLayer),this.__layers.set(this.__Id(n),i)),this.setActionPopup()}updateDrawStyleFunction(t,e,n,i,h,c){let d={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},p={...ix},f={...Qw},g={...ex},m={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"};c&&c.geo&&(d={width:c.geo.width,color:c.geo.color,fillColor:c.geo.fillColor,radius:c.geo.radius,radius2:c.geo.radius2,lineDash:c.geo.lineDash,iconWidth:c.geo.iconWidth,iconHeight:c.geo.iconHeight,iconPattern:c.geo.iconPattern,iconUrl:c.geo.iconUrl,iconAnchor:c.geo.iconAnchor,iconOffset:c.geo.iconOffset,arrowPattern:c.geo.arrowPattern}),c&&c.vertex&&(p={fontSize:c.vertex.fontSize,color:c.vertex.color,fillColor:c.vertex.fillColor}),c&&c.line&&(f={fontSize:c.line.fontSize,color:c.line.color,fillColor:c.line.fillColor}),c&&c.label&&(g={fontSize:c.label.fontSize,color:c.label.color,fillColor:c.label.fillColor}),c&&c.text&&(m={text:c.text.text||"点击编辑文本",fontSize:c.text.fontSize,offsetY:c.text.offsetY,offsetX:c.text.offsetX,padding:c.text.padding,textBaseline:c.text.textBaseline,color:c.text.color,fillColor:c.text.fillColor,rotation:c.text.rotation});let _=null;this.__currentOptions&&(_=this.__currentOptions.shape),_&&_==r&&(d.color="rgba(24, 144, 255, 0)",d.fillColor="rgba(24, 144, 255, 0)",m.text||(m.text="点击编辑文本"));const y=[Jw(d,m)],v=t.getGeometry(),w=v.getType();let x,b,C,S,E,I=!1;if(!e||e===w)if(w===o)E=[v.getCoordinates()],I=!1;else if(w===s)x=v.getInteriorPoint(),C=wf(v),E=v.getCoordinates()[0],S=new lo(v.getCoordinates()[0]),I=!0;else if(w===a)x=new Tr(v.getLastCoordinate()),b=xf(v),E=v.getCoordinates(),S=v,I=!1;else if(w===l){x=new Tr(v.getFirstCoordinate());C=wf(qr(v,128)),E=[],E.push(v.getCenter()),E.push(v.getLastCoordinate()),E[0][1]=E[0][1]+7e5,I=!1}else if(w===u){const t=v.getGeometries();for(let e=0;e<t.length;e++)if(t[e].getType()==s)C=wf(v);else if(t[e].getType()==o){x=new Tr(t[e].getCoordinates());const n=t[e].getCoordinates();n[1]=n[1]+7e5,E=[n]}I=!1}if(n&&f.fontSize&&S){let t=0;const e=[];S.forEachSegment(((n,i)=>{const r=new lo([n,i]),o=xf(r);e.push(tx(f));const s=new Tr(r.getCoordinateAt(.5));e[t].setGeometry(s),e[t].getText().setText(o.lengthString),y.push(e[t]),t++}))}if(i&&p.fontSize&&E){let t=0;const e=I?E.length-1:E.length,n=[];for(let i=0;i<e;i++){const e=Wi(E[i],"EPSG:3857","EPSG:4326"),{longitude:r,latitude:o}=_p(e[0],e[1]),s=`${r.toFixed(6)}, ${o.toFixed(6)}`;n.push(rx(p));const a=new Tr(E[i]);n[t].setGeometry(a),n[t].getText().setText(s),y.push(n[t]),t++}}if(h&&g.fontSize){const t=nx(g);w===s||w===l||w===u?(t.setGeometry(x),t.getText().setText(null==C?void 0:C.areaString),y.push(t)):w===a&&(t.setGeometry(x),t.getText().setText(null==b?void 0:b.lengthString),y.push(t))}if("arrow"==d.iconPattern&&d.iconUrl)if(d.radius=d.iconWidth,d.radius2=d.iconHeight,d.url=d.iconUrl,"last"==d.arrowPattern){const t=v.getCoordinates();if(t.length&&t.length>=2){const e=t.length-1;let n=0;v.forEachSegment(((t,i)=>{if(n++,n==e){const e=i[0]-t[0],n=i[1]-t[1],r=Math.atan2(n,e);d.rotation=-r;const o=Kw(d),s=new Tr(i);o.setGeometry(s),y.push(o)}}))}}else"every"==d.arrowPattern?v.forEachSegment(((t,e)=>{const n=e[0]-t[0],i=e[1]-t[1],r=Math.atan2(i,n);d.rotation=-r;const o=Kw(d),s=new Tr(e);o.setGeometry(s),y.push(o)})):d.arrowPattern;return y}destructor(){this.mapEventIns.destructor(),this.vuePopupIns.destructor(),this.modify=null,this.snapTag=null,this.drawTag=null,this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}setActionPopup(){var t,e;this.dcPopupOptions={id:`${this.__layerIdPrefix}dc_popup`,name:`${this.__layerIdPrefix}vnode_popup`,vNode:dx,vNodeData:{data:this.__crurentSelDrawData,cancelCb:()=>{var t,e;this.__removeSourceFeatureById(this.__crurentSelDrawData.id),null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id),null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.drawTipPopupOptions.id),this.customCallbackFunc=this.__currentOptions.callback,this.customCallbackFunc&&this.customCallbackFunc(h.delete,this.__crurentSelDrawData)}},wrapX:!0,callback:t=>{this.__currentFeature=t,this.__crurentSelDrawData=t.get("__drawData"),this.__currentOptions=t.get(c),this.dcPopupOptions.vNodeData.data=this.__crurentSelDrawData},popupIsCenter:!1,eventType:Nw},null==(t=this.vuePopupIns)||t.addLayer(this.dcPopupOptions);const n=this.dcNodePopupCb(this.dcPopupOptions);this.dcEventSingleOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:Nw,cb:n,delay:300,debounce:!1},this.mapEventIns.addEvent(this.dcEventSingleOptions),this.dcEventDbclickOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:zw,cb:n,delay:300,debounce:!1},this.mapEventIns.addEvent(this.dcEventDbclickOptions),this.dcEventDragOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:Bw,cb:n,delay:300,debounce:!0},this.mapEventIns.addEvent(this.dcEventDragOptions),this.dcEventPointMoveOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:jw,cb:this.hightLightPointMoveHandle,delay:10,debounce:!1},this.mapEventIns.addEvent(this.dcEventPointMoveOptions),this.olBaseHandle&&this.olBaseHandle.customT&&(this.drawTipPopupOptions.customT=this.olBaseHandle.customT),null==(e=this.vuePopupIns)||e.addLayer(this.drawTipPopupOptions),this.mapEventIns.addEvent(this.drawTipEventPointMoveOptions),this.mapEventIns.addEvent(this.drawTipEventZoomOptions)}removeallInteraction(){var t,e;this.handle&&(this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null),this.modify&&(this.handle.removeInteraction(this.snapTag),this.handle.removeInteraction(this.modify),this.modify=null),null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.drawTipPopupOptions.id),null==(e=this.olBaseHandle)||e.setConstrainedView(!1))}setHoverFeatureStyle(t){if(this.oldDcNodePopupFeature&&this.oldDcNodePopupFeature.getId()==t.getId())return null;if(this.oldHoverNodePopupFeature){if(this.oldHoverNodePopupFeature.getId()==t.getId())return null;this.resetDcHoverFeatureStyle("hover")}this.oldHoverNodePopupFeature=t;const e=this.updateDrawStyleFunction(t,null,!1,!1,!1,{geo:{width:3,color:"rgba(255, 127, 0, 1)",fillColor:"rgba(255, 127, 0, 0.1)",radius:5,radius2:5,lineDash:[0,0],iconWidth:8,iconHeight:8,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"}});t.setStyle(e)}setDcFeatureStyle(t){this.oldDcNodePopupFeature&&this.resetDcHoverFeatureStyle("select"),this.oldDcNodePopupFeature=t;const e=this.updateDrawStyleFunction(t,null,!1,!1,!1,{geo:{width:3,color:"rgba(241, 51, 13, 1)",fillColor:"rgba(241, 51, 13, 0.1)",radius:5,radius2:5,lineDash:[0,0],iconWidth:8,iconHeight:8,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"}});t.setStyle(e)}resetDcHoverFeatureStyle(t){let e=this.oldDcNodePopupFeature;if("hover"===t){if(this.oldDcNodePopupFeature&&this.oldHoverNodePopupFeature&&this.oldDcNodePopupFeature.getId()==this.oldHoverNodePopupFeature.getId())return null;e=this.oldHoverNodePopupFeature}if(e){const t=e.get(c);let n=null;t&&(n={...t});const i=n.isShowSegments??!1,r=n.isShowLngLat??!1,o=n.isShowLabel??!1,s=e.get("__drawData");let a=null,l=null,u=null;s&&(a=s.geojson,a&&(l=a.properties,l&&(u=l.style)));const h=this.updateDrawStyleFunction(e,null,i,r,o,u);e.setStyle(h)}"hover"===t?this.oldHoverNodePopupFeature=null:"select"===t&&(this.oldDcNodePopupFeature=null)}drawStyleFunction(t,e,n,i,h){const c={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},d={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"},p=this.__currentOptions.shape;p&&p==r&&(c.color="rgba(24, 144, 255, 0)",c.fillColor="rgba(24, 144, 255, 0)",d.text="点击编辑文本");const f=[Jw(c,d)],g=t.getGeometry();if(!g)return null;const m=g.getType();let _,y,v,w,x,b=!1;if(!e||e===m)if(m===o)x=[g.getCoordinates()],b=!1;else if(m===s)_=g.getInteriorPoint(),v=wf(g),x=g.getCoordinates()[0],w=new lo(g.getCoordinates()[0]),b=!0;else if(m===a)_=new Tr(g.getLastCoordinate()),y=xf(g),x=g.getCoordinates(),w=g,b=!1;else if(m===l){_=new Tr(g.getFirstCoordinate());v=wf(qr(g,128)),x=[],x.push(g.getCenter()),x.push(g.getLastCoordinate()),x[0][1]=x[0][1]+7e5,b=!1}else if(m===u){const t=g.getGeometries();for(let e=0;e<t.length;e++)if(t[e].getType()==s)v=wf(g);else if(t[e].getType()==o){_=new Tr(t[e].getCoordinates());const n=t[e].getCoordinates();n[1]=n[1]+7e5,x=[n]}b=!1}if(n&&w){let t=0;w.forEachSegment(((e,n)=>{const i=new lo([e,n]),r=xf(i);this.segmentStyles.length-1<t&&this.segmentStyles.push(tx({...Qw}));const o=new Tr(i.getCoordinateAt(.5));this.segmentStyles[t].setGeometry(o),this.segmentStyles[t].getText().setText(r.lengthString),f.push(this.segmentStyles[t]),t++}))}if(i&&x){let t=0;const e=b?x.length-1:x.length;for(let n=0;n<e;n++){const e=Wi(x[n],"EPSG:3857","EPSG:4326"),{longitude:i,latitude:r}=_p(e[0],e[1]),o=`${i.toFixed(6)}, ${r.toFixed(6)}`;this.lableLngLatStyles.length-1<t&&this.lableLngLatStyles.push(rx({...ix}));const s=new Tr(x[n]);this.lableLngLatStyles[t].setGeometry(s),this.lableLngLatStyles[t].getText().setText(o),f.push(this.lableLngLatStyles[t]),t++}}return h&&(this.labelStyles=nx({...ex}),m===s||m===l||m===u?(this.labelStyles.setGeometry(_),this.labelStyles.getText().setText(null==v?void 0:v.areaString),f.push(this.labelStyles)):m===a&&(this.labelStyles.setGeometry(_),this.labelStyles.getText().setText(null==y?void 0:y.lengthString),f.push(this.labelStyles))),f}modifyStyleFunction(t){return t.get("features").forEach((e=>{const n=e.get(Vw);if(n){const i=t.getGeometry().getCoordinates(),r=e.getGeometry().getGeometries(),o=r[0].getCoordinates()[0],s=r[1].getCoordinates(),a=this.handle.getView().getProjection();let l,u,h;i[0]===s[0]&&i[1]===s[1]?(l=Wi(o[0],a,"EPSG:4326"),u=Wi(o[(o.length-1)/2],a,"EPSG:4326"),h=Ci(l,u)/2):(l=Wi(s,a,"EPSG:4326"),u=Wi(i,a,"EPSG:4326"),h=Ci(l,u));const c=$r(Wi(s,a,"EPSG:4326"),h,128);c.transform("EPSG:4326",a),r[0].setCoordinates(c.getCoordinates()),n.setGeometries(r)}})),this.defaultModifyStyle(t)}drawShape(t){var e,n;const i=t.shape,h=t.isClear??!1,d=t.isFreehand??!1,v=t.isShowSegments??!1,w=t.isShowLngLat??!1,x=t.isShowLabel??!1;if(this.isShowDcActionPopup=t.isShowAction??!1,this.isShowTipPopup=t.isShowTip??!1,this.handle&&this.olBaseHandle){h&&this.clearAllDrawShape(),this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),this.isShowTipPopup||null==(n=this.vuePopupIns)||n.hiddenPopupByID(this.drawTipPopupOptions.id),this.removeCancelDrawCB(),this.setCancelDrawCB(),this.removeallInteraction(),this.olBaseHandle.setConstrainedView(!0),this.__currentOptions=t,this.__drawData=null,this.drawType=i,this.drawModel=i,this.customCallbackFunc=t.callback;let b=null;i===r||i==o?this.drawType=o:i==p?(this.drawType=l,b=bf(ld(4))):i==f?(this.drawType=l,b=bf(ud())):i==s?this.drawType=s:i==a?this.drawType=a:i==_?(this.drawType=_,b=Cf):i==y?(this.drawType=l,b=function(t,e,n){e||(e=new Fu([new Ur([]),new Tr(t[0])]));const i=e.getGeometries(),r=Wi(t[0],n,"EPSG:4326"),o=$r(r,Ci(r,Wi(t[1],n,"EPSG:4326")),128);return Sf(o),o.transform("EPSG:4326",n),i[0].setCoordinates(o.getCoordinates()),e.setGeometries(i),e}):i==m?this.drawType=a:i==g&&(this.drawType=s),this.drawTag&&(this.drawTag=null),this.drawTag=new hd({source:this.interactionSource,type:this.drawType,geometryFunction:b,style:t=>this.drawStyleFunction(t,this.drawType,v,w,x),freehand:d,wrapX:!1}),this.InteractionLayer.setStyle((t=>this.drawStyleFunction(t,null,v,w,x))),this.drawTag.on("drawstart",(e=>{var n;this.olBaseHandle.setConstrainedView(!0),this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(n=this.vuePopupIns)||n.hiddenPopupByID(this.dcPopupOptions.id)),this.setDrawBackCB(),this.drawLayerZIndex=this.olBaseHandle.getCurrentzIndex()+1,this.InteractionLayer.setZIndex(this.drawLayerZIndex),t.needModify&&this.modify&&this.modify.setActive(!1)})),this.drawTag.on("drawend",(e=>{this.olBaseHandle.setConstrainedView(!1),this.removeDrawBackCB(),t.needModify&&this.modify&&this.modify.setActive(!0),this.getDrawData(t)(e),t.once?(t.needModify?this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null):this.drawTag&&this.removeallInteraction(),this.removeCancelDrawCB()):t.needModify||(this.handle.removeInteraction(this.modify),this.handle.removeInteraction(this.snapTag))})),t.needModify&&(this.modify&&(this.modify=null),this.modify=new wd({source:this.interactionSource,style:t=>this.modifyStyleFunction(t)}),this.modify.on("modifystart",(t=>{var e;this.olBaseHandle.setConstrainedView(!0),this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),t.features.forEach((t=>{const e=t.getGeometry();e.getType()===u&&t.set(Vw,e.clone(),!0)}))})),this.modify.on("modifyend",(e=>{this.olBaseHandle.setConstrainedView(!1),e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0))}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))}))),this.handle.addInteraction(this.drawTag),this.handle.addInteraction(this.snapTag),t.needModify&&(this.handle.addInteraction(this.modify),this.modify.setActive(!0))}}outModifyMode(){this.handle&&(this.removeCancelDrawCB(),this.modify&&(this.handle.removeInteraction(this.modify),this.handle.removeInteraction(this.snapTag),this.modify=null))}getCoordinatesLngLat(t){const e=[];return t[0].forEach((t=>{const n=Wi(t,"EPSG:3857","EPSG:4326"),{longitude:i,latitude:r}=_p(n[0],n[1]);e.push([i,r])})),e}updateAllDrawDataLabelStyle(t,e,n,i){var r;this.isShowTipPopup=i,this.isShowTipPopup||null==(r=this.vuePopupIns)||r.hiddenPopupByID(this.drawTipPopupOptions.id),this.interactionSource.forEachFeature((r=>{const o=r.get(d),s=r.get(c);s.isShowLabel=n,s.isShowLngLat=e,s.isShowSegments=t,s.isShowTip=i,r.setProperties({[c]:s});const a=r.get("__drawData");let l=null,u=null,h=null;if(a&&(l=a.geojson,l&&(u=l.properties,u&&(h=u.style))),o){const i=this.updateDrawStyleFunction(r,null,t,e,n,h);r.setStyle(i)}}))}getAllDrawData(){const t={type:"FeatureCollection",features:[]};return this.interactionSource.forEachFeature((e=>{const n=e.get(d),i=e.get("__drawData");if(n){const e=Ow.cloneDeep(i.geojson);t.features.push(e)}})),t}saveAllDrawData(t="geojson.json"){const e=this.getAllDrawData();if(e&&e.features&&e.features.length){const n=JSON.stringify(e),i=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(i),o=document.createElement("a");return o.href=r,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),e}return null}addGeojsonData(t){if(!t.data||!t.id)return null;this.isShowDcActionPopup=t.isShowAction??!1,this.__currentOptions=null;const e=new Gd({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(t.data);this.interactionSource.addFeatures(e);const n=e.length;let i=0;e.forEach((e=>{const r=e.get(c),l=e.get(v),u=e.get(d);if(!l&&u&&r);else{const n=e.get("__drawData");let i=n&&n.id;i||(i=`draw_${Yt(10)}`),e.setId(i);let r=t.isShowSegments,l=t.isShowLngLat,u=t.isShowLabel;const p={[d]:!0,[c]:{id:i,addId:t.id},[v]:!0},f=e.get("style"),g=e.get("editProps");if(n){if(n.oldDrawOptions){const e=n.oldDrawOptions;r=e.isShowSegments??!0,l=e.isShowLngLat??!0,u=e.isShowLabel??!0,this.__currentOptions=e,p[c]={...e,callback:t.callback,id:i,addId:t.id}}n.geojson.properties[mx]=Ow.cloneDeep(g),n.geojson.properties.style=Ow.cloneDeep(f),n.geojson.properties.__drawData=Ow.cloneDeep(n),t.callback&&t.callback(h.draw,n)}else{const n=e.getGeometry().getType();t.shape="Point"===n||"MultiPoint"===n?o:"Polygon"===n||"MultiPolygon"===n?s:"LineString"===n||"MultiLineString"===n?a:s,p[c]={...t,id:i,addId:t.id},this.getDrawData(t)({type:"drawend",feature:e})}let m=null;m=f?this.updateDrawStyleFunction(e,null,r,l,u,f):this.updateDrawStyleFunction(e,null,r,l,u,null),e.setStyle(m),e.setProperties(p),e.setProperties({[v]:!0})}i+=1,i===n&&this.olBaseHandle.fitToFeature(e,[120,120,120,120])}))}removeGeojsonData(t){const e=[];this.interactionSource.forEachFeature((n=>{const i=n.get(c);n.get(v)&&i&&i.addId==t.id&&e.push(n)})),e.forEach((t=>{this.interactionSource.removeFeature(t)}))}getOrginDrawData(){return this.__drawData}clearAllDrawShape(){var t;this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id)),this.interactionSource&&this.interactionSource.clear()}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeLayer(t.layer)})),this.__layers.clear(),!0)}}const yx=class extends kg{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:t.interpolate,projection:t.projection,resolutions:t.resolutions,state:t.state}),this.canvasFunction_=t.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5}getImageInternal(t,e,n,i){e=this.findNearestResolution(e);let r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==n&&cn(r.getExtent(),t))return r;!function(t,e){const n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}(t=t.slice(),this.ratio_);const o=[An(t)/e*n,Ln(t)/e*n],s=this.canvasFunction_.call(this,t,e,n,o,i);return s&&(r=new lh(t,e,n,s)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r}};var vx=class extends yx{constructor(t){var e={attributions:t.attributions,logo:t.logo,projection:t.projection,canvasFunction:function(t,e,n,i){return this.calculateImage(t,e,n,i)}};super(e),this._image=t.image?t.image:new Image,this._image.crossOrigin=t.crossOrigin,this._image.onload=function(){this.setCrop(this.crop),this.changed()}.bind(this),t.image||(this._image.src=t.url),this.center=t.imageCenter,this.setScale(t.imageScale),this.rotate=t.imageRotate?t.imageRotate:0,this.crop=t.imageCrop,this.mask=t.imageMask,this.setCrop(this.crop),this.on("change",function(){this.set("extent",this.calculateExtent())}.bind(this))}calculateImage(t,e,n,i){if(this.center){var r=document.createElement("canvas");r.width=i[0],r.height=i[1];var o=r.getContext("2d");if(!this._imageSize)return r;if(this.mask){o.beginPath();var s=p(this.mask[0]);o.moveTo(s[0],s[1]);for(var a=1;a<this.mask.length;a++)s=p(this.mask[a]),o.lineTo(s[0],s[1]);o.clip()}var l=p(this.center),u=(this._image.naturalWidth/2-this.crop[0])*this.scale[0]/e*n,h=(this._image.naturalHeight/2-this.crop[1])*this.scale[1]/e*n,c=this._imageSize[0]*this.scale[0]/e*n,d=this._imageSize[1]*this.scale[1]/e*n;return o.translate(l[0],l[1]),this.rotate&&o.rotate(this.rotate),o.drawImage(this._image,this.crop[0],this.crop[1],this._imageSize[0],this._imageSize[1],-u,-h,c,d),r}function p(e){return[(e[0]-t[0])/(t[2]-t[0])*i[0],(e[1]-t[3])/(t[1]-t[3])*i[1]]}}getCenter(){return this.center}setCenter(t){this.center=t,this.changed()}getScale(){return this.scale}setScale(t){switch(typeof t){case"number":t=[t,t];break;case"object":if(2!=t.length)return;break;default:return}this.scale=t,this.changed()}getRotation(){return this.rotate}setRotation(t){this.rotate=t,this.changed()}getGeoImage(){return this._image}getCrop(){return this.crop}setMask(t){this.mask=t,this.changed()}getMask(){return this.mask}setCrop(t){if(this._image.naturalWidth){if(t){switch(typeof t){case"number":t=[t,t,this._image.naturalWidth-t,this._image.naturalHeight-t];break;case"object":if(4!=t.length)return;break;default:return}t=sn([[t[0],t[1]],[t[2],t[3]]]),this.crop=[Math.max(0,t[0]),Math.max(0,t[1]),Math.min(this._image.naturalWidth,t[2]),Math.min(this._image.naturalHeight,t[3])]}else this.crop=[0,0,this._image.naturalWidth,this._image.naturalHeight];this.crop[2]<=this.crop[0]&&(this.crop[2]=this.crop[0]+1),this.crop[3]<=this.crop[1]&&(this.crop[3]=this.crop[1]+1),this._imageSize=[this.crop[2]-this.crop[0],this.crop[3]-this.crop[1]],this.changed()}else this.crop=t}getExtent(t){var e=this.get("extent");if(e||(e=this.calculateExtent()),t)for(var n=0;n<t.length;n++)t[n]=e[n];return e}calculateExtent(t){var e;if(!1!==t&&this.getMask())e=new Ur([this.getMask()]);else{var n=this.getCenter(),i=this.getScale(),r=this.getGeoImage().width*i[0],o=this.getGeoImage().height*i[1];(e=Yr(sn([[n[0]-r/2,n[1]-o/2],[n[0]+r/2,n[1]+o/2]]))).rotate(-this.getRotation(),n)}return e.getExtent()}},wx=class extends xg{constructor(t){super(t)}getExtent(){return this.getSource().getExtent()}};class xx{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"__layers",null),e(this,"__layerIdPrefix","IMAGE_GEO_BASIC_"),e(this,"checkPicurl",(t=>new Promise(((e,n)=>{const i=document.createElement("img");i.src=t,i.onload=()=>{e({width:i.naturalWidth,height:i.naturalHeight})},i.onerror=function(){n({width:-1,height:-1})}})))),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map}destructor(){this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers.clear(),this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}async createLayer(t={url:"",id:"",name:"",zIndex:0,extent:n,bbox:[],wrapX:!0,opacity:1}){if(!t.url||!t.id)return null;if(t.bbox&&!t.bbox.length)return null;let e=n;t.extent&&t.extent.length?4===t.extent.length?e=t.extent:1===t.extent.length&&(e=yp(t.extent)):e=yp(t.bbox),e=ff(e);let i=t.name?t.name:Yt(10);i=this.__Name(i);const r=this.__Id(t.id),o=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),s={[d]:!0,[c]:t},a=await this.checkPicurl(t.url);let l,u;if(t.level){if(String(t.level).includes("2")||String(t.level).includes("3")){const e=wp(yp(t.bbox));e&&e.length&&(l=e[0]);const n=[[Wi((h=t.bbox)[0][0],"EPSG:4326","EPSG:3857"),Wi(h[0][1],"EPSG:4326","EPSG:3857"),Wi(h[0][2],"EPSG:4326","EPSG:3857"),Wi(h[0][3],"EPSG:4326","EPSG:3857"),Wi(h[0][4],"EPSG:4326","EPSG:3857")]];n&&n.length&&(u=n[0])}}else l=t.bbox[0];var h;let p=0;t.isRotation&&(p=t.rotationInDegree?t.rotationInDegree*Math.PI/180:_f(t.bbox)),isNaN(p)&&(p=0);const f=Tn(e),g=zi(this.handle.getView().getProjection(),1,f),m=Ci(l[0],l[1]),_=Ci(l[0],l[3]),y=m/(a.width*g),v=_/(a.height*g),w={url:t.url,projection:"EPSG:3857",imageExtent:e,imageCenter:f,imageRotate:p,imageScale:[y,v],imageMask:u,wrapX:t.wrapX},x=new vx(w);x.setProperties(s);const b=t.opacity?t.opacity:1,C=new wx({source:x,extent:e,zIndex:o,opacity:b});C.setProperties(s),C.set("id",r),C.set("name",i);return{options:t,imageOptions:w,source:x,layer:C}}async addLayer(t){if(this.handle){const e=await this.createLayer(t);return!!e&&(this.handle.addLayer(e.layer),this.__layers.set(this.__Id(t.id),e),!0)}return!1}fitToView(t){return!!this.olBaseHandle&&(t.extent?(this.olBaseHandle.fitToExtent(t.extent),!0):void 0)}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeLayer(t.layer)})),this.__layers.clear(),!0)}setLayerOpacity(t,e){return this.setLayerOpacityByID(t.id,e)}setLayerOpacityByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setOpacity(e),!0)}return!1}showHiddenLayer(t,e){return this.showHiddenLayerByID(t.id,e)}showHiddenLayerByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setVisible(e),!0)}return!1}getExtent(t){return this.getExtentById(t.id)}getExtentById(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));return e?e.layer.getExtent():[]}return[]}getCenter(t){return this.getCenterById(t.id)}getCenterById(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));if(e){return Tn(e.layer.getExtent())}return[]}return[]}}const bx=J({name:"DrawCancelConfirm",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({name:"我是VueNode标题",longitude:"149.757575E",latitude:"30.435657N",satellite:"888",time:"2023-07-16 12:00:00",x:180,y:1620})}},setup:(t,e)=>({colseHandle:()=>{t&&t.destory()},cancelHandle:()=>{t&&t.vNodeData.cancelCb()},modifyHandle:()=>{t&&t.vNodeData.modifyCb()},editHandle:()=>{t&&t.vNodeData.editCb()},confirmHandle:()=>{t&&t.vNodeData.confirmCb()}})}),Cx=["id"],Sx=(t=>(nt("data-v-71d1b903"),t=t(),it(),t))((()=>rt("div",{class:"row_nw_fs_center title_box"},"请选择绘制操作",-1))),Ex={class:"row_nw_center_center info_box",style:{color:"#fff"}},Ix={class:"row_nw_center_center act_box"};const Px=Q(bx,[["render",function(t,e,n,i,r,o){return tt(),et("div",{id:t.id,class:"col_nw_fs_center panel_container"},[rt("div",{class:"row_nw_fs_center close_icon",onClick:e[0]||(e[0]=(...e)=>t.colseHandle&&t.colseHandle(...e))},"X"),Sx,rt("div",Ex,ot(t.vNodeData.data.id),1),rt("div",Ix,[rt("div",{class:"row_nw_center_center info_del",onClick:e[1]||(e[1]=(...e)=>t.cancelHandle&&t.cancelHandle(...e))},"删除"),rt("div",{class:"row_nw_center_center info_del",onClick:e[2]||(e[2]=(...e)=>t.modifyHandle&&t.modifyHandle(...e))},"修改"),rt("div",{class:"row_nw_center_center info_del",onClick:e[3]||(e[3]=(...e)=>t.editHandle&&t.editHandle(...e))},"属性"),rt("div",{class:"row_nw_center_center info_confirm",onClick:e[4]||(e[4]=(...e)=>t.confirmHandle&&t.confirmHandle(...e))},"完成")])],8,Cx)}],["__scopeId","data-v-71d1b903"]]);function Tx(t){return!!pt()&&(ft(t),!0)}function kx(t){return"function"==typeof t?t():gt(t)}const Dx="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const Mx=Object.prototype.toString,Lx=t=>"[object Object]"===Mx.call(t),Rx=()=>{},Ox=Fx();function Fx(){var t,e;return Dx&&(null==(t=null==window?void 0:window.navigator)?void 0:t.userAgent)&&(/iP(ad|hone|od)/.test(window.navigator.userAgent)||(null==(e=null==window?void 0:window.navigator)?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(null==window?void 0:window.navigator.userAgent))}function Ax(t,e){return function(...n){return new Promise(((i,r)=>{Promise.resolve(t((()=>e.apply(this,n)),{fn:e,thisArg:this,args:n})).then(i).catch(r)}))}}const zx=t=>t();function Bx(t,e=200,n={}){return Ax(function(t,e={}){let n,i,r=Rx;const o=t=>{clearTimeout(t),r(),r=Rx};return s=>{const a=kx(t),l=kx(e.maxWait);return n&&o(n),a<=0||void 0!==l&&l<=0?(i&&(o(i),i=null),Promise.resolve(s())):new Promise(((t,u)=>{r=e.rejectOnCancel?u:t,l&&!i&&(i=setTimeout((()=>{n&&o(n),i=null,t(s())}),l)),n=setTimeout((()=>{i&&o(i),i=null,t(s())}),a)}))}}(e,n),t)}function jx(t,e,n={}){const{eventFilter:i,...r}=n,{eventFilter:o,pause:s,resume:a,isActive:l}=function(t=zx){const e=ct(!0);return{isActive:dt(e),pause:function(){e.value=!1},resume:function(){e.value=!0},eventFilter:(...n)=>{e.value&&t(...n)}}}(i),u=function(t,e,n={}){const{eventFilter:i=zx,...r}=n;return ut(t,Ax(i,e),r)}(t,e,{...r,eventFilter:o});return{stop:u,pause:s,resume:a,isActive:l}}function Gx(t,e=!0,n){const i=function(t){return t||ht()}();i?at(t,n):e?t():lt(t)}function Nx(t,e,n){const i=ut(t,((t,r,o)=>{t&&((null==n?void 0:n.once)&&lt((()=>i())),e(t,r,o))}),{...n,once:!1});return i}function Vx(t){var e;const n=kx(t);return null!=(e=null==n?void 0:n.$el)?e:n}const Hx=Dx?window:void 0,Wx=Dx?window.navigator:void 0;function Xx(...t){let e,n,i,r;if("string"==typeof t[0]||Array.isArray(t[0])?([n,i,r]=t,e=Hx):[e,n,i,r]=t,!e)return Rx;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const o=[],s=()=>{o.forEach((t=>t())),o.length=0},a=ut((()=>[Vx(e),kx(r)]),(([t,e])=>{if(s(),!t)return;const r=Lx(e)?{...e}:e;o.push(...n.flatMap((e=>i.map((n=>((t,e,n,i)=>(t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)))(t,e,n,r))))))}),{immediate:!0,flush:"post"}),l=()=>{a(),s()};return Tx(l),l}let Ux=!1;function $x(t){const e=function(){const t=ct(!1),e=ht();return e&&at((()=>{t.value=!0}),e),t}();return mt((()=>(e.value,Boolean(t()))))}function Yx(t,e={}){const{controls:n=!1,navigator:i=Wx}=e,r=$x((()=>i&&"permissions"in i));let o;const s="string"==typeof t?{name:t}:t,a=ct(),l=()=>{o&&(a.value=o.state)},u=function(t){let e;function n(){return e||(e=t()),e}return n.reset=async()=>{const t=e;e=void 0,t&&await t},n}((async()=>{if(r.value){if(!o)try{o=await i.permissions.query(s),Xx(o,"change",l),l()}catch(Hj){a.value="prompt"}return o}}));return u(),n?{state:a,isSupported:r,query:u}:a}function qx(t={}){const{navigator:e=Wx,read:n=!1,source:i,copiedDuring:r=1500,legacy:o=!1}=t,s=$x((()=>e&&"clipboard"in e)),a=Yx("clipboard-read"),l=Yx("clipboard-write"),u=mt((()=>s.value||o)),h=ct(""),c=ct(!1),d=function(t,e,n={}){const{immediate:i=!0}=n,r=ct(!1);let o=null;function s(){o&&(clearTimeout(o),o=null)}function a(){r.value=!1,s()}function l(...n){s(),r.value=!0,o=setTimeout((()=>{r.value=!1,o=null,t(...n)}),kx(e))}return i&&(r.value=!0,Dx&&l()),Tx(a),{isPending:dt(r),start:l,stop:a}}((()=>c.value=!1),r);function p(t){return"granted"===t||"prompt"===t}return u.value&&n&&Xx(["copy","cut"],(function(){var t,n,i;s.value&&p(a.value)?e.clipboard.readText().then((t=>{h.value=t})):h.value=null!=(i=null==(n=null==(t=null==document?void 0:document.getSelection)?void 0:t.call(document))?void 0:n.toString())?i:""})),{isSupported:u,text:h,copied:c,copy:async function(t=kx(i)){u.value&&null!=t&&(s.value&&p(l.value)?await e.clipboard.writeText(t):function(t){const e=document.createElement("textarea");e.value=null!=t?t:"",e.style.position="absolute",e.style.opacity="0",document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()}(t),h.value=t,c.value=!0,d.start())}}}const Zx="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Kx="__vueuse_ssr_handlers__",Jx=Qx();function Qx(){return Kx in Zx||(Zx[Kx]=Zx[Kx]||{}),Zx[Kx]}const tb={boolean:{read:t=>"true"===t,write:t=>String(t)},object:{read:t=>JSON.parse(t),write:t=>JSON.stringify(t)},number:{read:t=>Number.parseFloat(t),write:t=>String(t)},any:{read:t=>t,write:t=>String(t)},string:{read:t=>t,write:t=>String(t)},map:{read:t=>new Map(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t.entries()))},set:{read:t=>new Set(JSON.parse(t)),write:t=>JSON.stringify(Array.from(t))},date:{read:t=>new Date(t),write:t=>t.toISOString()}},eb="vueuse-storage";function nb(t,e,n,i={}){var r;const{flush:o="pre",deep:s=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:u=!1,shallow:h,window:c=Hx,eventFilter:d,onError:p=(t=>{}),initOnMounted:f}=i,g=(h?_t:ct)("function"==typeof e?e():e);if(!n)try{n=function(t,e){return Jx[t]||e}("getDefaultStorage",(()=>{var t;return null==(t=Hx)?void 0:t.localStorage}))()}catch(Hj){p(Hj)}if(!n)return g;const m=kx(e),_=function(t){return null==t?"any":t instanceof Set?"set":t instanceof Map?"map":t instanceof Date?"date":"boolean"==typeof t?"boolean":"string"==typeof t?"string":"object"==typeof t?"object":Number.isNaN(t)?"any":"number"}(m),y=null!=(r=i.serializer)?r:tb[_],{pause:v,resume:w}=jx(g,(()=>function(e){try{const i=n.getItem(t);if(null==e)x(i,null),n.removeItem(t);else{const r=y.write(e);i!==r&&(n.setItem(t,r),x(i,r))}}catch(Hj){p(Hj)}}(g.value)),{flush:o,deep:s,eventFilter:d});function x(e,i){c&&c.dispatchEvent(new CustomEvent(eb,{detail:{key:t,oldValue:e,newValue:i,storageArea:n}}))}function b(e){if(!e||e.storageArea===n)if(e&&null==e.key)g.value=m;else if(!e||e.key===t){v();try{(null==e?void 0:e.newValue)!==y.write(g.value)&&(g.value=function(e){const i=e?e.newValue:n.getItem(t);if(null==i)return l&&null!=m&&n.setItem(t,y.write(m)),m;if(!e&&u){const t=y.read(i);return"function"==typeof u?u(t,m):"object"!==_||Array.isArray(t)?t:{...m,...t}}return"string"!=typeof i?i:y.read(i)}(e))}catch(Hj){p(Hj)}finally{e?lt(w):w()}}}function C(t){b(t.detail)}return c&&a&&Gx((()=>{Xx(c,"storage",b),Xx(c,eb,C),f&&b()})),f||b(),g}function ib(t,e,n={}){const{window:i=Hx}=n;return nb(t,e,null==i?void 0:i.localStorage,n)}function rb(t){return(rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ob=/^\s+/,sb=/\s+$/;function ab(t,e){if(e=e||{},(t=t||"")instanceof ab)return t;if(!(this instanceof ab))return new ab(t,e);var n=function(t){var e={r:0,g:0,b:0},n=1,i=null,r=null,o=null,s=!1,a=!1;"string"==typeof t&&(t=function(t){t=t.replace(ob,"").replace(sb,"").toLowerCase();var e,n=!1;if(Sb[t])t=Sb[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=Bb.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=Bb.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=Bb.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=Bb.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=Bb.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=Bb.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=Bb.hex8.exec(t))return{r:kb(e[1]),g:kb(e[2]),b:kb(e[3]),a:Rb(e[4]),format:n?"name":"hex8"};if(e=Bb.hex6.exec(t))return{r:kb(e[1]),g:kb(e[2]),b:kb(e[3]),format:n?"name":"hex"};if(e=Bb.hex4.exec(t))return{r:kb(e[1]+""+e[1]),g:kb(e[2]+""+e[2]),b:kb(e[3]+""+e[3]),a:Rb(e[4]+""+e[4]),format:n?"name":"hex8"};if(e=Bb.hex3.exec(t))return{r:kb(e[1]+""+e[1]),g:kb(e[2]+""+e[2]),b:kb(e[3]+""+e[3]),format:n?"name":"hex"};return!1}(t));"object"==rb(t)&&(jb(t.r)&&jb(t.g)&&jb(t.b)?(l=t.r,u=t.g,h=t.b,e={r:255*Pb(l,255),g:255*Pb(u,255),b:255*Pb(h,255)},s=!0,a="%"===String(t.r).substr(-1)?"prgb":"rgb"):jb(t.h)&&jb(t.s)&&jb(t.v)?(i=Mb(t.s),r=Mb(t.v),e=function(t,e,n){t=6*Pb(t,360),e=Pb(e,100),n=Pb(n,100);var i=Math.floor(t),r=t-i,o=n*(1-e),s=n*(1-r*e),a=n*(1-(1-r)*e),l=i%6,u=[n,s,o,o,a,n][l],h=[a,n,n,s,o,o][l],c=[o,o,a,n,n,s][l];return{r:255*u,g:255*h,b:255*c}}(t.h,i,r),s=!0,a="hsv"):jb(t.h)&&jb(t.s)&&jb(t.l)&&(i=Mb(t.s),o=Mb(t.l),e=function(t,e,n){var i,r,o;function s(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=Pb(t,360),e=Pb(e,100),n=Pb(n,100),0===e)i=r=o=n;else{var a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=s(l,a,t+1/3),r=s(l,a,t),o=s(l,a,t-1/3)}return{r:255*i,g:255*r,b:255*o}}(t.h,i,o),s=!0,a="hsl"),t.hasOwnProperty("a")&&(n=t.a));var l,u,h;return n=Ib(n),{ok:s,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function lb(t,e,n){t=Pb(t,255),e=Pb(e,255),n=Pb(n,255);var i,r,o=Math.max(t,e,n),s=Math.min(t,e,n),a=(o+s)/2;if(o==s)i=r=0;else{var l=o-s;switch(r=a>.5?l/(2-o-s):l/(o+s),o){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:r,l:a}}function ub(t,e,n){t=Pb(t,255),e=Pb(e,255),n=Pb(n,255);var i,r,o=Math.max(t,e,n),s=Math.min(t,e,n),a=o,l=o-s;if(r=0===o?0:l/o,o==s)i=0;else{switch(o){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4}i/=6}return{h:i,s:r,v:a}}function hb(t,e,n,i){var r=[Db(Math.round(t).toString(16)),Db(Math.round(e).toString(16)),Db(Math.round(n).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function cb(t,e,n,i){return[Db(Lb(i)),Db(Math.round(t).toString(16)),Db(Math.round(e).toString(16)),Db(Math.round(n).toString(16))].join("")}function db(t,e){e=0===e?0:e||10;var n=ab(t).toHsl();return n.s-=e/100,n.s=Tb(n.s),ab(n)}function pb(t,e){e=0===e?0:e||10;var n=ab(t).toHsl();return n.s+=e/100,n.s=Tb(n.s),ab(n)}function fb(t){return ab(t).desaturate(100)}function gb(t,e){e=0===e?0:e||10;var n=ab(t).toHsl();return n.l+=e/100,n.l=Tb(n.l),ab(n)}function mb(t,e){e=0===e?0:e||10;var n=ab(t).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-e/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-e/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-e/100*255))),ab(n)}function _b(t,e){e=0===e?0:e||10;var n=ab(t).toHsl();return n.l-=e/100,n.l=Tb(n.l),ab(n)}function yb(t,e){var n=ab(t).toHsl(),i=(n.h+e)%360;return n.h=i<0?360+i:i,ab(n)}function vb(t){var e=ab(t).toHsl();return e.h=(e.h+180)%360,ab(e)}function wb(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=ab(t).toHsl(),i=[ab(t)],r=360/e,o=1;o<e;o++)i.push(ab({h:(n.h+o*r)%360,s:n.s,l:n.l}));return i}function xb(t){var e=ab(t).toHsl(),n=e.h;return[ab(t),ab({h:(n+72)%360,s:e.s,l:e.l}),ab({h:(n+216)%360,s:e.s,l:e.l})]}function bb(t,e,n){e=e||6,n=n||30;var i=ab(t).toHsl(),r=360/n,o=[ab(t)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,o.push(ab(i));return o}function Cb(t,e){e=e||6;for(var n=ab(t).toHsv(),i=n.h,r=n.s,o=n.v,s=[],a=1/e;e--;)s.push(ab({h:i,s:r,v:o})),o=(o+a)%1;return s}ab.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,i=this.toRgb();return t=i.r/255,e=i.g/255,n=i.b/255,.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=Ib(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=ub(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=ub(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),i=Math.round(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+i+"%)":"hsva("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var t=lb(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=lb(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),i=Math.round(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+i+"%)":"hsla("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(t){return hb(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,n,i,r){var o=[Db(Math.round(t).toString(16)),Db(Math.round(e).toString(16)),Db(Math.round(n).toString(16)),Db(Lb(i))];if(r&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*Pb(this._r,255))+"%",g:Math.round(100*Pb(this._g,255))+"%",b:Math.round(100*Pb(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*Pb(this._r,255))+"%, "+Math.round(100*Pb(this._g,255))+"%, "+Math.round(100*Pb(this._b,255))+"%)":"rgba("+Math.round(100*Pb(this._r,255))+"%, "+Math.round(100*Pb(this._g,255))+"%, "+Math.round(100*Pb(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(Eb[hb(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+cb(this._r,this._g,this._b,this._a),n=e,i=this._gradientType?"GradientType = 1, ":"";if(t){var r=ab(t);n="#"+cb(r._r,r._g,r._b,r._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,i=this._a<1&&this._a>=0;return e||!i||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return ab(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(gb,arguments)},brighten:function(){return this._applyModification(mb,arguments)},darken:function(){return this._applyModification(_b,arguments)},desaturate:function(){return this._applyModification(db,arguments)},saturate:function(){return this._applyModification(pb,arguments)},greyscale:function(){return this._applyModification(fb,arguments)},spin:function(){return this._applyModification(yb,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(bb,arguments)},complement:function(){return this._applyCombination(vb,arguments)},monochromatic:function(){return this._applyCombination(Cb,arguments)},splitcomplement:function(){return this._applyCombination(xb,arguments)},triad:function(){return this._applyCombination(wb,[3])},tetrad:function(){return this._applyCombination(wb,[4])}},ab.fromRatio=function(t,e){if("object"==rb(t)){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]="a"===i?t[i]:Mb(t[i]));t=n}return ab(t,e)},ab.equals=function(t,e){return!(!t||!e)&&ab(t).toRgbString()==ab(e).toRgbString()},ab.random=function(){return ab.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},ab.mix=function(t,e,n){n=0===n?0:n||50;var i=ab(t).toRgb(),r=ab(e).toRgb(),o=n/100;return ab({r:(r.r-i.r)*o+i.r,g:(r.g-i.g)*o+i.g,b:(r.b-i.b)*o+i.b,a:(r.a-i.a)*o+i.a})},ab.readability=function(t,e){var n=ab(t),i=ab(e);return(Math.max(n.getLuminance(),i.getLuminance())+.05)/(Math.min(n.getLuminance(),i.getLuminance())+.05)},ab.isReadable=function(t,e,n){var i,r,o=ab.readability(t,e);switch(r=!1,(i=function(t){var e,n;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==n&&"large"!==n&&(n="small");return{level:e,size:n}}(n)).level+i.size){case"AAsmall":case"AAAlarge":r=o>=4.5;break;case"AAlarge":r=o>=3;break;case"AAAsmall":r=o>=7}return r},ab.mostReadable=function(t,e,n){var i,r,o,s,a=null,l=0;r=(n=n||{}).includeFallbackColors,o=n.level,s=n.size;for(var u=0;u<e.length;u++)(i=ab.readability(t,e[u]))>l&&(l=i,a=ab(e[u]));return ab.isReadable(t,a,{level:o,size:s})||!r?a:(n.includeFallbackColors=!1,ab.mostReadable(t,["#fff","#000"],n))};var Sb=ab.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Eb=ab.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(Sb);function Ib(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Pb(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function Tb(t){return Math.min(1,Math.max(0,t))}function kb(t){return parseInt(t,16)}function Db(t){return 1==t.length?"0"+t:""+t}function Mb(t){return t<=1&&(t=100*t+"%"),t}function Lb(t){return Math.round(255*parseFloat(t)).toString(16)}function Rb(t){return kb(t)/255}var Ob,Fb,Ab,zb,Bb=(Fb="[\\s|\\(]+("+(Ob="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Ob+")[,|\\s]+("+Ob+")\\s*\\)?",Ab="[\\s|\\(]+("+Ob+")[,|\\s]+("+Ob+")[,|\\s]+("+Ob+")[,|\\s]+("+Ob+")\\s*\\)?",{CSS_UNIT:new RegExp(Ob),rgb:new RegExp("rgb"+Fb),rgba:new RegExp("rgba"+Ab),hsl:new RegExp("hsl"+Fb),hsla:new RegExp("hsla"+Ab),hsv:new RegExp("hsv"+Fb),hsva:new RegExp("hsva"+Ab),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function jb(t){return!!Bb.CSS_UNIT.exec(t)}(zb=zb||{}).stringify=function(){var t={"visit_linear-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return t.visit_gradient(e)},"visit_radial-gradient":function(e){return t.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return t.visit_gradient(e)},visit_gradient:function(e){var n=t.visit(e.orientation);return n&&(n+=", "),e.type+"("+n+t.visit(e.colorStops)+")"},visit_shape:function(e){var n=e.value,i=t.visit(e.at),r=t.visit(e.style);return r&&(n+=" "+r),i&&(n+=" at "+i),n},"visit_default-radial":function(e){var n="",i=t.visit(e.at);return i&&(n+=i),n},"visit_extent-keyword":function(e){var n=e.value,i=t.visit(e.at);return i&&(n+=" at "+i),n},"visit_position-keyword":function(t){return t.value},visit_position:function(e){return t.visit(e.value.x)+" "+t.visit(e.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(e){return t.visit_color(e.value,e)},visit_hex:function(e){return t.visit_color("#"+e.value,e)},visit_rgb:function(e){return t.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return t.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,n){var i=e,r=t.visit(n.length);return r&&(i+=" "+r),i},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(e){var n="",i=e.length;return e.forEach((function(e,r){n+=t.visit(e),r<i-1&&(n+=", ")})),n},visit:function(e){if(!e)return"";if(e instanceof Array)return t.visit_array(e,"");if(e.type){var n=t["visit_"+e.type];if(n)return n(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}};return function(e){return t.visit(e)}}(),(zb=zb||{}).parse=function(){var t={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function n(t){var n=new Error(e+": "+t);throw n.source=e,n}function i(){var t=p(r);return e.length>0&&n("Invalid input not EOF"),t}function r(){return o("linear-gradient",t.linearGradient,a)||o("repeating-linear-gradient",t.repeatingLinearGradient,a)||o("radial-gradient",t.radialGradient,l)||o("repeating-radial-gradient",t.repeatingRadialGradient,l)}function o(e,i,r){return s(i,(function(i){var o=r();return o&&(v(t.comma)||n("Missing comma before color stops")),{type:e,orientation:o,colorStops:p(f)}}))}function s(e,i){var r=v(e);if(r){v(t.startCall)||n("Missing (");var o=i(r);return v(t.endCall)||n("Missing )"),o}}function a(){return y("directional",t.sideOrCorner,1)||y("angular",t.angleValue,1)}function l(){var n,i,r=u();return r&&((n=[]).push(r),i=e,v(t.comma)&&((r=u())?n.push(r):e=i)),n}function u(){var t=function(){var t=y("shape",/^(circle)/i,0);t&&(t.style=_()||h());return t}()||function(){var t=y("shape",/^(ellipse)/i,0);t&&(t.style=m()||h());return t}();if(t)t.at=c();else{var e=h();if(e){t=e;var n=c();n&&(t.at=n)}else{var i=d();i&&(t={type:"default-radial",at:i})}}return t}function h(){return y("extent-keyword",t.extentKeywords,1)}function c(){if(y("position",/^at/,0)){var t=d();return t||n("Missing positioning value"),t}}function d(){var t={x:m(),y:m()};if(t.x||t.y)return{type:"position",value:t}}function p(e){var i=e(),r=[];if(i)for(r.push(i);v(t.comma);)(i=e())?r.push(i):n("One extra comma");return r}function f(){var e=y("hex",t.hexColor,1)||s(t.rgbaColor,(function(){return{type:"rgba",value:p(g)}}))||s(t.rgbColor,(function(){return{type:"rgb",value:p(g)}}))||y("literal",t.literalColor,0);return e||n("Expected color definition"),e.length=m(),e}function g(){return v(t.number)[1]}function m(){return y("%",t.percentageValue,1)||y("position-keyword",t.positionKeywords,1)||_()}function _(){return y("px",t.pixelValue,1)||y("em",t.emValue,1)}function y(t,e,n){var i=v(e);if(i)return{type:t,value:i[n]}}function v(t){var n,i;return(i=/^[\n\r\t\s]+/.exec(e))&&w(i[0].length),(n=t.exec(e))&&w(n[0].length),n}function w(t){e=e.substr(t)}return function(t){return e=t.toString(),i()}}();var Gb=zb.parse,Nb=zb.stringify,Vb="top",Hb="bottom",Wb="right",Xb="left",Ub="auto",$b=[Vb,Hb,Wb,Xb],Yb="start",qb="end",Zb="clippingParents",Kb="viewport",Jb="popper",Qb="reference",tC=$b.reduce((function(t,e){return t.concat([e+"-"+Yb,e+"-"+qb])}),[]),eC=[].concat($b,[Ub]).reduce((function(t,e){return t.concat([e,e+"-"+Yb,e+"-"+qb])}),[]),nC=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function iC(t){return t?(t.nodeName||"").toLowerCase():null}function rC(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function oC(t){return t instanceof rC(t).Element||t instanceof Element}function sC(t){return t instanceof rC(t).HTMLElement||t instanceof HTMLElement}function aC(t){return"undefined"!=typeof ShadowRoot&&(t instanceof rC(t).ShadowRoot||t instanceof ShadowRoot)}const lC={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var n=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];sC(r)&&iC(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(t){var e=i[t];!1===e?r.removeAttribute(t):r.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach((function(t){var i=e.elements[t],r=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce((function(t,e){return t[e]="",t}),{});sC(i)&&iC(i)&&(Object.assign(i.style,o),Object.keys(r).forEach((function(t){i.removeAttribute(t)})))}))}},requires:["computeStyles"]};function uC(t){return t.split("-")[0]}var hC=Math.max,cC=Math.min,dC=Math.round;function pC(){var t=navigator.userAgentData;return null!=t&&t.brands&&Array.isArray(t.brands)?t.brands.map((function(t){return t.brand+"/"+t.version})).join(" "):navigator.userAgent}function fC(){return!/^((?!chrome|android).)*safari/i.test(pC())}function gC(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=t.getBoundingClientRect(),r=1,o=1;e&&sC(t)&&(r=t.offsetWidth>0&&dC(i.width)/t.offsetWidth||1,o=t.offsetHeight>0&&dC(i.height)/t.offsetHeight||1);var s=(oC(t)?rC(t):window).visualViewport,a=!fC()&&n,l=(i.left+(a&&s?s.offsetLeft:0))/r,u=(i.top+(a&&s?s.offsetTop:0))/o,h=i.width/r,c=i.height/o;return{width:h,height:c,top:u,right:l+h,bottom:u+c,left:l,x:l,y:u}}function mC(t){var e=gC(t),n=t.offsetWidth,i=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:i}}function _C(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&aC(n)){var i=e;do{if(i&&t.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function yC(t){return rC(t).getComputedStyle(t)}function vC(t){return["table","td","th"].indexOf(iC(t))>=0}function wC(t){return((oC(t)?t.ownerDocument:t.document)||window.document).documentElement}function xC(t){return"html"===iC(t)?t:t.assignedSlot||t.parentNode||(aC(t)?t.host:null)||wC(t)}function bC(t){return sC(t)&&"fixed"!==yC(t).position?t.offsetParent:null}function CC(t){for(var e=rC(t),n=bC(t);n&&vC(n)&&"static"===yC(n).position;)n=bC(n);return n&&("html"===iC(n)||"body"===iC(n)&&"static"===yC(n).position)?e:n||function(t){var e=/firefox/i.test(pC());if(/Trident/i.test(pC())&&sC(t)&&"fixed"===yC(t).position)return null;var n=xC(t);for(aC(n)&&(n=n.host);sC(n)&&["html","body"].indexOf(iC(n))<0;){var i=yC(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||e&&"filter"===i.willChange||e&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(t)||e}function SC(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function EC(t,e,n){return hC(t,cC(e,n))}function IC(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function PC(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}function TC(t){return t.split("-")[1]}var kC={top:"auto",right:"auto",bottom:"auto",left:"auto"};function DC(t){var e,n=t.popper,i=t.popperRect,r=t.placement,o=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,u=t.adaptive,h=t.roundOffsets,c=t.isFixed,d=s.x,p=void 0===d?0:d,f=s.y,g=void 0===f?0:f,m="function"==typeof h?h({x:p,y:g}):{x:p,y:g};p=m.x,g=m.y;var _=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),v=Xb,w=Vb,x=window;if(u){var b=CC(n),C="clientHeight",S="clientWidth";if(b===rC(n)&&"static"!==yC(b=wC(n)).position&&"absolute"===a&&(C="scrollHeight",S="scrollWidth"),r===Vb||(r===Xb||r===Wb)&&o===qb)w=Hb,g-=(c&&b===x&&x.visualViewport?x.visualViewport.height:b[C])-i.height,g*=l?1:-1;if(r===Xb||(r===Vb||r===Hb)&&o===qb)v=Wb,p-=(c&&b===x&&x.visualViewport?x.visualViewport.width:b[S])-i.width,p*=l?1:-1}var E,I=Object.assign({position:a},u&&kC),P=!0===h?function(t,e){var n=t.x,i=t.y,r=e.devicePixelRatio||1;return{x:dC(n*r)/r||0,y:dC(i*r)/r||0}}({x:p,y:g},rC(n)):{x:p,y:g};return p=P.x,g=P.y,l?Object.assign({},I,((E={})[w]=y?"0":"",E[v]=_?"0":"",E.transform=(x.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",E)):Object.assign({},I,((e={})[w]=y?g+"px":"",e[v]=_?p+"px":"",e.transform="",e))}var MC={passive:!0};var LC={left:"right",right:"left",bottom:"top",top:"bottom"};function RC(t){return t.replace(/left|right|bottom|top/g,(function(t){return LC[t]}))}var OC={start:"end",end:"start"};function FC(t){return t.replace(/start|end/g,(function(t){return OC[t]}))}function AC(t){var e=rC(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function zC(t){return gC(wC(t)).left+AC(t).scrollLeft}function BC(t){var e=yC(t),n=e.overflow,i=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function jC(t){return["html","body","#document"].indexOf(iC(t))>=0?t.ownerDocument.body:sC(t)&&BC(t)?t:jC(xC(t))}function GC(t,e){var n;void 0===e&&(e=[]);var i=jC(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),o=rC(i),s=r?[o].concat(o.visualViewport||[],BC(i)?i:[]):i,a=e.concat(s);return r?a:a.concat(GC(xC(s)))}function NC(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function VC(t,e,n){return e===Kb?NC(function(t,e){var n=rC(t),i=wC(t),r=n.visualViewport,o=i.clientWidth,s=i.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;var u=fC();(u||!u&&"fixed"===e)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:o,height:s,x:a+zC(t),y:l}}(t,n)):oC(e)?function(t,e){var n=gC(t,!1,"fixed"===e);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}(e,n):NC(function(t){var e,n=wC(t),i=AC(t),r=null==(e=t.ownerDocument)?void 0:e.body,o=hC(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),s=hC(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+zC(t),l=-i.scrollTop;return"rtl"===yC(r||n).direction&&(a+=hC(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(wC(t)))}function HC(t,e,n,i){var r="clippingParents"===e?function(t){var e=GC(xC(t)),n=["absolute","fixed"].indexOf(yC(t).position)>=0&&sC(t)?CC(t):t;return oC(n)?e.filter((function(t){return oC(t)&&_C(t,n)&&"body"!==iC(t)})):[]}(t):[].concat(e),o=[].concat(r,[n]),s=o[0],a=o.reduce((function(e,n){var r=VC(t,n,i);return e.top=hC(r.top,e.top),e.right=cC(r.right,e.right),e.bottom=cC(r.bottom,e.bottom),e.left=hC(r.left,e.left),e}),VC(t,s,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function WC(t){var e,n=t.reference,i=t.element,r=t.placement,o=r?uC(r):null,s=r?TC(r):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(o){case Vb:e={x:a,y:n.y-i.height};break;case Hb:e={x:a,y:n.y+n.height};break;case Wb:e={x:n.x+n.width,y:l};break;case Xb:e={x:n.x-i.width,y:l};break;default:e={x:n.x,y:n.y}}var u=o?SC(o):null;if(null!=u){var h="y"===u?"height":"width";switch(s){case Yb:e[u]=e[u]-(n[h]/2-i[h]/2);break;case qb:e[u]=e[u]+(n[h]/2-i[h]/2)}}return e}function XC(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=void 0===i?t.placement:i,o=n.strategy,s=void 0===o?t.strategy:o,a=n.boundary,l=void 0===a?Zb:a,u=n.rootBoundary,h=void 0===u?Kb:u,c=n.elementContext,d=void 0===c?Jb:c,p=n.altBoundary,f=void 0!==p&&p,g=n.padding,m=void 0===g?0:g,_=IC("number"!=typeof m?m:PC(m,$b)),y=d===Jb?Qb:Jb,v=t.rects.popper,w=t.elements[f?y:d],x=HC(oC(w)?w:w.contextElement||wC(t.elements.popper),l,h,s),b=gC(t.elements.reference),C=WC({reference:b,element:v,strategy:"absolute",placement:r}),S=NC(Object.assign({},v,C)),E=d===Jb?S:b,I={top:x.top-E.top+_.top,bottom:E.bottom-x.bottom+_.bottom,left:x.left-E.left+_.left,right:E.right-x.right+_.right},P=t.modifiersData.offset;if(d===Jb&&P){var T=P[r];Object.keys(I).forEach((function(t){var e=[Wb,Hb].indexOf(t)>=0?1:-1,n=[Vb,Hb].indexOf(t)>=0?"y":"x";I[t]+=T[n]*e}))}return I}function UC(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function $C(t){return[Vb,Wb,Hb,Xb].some((function(e){return t[e]>=0}))}function YC(t,e,n){void 0===n&&(n=!1);var i,r,o=sC(e),s=sC(e)&&function(t){var e=t.getBoundingClientRect(),n=dC(e.width)/t.offsetWidth||1,i=dC(e.height)/t.offsetHeight||1;return 1!==n||1!==i}(e),a=wC(e),l=gC(t,s,n),u={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(o||!o&&!n)&&(("body"!==iC(e)||BC(a))&&(u=(i=e)!==rC(i)&&sC(i)?{scrollLeft:(r=i).scrollLeft,scrollTop:r.scrollTop}:AC(i)),sC(e)?((h=gC(e,!0)).x+=e.clientLeft,h.y+=e.clientTop):a&&(h.x=zC(a))),{x:l.left+u.scrollLeft-h.x,y:l.top+u.scrollTop-h.y,width:l.width,height:l.height}}function qC(t){var e=new Map,n=new Set,i=[];function r(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var i=e.get(t);i&&r(i)}})),i.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||r(t)})),i}var ZC={placement:"bottom",modifiers:[],strategy:"absolute"};function KC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function JC(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,i=void 0===n?[]:n,r=e.defaultOptions,o=void 0===r?ZC:r;return function(t,e,n){void 0===n&&(n=o);var r,s,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},ZC,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},l=[],u=!1,h={state:a,setOptions:function(n){var r="function"==typeof n?n(a.options):n;c(),a.options=Object.assign({},o,a.options,r),a.scrollParents={reference:oC(t)?GC(t):t.contextElement?GC(t.contextElement):[],popper:GC(e)};var s,u,d=function(t){var e=qC(t);return nC.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}((s=[].concat(i,a.options.modifiers),u=s.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{}),Object.keys(u).map((function(t){return u[t]}))));return a.orderedModifiers=d.filter((function(t){return t.enabled})),a.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,i=void 0===n?{}:n,r=t.effect;if("function"==typeof r){var o=r({state:a,name:e,instance:h,options:i}),s=function(){};l.push(o||s)}})),h.update()},forceUpdate:function(){if(!u){var t=a.elements,e=t.reference,n=t.popper;if(KC(e,n)){a.rects={reference:YC(e,CC(n),"fixed"===a.options.strategy),popper:mC(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(t){return a.modifiersData[t.name]=Object.assign({},t.data)}));for(var i=0;i<a.orderedModifiers.length;i++)if(!0!==a.reset){var r=a.orderedModifiers[i],o=r.fn,s=r.options,l=void 0===s?{}:s,c=r.name;"function"==typeof o&&(a=o({state:a,options:l,name:c,instance:h})||a)}else a.reset=!1,i=-1}}},update:(r=function(){return new Promise((function(t){h.forceUpdate(),t(a)}))},function(){return s||(s=new Promise((function(t){Promise.resolve().then((function(){s=void 0,t(r())}))}))),s}),destroy:function(){c(),u=!0}};if(!KC(t,e))return h;function c(){l.forEach((function(t){return t()})),l=[]}return h.setOptions(n).then((function(t){!u&&n.onFirstUpdate&&n.onFirstUpdate(t)})),h}}var QC=JC({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,i=t.options,r=i.scroll,o=void 0===r||r,s=i.resize,a=void 0===s||s,l=rC(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach((function(t){t.addEventListener("scroll",n.update,MC)})),a&&l.addEventListener("resize",n.update,MC),function(){o&&u.forEach((function(t){t.removeEventListener("scroll",n.update,MC)})),a&&l.removeEventListener("resize",n.update,MC)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=WC({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,i=n.gpuAcceleration,r=void 0===i||i,o=n.adaptive,s=void 0===o||o,a=n.roundOffsets,l=void 0===a||a,u={placement:uC(e.placement),variation:TC(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,DC(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,DC(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},lC,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.offset,o=void 0===r?[0,0]:r,s=eC.reduce((function(t,n){return t[n]=function(t,e,n){var i=uC(t),r=[Xb,Vb].indexOf(i)>=0?-1:1,o="function"==typeof n?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*r,[Xb,Wb].indexOf(i)>=0?{x:a,y:s}:{x:s,y:a}}(n,e.rects,o),t}),{}),a=s[e.placement],l=a.x,u=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[i]=s}},{name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name;if(!e.modifiersData[i]._skip){for(var r=n.mainAxis,o=void 0===r||r,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,u=n.padding,h=n.boundary,c=n.rootBoundary,d=n.altBoundary,p=n.flipVariations,f=void 0===p||p,g=n.allowedAutoPlacements,m=e.options.placement,_=uC(m),y=l||(_===m||!f?[RC(m)]:function(t){if(uC(t)===Ub)return[];var e=RC(t);return[FC(t),e,FC(e)]}(m)),v=[m].concat(y).reduce((function(t,n){return t.concat(uC(n)===Ub?function(t,e){void 0===e&&(e={});var n=e,i=n.placement,r=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,u=void 0===l?eC:l,h=TC(i),c=h?a?tC:tC.filter((function(t){return TC(t)===h})):$b,d=c.filter((function(t){return u.indexOf(t)>=0}));0===d.length&&(d=c);var p=d.reduce((function(e,n){return e[n]=XC(t,{placement:n,boundary:r,rootBoundary:o,padding:s})[uC(n)],e}),{});return Object.keys(p).sort((function(t,e){return p[t]-p[e]}))}(e,{placement:n,boundary:h,rootBoundary:c,padding:u,flipVariations:f,allowedAutoPlacements:g}):n)}),[]),w=e.rects.reference,x=e.rects.popper,b=new Map,C=!0,S=v[0],E=0;E<v.length;E++){var I=v[E],P=uC(I),T=TC(I)===Yb,k=[Vb,Hb].indexOf(P)>=0,D=k?"width":"height",M=XC(e,{placement:I,boundary:h,rootBoundary:c,altBoundary:d,padding:u}),L=k?T?Wb:Xb:T?Hb:Vb;w[D]>x[D]&&(L=RC(L));var R=RC(L),O=[];if(o&&O.push(M[P]<=0),a&&O.push(M[L]<=0,M[R]<=0),O.every((function(t){return t}))){S=I,C=!1;break}b.set(I,O)}if(C)for(var F=function(t){var e=v.find((function(e){var n=b.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return S=e,"break"},A=f?3:1;A>0;A--){if("break"===F(A))break}e.placement!==S&&(e.modifiersData[i]._skip=!0,e.placement=S,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,i=t.name,r=n.mainAxis,o=void 0===r||r,s=n.altAxis,a=void 0!==s&&s,l=n.boundary,u=n.rootBoundary,h=n.altBoundary,c=n.padding,d=n.tether,p=void 0===d||d,f=n.tetherOffset,g=void 0===f?0:f,m=XC(e,{boundary:l,rootBoundary:u,padding:c,altBoundary:h}),_=uC(e.placement),y=TC(e.placement),v=!y,w=SC(_),x="x"===w?"y":"x",b=e.modifiersData.popperOffsets,C=e.rects.reference,S=e.rects.popper,E="function"==typeof g?g(Object.assign({},e.rects,{placement:e.placement})):g,I="number"==typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),P=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,T={x:0,y:0};if(b){if(o){var k,D="y"===w?Vb:Xb,M="y"===w?Hb:Wb,L="y"===w?"height":"width",R=b[w],O=R+m[D],F=R-m[M],A=p?-S[L]/2:0,z=y===Yb?C[L]:S[L],B=y===Yb?-S[L]:-C[L],j=e.elements.arrow,G=p&&j?mC(j):{width:0,height:0},N=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},V=N[D],H=N[M],W=EC(0,C[L],G[L]),X=v?C[L]/2-A-W-V-I.mainAxis:z-W-V-I.mainAxis,U=v?-C[L]/2+A+W+H+I.mainAxis:B+W+H+I.mainAxis,$=e.elements.arrow&&CC(e.elements.arrow),Y=$?"y"===w?$.clientTop||0:$.clientLeft||0:0,q=null!=(k=null==P?void 0:P[w])?k:0,Z=R+U-q,K=EC(p?cC(O,R+X-q-Y):O,R,p?hC(F,Z):F);b[w]=K,T[w]=K-R}if(a){var J,Q="x"===w?Vb:Xb,tt="x"===w?Hb:Wb,et=b[x],nt="y"===x?"height":"width",it=et+m[Q],rt=et-m[tt],ot=-1!==[Vb,Xb].indexOf(_),st=null!=(J=null==P?void 0:P[x])?J:0,at=ot?it:et-C[nt]-S[nt]-st+I.altAxis,lt=ot?et+C[nt]+S[nt]-st-I.altAxis:rt,ut=p&&ot?(ct=EC(at,et,ht=lt))>ht?ht:ct:EC(p?at:it,et,p?lt:rt);b[x]=ut,T[x]=ut-et}var ht,ct;e.modifiersData[i]=T}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,i=t.name,r=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=uC(n.placement),l=SC(a),u=[Xb,Wb].indexOf(a)>=0?"height":"width";if(o&&s){var h=function(t,e){return IC("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:PC(t,$b))}(r.padding,n),c=mC(o),d="y"===l?Vb:Xb,p="y"===l?Hb:Wb,f=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],g=s[l]-n.rects.reference[l],m=CC(o),_=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,y=f/2-g/2,v=h[d],w=_-c[u]-h[p],x=_/2-c[u]/2+y,b=EC(v,x,w),C=l;n.modifiersData[i]=((e={})[C]=b,e.centerOffset=b-x,e)}},effect:function(t){var e=t.state,n=t.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=e.elements.popper.querySelector(i)))&&_C(e.elements.popper,i)&&(e.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,i=e.rects.reference,r=e.rects.popper,o=e.modifiersData.preventOverflow,s=XC(e,{elementContext:"reference"}),a=XC(e,{altBoundary:!0}),l=UC(s,i),u=UC(a,r,o),h=$C(l),c=$C(u);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:h,hasPopperEscaped:c},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":c})}}]});
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
function tS(t){return"[object Object]"===Object.prototype.toString.call(t)}function eS(){return eS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},eS.apply(this,arguments)}function nS(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)e.indexOf(n=o[i])>=0||(r[n]=t[n]);return r}const iS={silent:!1,logLevel:"warn"},rS=["validator"],oS=Object.prototype,sS=oS.toString,aS=oS.hasOwnProperty,lS=/^\s*function (\w+)/;function uS(t){var e;const n=null!==(e=null==t?void 0:t.type)&&void 0!==e?e:t;if(n){const t=n.toString().match(lS);return t?t[1]:""}return""}const hS=function(t){var e,n;return!1!==tS(t)&&(void 0===(e=t.constructor)||!1!==tS(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf"))};let cS=t=>t;const dS=(t,e)=>aS.call(t,e),pS=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},fS=Array.isArray||function(t){return"[object Array]"===sS.call(t)},gS=t=>"[object Function]"===sS.call(t),mS=t=>hS(t)&&dS(t,"_vueTypes_name"),_S=t=>hS(t)&&(dS(t,"type")||["_vueTypes_name","validator","default","required"].some((e=>dS(t,e))));function yS(t,e){return Object.defineProperty(t.bind(e),"__original",{value:t})}function vS(t,e,n=!1){let i,r=!0,o="";i=hS(t)?t:{type:t};const s=mS(i)?i._vueTypes_name+" - ":"";if(_S(i)&&null!==i.type){if(void 0===i.type||!0===i.type)return r;if(!i.required&&void 0===e)return r;fS(i.type)?(r=i.type.some((t=>!0===vS(t,e,!0))),o=i.type.map((t=>uS(t))).join(" or ")):(o=uS(i),r="Array"===o?fS(e):"Object"===o?hS(e):"String"===o||"Number"===o||"Boolean"===o||"Function"===o?function(t){if(null==t)return"";const e=t.constructor.toString().match(lS);return e?e[1]:""}(e)===o:e instanceof i.type)}if(!r){const t=`${s}value "${e}" should be of type "${o}"`;return!1===n?(cS(t),!1):t}if(dS(i,"validator")&&gS(i.validator)){const t=cS,o=[];if(cS=t=>{o.push(t)},r=i.validator(e),cS=t,!r){const t=(o.length>1?"* ":"")+o.join("\n* ");return o.length=0,!1===n?(cS(t),r):t}}return r}function wS(t,e){const n=Object.defineProperties(e,{_vueTypes_name:{value:t,writable:!0},isRequired:{get(){return this.required=!0,this}},def:{value(t){return void 0===t?(dS(this,"default")&&delete this.default,this):gS(t)||!0===vS(this,t,!0)?(this.default=fS(t)?()=>[...t]:hS(t)?()=>Object.assign({},t):t,this):(cS(`${this._vueTypes_name} - invalid default value: "${t}"`),this)}}}),{validator:i}=n;return gS(i)&&(n.validator=yS(i,n)),n}function xS(t,e){const n=wS(t,e);return Object.defineProperty(n,"validate",{value(t){return gS(this.validator)&&cS(`${this._vueTypes_name} - calling .validate() will overwrite the current custom validator function. Validator info:\n${JSON.stringify(this)}`),this.validator=yS(t,this),this}})}function bS(t,e,n){const i=function(t){const e={};return Object.getOwnPropertyNames(t).forEach((n=>{e[n]=Object.getOwnPropertyDescriptor(t,n)})),Object.defineProperties({},e)}(e);if(i._vueTypes_name=t,!hS(n))return i;const{validator:r}=n,o=nS(n,rS);if(gS(r)){let{validator:t}=i;t&&(t=null!==(a=(s=t).__original)&&void 0!==a?a:s),i.validator=yS(t?function(e){return t.call(this,e)&&r.call(this,e)}:r,i)}var s,a;return Object.assign(i,o)}function CS(t){return t.replace(/^(?!\s*$)/gm,"  ")}function SS(t,e="custom validation failed"){if("function"!=typeof t)throw new TypeError("[VueTypes error]: You must provide a function as argument");return wS(t.name||"<<anonymous function>>",{type:null,validator(n){const i=t(n);return i||cS(`${this._vueTypes_name} - ${e}`),i}})}function ES(t){if(!fS(t))throw new TypeError("[VueTypes error]: You must provide an array as argument.");const e=`oneOf - value should be one of "${t.join('", "')}".`,n=t.reduce(((t,e)=>{if(null!=e){const n=e.constructor;-1===t.indexOf(n)&&t.push(n)}return t}),[]);return wS("oneOf",{type:n.length>0?n:void 0,validator(n){const i=-1!==t.indexOf(n);return i||cS(e),i}})}function IS(t){if(!fS(t))throw new TypeError("[VueTypes error]: You must provide an array as argument");let e=!1,n=[];for(let r=0;r<t.length;r+=1){const i=t[r];if(_S(i)){if(mS(i)&&"oneOf"===i._vueTypes_name&&i.type){n=n.concat(i.type);continue}if(gS(i.validator)&&(e=!0),!0===i.type||!i.type){cS('oneOfType - invalid usage of "true" or "null" as types.');continue}n=n.concat(i.type)}else n.push(i)}n=n.filter(((t,e)=>n.indexOf(t)===e));const i=n.length>0?n:null;return wS("oneOfType",e?{type:i,validator(e){const n=[],i=t.some((t=>{const i=vS(mS(t)&&"oneOf"===t._vueTypes_name?t.type||null:t,e,!0);return"string"==typeof i&&n.push(i),!0===i}));return i||cS(`oneOfType - provided value does not match any of the ${n.length} passed-in validators:\n${CS(n.join("\n"))}`),i}}:{type:i})}function PS(t){return wS("arrayOf",{type:Array,validator(e){let n="";const i=e.every((e=>(n=vS(t,e,!0),!0===n)));return i||cS(`arrayOf - value validation error:\n${CS(n)}`),i}})}function TS(t){return wS("instanceOf",{type:t})}function kS(t){return wS("objectOf",{type:Object,validator(e){let n="";const i=Object.keys(e).every((i=>(n=vS(t,e[i],!0),!0===n)));return i||cS(`objectOf - value validation error:\n${CS(n)}`),i}})}function DS(t){const e=Object.keys(t),n=e.filter((e=>{var n;return!(null===(n=t[e])||void 0===n||!n.required)})),i=wS("shape",{type:Object,validator(i){if(!hS(i))return!1;const r=Object.keys(i);if(n.length>0&&n.some((t=>-1===r.indexOf(t)))){const t=n.filter((t=>-1===r.indexOf(t)));return cS(1===t.length?`shape - required property "${t[0]}" is not defined.`:`shape - required properties "${t.join('", "')}" are not defined.`),!1}return r.every((n=>{if(-1===e.indexOf(n))return!0===this._vueTypes_isLoose||(cS(`shape - shape definition does not include a "${n}" property. Allowed keys: "${e.join('", "')}".`),!1);const r=vS(t[n],i[n],!0);return"string"==typeof r&&cS(`shape - "${n}" property validation error:\n ${CS(r)}`),!0===r}))}});return Object.defineProperty(i,"_vueTypes_isLoose",{writable:!0,value:!1}),Object.defineProperty(i,"loose",{get(){return this._vueTypes_isLoose=!0,this}}),i}const MS=["name","validate","getter"],LS=(()=>{var t;return(t=class{static get any(){return xS("any",{})}static get func(){return xS("function",{type:Function}).def(this.defaults.func)}static get bool(){return xS("boolean",{type:Boolean}).def(this.defaults.bool)}static get string(){return xS("string",{type:String}).def(this.defaults.string)}static get number(){return xS("number",{type:Number}).def(this.defaults.number)}static get array(){return xS("array",{type:Array}).def(this.defaults.array)}static get object(){return xS("object",{type:Object}).def(this.defaults.object)}static get integer(){return wS("integer",{type:Number,validator:t=>pS(t)}).def(this.defaults.integer)}static get symbol(){return wS("symbol",{validator:t=>"symbol"==typeof t})}static get nullable(){return{type:null}}static extend(t){if(fS(t))return t.forEach((t=>this.extend(t))),this;const{name:e,validate:n=!1,getter:i=!1}=t,r=nS(t,MS);if(dS(this,e))throw new TypeError(`[VueTypes error]: Type "${e}" already defined`);const{type:o}=r;if(mS(o))return delete r.type,Object.defineProperty(this,e,i?{get:()=>bS(e,o,r)}:{value(...t){const n=bS(e,o,r);return n.validator&&(n.validator=n.validator.bind(n,...t)),n}});let s;return s=i?{get(){const t=Object.assign({},r);return n?xS(e,t):wS(e,t)},enumerable:!0}:{value(...t){const i=Object.assign({},r);let o;return o=n?xS(e,i):wS(e,i),i.validator&&(o.validator=i.validator.bind(o,...t)),o},enumerable:!0},Object.defineProperty(this,e,s)}}).defaults={},t.sensibleDefaults=void 0,t.config=iS,t.custom=SS,t.oneOf=ES,t.instanceOf=TS,t.oneOfType=IS,t.arrayOf=PS,t.objectOf=kS,t.shape=DS,t.utils={validate:(t,e)=>!0===vS(e,t,!0),toType:(t,e,n=!1)=>n?xS(t,e):wS(t,e)},t})();let RS=class extends(function(t={func:()=>{},bool:!0,string:"",number:0,array:()=>[],object:()=>({}),integer:0}){var e;return(e=class extends LS{static get sensibleDefaults(){return eS({},this.defaults)}static set sensibleDefaults(e){this.defaults=!1!==e?eS({},!0!==e?e:t):{}}}).defaults=eS({},t),e}()){};var OS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function FS(t){var e={exports:{}};return t(e,e.exports),e.exports}var AS=function(t){return t&&t.Math==Math&&t},zS=AS("object"==typeof globalThis&&globalThis)||AS("object"==typeof window&&window)||AS("object"==typeof self&&self)||AS("object"==typeof OS&&OS)||function(){return this}()||Function("return this")(),BS=function(t){try{return!!t()}catch(e){return!0}},jS=!BS((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),GS={}.propertyIsEnumerable,NS=Object.getOwnPropertyDescriptor,VS={f:NS&&!GS.call({1:2},1)?function(t){var e=NS(this,t);return!!e&&e.enumerable}:GS},HS=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},WS={}.toString,XS=function(t){return WS.call(t).slice(8,-1)},US="".split,$S=BS((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==XS(t)?US.call(t,""):Object(t)}:Object,YS=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},qS=function(t){return $S(YS(t))},ZS=function(t){return"object"==typeof t?null!==t:"function"==typeof t},KS=function(t,e){if(!ZS(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!ZS(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!ZS(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!ZS(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},JS={}.hasOwnProperty,QS=function(t,e){return JS.call(t,e)},tE=zS.document,eE=ZS(tE)&&ZS(tE.createElement),nE=function(t){return eE?tE.createElement(t):{}},iE=!jS&&!BS((function(){return 7!=Object.defineProperty(nE("div"),"a",{get:function(){return 7}}).a})),rE=Object.getOwnPropertyDescriptor,oE={f:jS?rE:function(t,e){if(t=qS(t),e=KS(e,!0),iE)try{return rE(t,e)}catch(n){}if(QS(t,e))return HS(!VS.f.call(t,e),t[e])}},sE=function(t){if(!ZS(t))throw TypeError(String(t)+" is not an object");return t},aE=Object.defineProperty,lE={f:jS?aE:function(t,e,n){if(sE(t),e=KS(e,!0),sE(n),iE)try{return aE(t,e,n)}catch(i){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},uE=jS?function(t,e,n){return lE.f(t,e,HS(1,n))}:function(t,e,n){return t[e]=n,t},hE=function(t,e){try{uE(zS,t,e)}catch(n){zS[t]=e}return e},cE=zS["__core-js_shared__"]||hE("__core-js_shared__",{}),dE=Function.toString;"function"!=typeof cE.inspectSource&&(cE.inspectSource=function(t){return dE.call(t)});var pE,fE,gE,mE=cE.inspectSource,_E=zS.WeakMap,yE="function"==typeof _E&&/native code/.test(mE(_E)),vE=FS((function(t){(t.exports=function(t,e){return cE[t]||(cE[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.8.3",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),wE=0,xE=Math.random(),bE=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++wE+xE).toString(36)},CE=vE("keys"),SE=function(t){return CE[t]||(CE[t]=bE(t))},EE={},IE=zS.WeakMap;if(yE){var PE=cE.state||(cE.state=new IE),TE=PE.get,kE=PE.has,DE=PE.set;pE=function(t,e){return e.facade=t,DE.call(PE,t,e),e},fE=function(t){return TE.call(PE,t)||{}},gE=function(t){return kE.call(PE,t)}}else{var ME=SE("state");EE[ME]=!0,pE=function(t,e){return e.facade=t,uE(t,ME,e),e},fE=function(t){return QS(t,ME)?t[ME]:{}},gE=function(t){return QS(t,ME)}}var LE={set:pE,get:fE,has:gE,enforce:function(t){return gE(t)?fE(t):pE(t,{})},getterFor:function(t){return function(e){var n;if(!ZS(e)||(n=fE(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}},RE=FS((function(t){var e=LE.get,n=LE.enforce,i=String(String).split("String");(t.exports=function(t,e,r,o){var s,a=!!o&&!!o.unsafe,l=!!o&&!!o.enumerable,u=!!o&&!!o.noTargetGet;"function"==typeof r&&("string"!=typeof e||QS(r,"name")||uE(r,"name",e),(s=n(r)).source||(s.source=i.join("string"==typeof e?e:""))),t!==zS?(a?!u&&t[e]&&(l=!0):delete t[e],l?t[e]=r:uE(t,e,r)):l?t[e]=r:hE(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||mE(this)}))})),OE=zS,FE=function(t){return"function"==typeof t?t:void 0},AE=function(t,e){return arguments.length<2?FE(OE[t])||FE(zS[t]):OE[t]&&OE[t][e]||zS[t]&&zS[t][e]},zE=Math.ceil,BE=Math.floor,jE=function(t){return isNaN(t=+t)?0:(t>0?BE:zE)(t)},GE=Math.min,NE=function(t){return t>0?GE(jE(t),9007199254740991):0},VE=Math.max,HE=Math.min,WE=function(t,e){var n=jE(t);return n<0?VE(n+e,0):HE(n,e)},XE=function(t){return function(e,n,i){var r,o=qS(e),s=NE(o.length),a=WE(i,s);if(t&&n!=n){for(;s>a;)if((r=o[a++])!=r)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},UE={includes:XE(!0),indexOf:XE(!1)},$E=UE.indexOf,YE=function(t,e){var n,i=qS(t),r=0,o=[];for(n in i)!QS(EE,n)&&QS(i,n)&&o.push(n);for(;e.length>r;)QS(i,n=e[r++])&&(~$E(o,n)||o.push(n));return o},qE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ZE=qE.concat("length","prototype"),KE={f:Object.getOwnPropertyNames||function(t){return YE(t,ZE)}},JE={f:Object.getOwnPropertySymbols},QE=AE("Reflect","ownKeys")||function(t){var e=KE.f(sE(t)),n=JE.f;return n?e.concat(n(t)):e},tI=function(t,e){for(var n=QE(e),i=lE.f,r=oE.f,o=0;o<n.length;o++){var s=n[o];QS(t,s)||i(t,s,r(e,s))}},eI=/#|\.prototype\./,nI=function(t,e){var n=rI[iI(t)];return n==sI||n!=oI&&("function"==typeof e?BS(e):!!e)},iI=nI.normalize=function(t){return String(t).replace(eI,".").toLowerCase()},rI=nI.data={},oI=nI.NATIVE="N",sI=nI.POLYFILL="P",aI=nI,lI=oE.f,uI=function(t,e){var n,i,r,o,s,a=t.target,l=t.global,u=t.stat;if(n=l?zS:u?zS[a]||hE(a,{}):(zS[a]||{}).prototype)for(i in e){if(o=e[i],r=t.noTargetGet?(s=lI(n,i))&&s.value:n[i],!aI(l?i:a+(u?".":"#")+i,t.forced)&&void 0!==r){if(typeof o==typeof r)continue;tI(o,r)}(t.sham||r&&r.sham)&&uE(o,"sham",!0),RE(n,i,o,t)}},hI=function(t,e){var n=[][t];return!!n&&BS((function(){n.call(null,e||function(){throw 1},1)}))},cI=Object.defineProperty,dI={},pI=function(t){throw t},fI=function(t,e){if(QS(dI,t))return dI[t];e||(e={});var n=[][t],i=!!QS(e,"ACCESSORS")&&e.ACCESSORS,r=QS(e,0)?e[0]:pI,o=QS(e,1)?e[1]:void 0;return dI[t]=!!n&&!BS((function(){if(i&&!jS)return!0;var t={length:-1};i?cI(t,1,{enumerable:!0,get:pI}):t[1]=1,n.call(t,r,o)}))},gI=UE.indexOf,mI=[].indexOf,_I=!!mI&&1/[1].indexOf(1,-0)<0,yI=hI("indexOf"),vI=fI("indexOf",{ACCESSORS:!0,1:0});function wI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xI(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bI(t,e,n){return e&&xI(t.prototype,e),n&&xI(t,n),t}uI({target:"Array",proto:!0,forced:_I||!yI||!vI},{indexOf:function(t){return _I?mI.apply(this,arguments)||0:gI(this,t,arguments.length>1?arguments[1]:void 0)}}),function(){function t(){wI(this,t)}bI(t,null,[{key:"isInBrowser",value:function(){return"undefined"!=typeof window}},{key:"isServer",value:function(){return"undefined"==typeof window}},{key:"getUA",value:function(){return t.isInBrowser()?window.navigator.userAgent.toLowerCase():""}},{key:"isMobile",value:function(){return/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(navigator.appVersion)}},{key:"isOpera",value:function(){return-1!==navigator.userAgent.indexOf("Opera")}},{key:"isIE",value:function(){var e=t.getUA();return""!==e&&e.indexOf("msie")>0}},{key:"isIE9",value:function(){var e=t.getUA();return""!==e&&e.indexOf("msie 9.0")>0}},{key:"isEdge",value:function(){var e=t.getUA();return""!==e&&e.indexOf("edge/")>0}},{key:"isChrome",value:function(){var e=t.getUA();return""!==e&&/chrome\/\d+/.test(e)&&!t.isEdge()}},{key:"isPhantomJS",value:function(){var e=t.getUA();return""!==e&&/phantomjs/.test(e)}},{key:"isFirefox",value:function(){var e=t.getUA();return""!==e&&/firefox/.test(e)}}])}();var CI=[].join,SI=$S!=Object,EI=hI("join",",");uI({target:"Array",proto:!0,forced:SI||!EI},{join:function(t){return CI.call(qS(this),void 0===t?",":t)}});var II,PI,TI=function(t){return Object(YS(t))},kI=Array.isArray||function(t){return"Array"==XS(t)},DI=!!Object.getOwnPropertySymbols&&!BS((function(){return!String(Symbol())})),MI=DI&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,LI=vE("wks"),RI=zS.Symbol,OI=MI?RI:RI&&RI.withoutSetter||bE,FI=function(t){return QS(LI,t)||(DI&&QS(RI,t)?LI[t]=RI[t]:LI[t]=OI("Symbol."+t)),LI[t]},AI=FI("species"),zI=function(t,e){var n;return kI(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!kI(n.prototype)?ZS(n)&&null===(n=n[AI])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)},BI=function(t,e,n){var i=KS(e);i in t?lE.f(t,i,HS(0,n)):t[i]=n},jI=AE("navigator","userAgent")||"",GI=zS.process,NI=GI&&GI.versions,VI=NI&&NI.v8;VI?PI=(II=VI.split("."))[0]+II[1]:jI&&(!(II=jI.match(/Edge\/(\d+)/))||II[1]>=74)&&(II=jI.match(/Chrome\/(\d+)/))&&(PI=II[1]);var HI=PI&&+PI,WI=FI("species"),XI=function(t){return HI>=51||!BS((function(){var e=[];return(e.constructor={})[WI]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},UI=XI("splice"),$I=fI("splice",{ACCESSORS:!0,0:0,1:2}),YI=Math.max,qI=Math.min;uI({target:"Array",proto:!0,forced:!UI||!$I},{splice:function(t,e){var n,i,r,o,s,a,l=TI(this),u=NE(l.length),h=WE(t,u),c=arguments.length;if(0===c?n=i=0:1===c?(n=0,i=u-h):(n=c-2,i=qI(YI(jE(e),0),u-h)),u+n-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(r=zI(l,i),o=0;o<i;o++)(s=h+o)in l&&BI(r,o,l[s]);if(r.length=i,n<i){for(o=h;o<u-i;o++)a=o+n,(s=o+i)in l?l[a]=l[s]:delete l[a];for(o=u;o>u-i+n;o--)delete l[o-1]}else if(n>i)for(o=u-i;o>h;o--)a=o+n-1,(s=o+i-1)in l?l[a]=l[s]:delete l[a];for(o=0;o<n;o++)l[o+h]=arguments[o+2];return l.length=u-i+n,r}});var ZI={};ZI[FI("toStringTag")]="z";var KI="[object z]"===String(ZI),JI=FI("toStringTag"),QI="Arguments"==XS(function(){return arguments}()),tP=KI?XS:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=Object(t),JI))?n:QI?XS(e):"Object"==(i=XS(e))&&"function"==typeof e.callee?"Arguments":i},eP=KI?{}.toString:function(){return"[object "+tP(this)+"]"};KI||RE(Object.prototype,"toString",eP,{unsafe:!0});var nP=function(){var t=sE(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e};function iP(t,e){return RegExp(t,e)}var rP,oP,sP={UNSUPPORTED_Y:BS((function(){var t=iP("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),BROKEN_CARET:BS((function(){var t=iP("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},aP=RegExp.prototype.exec,lP=String.prototype.replace,uP=aP,hP=(rP=/a/,oP=/b*/g,aP.call(rP,"a"),aP.call(oP,"a"),0!==rP.lastIndex||0!==oP.lastIndex),cP=sP.UNSUPPORTED_Y||sP.BROKEN_CARET,dP=void 0!==/()??/.exec("")[1];(hP||dP||cP)&&(uP=function(t){var e,n,i,r,o=this,s=cP&&o.sticky,a=nP.call(o),l=o.source,u=0,h=t;return s&&(-1===(a=a.replace("y","")).indexOf("g")&&(a+="g"),h=String(t).slice(o.lastIndex),o.lastIndex>0&&(!o.multiline||o.multiline&&"\n"!==t[o.lastIndex-1])&&(l="(?: "+l+")",h=" "+h,u++),n=new RegExp("^(?:"+l+")",a)),dP&&(n=new RegExp("^"+l+"$(?!\\s)",a)),hP&&(e=o.lastIndex),i=aP.call(s?n:o,h),s?i?(i.input=i.input.slice(u),i[0]=i[0].slice(u),i.index=o.lastIndex,o.lastIndex+=i[0].length):o.lastIndex=0:hP&&i&&(o.lastIndex=o.global?i.index+i[0].length:e),dP&&i&&i.length>1&&lP.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i});var pP=uP;uI({target:"RegExp",proto:!0,forced:/./.exec!==pP},{exec:pP});var fP=RegExp.prototype,gP=fP.toString,mP=BS((function(){return"/a/b"!=gP.call({source:"a",flags:"b"})})),_P="toString"!=gP.name;(mP||_P)&&RE(RegExp.prototype,"toString",(function(){var t=sE(this),e=String(t.source),n=t.flags;return"/"+e+"/"+String(void 0===n&&t instanceof RegExp&&!("flags"in fP)?nP.call(t):n)}),{unsafe:!0});var yP=FI("species"),vP=!BS((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),wP="$0"==="a".replace(/./,"$0"),xP=FI("replace"),bP=!!/./[xP]&&""===/./[xP]("a","$0"),CP=!BS((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),SP=function(t,e,n,i){var r=FI(t),o=!BS((function(){var e={};return e[r]=function(){return 7},7!=""[t](e)})),s=o&&!BS((function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[yP]=function(){return n},n.flags="",n[r]=/./[r]),n.exec=function(){return e=!0,null},n[r](""),!e}));if(!o||!s||"replace"===t&&(!vP||!wP||bP)||"split"===t&&!CP){var a=/./[r],l=n(r,""[t],(function(t,e,n,i,r){return e.exec===pP?o&&!r?{done:!0,value:a.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),{REPLACE_KEEPS_$0:wP,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:bP}),u=l[0],h=l[1];RE(String.prototype,t,u),RE(RegExp.prototype,r,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)})}i&&uE(RegExp.prototype[r],"sham",!0)},EP=FI("match"),IP=function(t){var e;return ZS(t)&&(void 0!==(e=t[EP])?!!e:"RegExp"==XS(t))},PP=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},TP=FI("species"),kP=function(t){return function(e,n){var i,r,o=String(YS(e)),s=jE(n),a=o.length;return s<0||s>=a?t?"":void 0:(i=o.charCodeAt(s))<55296||i>56319||s+1===a||(r=o.charCodeAt(s+1))<56320||r>57343?t?o.charAt(s):i:t?o.slice(s,s+2):r-56320+(i-55296<<10)+65536}},DP={codeAt:kP(!1),charAt:kP(!0)},MP=DP.charAt,LP=function(t,e,n){return e+(n?MP(t,e).length:1)},RP=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==XS(t))throw TypeError("RegExp#exec called on incompatible receiver");return pP.call(t,e)},OP=[].push,FP=Math.min,AP=!BS((function(){return!RegExp(4294967295,"y")}));SP("split",2,(function(t,e,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var i=String(YS(this)),r=void 0===n?4294967295:n>>>0;if(0===r)return[];if(void 0===t)return[i];if(!IP(t))return e.call(i,t,r);for(var o,s,a,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,c=new RegExp(t.source,u+"g");(o=pP.call(c,i))&&!((s=c.lastIndex)>h&&(l.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&OP.apply(l,o.slice(1)),a=o[0].length,h=s,l.length>=r));)c.lastIndex===o.index&&c.lastIndex++;return h===i.length?!a&&c.test("")||l.push(""):l.push(i.slice(h)),l.length>r?l.slice(0,r):l}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var r=YS(this),o=null==e?void 0:e[t];return void 0!==o?o.call(e,r,n):i.call(String(r),e,n)},function(t,r){var o=n(i,t,this,r,i!==e);if(o.done)return o.value;var s,a,l,u=sE(t),h=String(this),c=(s=RegExp,void 0===(l=sE(u).constructor)||null==(a=sE(l)[TP])?s:PP(a)),d=u.unicode,p=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(AP?"y":"g"),f=new c(AP?u:"^(?:"+u.source+")",p),g=void 0===r?4294967295:r>>>0;if(0===g)return[];if(0===h.length)return null===RP(f,h)?[h]:[];for(var m=0,_=0,y=[];_<h.length;){f.lastIndex=AP?_:0;var v,w=RP(f,AP?h:h.slice(_));if(null===w||(v=FP(NE(f.lastIndex+(AP?0:_)),h.length))===m)_=LP(h,_,d);else{if(y.push(h.slice(m,_)),y.length===g)return y;for(var x=1;x<=w.length-1;x++)if(y.push(w[x]),y.length===g)return y;_=m=v}}return y.push(h.slice(m)),y}]}),!AP);var zP,BP="\t\n\v\f\r                　\u2028\u2029\ufeff",jP="["+BP+"]",GP=RegExp("^"+jP+jP+"*"),NP=RegExp(jP+jP+"*$"),VP=function(t){return function(e){var n=String(YS(e));return 1&t&&(n=n.replace(GP,"")),2&t&&(n=n.replace(NP,"")),n}},HP={start:VP(1),end:VP(2),trim:VP(3)}.trim;uI({target:"String",proto:!0,forced:(zP="trim",BS((function(){return!!BP[zP]()||"​᠎"!="​᠎"[zP]()||BP[zP].name!==zP})))},{trim:function(){return HP(this)}});var WP=XI("slice"),XP=fI("slice",{ACCESSORS:!0,0:0,1:2}),UP=FI("species"),$P=[].slice,YP=Math.max;uI({target:"Array",proto:!0,forced:!WP||!XP},{slice:function(t,e){var n,i,r,o=qS(this),s=NE(o.length),a=WE(t,s),l=WE(void 0===e?s:e,s);if(kI(o)&&("function"!=typeof(n=o.constructor)||n!==Array&&!kI(n.prototype)?ZS(n)&&null===(n=n[UP])&&(n=void 0):n=void 0,n===Array||void 0===n))return $P.call(o,a,l);for(i=new(void 0===n?Array:n)(YP(l-a,0)),r=0;a<l;a++,r++)a in o&&BI(i,r,o[a]);return i.length=r,i}});var qP=Object.keys||function(t){return YE(t,qE)},ZP=BS((function(){qP(1)}));uI({target:"Object",stat:!0,forced:ZP},{keys:function(t){return qP(TI(t))}});var KP,JP=FI("match"),QP=oE.f,tT="".startsWith,eT=Math.min,nT=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[JP]=!1,"/./"[t](e)}catch(i){}}return!1}("startsWith"),iT=!(nT||(KP=QP(String.prototype,"startsWith"),!KP||KP.writable));function rT(t){return(rT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}uI({target:"String",proto:!0,forced:!iT&&!nT},{startsWith:function(t){var e=String(YS(this));!function(t){if(IP(t))throw TypeError("The method doesn't accept regular expressions")}(t);var n=NE(eT(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return tT?tT.call(e,i,n):e.slice(n,n+i.length)===i}});var oT=function(t){return"string"==typeof t},sT=function(t){return null!==t&&"object"===rT(t)},aT=function(){function t(){wI(this,t)}return bI(t,null,[{key:"isWindow",value:function(t){return t===window}},{key:"addEventListener",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t&&e&&n&&t.addEventListener(e,n,i)}},{key:"removeEventListener",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t&&e&&n&&t.removeEventListener(e,n,i)}},{key:"triggerDragEvent",value:function(e,n){var i=!1,r=function(t){var e;null===(e=n.drag)||void 0===e||e.call(n,t)},o=function e(o){var s;t.removeEventListener(document,"mousemove",r),t.removeEventListener(document,"mouseup",e),document.onselectstart=null,document.ondragstart=null,i=!1,null===(s=n.end)||void 0===s||s.call(n,o)};t.addEventListener(e,"mousedown",(function(e){var s;i||(document.onselectstart=function(){return!1},document.ondragstart=function(){return!1},t.addEventListener(document,"mousemove",r),t.addEventListener(document,"mouseup",o),i=!0,null===(s=n.start)||void 0===s||s.call(n,e))}))}},{key:"getBoundingClientRect",value:function(t){return t&&sT(t)&&1===t.nodeType?t.getBoundingClientRect():null}},{key:"hasClass",value:function(t,e){return!!(t&&sT(t)&&oT(e)&&1===t.nodeType)&&t.classList.contains(e.trim())}},{key:"addClass",value:function(e,n){if(e&&sT(e)&&oT(n)&&1===e.nodeType&&(n=n.trim(),!t.hasClass(e,n))){var i=e.className;e.className=i?i+" "+n:n}}},{key:"removeClass",value:function(t,e){if(t&&sT(t)&&oT(e)&&1===t.nodeType&&"string"==typeof t.className){e=e.trim();for(var n=t.className.trim().split(" "),i=n.length-1;i>=0;i--)n[i]=n[i].trim(),n[i]&&n[i]!==e||n.splice(i,1);t.className=n.join(" ")}}},{key:"toggleClass",value:function(t,e,n){t&&sT(t)&&oT(e)&&1===t.nodeType&&t.classList.toggle(e,n)}},{key:"replaceClass",value:function(e,n,i){e&&sT(e)&&oT(n)&&oT(i)&&1===e.nodeType&&(n=n.trim(),i=i.trim(),t.removeClass(e,n),t.addClass(e,i))}},{key:"getScrollTop",value:function(t){var e="scrollTop"in t?t.scrollTop:t.pageYOffset;return Math.max(e,0)}},{key:"setScrollTop",value:function(t,e){"scrollTop"in t?t.scrollTop=e:t.scrollTo(t.scrollX,e)}},{key:"getRootScrollTop",value:function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},{key:"setRootScrollTop",value:function(e){t.setScrollTop(window,e),t.setScrollTop(document.body,e)}},{key:"getElementTop",value:function(e,n){if(t.isWindow(e))return 0;var i=n?t.getScrollTop(n):t.getRootScrollTop();return e.getBoundingClientRect().top+i}},{key:"getVisibleHeight",value:function(e){return t.isWindow(e)?e.innerHeight:e.getBoundingClientRect().height}},{key:"isHidden",value:function(t){if(!t)return!1;var e=window.getComputedStyle(t),n="none"===e.display,i=null===t.offsetParent&&"fixed"!==e.position;return n||i}},{key:"triggerEvent",value:function(t,e){if("createEvent"in document){var n=document.createEvent("HTMLEvents");n.initEvent(e,!1,!0),t.dispatchEvent(n)}}},{key:"calcAngle",value:function(t,e){var n=t.getBoundingClientRect(),i=n.left+n.width/2,r=n.top+n.height/2,o=Math.abs(i-e.clientX),s=Math.abs(r-e.clientY),a=s/Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),l=Math.acos(a),u=Math.floor(180/(Math.PI/l));return e.clientX>i&&e.clientY>r&&(u=180-u),e.clientX==i&&e.clientY>r&&(u=180),e.clientX>i&&e.clientY==r&&(u=90),e.clientX<i&&e.clientY>r&&(u=180+u),e.clientX<i&&e.clientY==r&&(u=270),e.clientX<i&&e.clientY<r&&(u=360-u),u}},{key:"querySelector",value:function(t,e){return e?e.querySelector(t):document.querySelector(t)}},{key:"createElement",value:function(t){for(var e=document.createElement(t),n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0;o<i.length;o++)i[o]&&e.classList.add(i[o]);return e}},{key:"appendChild",value:function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++)t.appendChild(e+1<1||arguments.length<=e+1?void 0:arguments[e+1])}},{key:"getWindow",value:function(t){if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}},{key:"isElement",value:function(t){return t instanceof this.getWindow(t).Element||t instanceof Element}},{key:"isHTMLElement",value:function(t){return t instanceof this.getWindow(t).HTMLElement||t instanceof HTMLElement}},{key:"isShadowRoot",value:function(t){return"undefined"!=typeof ShadowRoot&&(t instanceof this.getWindow(t).ShadowRoot||t instanceof ShadowRoot)}},{key:"getWindowScroll",value:function(t){var e=this.getWindow(t);return{scrollLeft:e.pageXOffset||0,scrollTop:e.pageYOffset||0}}}]),t}(),lT=Math.floor,uT="".replace,hT=/\$([$&'`]|\d\d?|<[^>]*>)/g,cT=/\$([$&'`]|\d\d?)/g,dT=function(t,e,n,i,r,o){var s=n+t.length,a=i.length,l=cT;return void 0!==r&&(r=TI(r),l=hT),uT.call(o,l,(function(o,l){var u;switch(l.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(s);case"<":u=r[l.slice(1,-1)];break;default:var h=+l;if(0===h)return o;if(h>a){var c=lT(h/10);return 0===c?o:c<=a?void 0===i[c-1]?l.charAt(1):i[c-1]+l.charAt(1):o}u=i[h-1]}return void 0===u?"":u}))},pT=Math.max,fT=Math.min;SP("replace",2,(function(t,e,n,i){var r=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,o=i.REPLACE_KEEPS_$0,s=r?"$":"$0";return[function(n,i){var r=YS(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,r,i):e.call(String(r),n,i)},function(t,i){if(!r&&o||"string"==typeof i&&-1===i.indexOf(s)){var a=n(e,t,this,i);if(a.done)return a.value}var l=sE(t),u=String(this),h="function"==typeof i;h||(i=String(i));var c=l.global;if(c){var d=l.unicode;l.lastIndex=0}for(var p=[];;){var f=RP(l,u);if(null===f)break;if(p.push(f),!c)break;""===String(f[0])&&(l.lastIndex=LP(u,NE(l.lastIndex),d))}for(var g,m="",_=0,y=0;y<p.length;y++){f=p[y];for(var v=String(f[0]),w=pT(fT(jE(f.index),u.length),0),x=[],b=1;b<f.length;b++)x.push(void 0===(g=f[b])?g:String(g));var C=f.groups;if(h){var S=[v].concat(x,w,u);void 0!==C&&S.push(C);var E=String(i.apply(void 0,S))}else E=dT(v,u,w,x,C,i);w>=_&&(m+=u.slice(_,w)+E,_=w+v.length)}return m+u.slice(_)}]})),function(){function t(){wI(this,t)}bI(t,null,[{key:"camelize",value:function(t){return t.replace(/-(\w)/g,(function(t,e){return e?e.toUpperCase():""}))}},{key:"capitalize",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}}])}(),function(){function t(){wI(this,t)}bI(t,null,[{key:"_clone",value:function(){}}])}();var gT=FI("isConcatSpreadable"),mT=HI>=51||!BS((function(){var t=[];return t[gT]=!1,t.concat()[0]!==t})),_T=XI("concat"),yT=function(t){if(!ZS(t))return!1;var e=t[gT];return void 0!==e?!!e:kI(t)};uI({target:"Array",proto:!0,forced:!mT||!_T},{concat:function(t){var e,n,i,r,o,s=TI(this),a=zI(s,0),l=0;for(e=-1,i=arguments.length;e<i;e++)if(yT(o=-1===e?s:arguments[e])){if(l+(r=NE(o.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(n=0;n<r;n++,l++)n in o&&BI(a,l,o[n])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");BI(a,l++,o)}return a.length=l,a}});var vT,wT=function(t,e,n){if(PP(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}},xT=[].push,bT=function(t){var e=1==t,n=2==t,i=3==t,r=4==t,o=6==t,s=7==t,a=5==t||o;return function(l,u,h,c){for(var d,p,f=TI(l),g=$S(f),m=wT(u,h,3),_=NE(g.length),y=0,v=c||zI,w=e?v(l,_):n||s?v(l,0):void 0;_>y;y++)if((a||y in g)&&(p=m(d=g[y],y,f),t))if(e)w[y]=p;else if(p)switch(t){case 3:return!0;case 5:return d;case 6:return y;case 2:xT.call(w,d)}else switch(t){case 4:return!1;case 7:xT.call(w,d)}return o?-1:i||r?r:w}},CT={forEach:bT(0),map:bT(1),filter:bT(2),some:bT(3),every:bT(4),find:bT(5),findIndex:bT(6),filterOut:bT(7)},ST=jS?Object.defineProperties:function(t,e){sE(t);for(var n,i=qP(e),r=i.length,o=0;r>o;)lE.f(t,n=i[o++],e[n]);return t},ET=AE("document","documentElement"),IT=SE("IE_PROTO"),PT=function(){},TT=function(t){return"<script>"+t+"<\/script>"},kT=function(){try{vT=document.domain&&new ActiveXObject("htmlfile")}catch(i){}var t,e;kT=vT?function(t){t.write(TT("")),t.close();var e=t.parentWindow.Object;return t=null,e}(vT):((e=nE("iframe")).style.display="none",ET.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(TT("document.F=Object")),t.close(),t.F);for(var n=qE.length;n--;)delete kT.prototype[qE[n]];return kT()};EE[IT]=!0;var DT=Object.create||function(t,e){var n;return null!==t?(PT.prototype=sE(t),n=new PT,PT.prototype=null,n[IT]=t):n=kT(),void 0===e?n:ST(n,e)},MT=FI("unscopables"),LT=Array.prototype;null==LT[MT]&&lE.f(LT,MT,{configurable:!0,value:DT(null)});var RT=function(t){LT[MT][t]=!0},OT=CT.find,FT=!0,AT=fI("find");"find"in[]&&Array(1).find((function(){FT=!1})),uI({target:"Array",proto:!0,forced:FT||!AT},{find:function(t){return OT(this,t,arguments.length>1?arguments[1]:void 0)}}),RT("find");var zT=CT.findIndex,BT=!0,jT=fI("findIndex");"findIndex"in[]&&Array(1).findIndex((function(){BT=!1})),uI({target:"Array",proto:!0,forced:BT||!jT},{findIndex:function(t){return zT(this,t,arguments.length>1?arguments[1]:void 0)}}),RT("findIndex");var GT=function(t,e,n,i,r,o,s,a){for(var l,u=r,h=0,c=!!s&&wT(s,a,3);h<i;){if(h in n){if(l=c?c(n[h],h,e):n[h],o>0&&kI(l))u=GT(t,e,l,NE(l.length),u,o-1)-1;else{if(u>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[u]=l}u++}h++}return u},NT=GT;uI({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=TI(this),n=NE(e.length),i=zI(e,0);return i.length=NT(i,e,e,n,0,void 0===t?1:jE(t)),i}});var VT=function(t){var e=t.return;if(void 0!==e)return sE(e.call(t)).value},HT=function(t,e,n,i){try{return i?e(sE(n)[0],n[1]):e(n)}catch(r){throw VT(t),r}},WT={},XT=FI("iterator"),UT=Array.prototype,$T=function(t){return void 0!==t&&(WT.Array===t||UT[XT]===t)},YT=FI("iterator"),qT=function(t){if(null!=t)return t[YT]||t["@@iterator"]||WT[tP(t)]},ZT=FI("iterator"),KT=!1;try{var JT=0,QT={next:function(){return{done:!!JT++}},return:function(){KT=!0}};QT[ZT]=function(){return this},Array.from(QT,(function(){throw 2}))}catch(zP){}var tk=function(t,e){if(!e&&!KT)return!1;var n=!1;try{var i={};i[ZT]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(r){}return n},ek=!tk((function(t){Array.from(t)}));uI({target:"Array",stat:!0,forced:ek},{from:function(t){var e,n,i,r,o,s,a=TI(t),l="function"==typeof this?this:Array,u=arguments.length,h=u>1?arguments[1]:void 0,c=void 0!==h,d=qT(a),p=0;if(c&&(h=wT(h,u>2?arguments[2]:void 0,2)),null==d||l==Array&&$T(d))for(n=new l(e=NE(a.length));e>p;p++)s=c?h(a[p],p):a[p],BI(n,p,s);else for(o=(r=d.call(a)).next,n=new l;!(i=o.call(r)).done;p++)s=c?HT(r,h,[i.value,p],!0):i.value,BI(n,p,s);return n.length=p,n}});var nk=function(t){return function(e,n,i,r){PP(n);var o=TI(e),s=$S(o),a=NE(o.length),l=t?a-1:0,u=t?-1:1;if(i<2)for(;;){if(l in s){r=s[l],l+=u;break}if(l+=u,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=u)l in s&&(r=n(r,s[l],l,o));return r}},ik={left:nk(!1),right:nk(!0)},rk="process"==XS(zS.process),ok=ik.left,sk=hI("reduce"),ak=fI("reduce",{1:0});uI({target:"Array",proto:!0,forced:!sk||!ak||!rk&&HI>79&&HI<83},{reduce:function(t){return ok(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}}),RT("flat");var lk,uk,hk,ck=!BS((function(){return Object.isExtensible(Object.preventExtensions({}))})),dk=FS((function(t){var e=lE.f,n=bE("meta"),i=0,r=Object.isExtensible||function(){return!0},o=function(t){e(t,n,{value:{objectID:"O"+ ++i,weakData:{}}})},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!ZS(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!QS(t,n)){if(!r(t))return"F";if(!e)return"E";o(t)}return t[n].objectID},getWeakData:function(t,e){if(!QS(t,n)){if(!r(t))return!0;if(!e)return!1;o(t)}return t[n].weakData},onFreeze:function(t){return ck&&s.REQUIRED&&r(t)&&!QS(t,n)&&o(t),t}};EE[n]=!0})),pk=function(t,e){this.stopped=t,this.result=e},fk=function(t,e,n){var i,r,o,s,a,l,u,h=n&&n.that,c=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),f=wT(e,h,1+c+p),g=function(t){return i&&VT(i),new pk(!0,t)},m=function(t){return c?(sE(t),p?f(t[0],t[1],g):f(t[0],t[1])):p?f(t,g):f(t)};if(d)i=t;else{if("function"!=typeof(r=qT(t)))throw TypeError("Target is not iterable");if($T(r)){for(o=0,s=NE(t.length);s>o;o++)if((a=m(t[o]))&&a instanceof pk)return a;return new pk(!1)}i=r.call(t)}for(l=i.next;!(u=l.call(i)).done;){try{a=m(u.value)}catch(_){throw VT(i),_}if("object"==typeof a&&a&&a instanceof pk)return a}return new pk(!1)},gk=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t},mk=lE.f,_k=FI("toStringTag"),yk=function(t,e,n){t&&!QS(t=n?t:t.prototype,_k)&&mk(t,_k,{configurable:!0,value:e})},vk=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),e=n instanceof Array}catch(i){}return function(n,i){return sE(n),function(t){if(!ZS(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(i),e?t.call(n,i):n.__proto__=i,n}}():void 0),wk=function(t,e,n){for(var i in e)RE(t,i,e[i],n);return t},xk=!BS((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),bk=SE("IE_PROTO"),Ck=Object.prototype,Sk=xk?Object.getPrototypeOf:function(t){return t=TI(t),QS(t,bk)?t[bk]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ck:null},Ek=FI("iterator"),Ik=!1;[].keys&&("next"in(hk=[].keys())?(uk=Sk(Sk(hk)))!==Object.prototype&&(lk=uk):Ik=!0),(null==lk||BS((function(){var t={};return lk[Ek].call(t)!==t})))&&(lk={}),QS(lk,Ek)||uE(lk,Ek,(function(){return this}));var Pk={IteratorPrototype:lk,BUGGY_SAFARI_ITERATORS:Ik},Tk=Pk.IteratorPrototype,kk=function(){return this},Dk=Pk.IteratorPrototype,Mk=Pk.BUGGY_SAFARI_ITERATORS,Lk=FI("iterator"),Rk=function(){return this},Ok=function(t,e,n,i,r,o,s){var a,l,u;l=i,u=e+" Iterator",(a=n).prototype=DT(Tk,{next:HS(1,l)}),yk(a,u,!1),WT[u]=kk;var h,c,d,p=function(t){if(t===r&&y)return y;if(!Mk&&t in m)return m[t];switch(t){case"keys":case"values":case"entries":return function(){return new n(this,t)}}return function(){return new n(this)}},f=e+" Iterator",g=!1,m=t.prototype,_=m[Lk]||m["@@iterator"]||r&&m[r],y=!Mk&&_||p(r),v="Array"==e&&m.entries||_;if(v&&(h=Sk(v.call(new t)),Dk!==Object.prototype&&h.next&&(Sk(h)!==Dk&&(vk?vk(h,Dk):"function"!=typeof h[Lk]&&uE(h,Lk,Rk)),yk(h,f,!0))),"values"==r&&_&&"values"!==_.name&&(g=!0,y=function(){return _.call(this)}),m[Lk]!==y&&uE(m,Lk,y),WT[e]=y,r)if(c={values:p("values"),keys:o?y:p("keys"),entries:p("entries")},s)for(d in c)(Mk||g||!(d in m))&&RE(m,d,c[d]);else uI({target:e,proto:!0,forced:Mk||g},c);return c},Fk=FI("species"),Ak=lE.f,zk=dk.fastKey,Bk=LE.set,jk=LE.getterFor;!function(t,e,n){var i=-1!==t.indexOf("Map"),r=-1!==t.indexOf("Weak"),o=i?"set":"add",s=zS[t],a=s&&s.prototype,l=s,u={},h=function(t){var e=a[t];RE(a,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(r&&!ZS(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return r&&!ZS(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(r&&!ZS(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(aI(t,"function"!=typeof s||!(r||a.forEach&&!BS((function(){(new s).entries().next()})))))l=n.getConstructor(e,t,i,o),dk.REQUIRED=!0;else if(aI(t,!0)){var c=new l,d=c[o](r?{}:-0,1)!=c,p=BS((function(){c.has(1)})),f=tk((function(t){new s(t)})),g=!r&&BS((function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)}));f||((l=e((function(e,n){gk(e,l,t);var r,a,u,h,c,d=(r=new s,a=e,u=l,vk&&"function"==typeof(h=a.constructor)&&h!==u&&ZS(c=h.prototype)&&c!==u.prototype&&vk(r,c),r);return null!=n&&fk(n,d[o],{that:d,AS_ENTRIES:i}),d}))).prototype=a,a.constructor=l),(p||g)&&(h("delete"),h("has"),i&&h("get")),(g||d)&&h(o),r&&a.clear&&delete a.clear}u[t]=l,uI({global:!0,forced:l!=s},u),yk(l,t),r||n.setStrong(l,t,i)}("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,n,i){var r=t((function(t,o){gk(t,r,e),Bk(t,{type:e,index:DT(null),first:void 0,last:void 0,size:0}),jS||(t.size=0),null!=o&&fk(o,t[i],{that:t,AS_ENTRIES:n})})),o=jk(e),s=function(t,e,n){var i,r,s=o(t),l=a(t,e);return l?l.value=n:(s.last=l={index:r=zk(e,!0),key:e,value:n,previous:i=s.last,next:void 0,removed:!1},s.first||(s.first=l),i&&(i.next=l),jS?s.size++:t.size++,"F"!==r&&(s.index[r]=l)),t},a=function(t,e){var n,i=o(t),r=zk(e);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==e)return n};return wk(r.prototype,{clear:function(){for(var t=o(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,jS?t.size=0:this.size=0},delete:function(t){var e=this,n=o(e),i=a(e,t);if(i){var r=i.next,s=i.previous;delete n.index[i.index],i.removed=!0,s&&(s.next=r),r&&(r.previous=s),n.first==i&&(n.first=r),n.last==i&&(n.last=s),jS?n.size--:e.size--}return!!i},forEach:function(t){for(var e,n=o(this),i=wT(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:n.first;)for(i(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),wk(r.prototype,n?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return s(this,0===t?0:t,e)}}:{add:function(t){return s(this,t=0===t?0:t,t)}}),jS&&Ak(r.prototype,"size",{get:function(){return o(this).size}}),r},setStrong:function(t,e,n){var i,r,o=e+" Iterator",s=jk(e),a=jk(o);Ok(t,e,(function(t,e){Bk(this,{type:o,target:t,state:s(t),kind:e,last:void 0})}),(function(){for(var t=a(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),i=AE(e),r=lE.f,jS&&i&&!i[Fk]&&r(i,Fk,{configurable:!0,get:function(){return this}})}});var Gk=DP.charAt,Nk=LE.set,Vk=LE.getterFor("String Iterator");Ok(String,"String",(function(t){Nk(this,{type:"String Iterator",string:String(t),index:0})}),(function(){var t,e=Vk(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=Gk(n,i),e.index+=t.length,{value:t,done:!1})}));var Hk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Wk=LE.set,Xk=LE.getterFor("Array Iterator"),Uk=Ok(Array,"Array",(function(t,e){Wk(this,{type:"Array Iterator",target:qS(t),index:0,kind:e})}),(function(){var t=Xk(this),e=t.target,n=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values");WT.Arguments=WT.Array,RT("keys"),RT("values"),RT("entries");var $k=FI("iterator"),Yk=FI("toStringTag"),qk=Uk.values;for(var Zk in Hk){var Kk=zS[Zk],Jk=Kk&&Kk.prototype;if(Jk){if(Jk[$k]!==qk)try{uE(Jk,$k,qk)}catch(zP){Jk[$k]=qk}if(Jk[Yk]||uE(Jk,Yk,Zk),Hk[Zk])for(var Qk in Uk)if(Jk[Qk]!==Uk[Qk])try{uE(Jk,Qk,Uk[Qk])}catch(zP){Jk[Qk]=Uk[Qk]}}}!function(){function t(){wI(this,t)}bI(t,null,[{key:"deduplicate",value:function(t){return Array.from(new Set(t))}},{key:"flat",value:function(e){return e.reduce((function(e,n){var i=Array.isArray(n)?t.flat(n):n;return e.concat(i)}),[])}},{key:"find",value:function(t,e){return t.find(e)}},{key:"findIndex",value:function(t,e){return t.findIndex(e)}}])}(),function(){function t(){wI(this,t)}bI(t,null,[{key:"today",value:function(){return new Date}}])}(),function(){function t(){wI(this,t)}bI(t,null,[{key:"range",value:function(t,e,n){return Math.min(Math.max(t,e),n)}},{key:"clamp",value:function(t,e,n){return e<n?t<e?e:t>n?n:t:t<n?n:t>e?e:t}}])}();var tD=Object.defineProperty,eD=(t,e,n)=>(((t,e,n)=>{e in t?tD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const nD=t=>Math.round(100*t)/100;class iD{constructor(t){eD(this,"instance"),eD(this,"alphaValue",0),eD(this,"redValue",0),eD(this,"greenValue",0),eD(this,"blueValue",0),eD(this,"hueValue",0),eD(this,"saturationValue",0),eD(this,"brightnessValue",0),eD(this,"hslSaturationValue",0),eD(this,"lightnessValue",0),eD(this,"initAlpha",(()=>{const t=this.instance.getAlpha();this.alphaValue=100*Math.min(1,t)})),eD(this,"initLightness",(()=>{const{s:t,l:e}=this.instance.toHsl();this.hslSaturationValue=nD(t),this.lightnessValue=nD(e)})),eD(this,"initRgb",(()=>{const{r:t,g:e,b:n}=this.instance.toRgb();this.redValue=nD(t),this.greenValue=nD(e),this.blueValue=nD(n)})),eD(this,"initHsb",(()=>{const{h:t,s:e,v:n}=this.instance.toHsv();this.hueValue=Math.min(360,Math.ceil(t)),this.saturationValue=nD(e),this.brightnessValue=nD(n)})),eD(this,"toHexString",(()=>this.instance.toHexString())),eD(this,"toRgbString",(()=>this.instance.toRgbString())),this.instance=ab(t),this.initRgb(),this.initHsb(),this.initLightness(),this.initAlpha()}toString(t){return this.instance.toString(t)}get hex(){return this.instance.toHex()}set hex(t){this.instance=ab(t),this.initHsb(),this.initRgb(),this.initAlpha(),this.initLightness()}set hue(t){0===this.saturation&&0===this.brightness&&(this.saturationValue=1,this.brightnessValue=1),this.instance=ab({h:nD(t),s:this.saturation,v:this.brightness,a:this.alphaValue/100}),this.initRgb(),this.initLightness(),this.hueValue=nD(t)}get hue(){return this.hueValue}set saturation(t){this.instance=ab({h:this.hue,s:nD(t),v:this.brightness,a:this.alphaValue/100}),this.initRgb(),this.initLightness(),this.saturationValue=nD(t)}get saturation(){return this.saturationValue}set brightness(t){this.instance=ab({h:this.hue,s:this.saturation,v:nD(t),a:this.alphaValue/100}),this.initRgb(),this.initLightness(),this.brightnessValue=nD(t)}get brightness(){return this.brightnessValue}set lightness(t){this.instance=ab({h:this.hue,s:this.hslSaturationValue,l:nD(t),a:this.alphaValue/100}),this.initRgb(),this.initHsb(),this.lightnessValue=nD(t)}get lightness(){return this.lightnessValue}set red(t){const e=this.instance.toRgb();this.instance=ab({...e,r:nD(t),a:this.alphaValue/100}),this.initHsb(),this.initLightness(),this.redValue=nD(t)}get red(){return this.redValue}set green(t){const e=this.instance.toRgb();this.instance=ab({...e,g:nD(t),a:this.alphaValue/100}),this.initHsb(),this.initLightness(),this.greenValue=nD(t)}get green(){return this.greenValue}set blue(t){const e=this.instance.toRgb();this.instance=ab({...e,b:nD(t),a:this.alphaValue/100}),this.initHsb(),this.initLightness(),this.blueValue=nD(t)}get blue(){return this.blueValue}set alpha(t){this.instance.setAlpha(t/100),this.alphaValue=t}get alpha(){return this.alphaValue}get RGB(){return[this.red,this.green,this.blue,parseFloat((this.alpha/100).toFixed(2))]}get HSB(){return[this.hue,this.saturation,this.brightness,parseFloat((this.alpha/100).toFixed(2))]}get HSL(){return[this.hue,this.hslSaturationValue,this.lightness,parseFloat((this.alpha/100).toFixed(2))]}}function rD(t,e,n,i){return`rgba(${[t,e,n,i/100].join(",")})`}const oD=(t,e,n)=>e<n?t<e?e:t>n?n:t:t<n?n:t>e?e:t,sD="color-history",aD=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},lD=J({name:"Alpha",props:{color:RS.instanceOf(iD),size:RS.oneOf(["small","default"]).def("default")},emits:["change"],setup(t,{emit:e}){const n=ct(null),i=ct(null);let r=t.color||new iD;const o=yt({red:r.red,green:r.green,blue:r.blue,alpha:r.alpha});ut((()=>t.color),(t=>{t&&(r=t,wt(o,{red:t.red,green:t.green,blue:t.blue,alpha:t.alpha}))}),{deep:!0});const s=mt((()=>({background:`linear-gradient(to right, ${rD(o.red,o.green,o.blue,0)} , ${rD(o.red,o.green,o.blue,100)})`}))),a=()=>{if(n.value&&i.value){const t=o.alpha/100,e=n.value.getBoundingClientRect(),r=i.value.offsetWidth;return Math.round(t*(e.width-r)+r/2)}return 0},l=mt((()=>({left:a()+"px",top:0}))),u=t=>{if(t.stopPropagation(),n.value&&i.value){const s=n.value.getBoundingClientRect(),a=i.value.offsetWidth;let l=t.clientX-s.left;l=Math.max(a/2,l),l=Math.min(l,s.width-a/2);const u=Math.round((l-a/2)/(s.width-a)*100);r.alpha=u,o.alpha=u,e("change",u)}};return Gx((()=>{const t={drag:t=>{u(t)},end:t=>{u(t)}};n.value&&i.value&&aT.triggerDragEvent(n.value,t)})),{barElement:n,cursorElement:i,getCursorStyle:l,getBackgroundStyle:s,onClickSider:t=>{t.target!==n.value&&u(t)}}}}),uD=[(t=>(nt("data-v-18925ba6"),t=t(),it(),t))((()=>rt("div",{class:"vc-alpha-slider__bar-handle"},null,-1)))];const hD=aD(lD,[["render",function(t,e,n,i,r,o){return tt(),et("div",{class:bt(["vc-alpha-slider","transparent",{"small-slider":"small"===t.size}])},[rt("div",{ref:"barElement",class:"vc-alpha-slider__bar",style:Ct(t.getBackgroundStyle),onClick:e[0]||(e[0]=(...e)=>t.onClickSider&&t.onClickSider(...e))},[rt("div",{class:bt(["vc-alpha-slider__bar-pointer",{"small-bar":"small"===t.size}]),ref:"cursorElement",style:Ct(t.getCursorStyle)},uD,6)],4)],2)}],["__scopeId","data-v-18925ba6"]]),cD=[["#fcc02e","#f67c01","#e64a19","#d81b43","#8e24aa","#512da7","#1f87e8","#008781","#05a045"],["#fed835","#fb8c00","#f5511e","#eb1d4e","#9c28b1","#5d35b0","#2097f3","#029688","#4cb050"],["#ffeb3c","#ffa727","#fe5722","#eb4165","#aa47bc","#673bb7","#42a5f6","#26a59a","#83c683"],["#fff176","#ffb74e","#ff8a66","#f1627e","#b968c7","#7986cc","#64b5f6","#80cbc4","#a5d6a7"],["#fff59c","#ffcc80","#ffab91","#fb879e","#cf93d9","#9ea8db","#90caf8","#b2dfdc","#c8e6ca"],["transparent","#ffffff","#dedede","#a9a9a9","#4b4b4b","#353535","#212121","#000000","advance"]],dD=J({name:"Palette",emits:["change"],setup:(t,{emit:e})=>({palettes:cD,computedBgStyle:t=>"transparent"===t?t:"advance"===t?{}:{background:ab(t).toRgbString()},onColorChange:t=>{e("change",t)}})}),pD={class:"vc-compact"},fD=["onClick"];const gD=aD(dD,[["render",function(t,e,n,i,r,o){return tt(),et("div",pD,[(tt(!0),et(St,null,Et(t.palettes,((e,n)=>(tt(),et("div",{key:n,class:"vc-compact__row"},[(tt(!0),et(St,null,Et(e,((e,n)=>(tt(),et("div",{key:n,class:"vc-compact__color-cube--wrap",onClick:n=>t.onColorChange(e)},[rt("div",{class:bt(["vc-compact__color_cube",{advance:"advance"===e,transparent:"transparent"===e}]),style:Ct(t.computedBgStyle(e))},null,6)],8,fD)))),128))])))),128))])}],["__scopeId","data-v-b969fd48"]]),mD=J({name:"Board",props:{color:RS.instanceOf(iD),round:RS.bool.def(!1),hide:RS.bool.def(!0)},emits:["change"],setup(t,{emit:e}){var n,i,r;const o=ht(),s={h:(null==(n=t.color)?void 0:n.hue)||0,s:1,v:1},a=new iD(s).toHexString(),l=yt({hueColor:a,saturation:(null==(i=t.color)?void 0:i.saturation)||0,brightness:(null==(r=t.color)?void 0:r.brightness)||0}),u=ct(0),h=ct(0),c=ct(),d=mt((()=>({top:u.value+"px",left:h.value+"px"}))),p=()=>{if(o){const t=o.vnode.el;h.value=l.saturation*(null==t?void 0:t.clientWidth),u.value=(1-l.brightness)*(null==t?void 0:t.clientHeight)}};let f=!1;const g=t=>{if(o){const n=o.vnode.el,i=null==n?void 0:n.getBoundingClientRect();let r=t.clientX-i.left,s=t.clientY-i.top;r=oD(r,0,i.width),s=oD(s,0,i.height);const a=r/i.width,c=oD(-s/i.height+1,0,1);h.value=r,u.value=s,l.saturation=a,l.brightness=c,e("change",a,c)}};return Gx((()=>{o&&o.vnode.el&&c.value&&lt((()=>{p()}))})),Nx((()=>t.color),(t=>{wt(l,{hueColor:new iD({h:t.hue,s:1,v:1}).toHexString(),saturation:t.saturation,brightness:t.brightness}),p()}),{deep:!0}),{state:l,cursorElement:c,getCursorStyle:d,onClickBoard:t=>{f=!0,g(t)},onDrag:t=>{f&&g(t)},onDragEnd:()=>{f=!1}}}}),_D=t=>(nt("data-v-7f0cdcdf"),t=t(),it(),t),yD=_D((()=>rt("div",{class:"vc-saturation__white"},null,-1))),vD=_D((()=>rt("div",{class:"vc-saturation__black"},null,-1))),wD=[_D((()=>rt("div",null,null,-1)))];const xD=aD(mD,[["render",function(t,e,n,i,r,o){return tt(),et("div",{ref:"boardElement",class:bt(["vc-saturation",{"vc-saturation__chrome":t.round,"vc-saturation__hidden":t.hide}]),style:Ct({backgroundColor:t.state.hueColor}),onMousedown:e[0]||(e[0]=(...e)=>t.onClickBoard&&t.onClickBoard(...e)),onMousemove:e[1]||(e[1]=(...e)=>t.onDrag&&t.onDrag(...e)),onMouseup:e[2]||(e[2]=(...e)=>t.onDragEnd&&t.onDragEnd(...e))},[yD,vD,rt("div",{class:"vc-saturation__cursor",ref:"cursorElement",style:Ct(t.getCursorStyle)},wD,4)],38)}],["__scopeId","data-v-7f0cdcdf"]]),bD=J({name:"Hue",props:{color:RS.instanceOf(iD),size:RS.oneOf(["small","default"]).def("default")},emits:["change"],setup(t,{emit:e}){const n=ct(null),i=ct(null);let r=t.color||new iD;const o=yt({hue:r.hue||0});ut((()=>t.color),(t=>{t&&(r=t,wt(o,{hue:r.hue}))}),{deep:!0});const s=()=>{if(n.value&&i.value){const t=n.value.getBoundingClientRect(),e=i.value.offsetWidth;return 360===o.hue?t.width-e/2:o.hue%360*(t.width-e)/360+e/2}return 0},a=mt((()=>({left:s()+"px",top:0}))),l=t=>{if(t.stopPropagation(),n.value&&i.value){const s=n.value.getBoundingClientRect(),a=i.value.offsetWidth;let l=t.clientX-s.left;l=Math.min(l,s.width-a/2),l=Math.max(a/2,l);const u=Math.round((l-a/2)/(s.width-a)*360);r.hue=u,o.hue=u,e("change",u)}};return Gx((()=>{const t={drag:t=>{l(t)},end:t=>{l(t)}};n.value&&i.value&&aT.triggerDragEvent(n.value,t)})),{barElement:n,cursorElement:i,getCursorStyle:a,onClickSider:t=>{t.target!==n.value&&l(t)}}}}),CD=[(t=>(nt("data-v-e1a08576"),t=t(),it(),t))((()=>rt("div",{class:"vc-hue-slider__bar-handle"},null,-1)))];const SD=aD(bD,[["render",function(t,e,n,i,r,o){return tt(),et("div",{class:bt(["vc-hue-slider",{"small-slider":"small"===t.size}])},[rt("div",{ref:"barElement",class:"vc-hue-slider__bar",onClick:e[0]||(e[0]=(...e)=>t.onClickSider&&t.onClickSider(...e))},[rt("div",{class:bt(["vc-hue-slider__bar-pointer",{"small-bar":"small"===t.size}]),ref:"cursorElement",style:Ct(t.getCursorStyle)},CD,6)],512)],2)}],["__scopeId","data-v-e1a08576"]]),ED=J({name:"Lightness",props:{color:RS.instanceOf(iD),size:RS.oneOf(["small","default"]).def("default")},emits:["change"],setup(t,{emit:e}){const n=ct(null),i=ct(null);let r=t.color||new iD;const[o,s,a]=r.HSL,l=yt({hue:o,saturation:s,lightness:a});ut((()=>t.color),(t=>{if(t){r=t;const[e,n,i]=r.HSL;wt(l,{hue:e,saturation:n,lightness:i})}}),{deep:!0});const u=mt((()=>{const t=ab({h:l.hue,s:l.saturation,l:.8}).toPercentageRgbString(),e=ab({h:l.hue,s:l.saturation,l:.6}).toPercentageRgbString(),n=ab({h:l.hue,s:l.saturation,l:.4}).toPercentageRgbString(),i=ab({h:l.hue,s:l.saturation,l:.2}).toPercentageRgbString();return{background:[`linear-gradient(to right, rgb(255, 255, 255), ${t}, ${e}, ${n}, ${i}, rgb(0, 0, 0))`,`-webkit-linear-gradient(left, rgb(255, 255, 255), ${t}, ${e}, ${n}, ${i}, rgb(0, 0, 0))`,`-moz-linear-gradient(left, rgb(255, 255, 255), ${t}, ${e}, ${n}, ${i}, rgb(0, 0, 0))`,`-ms-linear-gradient(left, rgb(255, 255, 255), ${t}, ${e}, ${n}, ${i}, rgb(0, 0, 0))`]}})),h=()=>{if(n.value&&i.value){const t=l.lightness,e=n.value.getBoundingClientRect(),r=i.value.offsetWidth;return(1-t)*(e.width-r)+r/2}return 0},c=mt((()=>({left:h()+"px",top:0}))),d=t=>{if(t.stopPropagation(),n.value&&i.value){const o=n.value.getBoundingClientRect(),s=i.value.offsetWidth;let a=t.clientX-o.left;a=Math.max(s/2,a),a=Math.min(a,o.width-s/2);const l=1-(a-s/2)/(o.width-s);r.lightness=l,e("change",l)}};return Gx((()=>{const t={drag:t=>{d(t)},end:t=>{d(t)}};n.value&&i.value&&aT.triggerDragEvent(n.value,t)})),{barElement:n,cursorElement:i,getCursorStyle:c,getBackgroundStyle:u,onClickSider:t=>{t.target!==n.value&&d(t)}}}}),ID=[(t=>(nt("data-v-94a50a9e"),t=t(),it(),t))((()=>rt("div",{class:"vc-lightness-slider__bar-handle"},null,-1)))];const PD=aD(ED,[["render",function(t,e,n,i,r,o){return tt(),et("div",{class:bt(["vc-lightness-slider",{"small-slider":"small"===t.size}])},[rt("div",{ref:"barElement",class:"vc-lightness-slider__bar",style:Ct(t.getBackgroundStyle),onClick:e[0]||(e[0]=(...e)=>t.onClickSider&&t.onClickSider(...e))},[rt("div",{class:bt(["vc-lightness-slider__bar-pointer",{"small-bar":"small"===t.size}]),ref:"cursorElement",style:Ct(t.getCursorStyle)},ID,6)],4)],2)}],["__scopeId","data-v-94a50a9e"]]),TD=J({name:"History",props:{colors:RS.arrayOf(String).def((()=>[])),round:RS.bool.def(!1)},emits:["change"],setup:(t,{emit:e})=>({onColorSelect:t=>{e("change",t)}})}),kD={key:0,class:"vc-colorPicker__record"},DD={class:"color-list"},MD=["onClick"];const LD=aD(TD,[["render",function(t,e,n,i,r,o){return t.colors&&t.colors.length>0?(tt(),et("div",kD,[rt("div",DD,[(tt(!0),et(St,null,Et(t.colors,((e,n)=>(tt(),et("div",{key:n,class:bt(["color-item","transparent",{"color-item__round":t.round}]),onClick:n=>t.onColorSelect(e)},[rt("div",{class:"color-item__display",style:Ct({backgroundColor:e})},null,4)],10,MD)))),128))])])):It("",!0)}],["__scopeId","data-v-0f657238"]]),RD=J({name:"Display",props:{color:RS.instanceOf(iD),disableAlpha:RS.bool.def(!1)},emits:["update:color","change"],setup(t,{emit:e}){var n,i,r,o;const{copy:s,copied:a,isSupported:l}=qx(),u=ct("hex"),h=yt({color:t.color,hex:null==(n=t.color)?void 0:n.hex,alpha:Math.round((null==(i=t.color)?void 0:i.alpha)||100),rgba:null==(r=t.color)?void 0:r.RGB,previewBgColor:null==(o=t.color)?void 0:o.toRgbString()}),c=mt((()=>({background:h.previewBgColor}))),d=Bx((t=>{if(!t.target.value)return;let n=parseInt(t.target.value.replace("%",""));n>100&&(t.target.value="100",n=100),n<0&&(t.target.value="0",n=0),isNaN(n)&&(t.target.value="100",n=100),!isNaN(n)&&h.color&&(h.color.alpha=n),e("change",h.color)}),300),p=Bx(((t,n)=>{if(h.color)if("hex"===u.value){const n=t.target.value.replace("#","");ab(n).isValid()?[3,4].includes(n.length)&&(h.color.hex=n):h.color.hex="000000",e("change",h.color)}else if("rgba"===u.value&&3===n&&"0."===t.target.value.toString()&&h.rgba){h.rgba[n]=t.target.value;const[i,r,o,s]=h.rgba;h.color.hex=ab({r:i,g:r,b:o}).toHex(),h.color.alpha=Math.round(100*s),e("change",h.color)}}),100),f=Bx(((t,n)=>{if(t.target.value){if("hex"===u.value){const e=t.target.value.replace("#","");ab(e).isValid()&&h.color&&[6,8].includes(e.length)&&(h.color.hex=e)}else if(void 0!==n&&h.rgba&&h.color){if(t.target.value<0&&(t.target.value=0),3===n&&((t.target.value>1||isNaN(t.target.value))&&(t.target.value=1),"0."===t.target.value.toString()))return;n<3&&t.target.value>255&&(t.target.value=255),h.rgba[n]=t.target.value;const[e,i,r,o]=h.rgba;h.color.hex=ab({r:e,g:i,b:r}).toHex(),h.color.alpha=Math.round(100*o)}e("change",h.color)}}),300);return Nx((()=>t.color),(t=>{t&&(h.color=t,h.alpha=Math.round(h.color.alpha),h.hex=h.color.hex,h.rgba=h.color.RGB)}),{deep:!0}),Nx((()=>h.color),(()=>{h.color&&(h.previewBgColor=h.color.toRgbString())}),{deep:!0}),{state:h,getBgColorStyle:c,inputType:u,copied:a,onInputTypeChange:()=>{u.value="rgba"===u.value?"hex":"rgba"},onAlphaBlur:d,onInputChange:f,onBlurChange:p,onCopyColorStr:()=>{if(l&&h.color){const t="hex"===u.value?h.color.toString(100===h.color.alpha?"hex6":"hex8"):h.color.toRgbString();s(t||"")}}}}}),OD={class:"vc-display"},FD={class:"vc-current-color vc-transparent"},AD={key:0,class:"copy-text"},zD={key:0,style:{display:"flex",flex:"1",gap:"4px",height:"100%"}},BD={class:"vc-color-input"},jD={key:0,class:"vc-alpha-input"},GD=["value"],ND={key:1,style:{display:"flex",flex:"1",gap:"4px",height:"100%"}},VD=["value","onInput","onBlur"];const HD=aD(RD,[["render",function(t,e,n,i,r,o){return tt(),et("div",OD,[rt("div",FD,[rt("div",{class:"color-cube",style:Ct(t.getBgColorStyle),onClick:e[0]||(e[0]=(...e)=>t.onCopyColorStr&&t.onCopyColorStr(...e))},[t.copied?(tt(),et("span",AD,"Copied!")):It("",!0)],4)]),"hex"===t.inputType?(tt(),et("div",zD,[rt("div",BD,[Pt(rt("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.state.hex=e),maxlength:"8",onInput:e[2]||(e[2]=(...e)=>t.onInputChange&&t.onInputChange(...e)),onBlur:e[3]||(e[3]=(...e)=>t.onBlurChange&&t.onBlurChange(...e))},null,544),[[Tt,t.state.hex]])]),t.disableAlpha?It("",!0):(tt(),et("div",jD,[rt("input",{class:"vc-alpha-input__inner",value:t.state.alpha,onInput:e[4]||(e[4]=(...e)=>t.onAlphaBlur&&t.onAlphaBlur(...e))},null,40,GD),kt("% ")]))])):t.state.rgba?(tt(),et("div",ND,[(tt(!0),et(St,null,Et(t.state.rgba,((e,n)=>(tt(),et("div",{class:"vc-color-input",key:n},[rt("input",{value:e,onInput:e=>t.onInputChange(e,n),onBlur:e=>t.onBlurChange(e,n)},null,40,VD)])))),128))])):It("",!0),rt("div",{class:"vc-input-toggle",onClick:e[5]||(e[5]=(...e)=>t.onInputTypeChange&&t.onInputTypeChange(...e))},ot(t.inputType),1)])}],["__scopeId","data-v-7334ac20"]]),WD=J({name:"FkColorPicker",components:{Display:HD,Alpha:hD,Palette:gD,Board:xD,Hue:SD,Lightness:PD,History:LD},props:{color:RS.instanceOf(iD),disableHistory:RS.bool.def(!1),roundHistory:RS.bool.def(!1),disableAlpha:RS.bool.def(!1)},emits:["update:color","change","advanceChange"],setup(t,{emit:e}){const n=t.color||new iD,i=yt({color:n,hex:n.toHexString(),rgb:n.toRgbString()}),r=ct(!1),o=mt((()=>({background:i.rgb}))),s=ib(sD,[],{}),a=Bx((()=>{if(t.disableHistory)return;const e=i.color.toRgbString();if(s.value=s.value.filter((t=>!ab.equals(t,e))),!s.value.includes(e)){for(;s.value.length>8;)s.value.pop();s.value.unshift(e)}}),500);return Nx((()=>t.color),(t=>{t&&(i.color=t)}),{deep:!0}),Nx((()=>i.color),(()=>{i.hex=i.color.hex,i.rgb=i.color.toRgbString(),a(),e("update:color",i.color),e("change",i.color)}),{deep:!0}),{state:i,advancePanelShow:r,onBack:()=>{r.value=!1,e("advanceChange",!1)},onCompactChange:t=>{"advance"===t?(r.value=!0,e("advanceChange",!0)):(i.color.hex=t,e("advanceChange",!1))},onAlphaChange:t=>{i.color.alpha=t},onHueChange:t=>{i.color.hue=t},onBoardChange:(t,e)=>{i.color.saturation=t,i.color.brightness=e},onLightChange:t=>{i.color.lightness=t},onInputChange:t=>{const e=t.target.value.replace("#","");ab(e).isValid()&&(i.color.hex=e)},previewStyle:o,historyColors:s}}}),XD={class:"vc-fk-colorPicker"},UD={class:"vc-fk-colorPicker__inner"},$D={class:"vc-fk-colorPicker__header"},YD=[(t=>(nt("data-v-48e3c224"),t=t(),it(),t))((()=>rt("div",{class:"back"},null,-1)))];const qD=aD(WD,[["render",function(t,e,n,i,r,o){const s=Lt("Palette"),a=Lt("Board"),l=Lt("Hue"),u=Lt("Lightness"),h=Lt("Alpha"),c=Lt("Display"),d=Lt("History");return tt(),et("div",XD,[rt("div",UD,[rt("div",$D,[t.advancePanelShow?(tt(),et("span",{key:0,style:{cursor:"pointer"},onClick:e[0]||(e[0]=(...e)=>t.onBack&&t.onBack(...e))},YD)):It("",!0)]),t.advancePanelShow?It("",!0):(tt(),Rt(s,{key:0,onChange:t.onCompactChange},null,8,["onChange"])),t.advancePanelShow?(tt(),Rt(a,{key:1,color:t.state.color,onChange:t.onBoardChange},null,8,["color","onChange"])):It("",!0),t.advancePanelShow?(tt(),Rt(l,{key:2,color:t.state.color,onChange:t.onHueChange},null,8,["color","onChange"])):It("",!0),t.advancePanelShow?It("",!0):(tt(),Rt(u,{key:3,color:t.state.color,onChange:t.onLightChange},null,8,["color","onChange"])),t.disableAlpha?It("",!0):(tt(),Rt(h,{key:4,color:t.state.color,onChange:t.onAlphaChange},null,8,["color","onChange"])),xt(c,{color:t.state.color,"disable-alpha":t.disableAlpha},null,8,["color","disable-alpha"]),t.disableHistory?It("",!0):(tt(),Rt(d,{key:5,round:t.roundHistory,colors:t.historyColors,onChange:t.onCompactChange},null,8,["round","colors","onChange"]))])])}],["__scopeId","data-v-48e3c224"]]),ZD=J({name:"ChromeColorPicker",components:{Display:HD,Alpha:hD,Board:xD,Hue:SD,History:LD},props:{color:RS.instanceOf(iD),disableHistory:RS.bool.def(!1),roundHistory:RS.bool.def(!1),disableAlpha:RS.bool.def(!1)},emits:["update:color","change"],setup(t,{emit:e}){const n=t.color||new iD,i=yt({color:n,hex:n.toHexString(),rgb:n.toRgbString()}),r=mt((()=>({background:i.rgb}))),o=ib(sD,[],{}),s=Bx((()=>{if(t.disableHistory)return;const e=i.color.toRgbString();if(o.value=o.value.filter((t=>!ab.equals(t,e))),!o.value.includes(e)){for(;o.value.length>8;)o.value.pop();o.value.unshift(e)}}),500);return Nx((()=>t.color),(t=>{t&&(i.color=t)}),{deep:!0}),Nx((()=>i.color),(()=>{i.hex=i.color.hex,i.rgb=i.color.toRgbString(),s(),e("update:color",i.color),e("change",i.color)}),{deep:!0}),{state:i,previewStyle:r,historyColors:o,onAlphaChange:t=>{i.color.alpha=t},onHueChange:t=>{i.color.hue=t},onBoardChange:(t,e)=>{i.color.saturation=t,i.color.brightness=e},onInputChange:t=>{void 0!==t.hex&&(i.color.hex=t.hex),void 0!==t.alpha&&(i.color.alpha=t.alpha)},onCompactChange:t=>{"advance"!==t&&(i.color.hex=t)}}}}),KD={class:"vc-chrome-colorPicker"},JD={class:"vc-chrome-colorPicker-body"},QD={class:"chrome-controls"},tM={class:"chrome-sliders"};const eM=aD(ZD,[["render",function(t,e,n,i,r,o){const s=Lt("Board"),a=Lt("Hue"),l=Lt("Alpha"),u=Lt("Display"),h=Lt("History");return tt(),et("div",KD,[xt(s,{round:!0,hide:!1,color:t.state.color,onChange:t.onBoardChange},null,8,["color","onChange"]),rt("div",JD,[rt("div",QD,[rt("div",tM,[xt(a,{size:"small",color:t.state.color,onChange:t.onHueChange},null,8,["color","onChange"]),t.disableAlpha?It("",!0):(tt(),Rt(l,{key:0,size:"small",color:t.state.color,onChange:t.onAlphaChange},null,8,["color","onChange"]))])]),xt(u,{color:t.state.color,"disable-alpha":t.disableAlpha},null,8,["color","disable-alpha"]),t.disableHistory?It("",!0):(tt(),Rt(h,{key:0,round:t.roundHistory,colors:t.historyColors,onChange:t.onCompactChange},null,8,["round","colors","onChange"]))])])}],["__scopeId","data-v-2611d66c"]]),nM="Vue3ColorPickerProvider";let iM=!1;const rM=J({name:"Angle",props:{angle:{type:Number,default:0},size:{type:Number,default:16,validator:t=>t>=16},borderWidth:{type:Number,default:1,validator:t=>t>=1},borderColor:{type:String,default:"#666"}},emits:["update:angle","change"],setup(t,{emit:e}){const n=ct(null),i=ct(0);ut((()=>t.angle),(t=>{i.value=t}));const r=mt((()=>({width:t.size+"px",height:t.size+"px",borderWidth:t.borderWidth+"px",borderColor:t.borderColor,transform:`rotate(${i.value}deg)`}))),o=r=>{n.value&&(i.value=((t,e)=>{const n=t.getBoundingClientRect(),i=n.left+n.width/2,r=n.top+n.height/2,o=Math.abs(i-e.clientX),s=Math.abs(r-e.clientY),a=s/Math.sqrt(Math.pow(o,2)+Math.pow(s,2)),l=Math.acos(a);let u=Math.floor(180/(Math.PI/l));return e.clientX>i&&e.clientY>r&&(u=180-u),e.clientX==i&&e.clientY>r&&(u=180),e.clientX>i&&e.clientY==r&&(u=90),e.clientX<i&&e.clientY>r&&(u=180+u),e.clientX<i&&e.clientY==r&&(u=270),e.clientX<i&&e.clientY<r&&(u=360-u),u})(n.value,r)%360,(()=>{let n=Number(i.value);isNaN(n)||(n=n>360||n<0?t.angle:n,i.value=360===n?0:n,e("update:angle",i.value),e("change",i.value))})())};return at((()=>{const t={drag:t=>{o(t)},end:t=>{o(t)}};n.value&&((t,e)=>{const n=function(t){var n;null==(n=e.drag)||n.call(e,t)},i=function(t){var r;document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",i,!1),document.onselectstart=null,document.ondragstart=null,iM=!1,null==(r=e.end)||r.call(e,t)};t&&t.addEventListener("mousedown",(t=>{var r;iM||(document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",n,!1),document.addEventListener("mouseup",i,!1),iM=!0,null==(r=e.start)||r.call(e,t))}))})(n.value,t)})),()=>xt("div",{class:"bee-angle"},[xt("div",{class:"bee-angle__round",ref:n,style:r.value},null)])}}),oM=J({name:"GradientColorPicker",components:{Angle:rM,Display:HD,Alpha:hD,Palette:gD,Board:xD,Hue:SD,Lightness:PD,History:LD},props:{startColor:RS.instanceOf(iD).isRequired,endColor:RS.instanceOf(iD).isRequired,startColorStop:RS.number.def(0),endColorStop:RS.number.def(100),angle:RS.number.def(0),type:RS.oneOf(["linear","radial"]).def("linear"),disableHistory:RS.bool.def(!1),roundHistory:RS.bool.def(!1),disableAlpha:RS.bool.def(!1),pickerType:RS.oneOf(["fk","chrome"]).def("fk")},emits:["update:startColor","update:endColor","update:angle","update:startColorStop","update:endColorStop","startColorChange","endColorChange","advanceChange","angleChange","startColorStopChange","endColorStopChange","typeChange"],setup(t,{emit:e}){const n=yt({startActive:!0,startColor:t.startColor,endColor:t.endColor,startColorStop:t.startColorStop,endColorStop:t.endColorStop,angle:t.angle,type:t.type,startColorRgba:t.startColor.toRgbString(),endColorRgba:t.endColor.toRgbString()}),i=vt(nM),r=ct("chrome"===t.pickerType),o=ct(),s=ct(),a=ct();ut((()=>[t.startColor,t.endColor,t.angle]),(t=>{n.startColor=t[0],n.endColor=t[1],n.angle=t[2]})),ut((()=>t.type),(t=>{n.type=t}));const l=mt({get:()=>n.startActive?n.startColor:n.endColor,set:t=>{n.startActive?n.startColor=t:n.endColor=t}}),u=mt((()=>{if(a.value&&o.value){const t=n.startColorStop/100,e=a.value.getBoundingClientRect(),i=o.value.offsetWidth;return Math.round(t*(e.width-i)+i/2)}return 0})),h=mt((()=>{if(a.value&&s.value){const t=n.endColorStop/100,e=a.value.getBoundingClientRect(),i=s.value.offsetWidth;return Math.round(t*(e.width-i)+i/2)}return 0})),c=mt((()=>{let t=`background: linear-gradient(${n.angle}deg, ${n.startColorRgba} ${n.startColorStop}%, ${n.endColorRgba} ${n.endColorStop}%)`;return"radial"===n.type&&(t=`background: radial-gradient(circle, ${n.startColorRgba} ${n.startColorStop}%, ${n.endColorRgba} ${n.endColorStop}%)`),t})),d=t=>{var i;if(n.startActive=!0,a.value&&o.value){const r=null==(i=a.value)?void 0:i.getBoundingClientRect();let s=t.clientX-r.left;s=Math.max(o.value.offsetWidth/2,s),s=Math.min(s,r.width-o.value.offsetWidth/2),n.startColorStop=Math.round((s-o.value.offsetWidth/2)/(r.width-o.value.offsetWidth)*100),e("update:startColorStop",n.startColorStop),e("startColorStopChange",n.startColorStop)}},p=t=>{var i;if(n.startActive=!1,a.value&&s.value){const r=null==(i=a.value)?void 0:i.getBoundingClientRect();let o=t.clientX-r.left;o=Math.max(s.value.offsetWidth/2,o),o=Math.min(o,r.width-s.value.offsetWidth/2),n.endColorStop=Math.round((o-s.value.offsetWidth/2)/(r.width-s.value.offsetWidth)*100),e("update:endColorStop",n.endColorStop),e("endColorStopChange",n.endColorStop)}},f=()=>{n.startActive?(e("update:startColor",n.startColor),e("startColorChange",n.startColor)):(e("update:endColor",n.endColor),e("endColorChange",n.endColor))},g=ib(sD,[],{}),m=Bx((()=>{if(t.disableHistory)return;const e=l.value.toRgbString();if(g.value=g.value.filter((t=>!ab.equals(t,e))),!g.value.includes(e)){for(;g.value.length>8;)g.value.pop();g.value.unshift(e)}}),500);return Gx((()=>{s.value&&o.value&&(aT.triggerDragEvent(s.value,{drag:t=>{p(t)},end:t=>{p(t)}}),aT.triggerDragEvent(o.value,{drag:t=>{d(t)},end:t=>{d(t)}}))})),Nx((()=>n.startColor),(t=>{n.startColorRgba=t.toRgbString()}),{deep:!0}),Nx((()=>n.endColor),(t=>{n.endColorRgba=t.toRgbString()}),{deep:!0}),Nx((()=>l.value),(()=>{m()}),{deep:!0}),{startGradientRef:o,stopGradientRef:s,colorRangeRef:a,state:n,currentColor:l,getStartColorLeft:u,getEndColorLeft:h,gradientBg:c,advancePanelShow:r,onDegreeBlur:t=>{const i=t.target,r=parseInt(i.value.replace("°",""));isNaN(r)||(n.angle=r%360),e("update:angle",n.angle),e("angleChange",n.angle)},onCompactChange:t=>{"advance"===t?(r.value=!0,e("advanceChange",!0)):(l.value.hex=t,e("advanceChange",!1)),f()},onAlphaChange:t=>{l.value.alpha=t,f()},onHueChange:t=>{l.value.hue=t,f()},onBoardChange:(t,e)=>{l.value.saturation=t,l.value.brightness=e,f()},onLightChange:t=>{l.value.lightness=t,f()},historyColors:g,onBack:()=>{r.value=!1,e("advanceChange",!1)},onDegreeChange:t=>{n.angle=t,e("update:angle",n.angle),e("angleChange",n.angle)},onDisplayChange:()=>{f()},onTypeChange:()=>{n.type="linear"===n.type?"radial":"linear",e("typeChange",n.type)},lang:null==i?void 0:i.lang}}}),sM=t=>(nt("data-v-c4d6d6ea"),t=t(),it(),t),aM={class:"vc-gradient-picker"},lM={class:"vc-gradient-picker__header"},uM={class:"vc-gradient__types"},hM={class:"vc-gradient-wrap__types"},cM={class:"vc-picker-degree-input vc-degree-input"},dM={class:"vc-degree-input__control"},pM=["value"],fM={class:"vc-degree-input__panel"},gM={class:"vc-degree-input__disk"},mM={class:"vc-gradient-picker__body"},_M={class:"vc-color-range",ref:"colorRangeRef"},yM={class:"vc-color-range__container"},vM={class:"vc-gradient__stop__container"},wM=["title"],xM=[sM((()=>rt("span",{class:"vc-gradient__stop--inner"},null,-1)))],bM=["title"],CM=[sM((()=>rt("span",{class:"vc-gradient__stop--inner"},null,-1)))];const SM=aD(oM,[["render",function(t,e,n,i,r,o){var s,a;const l=Lt("Angle"),u=Lt("Board"),h=Lt("Hue"),c=Lt("Palette"),d=Lt("Lightness"),p=Lt("Alpha"),f=Lt("Display"),g=Lt("History");return tt(),et("div",aM,[rt("div",lM,[rt("div",null,[Pt(rt("div",{class:"back",style:{cursor:"pointer"},onClick:e[0]||(e[0]=(...e)=>t.onBack&&t.onBack(...e))},null,512),[[Bt,"fk"===t.pickerType&&t.advancePanelShow]])]),rt("div",uM,[rt("div",hM,[(tt(),et(St,null,Et(["linear","radial"],(n=>rt("div",{class:bt(["vc-gradient__type",{active:t.state.type===n}]),key:n,onClick:e[1]||(e[1]=(...e)=>t.onTypeChange&&t.onTypeChange(...e))},ot(t.lang?t.lang[n]:n),3))),64))]),Pt(rt("div",cM,[rt("div",dM,[rt("input",{value:t.state.angle,onBlur:e[2]||(e[2]=(...e)=>t.onDegreeBlur&&t.onDegreeBlur(...e))},null,40,pM),kt("deg ")]),rt("div",fM,[rt("div",gM,[xt(l,{angle:t.state.angle,"onUpdate:angle":e[3]||(e[3]=e=>t.state.angle=e),size:40,onChange:t.onDegreeChange},null,8,["angle","onChange"])])])],512),[[Bt,"linear"===t.state.type]])])]),rt("div",mM,[rt("div",_M,[rt("div",yM,[rt("div",{class:"vc-background",style:Ct(t.gradientBg)},null,4),rt("div",vM,[rt("div",{class:bt(["vc-gradient__stop",{"vc-gradient__stop--current":t.state.startActive}]),ref:"startGradientRef",title:null==(s=t.lang)?void 0:s.start,style:Ct({left:t.getStartColorLeft+"px",backgroundColor:t.state.startColorRgba})},xM,14,wM),rt("div",{class:bt(["vc-gradient__stop",{"vc-gradient__stop--current":!t.state.startActive}]),ref:"stopGradientRef",title:null==(a=t.lang)?void 0:a.end,style:Ct({left:t.getEndColorLeft+"px",backgroundColor:t.state.endColorRgba})},CM,14,bM)])])],512)]),t.advancePanelShow?(tt(),Rt(u,{key:0,color:t.currentColor,onChange:t.onBoardChange},null,8,["color","onChange"])):It("",!0),t.advancePanelShow?(tt(),Rt(h,{key:1,color:t.currentColor,onChange:t.onHueChange},null,8,["color","onChange"])):It("",!0),t.advancePanelShow?It("",!0):(tt(),Rt(c,{key:2,onChange:t.onCompactChange},null,8,["onChange"])),t.advancePanelShow?It("",!0):(tt(),Rt(d,{key:3,color:t.currentColor,onChange:t.onLightChange},null,8,["color","onChange"])),t.disableAlpha?It("",!0):(tt(),Rt(p,{key:4,color:t.currentColor,onChange:t.onAlphaChange},null,8,["color","onChange"])),xt(f,{color:t.currentColor,"disable-alpha":t.disableAlpha,onChange:t.onDisplayChange},null,8,["color","disable-alpha","onChange"]),t.disableHistory?It("",!0):(tt(),Rt(g,{key:5,round:t.roundHistory,colors:t.historyColors,onChange:t.onCompactChange},null,8,["round","colors","onChange"]))])}],["__scopeId","data-v-c4d6d6ea"]]),EM=J({name:"WrapContainer",props:{theme:RS.oneOf(["white","black"]).def("white"),showTab:RS.bool.def(!1),activeKey:RS.oneOf(["pure","gradient"]).def("pure")},emits:["update:activeKey","change"],setup(t,{emit:e}){const n=yt({activeKey:t.activeKey}),i=vt(nM);return Nx((()=>t.activeKey),(t=>{n.activeKey=t})),{state:n,onActiveKeyChange:t=>{n.activeKey=t,e("update:activeKey",t),e("change",t)},lang:null==i?void 0:i.lang}}}),IM={class:"vc-colorpicker--container"},PM={key:0,class:"vc-colorpicker--tabs"},TM={class:"vc-colorpicker--tabs__inner"},kM={class:"vc-btn__content"},DM={class:"vc-btn__content"};const MM=aD(EM,[["render",function(t,e,n,i,r,o){var s,a;return tt(),et("div",{class:bt(["vc-colorpicker",t.theme])},[rt("div",IM,[t.showTab?(tt(),et("div",PM,[rt("div",TM,[rt("div",{class:bt(["vc-colorpicker--tabs__btn",{"vc-btn-active":"pure"===t.state.activeKey}]),onClick:e[0]||(e[0]=e=>t.onActiveKeyChange("pure"))},[rt("button",null,[rt("div",kM,ot(null==(s=t.lang)?void 0:s.pure),1)])],2),rt("div",{class:bt(["vc-colorpicker--tabs__btn",{"vc-btn-active":"gradient"===t.state.activeKey}]),onClick:e[1]||(e[1]=e=>t.onActiveKeyChange("gradient"))},[rt("button",null,[rt("div",DM,ot(null==(a=t.lang)?void 0:a.gradient),1)])],2),rt("div",{class:"vc-colorpicker--tabs__bg",style:Ct({width:"50%",left:`calc(${"gradient"===t.state.activeKey?50:0}%)`})},null,4)])])):It("",!0),zt(t.$slots,"default",{},void 0,!0)])],2)}],["__scopeId","data-v-0492277d"]]),LM={En:{start:"Start",end:"End",pure:"Pure",gradient:"Gradient",linear:"linear",radial:"radial"},"ZH-cn":{start:"开始",end:"结束",pure:"纯色",gradient:"渐变",linear:"线性",radial:"径向"}},RM={isWidget:RS.bool.def(!1),pickerType:RS.oneOf(["fk","chrome"]).def("fk"),shape:RS.oneOf(["circle","square"]).def("square"),pureColor:{type:[String,Object],default:"#000000"},gradientColor:RS.string.def("linear-gradient(90deg, rgba(255, 255, 255, 1) 0%, rgba(0, 0, 0, 1) 100%)"),format:{type:String,default:"rgb"},disableAlpha:RS.bool.def(!1),disableHistory:RS.bool.def(!1),roundHistory:RS.bool.def(!1),useType:RS.oneOf(["pure","gradient","both"]).def("pure"),activeKey:RS.oneOf(["pure","gradient"]).def("pure"),lang:{type:String,default:"ZH-cn"},zIndex:RS.number.def(9999),pickerContainer:{type:[String,HTMLElement],default:"body"},debounce:RS.number.def(100),theme:RS.oneOf(["white","black"]).def("white"),blurClose:RS.bool.def(!1),defaultPopup:RS.bool.def(!1)},OM=J({name:"ColorPicker",components:{FkColorPicker:qD,ChromeColorPicker:eM,GradientColorPicker:SM,WrapContainer:MM},inheritAttrs:!1,props:RM,emits:["update:pureColor","pureColorChange","update:gradientColor","gradientColorChange","update:activeKey","activeKeyChange"],setup(t,{emit:e}){Dt(nM,{lang:mt((()=>LM[t.lang||"ZH-cn"]))});const n=!!Mt().extra,i=yt({pureColor:t.pureColor||"",activeKey:"gradient"===t.useType?"gradient":t.activeKey,isAdvanceMode:!1}),r=new iD("#000"),o=new iD("#000"),s=new iD(i.pureColor),a=yt({startColor:r,endColor:o,startColorStop:0,endColorStop:100,angle:0,type:"linear",gradientColor:t.gradientColor}),l=ct(s),u=ct(t.defaultPopup),h=ct(null),c=ct(null);let d=null;const p=mt((()=>({background:"gradient"!==i.activeKey?ab(i.pureColor).toRgbString():a.gradientColor}))),f=mt((()=>"gradient"===i.activeKey?SM.name:"fk"===t.pickerType?qD.name:eM.name)),g=t=>{i.isAdvanceMode=t},m=mt((()=>{const e={disableAlpha:t.disableAlpha,disableHistory:t.disableHistory,roundHistory:t.roundHistory,pickerType:t.pickerType};return"gradient"===i.activeKey?{...e,startColor:a.startColor,endColor:a.endColor,angle:a.angle,type:a.type,startColorStop:a.startColorStop,endColorStop:a.endColorStop,onStartColorChange:t=>{a.startColor=t,w()},onEndColorChange:t=>{a.endColor=t,w()},onStartColorStopChange:t=>{a.startColorStop=t,w()},onEndColorStopChange:t=>{a.endColorStop=t,w()},onAngleChange:t=>{a.angle=t,w()},onTypeChange:t=>{a.type=t,w()},onAdvanceChange:g}:{...e,disableAlpha:t.disableAlpha,disableHistory:t.disableHistory,roundHistory:t.roundHistory,color:l.value,onChange:C,onAdvanceChange:g}})),_=()=>{u.value=!1},y=Bx((()=>{!t.isWidget&&t.blurClose&&_()}),100);!function(t,e,n={}){const{window:i=Hx,ignore:r=[],capture:o=!0,detectIframe:s=!1}=n;if(!i)return Rx;Ox&&!Ux&&(Ux=!0,Array.from(i.document.body.children).forEach((t=>t.addEventListener("click",Rx))),i.document.documentElement.addEventListener("click",Rx));let a=!0;const l=t=>r.some((e=>{if("string"==typeof e)return Array.from(i.document.querySelectorAll(e)).some((e=>e===t.target||t.composedPath().includes(e)));{const n=Vx(e);return n&&(t.target===n||t.composedPath().includes(n))}})),u=[Xx(i,"click",(n=>{const i=Vx(t);i&&i!==n.target&&!n.composedPath().includes(i)&&(0===n.detail&&(a=!l(n)),a?e(n):a=!0)}),{passive:!0,capture:o}),Xx(i,"pointerdown",(e=>{const n=Vx(t);a=!l(e)&&!(!n||e.composedPath().includes(n))}),{passive:!0}),s&&Xx(i,"blur",(n=>{setTimeout((()=>{var r;const o=Vx(t);"IFRAME"!==(null==(r=i.document.activeElement)?void 0:r.tagName)||(null==o?void 0:o.contains(i.document.activeElement))||e(n)}),0)}))].filter(Boolean)}(c,(()=>{_()}));const v=()=>{var t,e,n,i;try{const[r]=Gb(a.gradientColor);if(r&&r.type.includes("gradient")&&r.colorStops.length>=2){const o=r.colorStops[0],s=r.colorStops[1];a.startColorStop=Number(null==(t=o.length)?void 0:t.value)||0,a.endColorStop=Number(null==(e=s.length)?void 0:e.value)||0,"linear-gradient"===r.type&&"angular"===(null==(n=r.orientation)?void 0:n.type)&&(a.angle=Number(null==(i=r.orientation)?void 0:i.value)||0),a.type=r.type.split("-")[0];const[l,u,h,c]=o.value,[d,p,f,g]=s.value;a.startColor=new iD({r:Number(l),g:Number(u),b:Number(h),a:Number(c)}),a.endColor=new iD({r:Number(d),g:Number(p),b:Number(f),a:Number(g)})}}catch(r){}},w=Bx((()=>{const t=x();try{a.gradientColor=Nb(t),e("update:gradientColor",a.gradientColor),e("gradientColorChange",a.gradientColor)}catch(Vj){}}),t.debounce),x=()=>{const t=[],e=a.startColor.RGB.map((t=>t.toString())),n=a.endColor.RGB.map((t=>t.toString())),i=[{type:"rgba",value:[e[0],e[1],e[2],e[3]],length:{value:a.startColorStop+"",type:"%"}},{type:"rgba",value:[n[0],n[1],n[2],n[3]],length:{value:a.endColorStop+"",type:"%"}}];return"linear"===a.type?t.push({type:"linear-gradient",orientation:{type:"angular",value:a.angle+""},colorStops:i}):"radial"===a.type&&t.push({type:"radial-gradient",orientation:[{type:"shape",value:"circle"}],colorStops:i}),t},b=()=>{h.value&&c.value&&(d=QC(h.value,c.value,{placement:"auto",modifiers:[{name:"offset",options:{offset:[0,8]}},{name:"flip",options:{allowedAutoPlacements:["top","bottom","left","right"],rootBoundary:"viewport"}}]}))},C=e=>{l.value=e,i.pureColor=e.toString(t.format),S()},S=Bx((()=>{e("update:pureColor",i.pureColor),e("pureColorChange",i.pureColor)}),t.debounce);return Gx((()=>{v(),d||b()})),Nx((()=>t.gradientColor),(t=>{t!=a.gradientColor&&(a.gradientColor=t)})),Nx((()=>a.gradientColor),(()=>{v()})),Nx((()=>t.activeKey),(t=>{i.activeKey=t})),Nx((()=>t.useType),(t=>{"gradient"!==i.activeKey&&"gradient"===t?i.activeKey="gradient":i.activeKey="pure"})),Nx((()=>t.pureColor),(t=>{ab.equals(t,i.pureColor)||(i.pureColor=t,l.value=new iD(t))}),{deep:!0}),{colorCubeRef:h,pickerRef:c,showPicker:u,colorInstance:l,getBgColorStyle:p,getComponentName:f,getBindArgs:m,state:i,hasExtra:n,onColorChange:C,onShowPicker:()=>{u.value=!0,d?d.update():b()},onActiveKeyChange:t=>{i.activeKey=t,e("update:activeKey",t),e("activeKeyChange",t)},onAutoClose:y}}}),FM={key:0,class:"vc-color-extra"},AM={key:0,class:"vc-color-extra"};const zM=aD(OM,[["render",function(t,e,n,i,r,o){const s=Lt("WrapContainer");return tt(),et(St,null,[t.isWidget?(tt(),Rt(s,{key:0,"active-key":t.state.activeKey,"onUpdate:activeKey":e[0]||(e[0]=e=>t.state.activeKey=e),"show-tab":"both"===t.useType,style:Ct({zIndex:t.zIndex}),theme:t.theme,onChange:t.onActiveKeyChange},{default:Ot((()=>[(tt(),Rt(Ft(t.getComponentName),At({key:t.getComponentName},t.getBindArgs),null,16)),t.hasExtra?(tt(),et("div",FM,[zt(t.$slots,"extra",{},void 0,!0)])):It("",!0)])),_:3},8,["active-key","show-tab","style","theme","onChange"])):It("",!0),t.isWidget?It("",!0):(tt(),et(St,{key:1},[rt("div",{class:bt(["vc-color-wrap transparent",{round:"circle"===t.shape}]),ref:"colorCubeRef"},[rt("div",{class:"current-color",style:Ct(t.getBgColorStyle),onClick:e[1]||(e[1]=(...e)=>t.onShowPicker&&t.onShowPicker(...e))},null,4)],2),(tt(),Rt(jt,{to:t.pickerContainer},[Pt(rt("div",{ref:"pickerRef",style:Ct({zIndex:t.zIndex}),onMouseleave:e[3]||(e[3]=(...e)=>t.onAutoClose&&t.onAutoClose(...e))},[t.showPicker?(tt(),Rt(s,{key:0,"show-tab":"both"===t.useType&&!t.state.isAdvanceMode,theme:t.theme,"active-key":t.state.activeKey,"onUpdate:activeKey":e[2]||(e[2]=e=>t.state.activeKey=e),onChange:t.onActiveKeyChange},{default:Ot((()=>[(tt(),Rt(Ft(t.getComponentName),At({key:t.getComponentName},t.getBindArgs),null,16)),t.hasExtra?(tt(),et("div",AM,[zt(t.$slots,"extra",{},void 0,!0)])):It("",!0)])),_:3},8,["show-tab","theme","active-key","onChange"])):It("",!0)],36),[[Bt,t.showPicker]])],8,["to"]))],64))],64)}],["__scopeId","data-v-354ca836"]]),BM={class:"col_nw_fs_fs props_nvu_container"},jM={class:"row_nw_fs_center props_nvu_box"},GM={class:"row_nw_fs_center label_title"},NM={class:"row_nw_fs_center input_box"},VM={key:0,class:"row_nw_fs_center props_des_box"},HM=J({__name:"NameValueUnit",props:{label:{type:String,default:"属性"},isShowDescribe:{type:Boolean,default:!0},initValue:{type:Object,default:()=>({})}},emits:["onInput","onBlur"],setup(t,{emit:e}){const n=e,i=t;at((()=>{i.initValue&&i.initValue.name&&(r.name=i.initValue.name,r.values=i.initValue.values,r.units=i.initValue.units,r.describe=i.initValue.describe)}));const r=yt({name:"",values:0,units:"",describe:""});function o(){r.name&&r.units&&n("onInput",{name:r.name,values:r.values,units:r.units,describe:r.describe})}function s(){r.name&&r.units&&n("onBlur",{name:r.name,values:r.values,units:r.units,describe:r.describe})}return(e,n)=>(tt(),et("div",BM,[rt("div",jM,[rt("div",GM,ot(t.label),1),rt("div",NM,[Pt(rt("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>r.name=t),class:"row_nw_fs_center input_cls",type:"text",placeholder:"名称",onInput:o,onBlur:s},null,544),[[Tt,r.name]]),Pt(rt("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>r.values=t),class:"row_nw_fs_center input_cls",type:"number",placeholder:"值",onInput:o,onBlur:s},null,544),[[Tt,r.values]]),Pt(rt("input",{"onUpdate:modelValue":n[2]||(n[2]=t=>r.units=t),class:"row_nw_fs_center input_cls",type:"text",placeholder:"单位",onInput:o,onBlur:s},null,544),[[Tt,r.units]])])]),t.isShowDescribe?(tt(),et("div",VM,[Pt(rt("textarea",{"onUpdate:modelValue":n[3]||(n[3]=t=>r.describe=t),class:"row_nw_fs_center text_cls",placeholder:"描述",onInput:o,onBlur:s},null,544),[[Tt,r.describe]])])):It("",!0)]))}}),WM=Q(HM,[["__scopeId","data-v-ec0ced47"]]),XM={class:"col_nw_fs_fs props_nvu_container"},UM={class:"row_nw_fs_center props_nvu_box"},$M={class:"row_nw_fs_center label_title"},YM={class:"row_nw_fs_center input_box"},qM={class:"row_nw_fs_center props_des_box"},ZM=J({__name:"NameValues",props:{label:{type:String,default:"属性"},initValue:{type:Object,default:()=>({})}},emits:["onInput","onBlur"],setup(t,{emit:e}){const n=e,i=t;at((()=>{i.initValue&&i.initValue.name&&(r.name=i.initValue.name,r.values=i.initValue.values)}));const r=yt({name:"",values:""});function o(){r.name&&r.values&&n("onInput",{name:r.name,values:r.values})}function s(){r.name&&r.values&&n("onBlur",{name:r.name,values:r.values})}return(e,n)=>(tt(),et("div",XM,[rt("div",UM,[rt("div",$M,ot(t.label),1),rt("div",YM,[Pt(rt("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>r.name=t),class:"row_nw_fs_center input_cls",type:"text",placeholder:"名称",onInput:o,onBlur:s},null,544),[[Tt,r.name]])])]),rt("div",qM,[Pt(rt("textarea",{"onUpdate:modelValue":n[1]||(n[1]=t=>r.values=t),class:"row_nw_fs_center text_cls",placeholder:"值",onInput:o,onBlur:s},null,544),[[Tt,r.values]])])]))}}),KM=Q(ZM,[["__scopeId","data-v-3fbfdb41"]]),JM=t=>(nt("data-v-8c06ddd0"),t=t(),it(),t),QM=["id"],tL={class:"panel_dbox"},eL=JM((()=>rt("div",{class:"row_nw_fs_center title_box"},"请编辑属性",-1))),nL={class:"col_nw_fs_fs panel_wraper"},iL={class:"row_nw_fs_center info_box"},rL=JM((()=>rt("div",{class:"row_nw_fs_center info_box_label"},"图形ID",-1))),oL={class:"row_nw_fs_center info_box_value"},sL={class:"row_nw_fs_center name_box"},aL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"名称",-1))),lL=JM((()=>rt("div",{class:"line_gap"},null,-1))),uL={class:"row_nw_fs_center name_box"},hL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线宽",-1))),cL={class:"row_nw_fs_center name_box"},dL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形虚线",-1))),pL=JM((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),fL={class:"row_nw_fs_center name_box"},gL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线色",-1))),mL={class:"row_nw_fs_center name_box"},_L=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形填充",-1))),yL={class:"row_nw_fs_center name_box"},vL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点文字",-1))),wL=JM((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),xL={class:"row_nw_fs_center name_box"},bL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点颜色",-1))),CL={class:"row_nw_fs_center name_box"},SL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点填充",-1))),EL={class:"row_nw_fs_center name_box"},IL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段文字",-1))),PL=JM((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),TL={class:"row_nw_fs_center name_box"},kL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段颜色",-1))),DL={class:"row_nw_fs_center name_box"},ML=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段填充",-1))),LL={class:"row_nw_fs_center name_box"},RL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签文字",-1))),OL=JM((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),FL={class:"row_nw_fs_center name_box"},AL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签颜色",-1))),zL={class:"row_nw_fs_center name_box"},BL=JM((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签填充",-1))),jL=JM((()=>rt("div",{class:"line_gap"},null,-1))),GL={class:"col_nw_fs_center pros_box"},NL={class:"row_nw_fe_center props_action_box"},VL=["onClick"],HL=["onClick"],WL=JM((()=>rt("div",{class:"line_gap"},null,-1))),XL={class:"col_nw_fs_center pros_box"},UL={class:"row_nw_fe_center props_action_box"},$L=["onClick"],YL=["onClick"],qL=JM((()=>rt("div",{class:"line_gap"},null,-1))),ZL={class:"row_nw_fs_center prop_json_box"},KL=JM((()=>rt("div",{class:"row_nw_fs_fs prop_json_label"},"JSON",-1))),JL={key:0,class:"prop_text_err_tips"},QL=JM((()=>rt("div",{class:"line_gap"},null,-1))),tR=J({__name:"DrawPolygonPropsPanel",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({})}},setup(t){const e=t;at((()=>{!function(){if(e.vNodeData&&e.vNodeData.data){const t=e.vNodeData.data;if(t.geojson){const e=t.geojson;if(e.properties){const t=e.properties;if(t.editProps){const e=t.editProps;if(e){const t=e.name;t?(n.name=t,i.name=t):r();const l=e.attributes;if(l){const t=l.properties;if(t&&t.length){const e=[],r=[];for(let n=0;n<t.length;n++)e.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[n]}}),r.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[n]}});n.attributes.properties=e,i.attributes.properties=r}else o();const e=l.keyValues;if(e&&e.length){const t=[],r=[];for(let n=0;n<e.length;n++)t.push({id:Yt(7),label:"属性",values:{...e[n]}}),r.push({id:Yt(7),label:"属性",values:{...e[n]}});n.attributes.keyValues=t,i.attributes.keyValues=r}else s();const r=l.json;try{const t=JSON.stringify(r);n.attributes.json=t,i.attributes.json=t}catch(Hj){a()}}else o(),s(),a()}else r(),o(),s(),a()}else r(),o(),s(),a();if(t.style){const e=t.style;e.geo&&(n.style.geo={...e.geo},i.style.geo={...e.geo}),e.vertex&&(n.style.vertex={...e.vertex},i.style.vertex={...e.vertex}),e.line&&(n.style.line={...e.line},i.style.line={...e.line}),e.label&&(n.style.label={...e.label},i.style.label={...e.label})}}else r(),o(),s(),a()}else r(),o(),s(),a()}else r(),o(),s(),a()}()}));const n=yt({name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""},isNotValidJson:!1});let i={name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""}};function r(){n.name="",i.name=""}function o(){n.attributes.properties.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}function s(){n.attributes.keyValues.push({id:Yt(7),label:"属性",values:{}})}function a(){n.attributes.json="",i.attributes.json=""}const l=()=>{if(n.attributes.json){try{const t=JSON.parse(n.attributes.json);if("object"==typeof t)return n.isNotValidJson=!1,t}catch(Hj){return n.isNotValidJson=!0,{}}return n.isNotValidJson=!0,{}}return n.isNotValidJson=!1,{}};const u=()=>{e&&e.vNodeData.cancelCb(i)},h=()=>{e&&e.vNodeData.cancelCb(i)},c=()=>{e&&e.vNodeData.updateCb(n)},d=()=>{if(!n.isNotValidJson){const t=function(){const t={name:n.name,attributes:{properties:[],keyValues:[],json:{}},style:Ow.cloneDeep(n.style)};if(n.attributes.properties.forEach((e=>{e.values&&e.values.name&&e.values.units&&t.attributes.properties.push({...e.values})})),n.attributes.keyValues.forEach((e=>{e.values&&e.values.name&&t.attributes.keyValues.push({...e.values})})),n.attributes.json){const e=l();t.attributes.json=e}return t}();e&&e.vNodeData.confirmCb(t)}};return(e,i)=>(tt(),et("div",{id:t.id,class:"col_nw_fs_fs panel_container"},[rt("div",{class:"panel_mask",onClick:u}),rt("div",tL,[rt("div",{class:"row_nw_fs_center close_icon",onClick:u},"X"),eL,rt("div",nL,[rt("div",iL,[rL,rt("div",oL,ot(t.vNodeData.data.id),1)]),rt("div",sL,[aL,Pt(rt("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>n.name=t),class:"row_nw_fs_center name_box_input",type:"text",placeholder:"名称"},null,512),[[Tt,n.name]])]),lL,rt("div",uL,[hL,Pt(rt("input",{"onUpdate:modelValue":i[1]||(i[1]=t=>n.style.geo.width=t),class:"row_nw_fs_center name_box_input",type:"number",placeholder:"名称",onBlur:c},null,544),[[Tt,n.style.geo.width]])]),rt("div",cL,[dL,Pt(rt("input",{"onUpdate:modelValue":i[2]||(i[2]=t=>n.style.geo.lineDash[0]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线长度",onBlur:c},null,544),[[Tt,n.style.geo.lineDash[0]]]),Pt(rt("input",{"onUpdate:modelValue":i[3]||(i[3]=t=>n.style.geo.lineDash[1]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线间隔",onBlur:c},null,544),[[Tt,n.style.geo.lineDash[1]]]),pL]),rt("div",fL,[gL,xt(gt(zM),{pureColor:n.style.geo.color,"onUpdate:pureColor":i[4]||(i[4]=t=>n.style.geo.color=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",mL,[_L,xt(gt(zM),{pureColor:n.style.geo.fillColor,"onUpdate:pureColor":i[5]||(i[5]=t=>n.style.geo.fillColor=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",yL,[vL,Pt(rt("input",{"onUpdate:modelValue":i[6]||(i[6]=t=>n.style.vertex.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:c},null,544),[[Tt,n.style.vertex.fontSize]]),wL]),rt("div",xL,[bL,xt(gt(zM),{pureColor:n.style.vertex.color,"onUpdate:pureColor":i[7]||(i[7]=t=>n.style.vertex.color=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",CL,[SL,xt(gt(zM),{pureColor:n.style.vertex.fillColor,"onUpdate:pureColor":i[8]||(i[8]=t=>n.style.vertex.fillColor=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",EL,[IL,Pt(rt("input",{"onUpdate:modelValue":i[9]||(i[9]=t=>n.style.line.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:c},null,544),[[Tt,n.style.line.fontSize]]),PL]),rt("div",TL,[kL,xt(gt(zM),{pureColor:n.style.line.color,"onUpdate:pureColor":i[10]||(i[10]=t=>n.style.line.color=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",DL,[ML,xt(gt(zM),{pureColor:n.style.line.fillColor,"onUpdate:pureColor":i[11]||(i[11]=t=>n.style.line.fillColor=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",LL,[RL,Pt(rt("input",{"onUpdate:modelValue":i[12]||(i[12]=t=>n.style.label.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:c},null,544),[[Tt,n.style.label.fontSize]]),OL]),rt("div",FL,[AL,xt(gt(zM),{pureColor:n.style.label.color,"onUpdate:pureColor":i[13]||(i[13]=t=>n.style.label.color=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),rt("div",zL,[BL,xt(gt(zM),{pureColor:n.style.label.fillColor,"onUpdate:pureColor":i[14]||(i[14]=t=>n.style.label.fillColor=t),format:"rgb",onPureColorChange:c},null,8,["pureColor"])]),jL,rt("div",GL,[(tt(!0),et(St,null,Et(n.attributes.properties,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(WM,{label:t.label,isShowDescribe:t.isShowDescribe,initValue:t.values,onOnBlur:t=>((t,e)=>{n.attributes.properties[t].values=e})(e,t)},null,8,["label","isShowDescribe","initValue","onOnBlur"]),rt("div",NL,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){n.attributes.properties.length>=2&&t<n.attributes.properties.length&&n.attributes.properties.splice(t,1)}(e)},"-",8,VL),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){n.attributes.properties.length&&n.attributes.properties.splice(t+1,0,{id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}(e)},"+",8,HL)])])))),128))]),WL,rt("div",XL,[(tt(!0),et(St,null,Et(n.attributes.keyValues,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(KM,{label:t.label,initValue:t.values,onOnBlur:t=>((t,e)=>{n.attributes.keyValues[t].values=e})(e,t)},null,8,["label","initValue","onOnBlur"]),rt("div",UL,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){n.attributes.keyValues.length>=2&&t<n.attributes.keyValues.length&&n.attributes.keyValues.splice(t,1)}(e)},"-",8,$L),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){n.attributes.keyValues.length&&n.attributes.keyValues.splice(t+1,0,{id:Yt(7),label:"属性",values:{}})}(e)},"+",8,YL)])])))),128))]),qL,rt("div",ZL,[KL,Pt(rt("textarea",{"onUpdate:modelValue":i[15]||(i[15]=t=>n.attributes.json=t),class:bt(["row_nw_fs_center prop_text_cls",{prop_text_err_cls:n.isNotValidJson}]),placeholder:"JSON字符串",onBlur:l},null,34),[[Tt,n.attributes.json]])]),n.isNotValidJson?(tt(),et("div",JL,"JSON 字符串有误，请检查")):It("",!0)]),QL,rt("div",{class:"row_nw_center_center action_box"},[rt("div",{class:"row_nw_center_center info_del",onClick:h},"取消"),rt("div",{class:"row_nw_center_center info_confirm",onClick:d},"完成")])])],8,QM))}}),eR=Q(tR,[["__scopeId","data-v-8c06ddd0"]]),nR={class:"row_nw_fs_center label_input_containner"},iR={class:"row_nw_fs_fs label_input_wraper"},rR={class:"row_nw_fs_center label_title"},oR={class:"row_nw_fs_center input_box"},sR=["id","name","value"],aR=["for"],lR=J({__name:"RadioSingleInput",props:{titleLabel:{type:String,default:"图案类型"},isRefresh:{type:Number,default:0},radioOptions:{type:Object,default:()=>({name:"imagingMode",options:[{id:"pattern",value:"pattern",title:"图案"},{id:"icons",value:"icons",title:"icons"}]})},initValue:{type:String,default:"pattern"}},emits:["onInput"],setup(t,{emit:e}){const n=e,i=t,r=ct(i.initValue);function o(){r.value=i.initValue}function s(){n("onInput",r.value)}return ut((()=>i.isRefresh),(()=>{o()})),at((()=>{o()})),(e,n)=>(tt(),et("div",nR,[rt("div",iR,[rt("div",rR,ot(t.titleLabel),1),rt("div",oR,[(tt(!0),et(St,null,Et(t.radioOptions.options,((e,i)=>(tt(),et("div",{key:"radio_"+i,class:"row_nw_fs_center radio_content"},[Pt(rt("input",{id:e.id,"onUpdate:modelValue":n[0]||(n[0]=t=>r.value=t),class:"radio_input",type:"radio",name:t.radioOptions.name,value:e.value,onChange:s},null,40,sR),[[Gt,r.value]]),rt("label",{for:e.id,class:"radio_label"},[rt("span",{class:bt(["radio_span",{radio_span_checked:e.value===r.value}])},null,2),kt(" "+ot(e.title),1)],8,aR)])))),128))])])]))}}),uR=Q(lR,[["__scopeId","data-v-a9af1aae"]]),hR={class:"row_nw_fs_center label_input_containner"},cR={class:"row_nw_fs_fs label_input_wraper"},dR={class:"row_nw_fs_center label_title"},pR={class:"row_nw_fs_center input_box"},fR=["id","name","value"],gR=["for"],mR=["src"],_R=J({__name:"RadioImageInput",props:{titleLabel:{type:String,default:"图案类型"},isRefresh:{type:Number,default:0},radioOptions:{type:Object,default:()=>({name:"imagingMode",options:[{id:"pattern",value:"pattern",title:"图案",image:""}]})},initValue:{type:String,default:"pattern"}},emits:["onInput"],setup(t,{emit:e}){const n=e,i=t,r=ct(i.initValue);function o(){r.value=i.initValue}function s(){n("onInput",r.value)}return ut((()=>i.isRefresh),(()=>{o()})),at((()=>{o()})),(e,n)=>(tt(),et("div",hR,[rt("div",cR,[rt("div",dR,ot(t.titleLabel),1),rt("div",pR,[(tt(!0),et(St,null,Et(t.radioOptions.options,((e,i)=>(tt(),et("div",{key:"radio_"+i,class:"col_nw_fs_center radio_content"},[Pt(rt("input",{id:e.id,"onUpdate:modelValue":n[0]||(n[0]=t=>r.value=t),class:"radio_input",type:"radio",name:t.radioOptions.name,value:e.value,onChange:s},null,40,fR),[[Gt,r.value]]),rt("label",{for:e.id,class:bt(["radio_label",{radio_label_checked:e.value===r.value}])},[rt("img",{src:e.image,class:bt(["radio_span",{radio_span_checked:e.value===r.value}])},null,10,mR),kt(" "+ot(e.title),1)],10,gR)])))),128))])])]))}}),yR=Q(_R,[["__scopeId","data-v-e1be51fc"]]),vR=""+new URL("airborne-_LEuutXQ.svg",import.meta.url).href,wR=""+new URL("bioregions-7k6OuNE1.svg",import.meta.url).href,xR=""+new URL("biota-OGT6eqWc.svg",import.meta.url).href,bR=""+new URL("cadastre-Zw2aI6Op.svg",import.meta.url).href,CR=""+new URL("coins-os-vFRav.svg",import.meta.url).href,SR=""+new URL("conservation-EJ97taRp.svg",import.meta.url).href,ER=""+new URL("coordinates-hUf9mOOe.svg",import.meta.url).href,IR=""+new URL("earth-8E6MHthW.svg",import.meta.url).href,PR=""+new URL("elevation-lQ5LLfcs.svg",import.meta.url).href,TR=""+new URL("energy-jB-4g1H5.svg",import.meta.url).href,kR=""+new URL("environment-vrHZiVeS.svg",import.meta.url).href,DR=""+new URL("flag-R_iW0qx7.svg",import.meta.url).href,MR=""+new URL("geocat-adBhou9Y.svg",import.meta.url).href,LR=""+new URL("geology-Ige5TzaK.svg",import.meta.url).href,RR=""+new URL("geonames-omIcF4oc.svg",import.meta.url).href,OR=""+new URL("geonetwork-fD-FZtXy.svg",import.meta.url).href,FR=""+new URL("health-_ABvJifZ.svg",import.meta.url).href,AR=""+new URL("inlandwaters-CCf0TQVr.svg",import.meta.url).href,zR=""+new URL("landcover-J_RpeTqt.svg",import.meta.url).href,BR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2016.0.0,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='512px'%20height='512px'%20viewBox='-247%20-247%20512%20512'%20enable-background='new%20-247%20-247%20512%20512'%20xml:space='preserve'%3e%3cpath%20fill='%23FFFFFF'%20d='M169,51.295h-0.098C189.176,20.858,201-15.688,201-55c0-106.038-85.963-192-192-192%20c-106.038,0-192,85.961-192,192c0,41.196,12.98,79.357,35.065,110.629l130.278,195.028c0.079,0.12,0.158,0.239,0.238,0.357%20l0.114,0.171h0.007c5.772,8.33,15.395,13.79,26.297,13.79s20.524-5.46,26.296-13.79h0.008l0.116-0.174%20c0.076-0.112,0.151-0.226,0.227-0.338L169,51.295z%20M9-150.999c53.019,0,96,42.98,96,96c0,53.018-42.981,96-96,96%20c-53.019,0-96-42.981-96-96C-87-108.019-44.019-150.999,9-150.999z'%20/%3e%3c/svg%3e",jR=""+new URL("military-q46Pd_aW.svg",import.meta.url).href,GR=""+new URL("oceans-Bv3PmQc2.svg",import.meta.url).href,NR=""+new URL("passengers-9ERqibB-.svg",import.meta.url).href,VR=""+new URL("restricted-oGZsq3Bp.svg",import.meta.url).href,HR=""+new URL("society-xAUKgyhI.svg",import.meta.url).href,WR=""+new URL("structure-jIHTc3MW.svg",import.meta.url).href,XR=""+new URL("tractor-U9uiPxht.svg",import.meta.url).href,UR=""+new URL("transportation-6XgTplYj.svg",import.meta.url).href,$R=""+new URL("utilities-yd0KIylc.svg",import.meta.url).href,YR=""+new URL("water-ilxK8-39.svg",import.meta.url).href,qR=""+new URL("weather-3t-hCFBc.svg",import.meta.url).href,ZR=t=>(nt("data-v-c395b59a"),t=t(),it(),t),KR=["id"],JR={class:"panel_dbox"},QR=ZR((()=>rt("div",{class:"row_nw_fs_center title_box"},"请编辑属性",-1))),tO={class:"col_nw_fs_fs panel_wraper"},eO={class:"row_nw_fs_center info_box"},nO=ZR((()=>rt("div",{class:"row_nw_fs_center info_box_label"},"图形ID",-1))),iO={class:"row_nw_fs_center info_box_value"},rO={class:"row_nw_fs_center name_box"},oO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"名称",-1))),sO=ZR((()=>rt("div",{class:"line_gap"},null,-1))),aO={class:"row_nw_fs_center"},lO={key:0,class:"col_nw_fs_fs pattern_box"},uO={key:1,class:"row_nw_fs_center pattern_box"},hO={class:"row_nw_fs_center name_box"},cO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线宽",-1))),dO={class:"row_nw_fs_center name_box"},pO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形虚线",-1))),fO=ZR((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),gO={class:"row_nw_fs_center name_box"},mO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形宽高",-1))),_O=ZR((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),yO={class:"row_nw_fs_center name_box"},vO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"箭头偏移",-1))),wO=ZR((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),xO={class:"row_nw_fs_center name_box"},bO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"箭头锚点",-1))),CO=ZR((()=>rt("div",{class:"row_nw_center_center fs_label"}," 分",-1))),SO={class:"row_nw_fs_center name_box"},EO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线色",-1))),IO={class:"row_nw_fs_center name_box"},PO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形填充",-1))),TO={class:"row_nw_fs_center name_box"},kO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点文字",-1))),DO=ZR((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),MO={class:"row_nw_fs_center name_box"},LO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点颜色",-1))),RO={class:"row_nw_fs_center name_box"},OO=ZR((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点填充",-1))),FO=ZR((()=>rt("div",{class:"line_gap"},null,-1))),AO={class:"col_nw_fs_center pros_box"},zO={class:"row_nw_fe_center props_action_box"},BO=["onClick"],jO=["onClick"],GO=ZR((()=>rt("div",{class:"line_gap"},null,-1))),NO={class:"col_nw_fs_center pros_box"},VO={class:"row_nw_fe_center props_action_box"},HO=["onClick"],WO=["onClick"],XO=ZR((()=>rt("div",{class:"line_gap"},null,-1))),UO={class:"row_nw_fs_center prop_json_box"},$O=ZR((()=>rt("div",{class:"row_nw_fs_fs prop_json_label"},"JSON",-1))),YO={key:2,class:"prop_text_err_tips"},qO=ZR((()=>rt("div",{class:"line_gap"},null,-1))),ZO=Q(J({__name:"DrawPointPropsPanel",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({})}},setup(t){const e={airborne:vR,bioregions:wR,biota:xR,cadastre:bR,coins:CR,conservation:SR,coordinates:ER,earth:IR,elevation:PR,energy:TR,environment:kR,flag:DR,geocat:MR,geology:LR,geonames:RR,geonetwork:OR,health:FR,inlandwaters:AR,landcover:zR,location:BR,military:jR,oceans:GR,passengers:NR,restricted:VR,society:HR,structure:WR,tractor:XR,transportation:UR,utilities:$R,water:YR,weather:qR},n={name:"patternOptions",options:[{id:"circle",value:"circle",title:"圆形"},{id:"square",value:"square",title:"正方形"},{id:"rectangle",value:"rectangle",title:"矩形"},{id:"triangle",value:"triangle",title:"三角形"},{id:"star",value:"star",title:"星形"},{id:"cross",value:"cross",title:"十字"},{id:"x",value:"x",title:"X"}]},i={name:"imageIconsOptions",options:[{id:"airborne",value:"airborne",title:"airborne",image:vR},{id:"bioregions",value:"bioregions",title:"bioregions",image:wR},{id:"biota",value:"biota",title:"biota",image:xR},{id:"cadastre",value:"cadastre",title:"cadastre",image:bR},{id:"coins",value:"coins",title:"coins",image:CR},{id:"conservation",value:"conservation",title:"conservation",image:SR},{id:"coordinates",value:"coordinates",title:"coordinates",image:ER},{id:"earth",value:"earth",title:"earth",image:IR},{id:"elevation",value:"elevation",title:"elevation",image:PR},{id:"energy",value:"energy",title:"energy",image:TR},{id:"environment",value:"environment",title:"environment",image:kR},{id:"flag",value:"flag",title:"flag",image:DR},{id:"geocat",value:"geocat",title:"geocat",image:MR},{id:"geology",value:"geology",title:"geology",image:LR},{id:"geonames",value:"geonames",title:"geonames",image:RR},{id:"geonetwork",value:"geonetwork",title:"geonetwork",image:OR},{id:"health",value:"health",title:"health",image:FR},{id:"inlandwaters",value:"inlandwaters",title:"inlandwaters",image:AR},{id:"landcover",value:"landcover",title:"landcover",image:zR},{id:"location",value:"location",title:"location",image:BR},{id:"military",value:"military",title:"military",image:jR},{id:"oceans",value:"oceans",title:"oceans",image:GR},{id:"passengers",value:"passengers",title:"passengers",image:NR},{id:"restricted",value:"restricted",title:"restricted",image:VR},{id:"society",value:"society",title:"society",image:HR},{id:"structure",value:"structure",title:"structure",image:WR},{id:"tractor",value:"tractor",title:"tractor",image:XR},{id:"transportation",value:"transportation",title:"transportation",image:UR},{id:"utilities",value:"utilities",title:"utilities",image:$R},{id:"water",value:"water",title:"water",image:YR},{id:"weather",value:"weather",title:"weather",image:qR}]},r=t;at((()=>{!function(){if(r.vNodeData&&r.vNodeData.data){const t=r.vNodeData.data;if(t.geojson){const e=t.geojson;if(e.properties){const t=e.properties;if(t.editProps){const e=t.editProps;if(e){const t=e.name;t?(o.name=t,a.name=t):c();const n=e.attributes;if(n){const t=n.properties;if(t&&t.length){const e=[],n=[];for(let i=0;i<t.length;i++)e.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[i]}}),n.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[i]}});o.attributes.properties=e,a.attributes.properties=n}else d();const e=n.keyValues;if(e&&e.length){const t=[],n=[];for(let i=0;i<e.length;i++)t.push({id:Yt(7),label:"属性",values:{...e[i]}}),n.push({id:Yt(7),label:"属性",values:{...e[i]}});o.attributes.keyValues=t,a.attributes.keyValues=n}else p();const i=n.json;try{const t=JSON.stringify(i);o.attributes.json=t,a.attributes.json=t}catch(Hj){f()}}else d(),p(),f()}else c(),d(),p(),f()}else c(),d(),p(),f();if(t.style){const e=t.style;if(e.geo){if(o.style.geo={...e.geo},a.style.geo={...e.geo},"icons"==o.style.geo.iconPattern){const t=o.style.geo.iconUrl,e=o.style.geo.iconUrl;let n=t.split("/");if(n.length||(n=t.split("\\")),n.length){const t=n[n.length-1].split(".");t.length&&(o.style.geo.iconUrl=t[0])}setTimeout((()=>{o.style.geo.iconUrl=e}),100)}s.value=s.value+1}e.vertex&&(o.style.vertex={...e.vertex},a.style.vertex={...e.vertex}),e.line&&(o.style.line={...e.line},a.style.line={...e.line}),e.label&&(o.style.label={...e.label},a.style.label={...e.label})}}else c(),d(),p(),f()}else c(),d(),p(),f()}else c(),d(),p(),f()}()}));const o=yt({name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""},isNotValidJson:!1}),s=ct(0);let a={name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""}};function l(t){o.style&&o.style.geo&&(o.style.geo.iconPattern=t)}function u(t){o.style&&o.style.geo&&(o.style.geo.iconUrl=t,y())}function h(t){o.style&&o.style.geo&&(o.style.geo.iconUrl=e[t],y())}function c(){o.name="",a.name=""}function d(){o.attributes.properties.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}function p(){o.attributes.keyValues.push({id:Yt(7),label:"属性",values:{}})}function f(){o.attributes.json="",a.attributes.json=""}const g=()=>{if(o.attributes.json){try{const t=JSON.parse(o.attributes.json);if("object"==typeof t)return o.isNotValidJson=!1,t}catch(Hj){return o.isNotValidJson=!0,{}}return o.isNotValidJson=!0,{}}return o.isNotValidJson=!1,{}};const m=()=>{r&&r.vNodeData.cancelCb(a)},_=()=>{r&&r.vNodeData.cancelCb(a)},y=()=>{r&&r.vNodeData.updateCb(o)},v=()=>{if(!o.isNotValidJson){const t=function(){const t={name:o.name,attributes:{properties:[],keyValues:[],json:{}},style:Ow.cloneDeep(o.style)};if(o.attributes.properties.forEach((e=>{e.values&&e.values.name&&e.values.units&&t.attributes.properties.push({...e.values})})),o.attributes.keyValues.forEach((e=>{e.values&&e.values.name&&t.attributes.keyValues.push({...e.values})})),o.attributes.json){const e=g();t.attributes.json=e}return t}();r&&r.vNodeData.confirmCb(t)}};return(e,r)=>(tt(),et("div",{id:t.id,class:"col_nw_fs_fs panel_container"},[rt("div",{class:"panel_mask",onClick:m}),rt("div",JR,[rt("div",{class:"row_nw_fs_center close_icon",onClick:m},"X"),QR,rt("div",tO,[rt("div",eO,[nO,rt("div",iO,ot(t.vNodeData.data.id),1)]),rt("div",rO,[oO,Pt(rt("input",{"onUpdate:modelValue":r[0]||(r[0]=t=>o.name=t),class:"row_nw_fs_center name_box_input",type:"text",placeholder:"名称"},null,512),[[Tt,o.name]])]),sO,rt("div",aO,[xt(uR,{initValue:o.style.geo.iconPattern,isRefresh:s.value,onOnInput:l},null,8,["initValue","isRefresh"])]),"pattern"==o.style.geo.iconPattern?(tt(),et("div",lO,[xt(uR,{titleLabel:"图案",radioOptions:n,initValue:o.style.geo.iconUrl,isRefresh:s.value,onOnInput:u},null,8,["initValue","isRefresh"])])):(tt(),et("div",uO,[xt(yR,{titleLabel:"Icons",radioOptions:i,initValue:o.style.geo.iconUrl,isRefresh:s.value,onOnInput:h},null,8,["initValue","isRefresh"])])),rt("div",hO,[cO,Pt(rt("input",{"onUpdate:modelValue":r[1]||(r[1]=t=>o.style.geo.width=t),class:"row_nw_fs_center name_box_input",type:"number",placeholder:"名称",onBlur:y},null,544),[[Tt,o.style.geo.width]])]),rt("div",dO,[pO,Pt(rt("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>o.style.geo.lineDash[0]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线长度",onBlur:y},null,544),[[Tt,o.style.geo.lineDash[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[3]||(r[3]=t=>o.style.geo.lineDash[1]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线间隔",onBlur:y},null,544),[[Tt,o.style.geo.lineDash[1]]]),fO]),rt("div",gO,[mO,Pt(rt("input",{"onUpdate:modelValue":r[4]||(r[4]=t=>o.style.geo.iconWidth=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"宽度",onBlur:y},null,544),[[Tt,o.style.geo.iconWidth]]),Pt(rt("input",{"onUpdate:modelValue":r[5]||(r[5]=t=>o.style.geo.iconHeight=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"高度",onBlur:y},null,544),[[Tt,o.style.geo.iconHeight]]),_O]),rt("div",yO,[vO,Pt(rt("input",{"onUpdate:modelValue":r[6]||(r[6]=t=>o.style.geo.iconOffset[0]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"offsetX",onBlur:y},null,544),[[Tt,o.style.geo.iconOffset[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[7]||(r[7]=t=>o.style.geo.iconOffset[1]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"offsetY",onBlur:y},null,544),[[Tt,o.style.geo.iconOffset[1]]]),wO]),rt("div",xO,[bO,Pt(rt("input",{"onUpdate:modelValue":r[8]||(r[8]=t=>o.style.geo.iconAnchor[0]=t),class:"row_nw_fs_center dash_input",type:"number",min:"0",max:"1",step:"0.01",placeholder:"anchorX",onBlur:y},null,544),[[Tt,o.style.geo.iconAnchor[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[9]||(r[9]=t=>o.style.geo.iconAnchor[1]=t),class:"row_nw_fs_center dash_input",type:"number",min:"0",max:"1",step:"0.01",placeholder:"anchorY",onBlur:y},null,544),[[Tt,o.style.geo.iconAnchor[1]]]),CO]),rt("div",SO,[EO,xt(gt(zM),{pureColor:o.style.geo.color,"onUpdate:pureColor":r[10]||(r[10]=t=>o.style.geo.color=t),format:"rgb",onPureColorChange:y},null,8,["pureColor"])]),rt("div",IO,[PO,xt(gt(zM),{pureColor:o.style.geo.fillColor,"onUpdate:pureColor":r[11]||(r[11]=t=>o.style.geo.fillColor=t),format:"rgb",onPureColorChange:y},null,8,["pureColor"])]),rt("div",TO,[kO,Pt(rt("input",{"onUpdate:modelValue":r[12]||(r[12]=t=>o.style.vertex.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:y},null,544),[[Tt,o.style.vertex.fontSize]]),DO]),rt("div",MO,[LO,xt(gt(zM),{pureColor:o.style.vertex.color,"onUpdate:pureColor":r[13]||(r[13]=t=>o.style.vertex.color=t),format:"rgb",onPureColorChange:y},null,8,["pureColor"])]),rt("div",RO,[OO,xt(gt(zM),{pureColor:o.style.vertex.fillColor,"onUpdate:pureColor":r[14]||(r[14]=t=>o.style.vertex.fillColor=t),format:"rgb",onPureColorChange:y},null,8,["pureColor"])]),FO,rt("div",AO,[(tt(!0),et(St,null,Et(o.attributes.properties,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(WM,{label:t.label,isShowDescribe:t.isShowDescribe,initValue:t.values,onOnBlur:t=>((t,e)=>{o.attributes.properties[t].values=e})(e,t)},null,8,["label","isShowDescribe","initValue","onOnBlur"]),rt("div",zO,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){o.attributes.properties.length>=2&&t<o.attributes.properties.length&&o.attributes.properties.splice(t,1)}(e)},"-",8,BO),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){o.attributes.properties.length&&o.attributes.properties.splice(t+1,0,{id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}(e)},"+",8,jO)])])))),128))]),GO,rt("div",NO,[(tt(!0),et(St,null,Et(o.attributes.keyValues,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(KM,{label:t.label,initValue:t.values,onOnBlur:t=>((t,e)=>{o.attributes.keyValues[t].values=e})(e,t)},null,8,["label","initValue","onOnBlur"]),rt("div",VO,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){o.attributes.keyValues.length>=2&&t<o.attributes.keyValues.length&&o.attributes.keyValues.splice(t,1)}(e)},"-",8,HO),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){o.attributes.keyValues.length&&o.attributes.keyValues.splice(t+1,0,{id:Yt(7),label:"属性",values:{}})}(e)},"+",8,WO)])])))),128))]),XO,rt("div",UO,[$O,Pt(rt("textarea",{"onUpdate:modelValue":r[15]||(r[15]=t=>o.attributes.json=t),class:bt(["row_nw_fs_center prop_text_cls",{prop_text_err_cls:o.isNotValidJson}]),placeholder:"JSON字符串",onBlur:g},null,34),[[Tt,o.attributes.json]])]),o.isNotValidJson?(tt(),et("div",YO,"JSON 字符串有误，请检查")):It("",!0)]),qO,rt("div",{class:"row_nw_center_center action_box"},[rt("div",{class:"row_nw_center_center info_del",onClick:_},"取消"),rt("div",{class:"row_nw_center_center info_confirm",onClick:v},"完成")])])],8,KR))}}),[["__scopeId","data-v-c395b59a"]]),KO=t=>(nt("data-v-004c8f36"),t=t(),it(),t),JO=["id"],QO={class:"panel_dbox"},tF=KO((()=>rt("div",{class:"row_nw_fs_center title_box"},"请编辑属性",-1))),eF=KO((()=>rt("div",{class:"line_gap"},null,-1))),nF={class:"col_nw_fs_fs panel_wraper"},iF={class:"row_nw_fs_center info_box"},rF=KO((()=>rt("div",{class:"row_nw_fs_center info_box_label"},"图形ID",-1))),oF={class:"row_nw_fs_center info_box_value"},sF=KO((()=>rt("div",{class:"line_gap"},null,-1))),aF={class:"row_nw_fs_center name_box"},lF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"文本",-1))),uF={class:"row_nw_fs_center name_box"},hF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"字体大小",-1))),cF=KO((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),dF={class:"row_nw_fs_center name_box"},pF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"旋转",-1))),fF=KO((()=>rt("div",{class:"row_nw_center_center fs_label"}," 度",-1))),gF={class:"row_nw_fs_center name_box"},mF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"偏移量",-1))),_F=KO((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),yF={class:"row_nw_fs_center name_box"},vF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"填充大小",-1))),wF=KO((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),xF={class:"row_nw_fs_center baseline_box"},bF={class:"row_nw_fs_center name_box"},CF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"文本颜色",-1))),SF={class:"row_nw_fs_center name_box"},EF=KO((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"文本背景",-1))),IF=KO((()=>rt("div",{class:"line_gap"},null,-1))),PF=Q(J({__name:"DrawTextPropsPanel",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({})}},setup(t){const e={name:"testBaselineOptions",options:[{id:"bottom",value:"bottom",title:"bottom"},{id:"top",value:"top",title:"top"},{id:"middle",value:"middle",title:"middle"},{id:"alphabetic",value:"alphabetic",title:"alphabetic"},{id:"hanging",value:"hanging",title:"hanging"},{id:"ideographic",value:"ideographic",title:"ideographic"}]},n=t;at((()=>{!function(){if(n.vNodeData&&n.vNodeData.data){const t=n.vNodeData.data;if(t.geojson){const e=t.geojson;if(e.properties){const t=e.properties;if(t.style){const e=t.style;e.geo&&(i.style.geo={...e.geo},o.style.geo={...e.geo},r.value=r.value+1),e.vertex&&(i.style.vertex={...e.vertex},o.style.vertex={...e.vertex}),e.line&&(i.style.line={...e.line},o.style.line={...e.line}),e.label&&(i.style.label={...e.label},o.style.label={...e.label}),e.text&&(i.style.text={...e.text},o.style.text={...e.text})}}}}}()}));const i=yt({name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:{text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"}},attributes:{properties:[],keyValues:[],json:""},isNotValidJson:!1}),r=ct(0);let o={name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:{text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"}},attributes:{properties:[],keyValues:[],json:""}};function s(t){i.style&&i.style.text&&(i.style.text.textBaseline=t,u())}const a=()=>{n&&n.vNodeData.cancelCb(o)},l=()=>{n&&n.vNodeData.cancelCb(o)},u=()=>{n&&n.vNodeData.updateCb(i)},h=()=>{const t={name:i.style.text.text,attributes:{properties:[],keyValues:[],json:{}},style:Ow.cloneDeep(i.style)};n&&n.vNodeData.confirmCb(t)};return(n,o)=>(tt(),et("div",{id:t.id,class:"col_nw_fs_fs panel_container"},[rt("div",{class:"panel_mask",onClick:a}),rt("div",QO,[rt("div",{class:"row_nw_fs_center close_icon",onClick:a},"X"),tF,eF,rt("div",nF,[rt("div",iF,[rF,rt("div",oF,ot(t.vNodeData.data.id),1)]),sF,rt("div",aF,[lF,Pt(rt("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>i.style.text.text=t),class:"row_nw_fs_center name_box_input",type:"text",placeholder:"文本",onInput:u},null,544),[[Tt,i.style.text.text]])]),rt("div",uF,[hF,Pt(rt("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>i.style.text.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"字体大小",onInput:u},null,544),[[Tt,i.style.text.fontSize]]),cF]),rt("div",dF,[pF,Pt(rt("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>i.style.text.rotation=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"旋转度数",onInput:u},null,544),[[Tt,i.style.text.rotation]]),fF]),rt("div",gF,[mF,Pt(rt("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>i.style.text.offsetX=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"X轴",onInput:u},null,544),[[Tt,i.style.text.offsetX]]),Pt(rt("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>i.style.text.offsetY=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"Y轴",onInput:u},null,544),[[Tt,i.style.text.offsetY]]),_F]),rt("div",yF,[vF,Pt(rt("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>i.style.text.padding[0]=t),class:"row_nw_fs_center pad_input",type:"number",placeholder:"上",onInput:u},null,544),[[Tt,i.style.text.padding[0]]]),Pt(rt("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>i.style.text.padding[1]=t),class:"row_nw_fs_center pad_input",type:"number",placeholder:"右",onInput:u},null,544),[[Tt,i.style.text.padding[1]]]),Pt(rt("input",{"onUpdate:modelValue":o[7]||(o[7]=t=>i.style.text.padding[2]=t),class:"row_nw_fs_center pad_input",type:"number",placeholder:"下",onInput:u},null,544),[[Tt,i.style.text.padding[2]]]),Pt(rt("input",{"onUpdate:modelValue":o[8]||(o[8]=t=>i.style.text.padding[3]=t),class:"row_nw_fs_center pad_input",type:"number",placeholder:"左",onInput:u},null,544),[[Tt,i.style.text.padding[3]]]),wF]),rt("div",xF,[xt(uR,{titleLabel:"基准",radioOptions:e,initValue:i.style.text.textBaseline,isRefresh:r.value,onOnInput:s},null,8,["initValue","isRefresh"])]),rt("div",bF,[CF,xt(gt(zM),{pureColor:i.style.text.color,"onUpdate:pureColor":o[9]||(o[9]=t=>i.style.text.color=t),format:"rgb",onPureColorChange:u},null,8,["pureColor"])]),rt("div",SF,[EF,xt(gt(zM),{pureColor:i.style.text.fillColor,"onUpdate:pureColor":o[10]||(o[10]=t=>i.style.text.fillColor=t),format:"rgb",onPureColorChange:u},null,8,["pureColor"])])]),IF,rt("div",{class:"row_nw_center_center action_box"},[rt("div",{class:"row_nw_center_center info_del",onClick:l},"取消"),rt("div",{class:"row_nw_center_center info_confirm",onClick:h},"完成")])])],8,JO))}}),[["__scopeId","data-v-004c8f36"]]),TF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366576891'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='20389'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M366.293333%20702.293333l195.626667-195.626667-195.626667-195.626667%2060.373333-60.373333%20256%20256-256%20256z'%20fill='%23FFFFFF'%20p-id='20390'%3e%3c/path%3e%3c/svg%3e",kF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366003195'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3571'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M320%20823.424L614.848%20544%20320%20264.576%20396.544%20192%20768%20544%20396.544%20896z'%20p-id='3572'%3e%3c/path%3e%3c/svg%3e",DF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366020361'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3711'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M284.734984%201024l568.219385-511.943155L284.734984%200%20171.045631%20113.348285l454.530032%20398.70856L171.045631%20909.173754%20284.734984%201024z'%20p-id='3712'%3e%3c/path%3e%3c/svg%3e",MF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366205488'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='14376'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M775.585185%20445.62963L383.051852%2051.2c-17.066667-18.962963-39.822222-28.444444-64.474074-28.444444-26.548148%200-51.2%209.481481-68.266667%2026.548148-18.962963%2017.066667-28.444444%2039.822222-28.444444%2064.474074%200%2026.548148%209.481481%2051.2%2028.444444%2070.162963L576.474074%20512%20248.414815%20838.162963c-18.962963%2017.066667-28.444444%2039.822222-28.444445%2064.474074%200%2026.548148%209.481481%2051.2%2028.444445%2070.162963s41.718519%2028.444444%2066.37037%2028.444444c24.651852%200%2049.303704-9.481481%2066.370371-28.444444l392.533333-392.533333c18.962963-17.066667%2028.444444-39.822222%2028.444444-64.474074%201.896296-26.548148-7.585185-51.2-26.548148-70.162963z'%20fill='%23FFFFFF'%20p-id='14377'%3e%3c/path%3e%3c/svg%3e",LF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366485115'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='17234'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M322.58048%20852.35712a34.05824%2034.05824%200%200%201-8.51968-48.9472l192.14336-255.50848a59.65824%2059.65824%200%200%200%200-71.80288l-192.14336-255.488a34.03776%2034.03776%200%200%201%208.51968-48.9472%2047.18592%2047.18592%200%200%201%2057.344%204.096l310.12864%20276.70528a79.60576%2079.60576%200%200%201%200%20119.07072l-310.10816%20276.6848a47.18592%2047.18592%200%200%201-57.344%204.13696z'%20p-id='17235'%3e%3c/path%3e%3c/svg%3e",RF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366169020'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='10510'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M446.293333%20768a95.146667%2095.146667%200%200%201-38.826666-8.533333%2075.093333%2075.093333%200%200%201-44.8-67.84V332.373333A75.093333%2075.093333%200%200%201%20407.466667%20264.533333a89.6%2089.6%200%200%201%2094.293333%2011.093334l217.6%20179.626666a72.533333%2072.533333%200%200%201%200%20113.493334l-217.6%20179.626666a87.893333%2087.893333%200%200%201-55.466667%2019.626667z%20m0-426.666667v337.066667l207.36-166.4z'%20fill='%23FFFFFF'%20p-id='10511'%3e%3c/path%3e%3c/svg%3e",OF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366552206'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='19296'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M499.626667%20652.373333l110.506666-110.506666a42.496%2042.496%200%200%200%200-60.16L499.626667%20371.2c-26.88-26.453333-72.96-7.68-72.96%2030.293333v220.586667c0%2038.4%2046.08%2057.173333%2072.96%2030.293333z'%20p-id='19297'%3e%3c/path%3e%3c/svg%3e",FF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693365990094'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3431'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M446.293333%20768a95.146667%2095.146667%200%200%201-38.826666-8.533333%2075.093333%2075.093333%200%200%201-44.8-67.84V332.373333A75.093333%2075.093333%200%200%201%20407.466667%20264.533333a89.6%2089.6%200%200%201%2094.293333%2011.093334l217.6%20179.626666a72.533333%2072.533333%200%200%201%200%20113.493334l-217.6%20179.626666a87.893333%2087.893333%200%200%201-55.466667%2019.626667z'%20p-id='3432'%3e%3c/path%3e%3c/svg%3e",AF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693365980538'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3291'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M320.662%20291.061L703.339%20512%20320.661%20732.938z'%20p-id='3292'%3e%3c/path%3e%3c/svg%3e",zF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366543625'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='19154'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M682.666667%20512l-256%20256V256z'%20p-id='19155'%3e%3c/path%3e%3c/svg%3e",BF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693365956686'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3111'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M755.2%20544L390.4%20874.666667c-17.066667%2014.933333-44.8%2014.933333-59.733333-2.133334-6.4-8.533333-10.666667-19.2-10.666667-29.866666v-661.333334c0-23.466667%2019.2-42.666667%2042.666667-42.666666%2010.666667%200%2021.333333%204.266667%2027.733333%2010.666666l362.666667%20330.666667c17.066667%2014.933333%2019.2%2042.666667%202.133333%2059.733333%202.133333%202.133333%200%202.133333%200%204.266667z'%20fill='%23FFFFFF'%20p-id='3112'%3e%3c/path%3e%3c/svg%3e",jF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366123496'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='7813'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M960%20512l-512-320v240l-384-240v640l384-240v240z'%20p-id='7814'%3e%3c/path%3e%3c/svg%3e",GF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366087869'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5755'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M452.992%20148.992a30.592%2030.592%200%200%201%2020.992-7.978667c8.021333%200%2014.976%202.645333%2020.992%207.978667l331.008%20340.992c5.973333%205.973333%208.96%2013.354667%208.96%2022.016%200%208.704-2.986667%2016.042667-8.96%2022.016l-331.008%20340.992a30.592%2030.592%200%200%201-20.992%208.021333%2028.757333%2028.757333%200%200%201-20.992-9.002666%2028.757333%2028.757333%200%200%201-8.96-20.992c0-8.021333%202.986667-15.018667%208.96-20.992L765.013333%20512l-312.021333-320a28.757333%2028.757333%200%200%201-8.96-20.992c0-8.021333%202.986667-15.36%208.96-22.016z%20m-256%200a30.592%2030.592%200%200%201%2020.992-7.978667c8.021333%200%2014.976%202.645333%2020.992%207.978667l331.008%20340.992c5.973333%205.973333%208.96%2013.354667%208.96%2022.016%200%208.704-2.986667%2016.042667-8.96%2022.016l-331.008%20340.992a30.592%2030.592%200%200%201-20.992%208.021333%2028.757333%2028.757333%200%200%201-20.992-9.002666%2028.757333%2028.757333%200%200%201-8.96-20.992c0-8.021333%202.986667-15.018667%208.96-20.992L509.013333%20512%20196.992%20192a28.757333%2028.757333%200%200%201-8.96-20.992c0-8.021333%202.986667-15.36%208.96-22.016z'%20fill='%23FFFFFF'%20p-id='5756'%3e%3c/path%3e%3c/svg%3e",NF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366442347'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='16143'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M1024%20512%20512%200%20512%20320%200%20320%200%20704%20512%20704%20512%201024z'%20fill='%23FFFFFF'%20p-id='16144'%3e%3c/path%3e%3c/svg%3e",VF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366055682'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='4662'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M512.853333%20955.733333H341.333333a17.083733%2017.083733%200%200%201-15.837866-23.432533L494.455467%20512l-168.96-420.3008A17.066667%2017.066667%200%200%201%20341.333333%2068.266667h171.52a17.066667%2017.066667%200%200%201%2015.854934%2010.752l169.813333%20426.666666a16.964267%2016.964267%200%200%201%200%2012.612267l-169.813333%20426.666667a17.066667%2017.066667%200%200%201-15.854934%2010.769066z%20m-146.261333-34.133333h134.690133l163.0208-409.6-163.0208-409.6H366.592l162.0992%20403.234133a16.9472%2016.9472%200%200%201%200%2012.731734L366.592%20921.6z'%20p-id='4663'%3e%3c/path%3e%3c/svg%3e",HF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366092118'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='5895'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M596.48%20955.733333a17.066667%2017.066667%200%200%201-15.837867-23.432533L749.602133%20512l-168.96-420.3008a17.066667%2017.066667%200%201%201%2031.675734-12.731733l171.52%20426.666666a16.9472%2016.9472%200%200%201%200%2012.731734l-171.52%20426.666666a17.066667%2017.066667%200%200%201-15.837867%2010.7008zM426.666667%20955.733333H256a17.083733%2017.083733%200%200%201-15.854933-23.3984L408.285867%20512%20240.145067%2091.682133A17.066667%2017.066667%200%200%201%20256%2068.266667h170.666667a17.066667%2017.066667%200%200%201%2015.854933%2010.752l169.813333%20426.666666a16.964267%2016.964267%200%200%201%200%2012.612267l-169.813333%20426.666667A17.0496%2017.0496%200%200%201%20426.666667%20955.733333z%20m-145.4592-34.133333h133.888l163.0208-409.6-163.0208-409.6h-133.888l161.314133%20403.2512c1.621333%204.078933%201.621333%208.6016%200%2012.680533L281.207467%20921.6z'%20p-id='5896'%3e%3c/path%3e%3c/svg%3e",WF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366560399'%20class='icon'%20viewBox='0%200%201088%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='19436'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='212.5'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M821.12%20511.936L581.504%20832h252.096l252.416-320.064-258.688-318.016H576.576l-0.704%200.704%20245.248%20317.312zM323.008%20511.936L70.144%20832h252.032L576%20511.936%20315.84%20193.92H65.152l-0.64%200.704%20258.496%20317.312z'%20p-id='19437'%3e%3c/path%3e%3c/svg%3e",XF="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1693366470146'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='17094'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20fill='%23FFFFFF'%20d='M304.085333%20854.229333l36.096%2036.373334a18.026667%2018.026667%200%200%200%2025.813334-0.085334l347.754666-350.421333a39.957333%2039.957333%200%200%200%200-56.256L365.994667%20133.418667a18.154667%2018.154667%200%200%200-25.813334-0.064l-36.096%2036.352a19.328%2019.328%200%200%200%200.192%2027.029333L587.306667%20481.92a42.666667%2042.666667%200%200%201%200%2060.117333L304.277333%20827.2a19.349333%2019.349333%200%200%200-0.192%2027.029333zM496.896%20512L243.712%20256.853333c-40.384-40.682667-40.533333-106.56-0.192-147.242666l36.096-36.352a103.466667%20103.466667%200%200%201%20146.944%200.085333l347.754667%20350.4a125.290667%20125.290667%200%200%201%200%20176.490667L426.56%20950.634667a103.36%20103.36%200%200%201-146.944%200.085333l-36.096-36.373333c-40.32-40.618667-40.213333-106.538667%200.192-147.264L496.896%20512z'%20p-id='17095'%3e%3c/path%3e%3c/svg%3e",UF=t=>(nt("data-v-37eb3074"),t=t(),it(),t),$F=["id"],YF={class:"panel_dbox"},qF=UF((()=>rt("div",{class:"row_nw_fs_center title_box"},"请编辑属性",-1))),ZF={class:"col_nw_fs_fs panel_wraper"},KF={class:"row_nw_fs_center info_box"},JF=UF((()=>rt("div",{class:"row_nw_fs_center info_box_label"},"图形ID",-1))),QF={class:"row_nw_fs_center info_box_value"},tA={class:"row_nw_fs_center name_box"},eA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"名称",-1))),nA=UF((()=>rt("div",{class:"line_gap"},null,-1))),iA={class:"row_nw_fs_center pattern_box"},rA={class:"row_nw_fs_center"},oA={class:"row_nw_fs_center name_box"},sA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线宽",-1))),aA={class:"row_nw_fs_center name_box"},lA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形虚线",-1))),uA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),hA={class:"row_nw_fs_center name_box"},cA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"箭头宽高",-1))),dA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),pA={class:"row_nw_fs_center name_box"},fA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"箭头偏移",-1))),gA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),mA={class:"row_nw_fs_center name_box"},_A=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"箭头锚点",-1))),yA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"}," 分",-1))),vA={class:"row_nw_fs_center name_box"},wA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形线色",-1))),xA={class:"row_nw_fs_center name_box"},bA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"图形填充",-1))),CA={class:"row_nw_fs_center name_box"},SA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点文字",-1))),EA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),IA={class:"row_nw_fs_center name_box"},PA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点颜色",-1))),TA={class:"row_nw_fs_center name_box"},kA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"顶点填充",-1))),DA={class:"row_nw_fs_center name_box"},MA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段文字",-1))),LA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),RA={class:"row_nw_fs_center name_box"},OA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段颜色",-1))),FA={class:"row_nw_fs_center name_box"},AA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"线段填充",-1))),zA={class:"row_nw_fs_center name_box"},BA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签文字",-1))),jA=UF((()=>rt("div",{class:"row_nw_center_center fs_label"},"PX",-1))),GA={class:"row_nw_fs_center name_box"},NA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签颜色",-1))),VA={class:"row_nw_fs_center name_box"},HA=UF((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"标签填充",-1))),WA=UF((()=>rt("div",{class:"line_gap"},null,-1))),XA={class:"col_nw_fs_center pros_box"},UA={class:"row_nw_fe_center props_action_box"},$A=["onClick"],YA=["onClick"],qA=UF((()=>rt("div",{class:"line_gap"},null,-1))),ZA={class:"col_nw_fs_center pros_box"},KA={class:"row_nw_fe_center props_action_box"},JA=["onClick"],QA=["onClick"],tz=UF((()=>rt("div",{class:"line_gap"},null,-1))),ez={class:"row_nw_fs_center prop_json_box"},nz=UF((()=>rt("div",{class:"row_nw_fs_fs prop_json_label"},"JSON",-1))),iz={key:0,class:"prop_text_err_tips"},rz=UF((()=>rt("div",{class:"line_gap"},null,-1))),oz=Q(J({__name:"DrawLinePropsPanel",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({})}},setup(t){const e={arrow1_1:TF,arrow1_2:kF,arrow1_3:DF,arrow1_4:MF,arrow1_5:LF,arrow2_1:RF,arrow3_1:OF,arrow3_2:FF,arrow3_3:AF,arrow3_4:zF,arrow3_5:BF,arrow4_1:jF,arrow5_1:GF,arrow6_1:NF,arrow7_1:VF,arrow7_2:HF,arrow8_1:WF,arrow9_1:XF},n={name:"arrowPosOptions",options:[{id:"noNeed",value:"noNeed",title:"无"},{id:"last",value:"last",title:"最终尾部"},{id:"every",value:"every",title:"分段尾部"}]},i={name:"imageIconsOptions",options:[{id:"arrow1_1",value:"arrow1_1",title:"arrow1",image:TF},{id:"arrow1_2",value:"arrow1_2",title:"arrow2",image:kF},{id:"arrow1_3",value:"arrow1_3",title:"arrow3",image:DF},{id:"arrow1_4",value:"arrow1_4",title:"arrow4",image:MF},{id:"arrow1_5",value:"arrow1_5",title:"arrow5",image:LF},{id:"arrow2_1",value:"arrow2_1",title:"arrow6",image:RF},{id:"arrow3_1",value:"arrow3_1",title:"arrow7",image:OF},{id:"arrow3_2",value:"arrow3_2",title:"arrow8",image:FF},{id:"arrow3_3",value:"arrow3_3",title:"arrow9",image:AF},{id:"arrow3_4",value:"arrow3_4",title:"arrow10",image:zF},{id:"arrow3_5",value:"arrow3_5",title:"arrow11",image:BF},{id:"arrow4_1",value:"arrow4_1",title:"arrow12",image:jF},{id:"arrow5_1",value:"arrow5_1",title:"arrow13",image:GF},{id:"arrow6_1",value:"arrow6_1",title:"arrow14",image:NF},{id:"arrow7_1",value:"arrow7_1",title:"arrow15",image:VF},{id:"arrow7_2",value:"arrow7_2",title:"arrow16",image:HF},{id:"arrow8_1",value:"arrow8_1",title:"arrow17",image:WF},{id:"arrow9_1",value:"arrow9_1",title:"arrow18",image:XF}]},r=t;at((()=>{!function(){if(r.vNodeData&&r.vNodeData.data){const t=r.vNodeData.data;if(t.geojson){const e=t.geojson;if(e.properties){const t=e.properties;if(t.editProps){const e=t.editProps;if(e){const t=e.name;t?(o.name=t,a.name=t):h();const n=e.attributes;if(n){const t=n.properties;if(t&&t.length){const e=[],n=[];for(let i=0;i<t.length;i++)e.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[i]}}),n.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[i]}});o.attributes.properties=e,a.attributes.properties=n}else c();const e=n.keyValues;if(e&&e.length){const t=[],n=[];for(let i=0;i<e.length;i++)t.push({id:Yt(7),label:"属性",values:{...e[i]}}),n.push({id:Yt(7),label:"属性",values:{...e[i]}});o.attributes.keyValues=t,a.attributes.keyValues=n}else d();const i=n.json;try{const t=JSON.stringify(i);o.attributes.json=t,a.attributes.json=t}catch(Hj){p()}}else c(),d(),p()}else h(),c(),d(),p()}else h(),c(),d(),p();if(t.style){const e=t.style;if(e.geo){if(o.style.geo={...e.geo},a.style.geo={...e.geo},"arrow"!=o.style.geo.iconPattern&&(o.style.geo.iconPattern="arrow",o.style.geo.iconUrl=TF),"arrow"==o.style.geo.iconPattern){const t=o.style.geo.iconUrl,e=o.style.geo.iconUrl;let n=t.split("/");if(n.length||(n=t.split("\\")),n.length){const t=n[n.length-1].split(".");t.length&&(o.style.geo.iconUrl=t[0])}setTimeout((()=>{o.style.geo.iconUrl=e}),100)}s.value=s.value+1}e.vertex&&(o.style.vertex={...e.vertex},a.style.vertex={...e.vertex}),e.line&&(o.style.line={...e.line},a.style.line={...e.line}),e.label&&(o.style.label={...e.label},a.style.label={...e.label})}else"arrow"!=o.style.geo.iconPattern&&(o.style.geo.iconPattern="arrow",o.style.geo.iconUrl="arrow1_1",s.value=s.value+1,setTimeout((()=>{o.style.geo.iconUrl=TF})))}else h(),c(),d(),p()}else h(),c(),d(),p()}else h(),c(),d(),p(),"arrow"!=o.style.geo.iconPattern&&(o.style.geo.iconPattern="arrow",o.style.geo.iconUrl="arrow1_1",s.value=s.value+1,setTimeout((()=>{o.style.geo.iconUrl=TF})))}()}));const o=yt({name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""},isNotValidJson:!1}),s=ct(0);let a={name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""}};function l(t){o.style&&o.style.geo&&(o.style.geo.iconUrl=e[t],_())}function u(t){o.style&&o.style.geo&&(o.style.geo.arrowPattern=t,_())}function h(){o.name="",a.name=""}function c(){o.attributes.properties.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}function d(){o.attributes.keyValues.push({id:Yt(7),label:"属性",values:{}})}function p(){o.attributes.json="",a.attributes.json=""}const f=()=>{if(o.attributes.json){try{const t=JSON.parse(o.attributes.json);if("object"==typeof t)return o.isNotValidJson=!1,t}catch(Hj){return o.isNotValidJson=!0,{}}return o.isNotValidJson=!0,{}}return o.isNotValidJson=!1,{}};const g=()=>{r&&r.vNodeData.cancelCb(a)},m=()=>{r&&r.vNodeData.cancelCb(a)},_=()=>{r&&r.vNodeData.updateCb(o)},y=()=>{if(!o.isNotValidJson){const t=function(){const t={name:o.name,attributes:{properties:[],keyValues:[],json:{}},style:Ow.cloneDeep(o.style)};if(o.attributes.properties.forEach((e=>{e.values&&e.values.name&&e.values.units&&t.attributes.properties.push({...e.values})})),o.attributes.keyValues.forEach((e=>{e.values&&e.values.name&&t.attributes.keyValues.push({...e.values})})),o.attributes.json){const e=f();t.attributes.json=e}return t}();r&&r.vNodeData.confirmCb(t)}};return(e,r)=>(tt(),et("div",{id:t.id,class:"col_nw_fs_fs panel_container"},[rt("div",{class:"panel_mask",onClick:g}),rt("div",YF,[rt("div",{class:"row_nw_fs_center close_icon",onClick:g},"X"),qF,rt("div",ZF,[rt("div",KF,[JF,rt("div",QF,ot(t.vNodeData.data.id),1)]),rt("div",tA,[eA,Pt(rt("input",{"onUpdate:modelValue":r[0]||(r[0]=t=>o.name=t),class:"row_nw_fs_center name_box_input",type:"text",placeholder:"名称"},null,512),[[Tt,o.name]])]),nA,rt("div",iA,[xt(yR,{titleLabel:"Icons",radioOptions:i,initValue:o.style.geo.iconUrl,isRefresh:s.value,onOnInput:l},null,8,["initValue","isRefresh"])]),rt("div",rA,[xt(uR,{titleLabel:"图案",radioOptions:n,initValue:o.style.geo.arrowPattern,isRefresh:s.value,onOnInput:u},null,8,["initValue","isRefresh"])]),rt("div",oA,[sA,Pt(rt("input",{"onUpdate:modelValue":r[1]||(r[1]=t=>o.style.geo.width=t),class:"row_nw_fs_center name_box_input",type:"number",placeholder:"名称",onBlur:_},null,544),[[Tt,o.style.geo.width]])]),rt("div",aA,[lA,Pt(rt("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>o.style.geo.lineDash[0]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线长度",onBlur:_},null,544),[[Tt,o.style.geo.lineDash[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[3]||(r[3]=t=>o.style.geo.lineDash[1]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"虚线间隔",onBlur:_},null,544),[[Tt,o.style.geo.lineDash[1]]]),uA]),rt("div",hA,[cA,Pt(rt("input",{"onUpdate:modelValue":r[4]||(r[4]=t=>o.style.geo.iconWidth=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"宽度",onBlur:_},null,544),[[Tt,o.style.geo.iconWidth]]),Pt(rt("input",{"onUpdate:modelValue":r[5]||(r[5]=t=>o.style.geo.iconHeight=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"高度",onBlur:_},null,544),[[Tt,o.style.geo.iconHeight]]),dA]),rt("div",pA,[fA,Pt(rt("input",{"onUpdate:modelValue":r[6]||(r[6]=t=>o.style.geo.iconOffset[0]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"offsetX",onBlur:_},null,544),[[Tt,o.style.geo.iconOffset[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[7]||(r[7]=t=>o.style.geo.iconOffset[1]=t),class:"row_nw_fs_center dash_input",type:"number",placeholder:"offsetY",onBlur:_},null,544),[[Tt,o.style.geo.iconOffset[1]]]),gA]),rt("div",mA,[_A,Pt(rt("input",{"onUpdate:modelValue":r[8]||(r[8]=t=>o.style.geo.iconAnchor[0]=t),class:"row_nw_fs_center dash_input",type:"number",min:"0",max:"1",step:"0.01",placeholder:"anchorX",onBlur:_},null,544),[[Tt,o.style.geo.iconAnchor[0]]]),Pt(rt("input",{"onUpdate:modelValue":r[9]||(r[9]=t=>o.style.geo.iconAnchor[1]=t),class:"row_nw_fs_center dash_input",type:"number",min:"0",max:"1",step:"0.01",placeholder:"anchorY",onBlur:_},null,544),[[Tt,o.style.geo.iconAnchor[1]]]),yA]),rt("div",vA,[wA,xt(gt(zM),{pureColor:o.style.geo.color,"onUpdate:pureColor":r[10]||(r[10]=t=>o.style.geo.color=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",xA,[bA,xt(gt(zM),{pureColor:o.style.geo.fillColor,"onUpdate:pureColor":r[11]||(r[11]=t=>o.style.geo.fillColor=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",CA,[SA,Pt(rt("input",{"onUpdate:modelValue":r[12]||(r[12]=t=>o.style.vertex.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:_},null,544),[[Tt,o.style.vertex.fontSize]]),EA]),rt("div",IA,[PA,xt(gt(zM),{pureColor:o.style.vertex.color,"onUpdate:pureColor":r[13]||(r[13]=t=>o.style.vertex.color=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",TA,[kA,xt(gt(zM),{pureColor:o.style.vertex.fillColor,"onUpdate:pureColor":r[14]||(r[14]=t=>o.style.vertex.fillColor=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",DA,[MA,Pt(rt("input",{"onUpdate:modelValue":r[15]||(r[15]=t=>o.style.line.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:_},null,544),[[Tt,o.style.line.fontSize]]),LA]),rt("div",RA,[OA,xt(gt(zM),{pureColor:o.style.line.color,"onUpdate:pureColor":r[16]||(r[16]=t=>o.style.line.color=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",FA,[AA,xt(gt(zM),{pureColor:o.style.line.fillColor,"onUpdate:pureColor":r[17]||(r[17]=t=>o.style.line.fillColor=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",zA,[BA,Pt(rt("input",{"onUpdate:modelValue":r[18]||(r[18]=t=>o.style.label.fontSize=t),class:"row_nw_fs_center fs_input",type:"number",placeholder:"顶点文字大小,单位PX",onBlur:_},null,544),[[Tt,o.style.label.fontSize]]),jA]),rt("div",GA,[NA,xt(gt(zM),{pureColor:o.style.label.color,"onUpdate:pureColor":r[19]||(r[19]=t=>o.style.label.color=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),rt("div",VA,[HA,xt(gt(zM),{pureColor:o.style.label.fillColor,"onUpdate:pureColor":r[20]||(r[20]=t=>o.style.label.fillColor=t),format:"rgb",onPureColorChange:_},null,8,["pureColor"])]),WA,rt("div",XA,[(tt(!0),et(St,null,Et(o.attributes.properties,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(WM,{label:t.label,isShowDescribe:t.isShowDescribe,initValue:t.values,onOnBlur:t=>((t,e)=>{o.attributes.properties[t].values=e})(e,t)},null,8,["label","isShowDescribe","initValue","onOnBlur"]),rt("div",UA,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){o.attributes.properties.length>=2&&t<o.attributes.properties.length&&o.attributes.properties.splice(t,1)}(e)},"-",8,$A),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){o.attributes.properties.length&&o.attributes.properties.splice(t+1,0,{id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}(e)},"+",8,YA)])])))),128))]),qA,rt("div",ZA,[(tt(!0),et(St,null,Et(o.attributes.keyValues,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(KM,{label:t.label,initValue:t.values,onOnBlur:t=>((t,e)=>{o.attributes.keyValues[t].values=e})(e,t)},null,8,["label","initValue","onOnBlur"]),rt("div",KA,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){o.attributes.keyValues.length>=2&&t<o.attributes.keyValues.length&&o.attributes.keyValues.splice(t,1)}(e)},"-",8,JA),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){o.attributes.keyValues.length&&o.attributes.keyValues.splice(t+1,0,{id:Yt(7),label:"属性",values:{}})}(e)},"+",8,QA)])])))),128))]),tz,rt("div",ez,[nz,Pt(rt("textarea",{"onUpdate:modelValue":r[21]||(r[21]=t=>o.attributes.json=t),class:bt(["row_nw_fs_center prop_text_cls",{prop_text_err_cls:o.isNotValidJson}]),placeholder:"JSON字符串",onBlur:f},null,34),[[Tt,o.attributes.json]])]),o.isNotValidJson?(tt(),et("div",iz,"JSON 字符串有误，请检查")):It("",!0)]),rz,rt("div",{class:"row_nw_center_center action_box"},[rt("div",{class:"row_nw_center_center info_del",onClick:m},"取消"),rt("div",{class:"row_nw_center_center info_confirm",onClick:y},"完成")])])],8,$F))}}),[["__scopeId","data-v-37eb3074"]]),sz=t=>(nt("data-v-be111216"),t=t(),it(),t),az=["id"],lz={class:"panel_dbox"},uz=sz((()=>rt("div",{class:"row_nw_fs_center title_box"},"请编辑属性",-1))),hz={class:"col_nw_fs_fs panel_wraper"},cz={class:"row_nw_fs_center info_box"},dz=sz((()=>rt("div",{class:"row_nw_fs_center info_box_label"},"图形ID",-1))),pz={class:"row_nw_fs_center info_box_value"},fz={class:"row_nw_fs_center name_box"},gz=sz((()=>rt("div",{class:"row_nw_fs_center name_box_label"},"名称",-1))),mz=sz((()=>rt("div",{class:"line_gap"},null,-1))),_z={class:"col_nw_fs_center pros_box"},yz={class:"row_nw_fe_center props_action_box"},vz=["onClick"],wz=["onClick"],xz=sz((()=>rt("div",{class:"line_gap"},null,-1))),bz={class:"col_nw_fs_center pros_box"},Cz={class:"row_nw_fe_center props_action_box"},Sz=["onClick"],Ez=["onClick"],Iz=sz((()=>rt("div",{class:"line_gap"},null,-1))),Pz={class:"row_nw_fs_center prop_json_box"},Tz=sz((()=>rt("div",{class:"row_nw_fs_fs prop_json_label"},"JSON",-1))),kz={key:0,class:"prop_text_err_tips"},Dz=sz((()=>rt("div",{class:"line_gap"},null,-1))),Mz=Q(J({__name:"DrawUploadImagePropsPanel",props:{id:{type:String,default:"dc001"},customT:{type:Function,default:t=>t},destory:{type:Function,default:()=>{}},vNodeData:{type:Object,default:()=>({})}},setup(t){const e=t;at((()=>{!function(){if(e.vNodeData&&e.vNodeData.data){const t=e.vNodeData.data;if(t.geojson){const e=t.geojson;if(e.properties){const t=e.properties;if(t.editProps){const e=t.editProps;if(e){const t=e.name;t?(n.name=t,i.name=t):r();const l=e.attributes;if(l){const t=l.properties;if(t&&t.length){const e=[],r=[];for(let n=0;n<t.length;n++)e.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[n]}}),r.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{...t[n]}});n.attributes.properties=e,i.attributes.properties=r}else o();const e=l.keyValues;if(e&&e.length){const t=[],r=[];for(let n=0;n<e.length;n++)t.push({id:Yt(7),label:"属性",values:{...e[n]}}),r.push({id:Yt(7),label:"属性",values:{...e[n]}});n.attributes.keyValues=t,i.attributes.keyValues=r}else s();const r=l.json;try{const t=JSON.stringify(r);n.attributes.json=t,i.attributes.json=t}catch(Hj){a()}}else o(),s(),a()}else r(),o(),s(),a()}else r(),o(),s(),a();if(t.style){const e=t.style;e.geo&&(n.style.geo={...e.geo},i.style.geo={...e.geo}),e.vertex&&(n.style.vertex={...e.vertex},i.style.vertex={...e.vertex}),e.line&&(n.style.line={...e.line},i.style.line={...e.line}),e.label&&(n.style.label={...e.label},i.style.label={...e.label})}}else r(),o(),s(),a()}else r(),o(),s(),a()}else r(),o(),s(),a()}()}));const n=yt({name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""},isNotValidJson:!1});let i={name:"",style:{geo:{width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},vertex:{...ix},line:{...Qw},label:{...ex},text:null},attributes:{properties:[],keyValues:[],json:""}};function r(){n.name="",i.name=""}function o(){n.attributes.properties.push({id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}function s(){n.attributes.keyValues.push({id:Yt(7),label:"属性",values:{}})}function a(){n.attributes.json="",i.attributes.json=""}const l=()=>{if(n.attributes.json){try{const t=JSON.parse(n.attributes.json);if("object"==typeof t)return n.isNotValidJson=!1,t}catch(Hj){return n.isNotValidJson=!0,{}}return n.isNotValidJson=!0,{}}return n.isNotValidJson=!1,{}};const u=()=>{e&&e.vNodeData.cancelCb(i)},h=()=>{e&&e.vNodeData.cancelCb(i)},c=()=>{if(!n.isNotValidJson){const t=function(){const t={name:n.name,attributes:{properties:[],keyValues:[],json:{}},style:Ow.cloneDeep(n.style)};if(n.attributes.properties.forEach((e=>{e.values&&e.values.name&&e.values.units&&t.attributes.properties.push({...e.values})})),n.attributes.keyValues.forEach((e=>{e.values&&e.values.name&&t.attributes.keyValues.push({...e.values})})),n.attributes.json){const e=l();t.attributes.json=e}return t}();e&&e.vNodeData.confirmCb(t)}};return(e,i)=>(tt(),et("div",{id:t.id,class:"col_nw_fs_fs panel_container"},[rt("div",{class:"panel_mask",onClick:u}),rt("div",lz,[rt("div",{class:"row_nw_fs_center close_icon",onClick:u},"X"),uz,rt("div",hz,[rt("div",cz,[dz,rt("div",pz,ot(t.vNodeData.data.id),1)]),rt("div",fz,[gz,Pt(rt("input",{"onUpdate:modelValue":i[0]||(i[0]=t=>n.name=t),class:"row_nw_fs_center name_box_input",type:"text",placeholder:"名称"},null,512),[[Tt,n.name]])]),mz,rt("div",_z,[(tt(!0),et(St,null,Et(n.attributes.properties,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(WM,{label:t.label,isShowDescribe:t.isShowDescribe,initValue:t.values,onOnBlur:t=>((t,e)=>{n.attributes.properties[t].values=e})(e,t)},null,8,["label","isShowDescribe","initValue","onOnBlur"]),rt("div",yz,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){n.attributes.properties.length>=2&&t<n.attributes.properties.length&&n.attributes.properties.splice(t,1)}(e)},"-",8,vz),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){n.attributes.properties.length&&n.attributes.properties.splice(t+1,0,{id:Yt(7),label:"值属性",isShowDescribe:!0,values:{}})}(e)},"+",8,wz)])])))),128))]),xz,rt("div",bz,[(tt(!0),et(St,null,Et(n.attributes.keyValues,((t,e)=>(tt(),et("div",{key:t.id,class:"col_nw_fs_fs pros_inbox"},[xt(KM,{label:t.label,initValue:t.values,onOnBlur:t=>((t,e)=>{n.attributes.keyValues[t].values=e})(e,t)},null,8,["label","initValue","onOnBlur"]),rt("div",Cz,[rt("div",{class:"row_nw_center_center props_minus",onClick:t=>function(t){n.attributes.keyValues.length>=2&&t<n.attributes.keyValues.length&&n.attributes.keyValues.splice(t,1)}(e)},"-",8,Sz),rt("div",{class:"row_nw_center_center props_add",onClick:t=>function(t){n.attributes.keyValues.length&&n.attributes.keyValues.splice(t+1,0,{id:Yt(7),label:"属性",values:{}})}(e)},"+",8,Ez)])])))),128))]),Iz,rt("div",Pz,[Tz,Pt(rt("textarea",{"onUpdate:modelValue":i[1]||(i[1]=t=>n.attributes.json=t),class:bt(["row_nw_fs_center prop_text_cls",{prop_text_err_cls:n.isNotValidJson}]),placeholder:"JSON字符串",onBlur:l},null,34),[[Tt,n.attributes.json]])]),n.isNotValidJson?(tt(),et("div",kz,"JSON 字符串有误，请检查")):It("",!0)]),Dz,rt("div",{class:"row_nw_center_center action_box"},[rt("div",{class:"row_nw_center_center info_del",onClick:h},"取消"),rt("div",{class:"row_nw_center_center info_confirm",onClick:c},"完成")])])],8,az))}}),[["__scopeId","data-v-be111216"]]),Lz="editProps";class Rz{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"vuePopupIns",null),e(this,"mapEventIns",null),e(this,"__layers",null),e(this,"__layerIdPrefix","DRAW_"),e(this,"__drawData",{}),e(this,"__crurentSelDrawData",{}),e(this,"__currentFeature",null),e(this,"__currentOptions",null),e(this,"drawType",""),e(this,"drawTag",null),e(this,"snapTag",null),e(this,"drawModel",""),e(this,"modify",null),e(this,"interactionSource",null),e(this,"InteractionLayer",null),e(this,"drawLayerZIndex",20),e(this,"segmentStyles",null),e(this,"lableLngLatStyles",null),e(this,"labelStyles",null),e(this,"defaultModifyStyle",null),e(this,"sketchFeature",null),e(this,"listener",null),e(this,"dcPopupOptions",null),e(this,"dcEventSingleOptions",null),e(this,"dcEventDbclickOptions",null),e(this,"dcEventDragOptions",null),e(this,"dcEventPointMoveOptions",null),e(this,"isShowDcActionPopup",!1),e(this,"customCallbackFunc",null),e(this,"geoImageIns",null),e(this,"geoImageMaps",null),e(this,"newTranslate",null),e(this,"propsPanelPopupOptions",{[r]:{id:`${r}_panel_popup`,name:`${r}_panel_popup`,vNode:PF,vNodeData:{data:this.__crurentSelDrawData,cancelCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[r].id);const n=this.updateDrawStyleFunction(this.__currentFeature,null,!1,!1,!1,t.style);this.__currentFeature.setStyle(n)},updateCb:t=>{const e=this.updateDrawStyleFunction(this.__currentFeature,null,!1,!1,!1,t.style);this.__currentFeature.setStyle(e)},confirmCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[r].id),this.__crurentSelDrawData[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__crurentSelDrawData.style=Ow.cloneDeep(t.style),this.__currentFeature.values_.__drawData.geojson.properties[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__currentFeature.values_.__drawData.geojson.properties.style=Ow.cloneDeep(t.style),this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)}},popupIsCenter:!1},[o]:{id:`${o}_panel_popup`,name:`${o}_panel_popup`,vNode:ZO,vNodeData:{data:this.__crurentSelDrawData,cancelCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[o].id);const n=this.__currentOptions.isShowSegments??!1,i=this.__currentOptions.isShowLngLat??!1,r=this.__currentOptions.isShowLabel??!1,s=this.updateDrawStyleFunction(this.__currentFeature,null,n,i,r,t.style);this.__currentFeature.setStyle(s)},updateCb:t=>{const e=this.__currentOptions.isShowSegments??!1,n=this.__currentOptions.isShowLngLat??!1,i=this.__currentOptions.isShowLabel??!1,r=this.updateDrawStyleFunction(this.__currentFeature,null,e,n,i,t.style);this.__currentFeature.setStyle(r)},confirmCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[o].id),this.__crurentSelDrawData[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__crurentSelDrawData.style=Ow.cloneDeep(t.style),this.__currentFeature.values_.__drawData.geojson.properties[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__currentFeature.values_.__drawData.geojson.properties.style=Ow.cloneDeep(t.style),this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)}},popupIsCenter:!1},[p]:{},[f]:{id:`${f}_panel_popup`,name:`${f}_panel_popup`,vNode:eR,vNodeData:{data:this.__crurentSelDrawData,cancelCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[f].id);const n=this.__currentOptions.isShowSegments??!1,i=this.__currentOptions.isShowLngLat??!1,r=this.__currentOptions.isShowLabel??!1,o=this.updateDrawStyleFunction(this.__currentFeature,null,n,i,r,t.style);this.__currentFeature.setStyle(o)},updateCb:t=>{const e=this.__currentOptions.isShowSegments??!1,n=this.__currentOptions.isShowLngLat??!1,i=this.__currentOptions.isShowLabel??!1,r=this.updateDrawStyleFunction(this.__currentFeature,null,e,n,i,t.style);this.__currentFeature.setStyle(r)},confirmCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[f].id),this.__crurentSelDrawData[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__crurentSelDrawData.style=Ow.cloneDeep(t.style),this.__currentFeature.values_.__drawData.geojson.properties[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__currentFeature.values_.__drawData.geojson.properties.style=Ow.cloneDeep(t.style),this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)}},popupIsCenter:!1},[s]:{},[a]:{id:`${a}_panel_popup`,name:`${a}_panel_popup`,vNode:oz,vNodeData:{data:this.__crurentSelDrawData,cancelCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[a].id);const n=this.__currentOptions.isShowSegments??!1,i=this.__currentOptions.isShowLngLat??!1,r=this.__currentOptions.isShowLabel??!1,o=this.updateDrawStyleFunction(this.__currentFeature,null,n,i,r,t.style);this.__currentFeature.setStyle(o)},updateCb:t=>{const e=this.__currentOptions.isShowSegments??!1,n=this.__currentOptions.isShowLngLat??!1,i=this.__currentOptions.isShowLabel??!1,r=this.updateDrawStyleFunction(this.__currentFeature,null,e,n,i,t.style);this.__currentFeature.setStyle(r)},confirmCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[a].id),this.__crurentSelDrawData[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__crurentSelDrawData.style=Ow.cloneDeep(t.style),this.__currentFeature.values_.__drawData.geojson.properties[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__currentFeature.values_.__drawData.geojson.properties.style=Ow.cloneDeep(t.style),this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)}},popupIsCenter:!1},[_]:{},[y]:{},[m]:{},[g]:{},[w]:{id:`${w}_panel_popup`,name:`${w}_panel_popup`,vNode:Mz,vNodeData:{data:this.__crurentSelDrawData,cancelCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[w].id)},updateCb:t=>{},confirmCb:t=>{var e;null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.propsPanelPopupOptions[w].id),this.__crurentSelDrawData[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__crurentSelDrawData.style=Ow.cloneDeep(t.style),this.__currentFeature.values_.__drawData.geojson.properties[Lz]={name:t.name,attributes:Ow.cloneDeep(t.attributes)},this.__currentFeature.values_.__drawData.geojson.properties.style=Ow.cloneDeep(t.style),this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)}},popupIsCenter:!1}}),e(this,"isShowTipPopup",!1),e(this,"drawTipPopupOptions",{id:`${this.__layerIdPrefix}_tip_popup`,name:`${this.__layerIdPrefix}_tipvnode_popup`,vNode:gx,customT:this.innerT,vNodeData:{},wrapX:!0}),e(this,"__oldTipPosition",[0,0]),e(this,"drawTipNodePopupCb",(t=>{var e;if(this.isShowTipPopup&&this.drawTag&&t.coordinate){this.__oldTipPosition=[...t.coordinate];const n=[...this.__oldTipPosition];if(n.length>=2){let t=3;this.olBaseHandle&&(t=this.olBaseHandle.getViewZoom());let i=262144;if(t>=3&&t<20){const e=21-t;i=Math.pow(2,e)}else t>=20&&(i=1);n[0]=n[0]+i,null==(e=this.vuePopupIns)||e.showPopupByID(this.drawTipPopupOptions.id,n)}}})),e(this,"drawTipEventPointMoveOptions",{id:`${this.__layerIdPrefix}_${Yt(10)}_tipmap_event`,type:jw,cb:this.drawTipNodePopupCb,delay:1,debounce:!1}),e(this,"drawTipEventZoomOptions",{id:`${this.__layerIdPrefix}_${Yt(10)}_tipmap_event`,type:Gw,cb:this.drawTipNodePopupCb,delay:1,debounce:!1}),e(this,"__removeSourceFeatureById",(t=>{const e=this.interactionSource.getFeatureById(t);e&&this.interactionSource.removeFeature(e)})),e(this,"cancelDraw",(t=>{(this.drawTag||this.modify)&&"Escape"==t.key&&this.removeallInteraction()})),e(this,"setCancelDrawCB",(()=>{window.addEventListener("keyup",this.cancelDraw)})),e(this,"removeCancelDrawCB",(()=>{window.removeEventListener("keyup",this.cancelDraw)})),e(this,"drawBackOnePoint",(t=>{this.drawTag&&("Q"!=t.key&&"q"!=t.key&&"Backspace"!=t.key&&"Delete"!=t.key||this.drawTag.removeLastPoint())})),e(this,"setDrawBackCB",(()=>{window.addEventListener("keyup",this.drawBackOnePoint)})),e(this,"removeDrawBackCB",(()=>{window.removeEventListener("keyup",this.drawBackOnePoint)})),e(this,"modifyBackOnePoint",(t=>{this.modify&&("Q"!=t.key&&"q"!=t.key&&"Backspace"!=t.key&&"Delete"!=t.key||this.modify.removePoint())})),e(this,"setModifyBackCB",(()=>{window.addEventListener("keyup",this.modifyBackOnePoint)})),e(this,"removeModifyBackCB",(()=>{window.removeEventListener("keyup",this.modifyBackOnePoint)})),e(this,"setMouseoutCb",(()=>{this.handle&&this.handle.getViewport().addEventListener("mouseout",this.removeallInteraction)})),e(this,"removeMouseoutCb",(()=>{this.handle&&this.handle.getViewport().removeEventListener("mouseout",this.removeallInteraction)})),e(this,"hightLightPointMoveHandle",(t=>{let e=t.pixel;e.length||(e=this.handle.getEventPixel(t.originalEvent));const n=this.handle.forEachFeatureAtPixel(e,(function(t){const e=t.get(d),n=t.get(c),i=null==n?void 0:n.id;if(e&&i&&i.startsWith("draw_"))return t}));this.handle.getTargetElement().style.cursor=n?"pointer":""})),e(this,"dcNodePopupCb",(t=>e=>{var n,i,r;if(this.isShowDcActionPopup){let o=e.pixel;o.length||(o=this.handle.getEventPixel(e.originalEvent));const s=this.handle.forEachFeatureAtPixel(o,(function(t){const e=t.get(d),n=t.get(c),i=null==n?void 0:n.id;if(e&&i&&i.startsWith("draw_"))return t}));if(s){t.callback&&(t.callback(s),null==(n=this.vuePopupIns)||n.updateLayer(this.dcPopupOptions));let r=e.coordinate;if(t.popupIsCenter){r=Tn(s.getGeometry().getExtent())}null==(i=this.vuePopupIns)||i.showPopupByID(this.dcPopupOptions.id,r)}else t.eventType==jw&&(null==(r=this.vuePopupIns)||r.hiddenPopupByID(this.dcPopupOptions.id))}})),e(this,"getDrawData",(t=>e=>{const n=t.shape;this.customCallbackFunc=t.callback;let i=null,l=null,v={area:0,areaString:"0 m²"},w={length:0,lengthString:"0 m"},x="",b=[],C=null,S=null;const E=`draw_${Yt(10)}`;if("drawend"==e.type)S=e.feature,C=e.feature.getGeometry(),C.getType();else if("modifyend"==e.type||"translateend"==e.type){const t=e.features.getArray();S=t[0],C=t[0].getGeometry(),C.getType()}if(S.setId(E),S.setProperties({[d]:!0,[c]:{...t,id:E}}),n==r||n==o){x=o;const t=C.getCoordinates(),e=C.getType();if("MultiPoint"==e){l=new ju(t).transform("EPSG:3857","EPSG:4326").getCoordinates();const e=yf(Tn(C.getExtent()));b=[e.longitude,e.latitude]}else l=yf(t),l=[l.longitude,l.latitude],b=[l[0],l[1]];this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiPoint"==e?bp(l,this.__drawData):xp(l,this.__drawData)}else if(n==p||n==f||n==s||n==g){x=s;const t=C.getCoordinates(),e=C.getType();l="MultiPolygon"==e?new Vu(t).transform("EPSG:3857","EPSG:4326").getCoordinates():[this.getCoordinatesLngLat(t)],v=wf(C);const r=yf(Tn(C.getExtent()));b=[r.longitude,r.latitude],this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiPolygon"==e?Sp(l,this.__drawData):Cp(l,this.__drawData)}else if(n==a||n==m){x=a;const t=C.getType(),e=[C.getCoordinates()];if("MultiLineString"==t){l=new zu(e).transform("EPSG:3857","EPSG:4326").getCoordinates();const t=yf(Tn(C.getExtent()));b=[t.longitude,t.latitude]}else{l=this.getCoordinatesLngLat(e);const t=l[Math.floor(l.length/2)];b=[t[0],t[1]]}w=xf(C),this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i="MultiLineString"==t?Ip(l,this.__drawData):Ep(l,this.__drawData)}else if(n==_){x=s;const t=qr(C,128),e=t.getCoordinates();l=[this.getCoordinatesLngLat(e)],v=wf(t);const r=yf(C.getCenter());b=[r.longitude,r.latitude],this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i=Cp(l,this.__drawData)}else if(n==y&&(x=s,C.getType()==u)){const t=C.getGeometries();if(2==t.length&&t[1].getType()==o){const e=yf(t[1].getCoordinates());b=[e.longitude,e.latitude]}for(let e=0;e<t.length;e++)if(t[e].getType()==s){const r=t[e].getCoordinates();if(l=[this.getCoordinatesLngLat(r)],v=wf(C),b&&2!==b.length){const t=yf(Tn(C.getExtent()));b=[t.longitude,t.latitude]}this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,area:v,length:w},i=Cp(l,this.__drawData);break}}if(this.__drawData={id:E,shape:n,geoType:x,coordinates:l,center:b,geojson:i,area:v,length:w},this.__crurentSelDrawData=Ow.cloneDeep(this.__drawData),"drawend"==e.type){const e=t.isShowSegments??!1,n=t.isShowLngLat??!1,i=t.isShowLabel??!1,r=this.updateDrawStyleFunction(S,null,e,n,i,null);S.setStyle(r)}else if("modifyend"==e.type||"translateend"==e.type){const e=t.isShowSegments??!1,n=t.isShowLngLat??!1,i=t.isShowLabel??!1,r=S.get("__drawData");let o=null,s=null,a=null;r&&(o=r.geojson,o&&(s=o.properties,s&&(a=s.style)));const l=this.updateDrawStyleFunction(S,null,e,n,i,a);S.setStyle(l),a&&(this.__drawData.geojson.properties[Lz]=r.geojson.properties[Lz],this.__drawData.geojson.properties.style=a)}this.__drawData.oldDrawOptions=Ow.cloneDeep(t),this.__drawData.geojson.properties.__drawData=Ow.cloneDeep(this.__drawData),S.set("__drawData",this.__drawData),this.customCallbackFunc&&("drawend"==e.type?this.customCallbackFunc(h.draw,this.__drawData):"modifyend"!=e.type&&"translateend"!=e.type||this.customCallbackFunc(h.modify,this.__drawData))})),e(this,"intoModifyMode",(t=>{this.modify||(this.removeCancelDrawCB(),this.setCancelDrawCB(),this.modify=new wd({source:this.interactionSource,condition:function(t){return sc(t)&&!nc(t)},style:t=>this.modifyStyleFunction(t)}),this.modify.on("modifystart",(t=>{var e;this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),t.features.forEach((t=>{const e=t.getGeometry(),n=t.get(x);e.getType()===u?t.set(Vw,e.clone(),!0):n&&t.set(Hw,{geometry:e.clone()},!0)}))})),this.modify.on("modifyend",(e=>{e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0));const n=t.get(Hw);n&&(t.setGeometry(n.geometry),t.unset(Hw,!0),this.addGeoImage(t))}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))})),this.newTranslate&&(this.newTranslate=null),this.newTranslate=new Dd({condition:function(t){return sc(t)&&nc(t)},layers:[this.InteractionLayer]}),this.newTranslate.on("translateend",(e=>{e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0));const n=t.get(Hw);if(n)t.setGeometry(n.geometry),t.unset(Hw,!0),this.addGeoImage(t);else{const e=t.get(c);e&&e.image&&e.image.data&&this.addGeoImage(t)}}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))})),this.handle.addInteraction(this.snapTag),this.handle.addInteraction(this.modify),this.handle.addInteraction(this.newTranslate),this.modify.setActive(!0))})),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map,this.vuePopupIns=new Aw(t),this.mapEventIns=new Fw(t),this.geoImageIns=new xx(t),this.geoImageMaps=new Map,this.segmentStyles=[tx()],this.lableLngLatStyles=[rx()],this.labelStyles=nx(),this.interactionSource=new ah,this.InteractionLayer=new ku({source:this.interactionSource,zIndex:this.olBaseHandle.getCurrentzIndex()});const n="CUSTOM_INTER_"+Yt(10);this.InteractionLayer.set("id",this.__Id(n)),this.InteractionLayer.set("name",this.__Name(n)),this.defaultModifyStyle=new wd({source:this.interactionSource}).getOverlay().getStyleFunction(),this.snapTag=new Ed({source:this.interactionSource});const i={source:this.interactionSource,layer:this.InteractionLayer};this.handle&&(this.handle.addLayer(this.InteractionLayer),this.__layers.set(this.__Id(n),i)),this.setActionPopup()}innerT(t){return`$innerT_${t}`}updateDrawStyleFunction(t,e,n,i,h,c){let d={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},p={...ix},f={...Qw},g={...ex},m={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"};c&&c.geo&&(d={width:c.geo.width,color:c.geo.color,fillColor:c.geo.fillColor,radius:c.geo.radius,radius2:c.geo.radius2,lineDash:c.geo.lineDash,iconWidth:c.geo.iconWidth,iconHeight:c.geo.iconHeight,iconPattern:c.geo.iconPattern,iconUrl:c.geo.iconUrl,iconAnchor:c.geo.iconAnchor,iconOffset:c.geo.iconOffset,arrowPattern:c.geo.arrowPattern}),c&&c.vertex&&(p={fontSize:c.vertex.fontSize,color:c.vertex.color,fillColor:c.vertex.fillColor}),c&&c.line&&(f={fontSize:c.line.fontSize,color:c.line.color,fillColor:c.line.fillColor}),c&&c.label&&(g={fontSize:c.label.fontSize,color:c.label.color,fillColor:c.label.fillColor}),c&&c.text&&(m={text:c.text.text||"点击编辑文本",fontSize:c.text.fontSize,offsetY:c.text.offsetY,offsetX:c.text.offsetX,padding:c.text.padding,textBaseline:c.text.textBaseline,color:c.text.color,fillColor:c.text.fillColor,rotation:c.text.rotation});let _=null;this.__currentOptions&&(_=this.__currentOptions.shape),_&&_==r&&(d.color="rgba(24, 144, 255, 0)",d.fillColor="rgba(24, 144, 255, 0)",m.text||(m.text="点击编辑文本"));const y=[Jw(d,m)],v=t.getGeometry(),w=v.getType();let x,b,C,S,E,I=!1;if(!e||e===w)if(w===o)E=[v.getCoordinates()],I=!1;else if(w===s)x=v.getInteriorPoint(),C=wf(v),E=v.getCoordinates()[0],S=new lo(v.getCoordinates()[0]),I=!0;else if(w===a)x=new Tr(v.getLastCoordinate()),b=xf(v),E=v.getCoordinates(),S=v,I=!1;else if(w===l){x=new Tr(v.getFirstCoordinate());C=wf(qr(v,128)),E=[],E.push(v.getCenter()),E.push(v.getLastCoordinate()),E[0][1]=E[0][1]+7e5,I=!1}else if(w===u){const t=v.getGeometries();for(let e=0;e<t.length;e++)if(t[e].getType()==s)C=wf(v);else if(t[e].getType()==o){x=new Tr(t[e].getCoordinates());const n=t[e].getCoordinates();n[1]=n[1]+7e5,E=[n]}I=!1}if(n&&f.fontSize&&S){let t=0;const e=[];S.forEachSegment(((n,i)=>{const r=new lo([n,i]),o=xf(r);e.push(tx(f));const s=new Tr(r.getCoordinateAt(.5));e[t].setGeometry(s),e[t].getText().setText(o.lengthString),y.push(e[t]),t++}))}if(i&&p.fontSize&&E){let t=0;const e=I?E.length-1:E.length,n=[];for(let i=0;i<e;i++){const e=Wi(E[i],"EPSG:3857","EPSG:4326"),{longitude:r,latitude:o}=_p(e[0],e[1]),s=`${r.toFixed(6)}, ${o.toFixed(6)}`;n.push(rx(p));const a=new Tr(E[i]);n[t].setGeometry(a),n[t].getText().setText(s),y.push(n[t]),t++}}if(h&&g.fontSize){const t=nx(g);w===s||w===l||w===u?(t.setGeometry(x),t.getText().setText(null==C?void 0:C.areaString),y.push(t)):w===a&&(t.setGeometry(x),t.getText().setText(null==b?void 0:b.lengthString),y.push(t))}if("arrow"==d.iconPattern&&d.iconUrl)if(d.radius=d.iconWidth,d.radius2=d.iconHeight,d.url=d.iconUrl,"last"==d.arrowPattern){const t=v.getCoordinates();if(t.length&&t.length>=2){const e=t.length-1;let n=0;v.forEachSegment(((t,i)=>{if(n++,n==e){const e=i[0]-t[0],n=i[1]-t[1],r=Math.atan2(n,e);d.rotation=-r;const o=Kw(d),s=new Tr(i);o.setGeometry(s),y.push(o)}}))}}else"every"==d.arrowPattern?v.forEachSegment(((t,e)=>{const n=e[0]-t[0],i=e[1]-t[1],r=Math.atan2(i,n);d.rotation=-r;const o=Kw(d),s=new Tr(e);o.setGeometry(s),y.push(o)})):d.arrowPattern;return y}getPanelPosition(){var t;const e=null==(t=this.olBaseHandle)?void 0:t.container;let n=window.innerWidth-480;if(e){const t=document.getElementById(e);(null==t?void 0:t.clientWidth)&&(n=(null==t?void 0:t.clientWidth)-480)}return this.handle.getCoordinateFromPixel([n,60])}destructor(){this.geoImageMaps.clear(),this.geoImageMaps=null,this.mapEventIns.destructor(),this.vuePopupIns.destructor(),this.geoImageIns.destructor(),this.modify=null,this.snapTag=null,this.drawTag=null,this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}setActionPopup(){var t,e,n,i,l,u,d;this.dcPopupOptions={id:`${this.__layerIdPrefix}dc_popup`,name:`${this.__layerIdPrefix}vnode_popup`,vNode:Px,vNodeData:{data:this.__crurentSelDrawData,cancelCb:()=>{var t,e;this.__removeSourceFeatureById(this.__crurentSelDrawData.id),null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id),null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.drawTipPopupOptions.id),this.customCallbackFunc=this.__currentOptions.callback;const n=this.__crurentSelDrawData.oldDrawOptions;n&&n.shape==f&&this.geoImageIns&&(n.addId&&n.addId.startsWith("label_image_")?this.geoImageIns.removeLayerByID(n.addId):n.id&&n.id.startsWith("label_image_")&&this.geoImageIns.removeLayerByID(n.id)),this.customCallbackFunc&&this.customCallbackFunc(h.delete,this.__crurentSelDrawData)},modifyCb:()=>{var t,e;null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id),null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.drawTipPopupOptions.id),this.intoModifyMode(this.__currentOptions),this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null)},editCb:()=>{var t,e,n,i,l,u,c,d,v,x,b,C;null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id),null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.drawTipPopupOptions.id);const S=this.__currentOptions.shape,E=this.__currentOptions.image;switch(S){case r:{this.propsPanelPopupOptions[r].vNodeData.data=this.__crurentSelDrawData,null==(n=this.vuePopupIns)||n.updateLayer(this.propsPanelPopupOptions[r]);const t=this.handle.getCoordinateFromPixel([0,0]);null==(i=this.vuePopupIns)||i.showPopupByID(this.propsPanelPopupOptions[r].id,t);break}case o:{this.propsPanelPopupOptions[o].vNodeData.data=this.__crurentSelDrawData,null==(l=this.vuePopupIns)||l.updateLayer(this.propsPanelPopupOptions[o]);const t=this.handle.getCoordinateFromPixel([0,0]);null==(u=this.vuePopupIns)||u.showPopupByID(this.propsPanelPopupOptions[o].id,t);break}case p:case f:case s:case g:case _:case y:if(E&&E.data){this.propsPanelPopupOptions[w].vNodeData.data=this.__crurentSelDrawData,null==(c=this.vuePopupIns)||c.updateLayer(this.propsPanelPopupOptions[w]);const t=this.handle.getCoordinateFromPixel([0,0]);null==(d=this.vuePopupIns)||d.showPopupByID(this.propsPanelPopupOptions[w].id,t)}else{this.propsPanelPopupOptions[f].vNodeData.data=this.__crurentSelDrawData,null==(v=this.vuePopupIns)||v.updateLayer(this.propsPanelPopupOptions[f]);const t=this.handle.getCoordinateFromPixel([0,0]);null==(x=this.vuePopupIns)||x.showPopupByID(this.propsPanelPopupOptions[f].id,t)}break;case a:case m:{this.propsPanelPopupOptions[a].vNodeData.data=this.__crurentSelDrawData,null==(b=this.vuePopupIns)||b.updateLayer(this.propsPanelPopupOptions[a]);const t=this.handle.getCoordinateFromPixel([0,0]);null==(C=this.vuePopupIns)||C.showPopupByID(this.propsPanelPopupOptions[a].id,t);break}}this.customCallbackFunc=this.__currentOptions.callback,this.customCallbackFunc&&this.customCallbackFunc(h.edit,this.__crurentSelDrawData)},confirmCb:()=>{var t,e;null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id),null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.drawTipPopupOptions.id),this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null),this.outModifyMode(),this.customCallbackFunc=this.__currentOptions.callback,this.customCallbackFunc&&this.customCallbackFunc(h.complete,this.__crurentSelDrawData)}},wrapX:!0,callback:t=>{this.__currentFeature=t,this.__crurentSelDrawData=t.get("__drawData"),this.__currentOptions=t.get(c),this.dcPopupOptions.vNodeData.data=this.__crurentSelDrawData},popupIsCenter:!1,eventType:Nw},null==(t=this.vuePopupIns)||t.addLayer(this.dcPopupOptions),null==(e=this.vuePopupIns)||e.addLayer(this.propsPanelPopupOptions[f]),null==(n=this.vuePopupIns)||n.addLayer(this.propsPanelPopupOptions[o]),null==(i=this.vuePopupIns)||i.addLayer(this.propsPanelPopupOptions[r]),null==(l=this.vuePopupIns)||l.addLayer(this.propsPanelPopupOptions[a]),null==(u=this.vuePopupIns)||u.addLayer(this.propsPanelPopupOptions[w]);const v=this.dcNodePopupCb(this.dcPopupOptions);this.dcEventSingleOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:Nw,cb:v,delay:300,debounce:!1},this.mapEventIns.addEvent(this.dcEventSingleOptions),this.dcEventDbclickOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:zw,cb:v,delay:300,debounce:!1},this.mapEventIns.addEvent(this.dcEventDbclickOptions),this.dcEventDragOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:Bw,cb:v,delay:300,debounce:!0},this.mapEventIns.addEvent(this.dcEventDragOptions),this.dcEventPointMoveOptions={id:`${this.__layerIdPrefix}_${Yt(10)}_map_event`,type:jw,cb:this.hightLightPointMoveHandle,delay:10,debounce:!1},this.mapEventIns.addEvent(this.dcEventPointMoveOptions),this.olBaseHandle&&this.olBaseHandle.customT&&(this.drawTipPopupOptions.customT=this.olBaseHandle.customT),null==(d=this.vuePopupIns)||d.addLayer(this.drawTipPopupOptions),this.mapEventIns.addEvent(this.drawTipEventPointMoveOptions),this.mapEventIns.addEvent(this.drawTipEventZoomOptions)}removeallInteraction(){var t;this.handle&&(this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null),this.modify&&(this.handle.removeInteraction(this.snapTag),this.handle.removeInteraction(this.modify),this.handle.removeInteraction(this.newTranslate),this.modify=null),null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.drawTipPopupOptions.id))}drawStyleFunction(t,e,n,i,h){const c={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},d={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"},p=this.__currentOptions.shape;p&&p==r&&(c.color="rgba(24, 144, 255, 0)",c.fillColor="rgba(24, 144, 255, 0)",d.text="点击编辑文本");const f=[Jw(c,d)],g=t.getGeometry();if(!g)return null;const m=g.getType();let _,y,v,w,x,b=!1;if(!e||e===m)if(m===o)x=[g.getCoordinates()],b=!1;else if(m===s)_=g.getInteriorPoint(),v=wf(g),x=g.getCoordinates()[0],w=new lo(g.getCoordinates()[0]),b=!0;else if(m===a)_=new Tr(g.getLastCoordinate()),y=xf(g),x=g.getCoordinates(),w=g,b=!1;else if(m===l){_=new Tr(g.getFirstCoordinate());v=wf(qr(g,128)),x=[],x.push(g.getCenter()),x.push(g.getLastCoordinate()),x[0][1]=x[0][1]+7e5,b=!1}else if(m===u){const t=g.getGeometries();for(let e=0;e<t.length;e++)if(t[e].getType()==s)v=wf(g);else if(t[e].getType()==o){_=new Tr(t[e].getCoordinates());const n=t[e].getCoordinates();n[1]=n[1]+7e5,x=[n]}b=!1}if(n&&w){let t=0;w.forEachSegment(((e,n)=>{const i=new lo([e,n]),r=xf(i);this.segmentStyles.length-1<t&&this.segmentStyles.push(tx({...Qw}));const o=new Tr(i.getCoordinateAt(.5));this.segmentStyles[t].setGeometry(o),this.segmentStyles[t].getText().setText(r.lengthString),f.push(this.segmentStyles[t]),t++}))}if(i&&x){let t=0;const e=b?x.length-1:x.length;for(let n=0;n<e;n++){const e=Wi(x[n],"EPSG:3857","EPSG:4326"),{longitude:i,latitude:r}=_p(e[0],e[1]),o=`${i.toFixed(6)}, ${r.toFixed(6)}`;this.lableLngLatStyles.length-1<t&&this.lableLngLatStyles.push(rx({...ix}));const s=new Tr(x[n]);this.lableLngLatStyles[t].setGeometry(s),this.lableLngLatStyles[t].getText().setText(o),f.push(this.lableLngLatStyles[t]),t++}}return h&&(this.labelStyles=nx({...ex}),m===s||m===l||m===u?(this.labelStyles.setGeometry(_),this.labelStyles.getText().setText(null==v?void 0:v.areaString),f.push(this.labelStyles)):m===a&&(this.labelStyles.setGeometry(_),this.labelStyles.getText().setText(null==y?void 0:y.lengthString),f.push(this.labelStyles))),f}calculateCenter(t){let e,n,i;const r=t.getType();if("Polygon"===r){let i=0,r=0,o=0;n=t.getCoordinates()[0].slice(1),n.forEach((function(t){i+=t[0],r+=t[1],o++})),e=[i/o,r/o]}else"LineString"===r?(e=t.getCoordinateAt(.5),n=t.getCoordinates()):e=Tn(t.getExtent());let o;return n?(o=n.map((function(t){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i})),i=Math.sqrt(Math.max.apply(Math,o))/3):i=Math.max(An(t.getExtent()),Ln(t.getExtent()))/3,{center:e,coordinates:n,minRadius:i,sqDistances:o}}modifyStyleFunction(t){return t.get("features").forEach((e=>{const n=e.get(Vw),i=e.get(Hw);if(n){const i=t.getGeometry().getCoordinates(),r=e.getGeometry().getGeometries(),o=r[0].getCoordinates()[0],s=r[1].getCoordinates(),a=this.handle.getView().getProjection();let l,u,h;i[0]===s[0]&&i[1]===s[1]?(l=Wi(o[0],a,"EPSG:4326"),u=Wi(o[(o.length-1)/2],a,"EPSG:4326"),h=Ci(l,u)/2):(l=Wi(s,a,"EPSG:4326"),u=Wi(i,a,"EPSG:4326"),h=Ci(l,u));const c=$r(Wi(s,a,"EPSG:4326"),h,128);c.transform("EPSG:4326",a),r[0].setCoordinates(c.getCoordinates()),n.setGeometries(r)}else if(i){const e=t.getGeometry().getCoordinates();let n=i.point;if(!n){n=e,i.point=n,i.geometry0=i.geometry;const t=this.calculateCenter(i.geometry0);i.center=t.center,i.minRadius=t.minRadius}const r=i.center,o=i.minRadius;let s,a;s=n[0]-r[0],a=n[1]-r[1];const l=Math.sqrt(s*s+a*a);if(l>o){const t=Math.atan2(a,s);s=e[0]-r[0],a=e[1]-r[1];const n=Math.sqrt(s*s+a*a);if(n>0){const e=Math.atan2(a,s),o=i.geometry0.clone();o.scale(n/l,void 0,r),o.rotate(e-t,r),i.geometry=o}}}})),this.defaultModifyStyle(t)}drawShape(t){var e,n;const i=t.shape,h=t.isClear??!1,d=t.isFreehand??!1,v=t.isShowSegments??!1,w=t.isShowLngLat??!1,b=t.isShowLabel??!1;if(this.isShowDcActionPopup=t.isShowAction??!1,this.isShowTipPopup=t.isShowTip??!1,this.handle&&this.olBaseHandle){h&&this.clearAllDrawShape(),this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),this.isShowTipPopup||null==(n=this.vuePopupIns)||n.hiddenPopupByID(this.drawTipPopupOptions.id),this.removeCancelDrawCB(),this.setCancelDrawCB(),this.removeallInteraction(),this.__currentOptions=t,this.__drawData=null,this.drawType=i,this.drawModel=i,this.customCallbackFunc=t.callback;let C=null;i===r||i==o?this.drawType=o:i==p?(this.drawType=l,C=ld(4)):i==f?(this.drawType=l,C=ud()):i==s?this.drawType=s:i==a?this.drawType=a:i==_?this.drawType=_:i==y?(this.drawType=l,C=function(t,e,n){e||(e=new Fu([new Ur([]),new Tr(t[0])]));const i=e.getGeometries(),r=Wi(t[0],n,"EPSG:4326"),o=$r(r,Ci(r,Wi(t[1],n,"EPSG:4326")),128);return Sf(o),o.transform("EPSG:4326",n),i[0].setCoordinates(o.getCoordinates()),e.setGeometries(i),e}):i==m?this.drawType=a:i==g&&(this.drawType=s),this.drawTag&&(this.drawTag=null),this.drawTag=new hd({source:this.interactionSource,type:this.drawType,geometryFunction:C,style:t=>this.drawStyleFunction(t,this.drawType,v,w,b),freehand:d}),this.InteractionLayer.setStyle((t=>this.drawStyleFunction(t,null,v,w,b))),this.drawTag.on("drawstart",(e=>{var n;this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(n=this.vuePopupIns)||n.hiddenPopupByID(this.dcPopupOptions.id)),this.setDrawBackCB(),this.drawLayerZIndex=this.olBaseHandle.getCurrentzIndex()+1,this.InteractionLayer.setZIndex(this.drawLayerZIndex),t.needModify&&this.modify&&this.modify.setActive(!1)})),this.drawTag.on("drawend",(e=>{this.removeDrawBackCB(),t.needModify&&this.modify&&this.modify.setActive(!0),this.getDrawData(t)(e),t.once?(t.needModify?this.drawTag&&(this.handle.removeInteraction(this.drawTag),this.drawTag=null):this.drawTag&&this.removeallInteraction(),this.removeCancelDrawCB()):t.needModify||(this.handle.removeInteraction(this.modify),this.handle.removeInteraction(this.newTranslate),this.handle.removeInteraction(this.snapTag))})),t.needModify&&(this.modify&&(this.modify=null),this.modify=new wd({source:this.interactionSource,condition:function(t){return sc(t)&&!nc(t)},style:t=>this.modifyStyleFunction(t)}),this.modify.on("modifystart",(t=>{var e;this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(e=this.vuePopupIns)||e.hiddenPopupByID(this.dcPopupOptions.id)),t.features.forEach((t=>{const e=t.getGeometry(),n=t.get(x);e.getType()===u?t.set(Vw,e.clone(),!0):n&&t.set(Hw,{geometry:e.clone()},!0)}))})),this.modify.on("modifyend",(e=>{e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0));const n=t.get(Hw);n&&(t.setGeometry(n.geometry),t.unset(Hw,!0),this.addGeoImage(t))}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))})),this.newTranslate&&(this.newTranslate=null),this.newTranslate=new Dd({condition:function(t){return sc(t)&&nc(t)},layers:[this.InteractionLayer]}),this.newTranslate.on("translateend",(e=>{e.features.forEach((t=>{const e=t.get(Vw);e&&(t.setGeometry(e),t.unset(Vw,!0));const n=t.get(Hw);if(n)t.setGeometry(n.geometry),t.unset(Hw,!0),this.addGeoImage(t);else{const e=t.get(c);e&&e.image&&e.image.data&&this.addGeoImage(t)}}));const n=e.features.getArray()[0].get(c);let i=null;n&&(i={...n}),i?(this.__currentOptions=i,this.getDrawData(i)(e)):(this.__currentOptions=t,this.getDrawData(t)(e))}))),this.handle.addInteraction(this.drawTag),this.handle.addInteraction(this.snapTag),t.needModify&&(this.handle.addInteraction(this.modify),this.handle.addInteraction(this.newTranslate),this.modify.setActive(!0))}}outModifyMode(){this.handle&&(this.removeCancelDrawCB(),this.modify&&(this.handle.removeInteraction(this.modify),this.handle.removeInteraction(this.newTranslate),this.handle.removeInteraction(this.snapTag),this.modify=null))}getCoordinatesLngLat(t){const e=[];return t[0].forEach((t=>{const n=Wi(t,"EPSG:3857","EPSG:4326"),{longitude:i,latitude:r}=_p(n[0],n[1]);e.push([i,r])})),e}updateAllDrawDataLabelStyle(t,e,n,i){var r;this.isShowTipPopup=i,this.isShowTipPopup||null==(r=this.vuePopupIns)||r.hiddenPopupByID(this.drawTipPopupOptions.id),this.interactionSource.forEachFeature((r=>{const o=r.get(d),s=r.get(c);s.isShowLabel=n,s.isShowLngLat=e,s.isShowSegments=t,s.isShowTip=i,r.setProperties({[c]:s});const a=r.get("__drawData");let l=null,u=null,h=null;if(a&&(l=a.geojson,l&&(u=l.properties,u&&(h=u.style))),o){const i=this.updateDrawStyleFunction(r,null,t,e,n,h);r.setStyle(i)}}))}getAllDrawData(){const t={type:"FeatureCollection",features:[]};return this.interactionSource.forEachFeature((e=>{const n=e.get(d),i=e.get("__drawData");if(n){const e=Ow.cloneDeep(i.geojson);t.features.push(e)}})),t}saveAllDrawData(t="geojson.json"){const e=this.getAllDrawData();if(e&&e.features&&e.features.length){const n=JSON.stringify(e),i=new Blob([n],{type:"application/json"}),r=URL.createObjectURL(i),o=document.createElement("a");return o.href=r,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),e}return null}addGeojsonData(t){if(!t.data||!t.id)return null;this.isShowDcActionPopup=t.isShowAction??!1,this.__currentOptions=null;const e=new Gd({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(t.data);this.interactionSource.addFeatures(e);const n=e.length;let i=0;e.forEach((e=>{const r=e.get(c),l=e.get(v),p=e.get(d);if(!l&&p&&r);else{const n=e.get("__drawData");let i=n&&n.id;i||(i=`draw_${Yt(10)}`),e.setId(i);let r=t.isShowSegments,l=t.isShowLngLat,p=t.isShowLabel;const f={[d]:!0,[c]:{id:i,addId:t.id},[v]:!0},g=e.get("style"),m=e.get("editProps");if(n){if(n.oldDrawOptions){const e=n.oldDrawOptions;r=e.isShowSegments??!0,l=e.isShowLngLat??!0,p=e.isShowLabel??!0,this.__currentOptions=e,e.shape&&e.shape==_&&(e.shape=s),e.shape&&e.shape==y&&(e.shape=s),e.shape&&e.shape==u&&(e.shape=s),f[c]={...e,callback:t.callback,id:i,addId:t.id},e.image&&e.image.data&&e.addId&&(f[c].addId=e.addId)}n.geojson.properties[Lz]=Ow.cloneDeep(m),n.geojson.properties.style=Ow.cloneDeep(g),n.geojson.properties.__drawData=Ow.cloneDeep(n),t.callback&&t.callback(h.draw,n)}else{const n=e.getGeometry().getType();t.shape="Point"===n||"MultiPoint"===n?o:"Polygon"===n||"MultiPolygon"===n?s:"LineString"===n||"MultiLineString"===n?a:s,f[c]={...t,id:i,addId:t.id},this.getDrawData(t)({type:"drawend",feature:e})}let w=null;if(w=g?this.updateDrawStyleFunction(e,null,r,l,p,g):this.updateDrawStyleFunction(e,null,r,l,p,null),e.setStyle(w),e.setProperties(f),e.setProperties({[v]:!0}),n&&n.oldDrawOptions){const t=n.oldDrawOptions;t.image&&t.image.data&&(this.addGeoImage(e),e.setProperties({[x]:!0}))}}i+=1,i===n&&this.olBaseHandle.fitToFeature(e,[120,120,120,120])}))}removeGeojsonData(t){const e=[];this.interactionSource.forEachFeature((n=>{const i=n.get(c);n.get(v)&&i&&i.addId==t.id&&e.push(n)})),e.forEach((t=>{this.interactionSource.removeFeature(t)}))}addImageData(t){if(!t.image||!t.id)return null;this.isShowDcActionPopup=t.isShowAction??!1,this.__currentOptions=null;const e=new Gd({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}),n=t.image,i=this.handle.getView().getCenter(),r=this.handle.getPixelFromCoordinate(i),o=150,s=parseInt(""+o*n.height/n.width),a=r[0]-o,l=r[1]+s,u=r[0]+o,h=r[1]-s,p=this.handle.getCoordinateFromPixel([a,l]),f=this.handle.getCoordinateFromPixel([u,h]),g=mf(p),m=mf(f),_=function(t,e,n,i,r={}){const o={polygon:[[[t,e],[n,e],[n,i],[t,i],[t,e]]],...r};return mp.parse(o,{Polygon:"polygon"})}(g[0],g[1],m[0],m[1]);t.data=_,t.image.scaleWidth=300,t.image.scaleHeight=2*s,t.image.anchor=[.5,.5],t.image.offset=[0,0],t.image.rotate=0;const y=e.readFeatures(_);this.interactionSource.addFeatures(y),y.forEach((e=>{const n=`draw_${Yt(10)}`;e.setId(n);const i=t.isShowSegments,r=t.isShowLngLat,o=t.isShowLabel,s={[d]:!0,[c]:{...t,id:n,addId:t.id},[v]:!0,[x]:!0};e.get("style"),this.getDrawData(t)({type:"drawend",feature:e});const a=this.updateDrawStyleFunction(e,null,i,r,o,null);e.setStyle(a),e.setProperties(s),this.addGeoImage(e)}))}addGeoImage(t){var e,n;const i=t.get(c);if(i){const r=i.addId;null==(e=this.geoImageIns)||e.removeLayerByID(r);const o=t.getGeometry().getCoordinates(),s=[this.getCoordinatesLngLat(o)],a={id:i.addId,url:i.image.data,isRotation:!0,bbox:s};null==(n=this.geoImageIns)||n.addLayer(a)}}getOrginDrawData(){return this.__drawData}clearAllDrawShape(){var t,e;this.dcPopupOptions&&this.dcPopupOptions.id&&(null==(t=this.vuePopupIns)||t.hiddenPopupByID(this.dcPopupOptions.id)),this.interactionSource&&this.interactionSource.clear(),null==(e=this.geoImageIns)||e.clearLayer(),this.vuePopupIns&&this.vuePopupIns.hiddenPopupAll()}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{this.handle.removeLayer(t.layer)})),this.__layers.clear(),!0)}}class Oz{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"mapDomContainner"),e(this,"__layers",null),e(this,"__layerIdPrefix","POPUP_"),this.olBaseHandle=t,this.handle=t.handle,this.mapDomContainner=this.handle.getTargetElement(),this.__layers=new Map}destructor(){this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__IdDom(t){return`${this.__layerIdPrefix}${t}_dom`}createLayer(t={id:"",hasClose:!0,duration:250}){var e;if(!t.id)return null;const n=document.createElement("div");n.className="ol_popup_wrapper",n.id=this.__IdDom(t.id);let i=null;t.hasClose&&(i=document.createElement("div"),i.className="ol_popup_closer",i.appendChild(document.createTextNode("x")),n.appendChild(i));const r=document.createElement("div");r.className="col_nw_fs_center ol_popup_content",n.appendChild(r),null==(e=this.mapDomContainner)||e.appendChild(n);const o=new Fc({id:this.__Id(t.id),element:n,autoPan:!0});let s=()=>{};t.hasClose&&(s=()=>{o.setPosition(void 0),i.blur()},null==i||i.addEventListener("click",s,!1));return{options:t,overlayDom:n,overlayCloeseDom:i,overlayCtxDom:r,closeFunc:s,overlay:o}}addLayer(t){if(this.handle){const e=this.createLayer(t);return!!e&&(this.handle.addOverlay(e.overlay),this.__layers.set(this.__Id(t.id),e),!0)}return!1}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(e.overlayCloeseDom&&e.overlayCloeseDom.removeEventListener("click",e.closeFunc,!1),e.overlay.setPosition(void 0),this.handle.removeOverlay(e.overlay),this.__layers.delete(this.__Id(t)),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{t.overlayCloeseDom&&t.overlayCloeseDom.removeEventListener("click",t.closeFunc,!1),this.handle.removeOverlay(t.overlay)})),this.__layers.clear(),!0)}showPopup(t,e,n){return this.showPopupByID(t.id,e,n)}showPopupByID(t,e,n){if(this.olBaseHandle){const i=this.__layers.get(this.__Id(t));return!!i&&(i.overlayCtxDom.innerHTML=n,i.overlay.setPosition(e),!0)}return!1}hiddenPopup(t){return this.hiddenPopupByID(t.id)}hiddenPopupByID(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));return!!e&&(e.overlay.setPosition(void 0),!0)}return!1}}class Fz{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"vuePopupIns",null),e(this,"normalPopupIns",null),e(this,"mapEventIns",null),e(this,"__layers",null),e(this,"__layerIdPrefix","GEOJSON_BASIC_"),e(this,"__currentOptions",null),e(this,"toggleStyleFunction",(t=>t=>{if(t.get(v)){const e=t.get("__drawData");let n=!0,i=!0,r=!0;const o=t.get("style");if(e&&e.oldDrawOptions){const t=e.oldDrawOptions;n=t.isShowSegments??!0,i=t.isShowLngLat??!0,r=t.isShowLabel??!0,this.__currentOptions=t}let s=null;return s=o?this.updateDrawStyleFunction(t,null,n,i,r,o):this.updateDrawStyleFunction(t,null,n,i,r,null),s}{let e="rgba(20 ,20, 20, 0.2)",n="rgba(20 ,20, 20, 1)",i=2,r="rgba(20 ,20, 20, 1)",o="rgba(255 ,255, 255, 0.2)",s=12,a=null;const l=null==t?void 0:t.get(c),u=null==t?void 0:t.get("style");if(u){let t=u.fillColor;t&&(t=Ww(t),e=t);let a=u.color;a&&(a=Ww(a),n=a);let l=u.width;l&&(l=parseInt(l),i=isNaN(l)?2:l);let h=u.radius;h&&(h=parseInt(h),s=isNaN(h)?2:h);let c=u.fontFillColor;c&&(c=Ww(c),o=c);let d=u.fontColor;d&&(d=Ww(d),r=d)}else if(l){const u=l.style,h=l.styleFunction;if(u){let t=u.fillColor;t&&(t=Ww(t),e=t);let a=u.color;a&&(a=Ww(a),n=a);let l=u.width;l&&(l=parseInt(l),i=isNaN(l)?2:l);let h=u.radius;h&&(h=parseInt(h),s=isNaN(h)?2:h);let c=u.fontFillColor;c&&(c=Ww(c),o=c);let d=u.fontColor;d&&(d=Ww(d),r=d)}else if(h)return a=h(t),a}const h=(null==t?void 0:t.get("name"))??"",d={fillColor:e,color:n,width:i,radius:s,text:h},p={fillColor:o,color:r,width:i,text:h};return new Ts({fill:Uw(d),stroke:$w(d),image:qw(d),text:Yw(p)})}})),e(this,"setFeatureStyle",(t=>{let e="rgba(20 ,20, 20, 0.2)",n="rgba(20 ,20, 20, 1)",i=2,r="rgba(20 ,20, 20, 1)",o="rgba(255 ,255, 255, 0.2)",s=12,a=null;const l=t.style;if(l){let t=l.fillColor;t&&(t=Ww(t),e=t);let a=l.color;a&&(a=Ww(a),n=a);let u=l.width;u&&(u=parseInt(u),i=isNaN(u)?2:u);let h=l.radius;h&&(h=parseInt(h),s=isNaN(h)?2:h);let c=l.fontFillColor;c&&(c=Ww(c),o=c);let d=l.fontColor;d&&(d=Ww(d),r=d)}const u={fillColor:e,color:n,width:i,radius:s,text:""},h={fillColor:o,color:r,width:i,text:""};if(a=new Ts({fill:Uw(u),stroke:$w(u),image:qw(u),text:Yw(h)}),t.id&&this.hasLayer(t)&&this.handle){const e=this.__layers.get(this.__Id(t.id));e&&e.layer.setStyle(a)}})),e(this,"resetFeatureStyle",(t=>{if(t.id&&this.hasLayer(t)&&this.handle){const e=this.__layers.get(this.__Id(t.id));if(e){const n=this.toggleStyleFunction(t)||lx;e.layer.setStyle(n)}}})),e(this,"narmalPopupCb",(t=>e=>{var n,i;let r=e.pixel;r.length||(r=this.handle.getEventPixel(e.originalEvent));const o=this.handle.forEachFeatureAtPixel(r,(function(e){const n=e.get(d),i=e.get(c),r=null==i?void 0:i.id;if(n&&r===t.id)return e}));if(o){t.callback&&t.callback(o,t);let i=e.coordinate;if(t.popupIsCenter){i=Tn(o.getGeometry().getExtent())}null==(n=this.normalPopupIns)||n.showPopupByID(t.id,i,t.htmlString)}else t.eventType==jw&&(null==(i=this.normalPopupIns)||i.hiddenPopupByID(t.id))})),e(this,"vNodePopupCb",(t=>e=>{var n,i,r,o;let s=e.pixel;s.length||(s=this.handle.getEventPixel(e.originalEvent));const a=this.handle.forEachFeatureAtPixel(s,(function(e){const n=e.get(d),i=e.get(c),r=null==i?void 0:i.id;if(n&&r===t.id)return e}));if(a){t.callback&&(t.callback(a,t),null==(n=this.vuePopupIns)||n.updateLayer(t)),t.preCloseAll&&(null==(i=this.vuePopupIns)||i.hiddenPopupAll());let o=e.coordinate;if(t.popupIsCenter){o=Tn(a.getGeometry().getExtent())}null==(r=this.vuePopupIns)||r.showPopupByID(t.id,o)}else t.eventType==jw&&(null==(o=this.vuePopupIns)||o.hiddenPopupByID(t.id))})),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map,this.mapEventIns=new Fw(t),this.normalPopupIns=new Oz(t),this.vuePopupIns=new Aw(t)}destructor(){this.normalPopupIns.destructor(),this.vuePopupIns.destructor(),this.mapEventIns.destructor(),this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers.clear(),this.__layers=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}updateDrawStyleFunction(t,e,n,i,h,c){let d={width:2,color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)",radius:5,radius2:5,lineDash:[0,0],iconWidth:6,iconHeight:6,iconPattern:"pattern",iconUrl:"circle",iconAnchor:[.5,.5],iconOffset:[0,0],arrowPattern:"noNeed"},p={...ix},f={...Qw},g={...ex},m={text:"",fontSize:14,offsetY:0,offsetX:0,rotation:0,padding:[0,0,0,0],textBaseline:"bottom",color:"rgba(24, 144, 255, 1)",fillColor:"rgba(24, 144, 255, .2)"};c&&c.geo&&(d={width:c.geo.width,color:c.geo.color,fillColor:c.geo.fillColor,radius:c.geo.radius,radius2:c.geo.radius2,lineDash:c.geo.lineDash,iconWidth:c.geo.iconWidth,iconHeight:c.geo.iconHeight,iconPattern:c.geo.iconPattern,iconUrl:c.geo.iconUrl,iconAnchor:c.geo.iconAnchor,iconOffset:c.geo.iconOffset,arrowPattern:c.geo.arrowPattern}),c&&c.vertex&&(p={fontSize:c.vertex.fontSize,color:c.vertex.color,fillColor:c.vertex.fillColor}),c&&c.line&&(f={fontSize:c.line.fontSize,color:c.line.color,fillColor:c.line.fillColor}),c&&c.label&&(g={fontSize:c.label.fontSize,color:c.label.color,fillColor:c.label.fillColor}),c&&c.text&&(m={text:c.text.text||"点击编辑文本",fontSize:c.text.fontSize,offsetY:c.text.offsetY,offsetX:c.text.offsetX,padding:c.text.padding,textBaseline:c.text.textBaseline,color:c.text.color,fillColor:c.text.fillColor,rotation:c.text.rotation});let _=null;this.__currentOptions&&(_=this.__currentOptions.shape),_&&_==r&&(d.color="rgba(24, 144, 255, 0)",d.fillColor="rgba(24, 144, 255, 0)",m.text||(m.text="点击编辑文本"));const y=[Jw(d,m)],v=t.getGeometry(),w=v.getType();let x,b,C,S,E,I=!1;if(!e||e===w)if(w===o)E=[v.getCoordinates()],I=!1;else if(w===s)x=v.getInteriorPoint(),C=wf(v),E=v.getCoordinates()[0],S=new lo(v.getCoordinates()[0]),I=!0;else if(w===a)x=new Tr(v.getLastCoordinate()),b=xf(v),E=v.getCoordinates(),S=v,I=!1;else if(w===l){x=new Tr(v.getFirstCoordinate());C=wf(qr(v,128)),E=[],E.push(v.getCenter()),E.push(v.getLastCoordinate()),E[0][1]=E[0][1]+7e5,I=!1}else if(w===u){const t=v.getGeometries();for(let e=0;e<t.length;e++)if(t[e].getType()==s)C=wf(v);else if(t[e].getType()==o){x=new Tr(t[e].getCoordinates());const n=t[e].getCoordinates();n[1]=n[1]+7e5,E=[n]}I=!1}if(n&&S){let t=0;const e=[];S.forEachSegment(((n,i)=>{const r=new lo([n,i]),o=xf(r);e.push(tx(f));const s=new Tr(r.getCoordinateAt(.5));e[t].setGeometry(s),e[t].getText().setText(o.lengthString),y.push(e[t]),t++}))}if(i&&E){let t=0;const e=I?E.length-1:E.length,n=[];for(let i=0;i<e;i++){const e=Wi(E[i],"EPSG:3857","EPSG:4326"),{longitude:r,latitude:o}=_p(e[0],e[1]),s=`${r.toFixed(6)}, ${o.toFixed(6)}`;n.push(rx(p));const a=new Tr(E[i]);n[t].setGeometry(a),n[t].getText().setText(s),y.push(n[t]),t++}}if(h){const t=nx(g);w===s||w===l||w===u?(t.setGeometry(x),t.getText().setText(null==C?void 0:C.areaString),y.push(t)):w===a&&(t.setGeometry(x),t.getText().setText(null==b?void 0:b.lengthString),y.push(t))}if("arrow"==d.iconPattern&&d.iconUrl)if(d.radius=d.iconWidth,d.radius2=d.iconHeight,d.url=d.iconUrl,"last"==d.arrowPattern){const t=v.getCoordinates();if(t.length&&t.length>=2){const e=t.length-1;let n=0;v.forEachSegment(((t,i)=>{if(n++,n==e){const e=i[0]-t[0],n=i[1]-t[1],r=Math.atan2(n,e);d.rotation=-r;const o=Kw(d),s=new Tr(i);o.setGeometry(s),y.push(o)}}))}}else"every"==d.arrowPattern?v.forEachSegment(((t,e)=>{const n=e[0]-t[0],i=e[1]-t[1],r=Math.atan2(i,n);d.rotation=-r;const o=Kw(d),s=new Tr(e);o.setGeometry(s),y.push(o)})):d.arrowPattern;return y}createLayerByUrl(t={url:"",id:"",name:"",zIndex:0,wrapX:!0,style:{fillColor:"rgba(20 ,20, 20, 0.2)",color:"rgba(20 ,20, 20, 1)"}}){if(!t.url||!t.id)return null;const e=this.__Id(t.id);let n=t.name?t.name:Yt(10);n=this.__Name(n);let i=t.wrapX;null==i&&(i=!0);const r=new ah({url:t.url,format:new Gd,wrapX:i});r.set("id",e),r.set("name",n);const o=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),s=new ku({source:r,zIndex:o});t.calZIndex=o,s.set("id",e),s.set("name",n);const a={[d]:!0,[c]:t},l=this.toggleStyleFunction(t);r.on("addfeature",(t=>{var e;t.feature.setProperties(a);const n=l(t.feature);null==(e=t.feature)||e.setStyle(n)})),r.on("featuresloadend",(e=>{this.olBaseHandle.fitToLayerSourceByID(this.__Id(t.id))}));return{options:t,source:r,layer:s}}createLayerByData(t){if(!t.data||!t.id)return null;const e=this.__Id(t.id);let n=t.name?t.name:Yt(10);n=this.__Name(n);const i={[d]:!0,[c]:t,[v]:!1},r=new Gd({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});let o=t.wrapX;null==o&&(o=!0);const s=new ah({features:r.readFeatures(t.data),wrapX:o});s.set("id",e),s.set("name",n),s.forEachFeature((t=>{t.get("__drawData")&&(i[v]=!0),t.setProperties(i)}));const a=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),l=this.toggleStyleFunction(t)||lx,u=new ku({source:s,style:l,zIndex:a});t.calZIndex=a,u.setProperties(i),u.set("id",e),u.set("name",n);return{options:t,source:s,layer:u}}addLayer(t){var e;if(this.handle){let n=null;if(t.url)n=this.createLayerByUrl(t);else{if(!t.data)return!1;n=this.createLayerByData(t)}if(n){this.handle.addLayer(n.layer),this.__layers.set(this.__Id(t.id),n);const i=t.delay??300,r=t.debounce??!0,o=t.debounceOption??{};if(t.isPopup)if(t.popupType==b.normal){if(this.normalPopupIns.addLayer(t),t.eventType){const e={id:t.id,type:t.eventType,cb:this.narmalPopupCb(t),delay:i,debounce:r,debounceOption:o};this.mapEventIns.addEvent(e)}}else if(t.popupType==b.vnode&&(null==(e=this.vuePopupIns)||e.addLayer(t),t.eventType)){const e={id:t.id,type:t.eventType,cb:this.vNodePopupCb(t),delay:i,debounce:r,debounceOption:o};this.mapEventIns.addEvent(e)}return!0}return!1}return!1}fitToView(t){return!!this.olBaseHandle&&(t.extent?(this.olBaseHandle.fitToExtent(t.extent,[32,32,32,32]),!0):(this.olBaseHandle.fitToLayerSourceByID(this.__Id(t.id),[32,32,32,32]),!0))}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}clearFeatures(t){this.clearFeaturesById(t.id)}clearFeaturesById(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(e.source.clear(),!0)}return!1}updateFeaturesData(t){if(!t.data||!t.id)return null;this.updateFeaturesDataById(t.id,t.data,t)}updateFeaturesDataById(t,e,n){if(this.handle){const i=this.__layers.get(this.__Id(t));if(i){i.source.clear();const t=new Gd({dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).readFeatures(e);i.source.addFeatures(t);const r={[d]:!0,[c]:n};return i.source.forEachFeature((t=>{t.setProperties(r)})),!0}return!1}return!1}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.__layers.delete(this.__Id(t)),e.options&&e.options.isPopup&&(e.options.popupType==b.normal?(this.normalPopupIns.removeLayerByID(t),this.mapEventIns.removeEventByID(t)):e.options.popupType==b.vnode&&(this.vuePopupIns.removeLayerByID(t),this.mapEventIns.removeEventByID(t))),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{if(this.handle.removeLayer(t.layer),t.options&&t.options.isPopup){const e=t.options.id;t.options.popupType==b.normal?(this.normalPopupIns.removeLayerByID(e),this.mapEventIns.removeEventByID(e)):t.options.popupType==b.vnode&&(this.vuePopupIns.removeLayerByID(e),this.mapEventIns.removeEventByID(e))}})),this.__layers.clear(),!0)}setLayerOpacity(t,e){return this.setLayerOpacityByID(t.id,e)}setLayerOpacityByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setOpacity(e),!0)}return!1}showHiddenLayer(t,e){return this.showHiddenLayerByID(t.id,e)}showHiddenLayerByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setVisible(e),!0)}return!1}setLayerIndex(t,e){return this.setLayerIndexByID(t.id,e)}setLayerIndexByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setZIndex(e),!0)}return!1}resetLayerIndex(t){return this.resetLayerIndexByID(t.id)}resetLayerIndexByID(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));if(e){const t=e.options.calZIndex;return e.layer.setZIndex(t),!0}return!1}return!1}}const Az=class extends kg{constructor(t){const e=void 0!==t.crossOrigin?t.crossOrigin:null,n=void 0!==t.imageLoadFunction?t.imageLoadFunction:Tg;super({attributions:t.attributions,interpolate:t.interpolate,projection:Ai(t.projection)}),this.url_=t.url,this.imageExtent_=t.imageExtent,this.image=null,this.image=new Da(this.imageExtent_,void 0,1,function(t){const e=t.load||ka,n=t.imageExtent,i=new Image;return null!==t.crossOrigin&&(i.crossOrigin=t.crossOrigin),()=>e(i,t.url).then((t=>{const e=An(n)/t.width,i=Ln(n)/t.height;return{image:t,extent:n,resolution:e!==i?[e,i]:i,pixelRatio:1}}))}({url:t.url,imageExtent:t.imageExtent,crossOrigin:e,load:(t,e)=>(this.image.setImage(t),n(this.image,e),ka(t))})),this.image.addEventListener(ce,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(t,e,n,i){return zn(t,this.image.getExtent())?this.image:null}getUrl(){return this.url_}};class zz{constructor(t){e(this,"olBaseHandle",null),e(this,"handle",null),e(this,"vuePopupIns",null),e(this,"normalPopupIns",null),e(this,"mapEventIns",null),e(this,"__mapEventsMap",null),e(this,"__popupInsMap",null),e(this,"__vuepopupInsMap",null),e(this,"__layers",null),e(this,"__layerIdPrefix","IMAGE_"),e(this,"narmalPopupCb",(t=>e=>{var n,i;let r=e.pixel;r.length||(r=this.handle.getEventPixel(e.originalEvent));const o=this.handle.forEachFeatureAtPixel(r,(function(e){const n=e.get(d),i=e.get(c),r=null==i?void 0:i.id;if(n&&r===t.id)return e}));if(o){t.callback&&t.callback(o,t);const e=this.getCenterById(t.id);null==(n=this.normalPopupIns)||n.showPopupByID(t.id,e,t.htmlString)}else t.eventType==jw&&(null==(i=this.normalPopupIns)||i.hiddenPopupByID(t.id))})),e(this,"vNodePopupCb",(t=>e=>{var n,i,r;let o=e.pixel;o.length||(o=this.handle.getEventPixel(e.originalEvent));const s=this.handle.forEachFeatureAtPixel(o,(function(e){const n=e.get(d),i=e.get(c),r=null==i?void 0:i.id;if(n&&r===t.id)return e}));if(s){t.callback&&(t.callback(s,t),null==(n=this.vuePopupIns)||n.updateLayer(t));const e=this.getCenterById(t.id);null==(i=this.vuePopupIns)||i.showPopupByID(t.id,e)}else t.eventType==jw&&(null==(r=this.vuePopupIns)||r.hiddenPopupByID(t.id))})),this.olBaseHandle=t,this.handle=t.handle,this.__layers=new Map,this.__mapEventsMap=new Map,this.__popupInsMap=new Map,this.__vuepopupInsMap=new Map,this.mapEventIns=new Fw(t),this.normalPopupIns=new Oz(t),this.vuePopupIns=new Aw(t)}destructor(){this.normalPopupIns.destructor(),this.vuePopupIns.destructor(),this.mapEventIns.destructor(),this.clearLayer(),this.olBaseHandle=null,this.handle=null,this.__layers.clear(),this.__layers=null,this.__mapEventsMap=null,this.__popupInsMap=null,this.__vuepopupInsMap=null}__Id(t){return`${this.__layerIdPrefix}${t}`}__Name(t){return`${this.__layerIdPrefix}${t}`}createLayer(t={url:"",id:"",name:"",zIndex:0,extent:n,wrapX:!0,opacity:1,htmlString:""}){var e;if(!t.url||!t.id)return null;if(!t.isRotation){let e=n;t.extent&&t.extent.length&&4===t.extent.length&&(e=t.extent),e=ff(e);let i=t.name?t.name:Yt(10);i=this.__Name(i);const r=this.__Id(t.id),o=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),s=wp(e),a={geometry:new Ur(s),name:i,id:r,wrapX:t.wrapX},l=new Be(a);l.setStyle(ox);const u={[d]:!0,[c]:t};l.setProperties(u);const h=new ah({features:[l],wrapX:t.wrapX});h.setProperties(u);const p=new ku({source:h,zIndex:o,declutter:!0});p.setProperties(u),p.set("id",r+"_vector"),p.set("name",i+"_vector");const f={url:t.url,imageExtent:e,interpolate:!0,wrapX:t.wrapX},g=new Az(f);g.setProperties(u);const m=t.opacity?t.opacity:1,_=new xg({source:g,extent:e,zIndex:o+1,opacity:m});_.setProperties(u),_.set("id",r),_.set("name",i);return{options:t,imageOptions:f,source:g,layer:_,layerVector:p}}if(t.extent&&(null==(e=t.extent)?void 0:e.length)&&t.extent[0]&&t.extent[0].length>=5){let e=yp(t.extent);e=ff(e);let n=0;n=t.rotationInDegree?t.rotationInDegree*Math.PI/180:_f(t.extent);const{vectorOneAngle:i,vectorTwoAngle:r,vectorThreeAngle:o}=function(t){if(t.length){const e=vp(t);if(null==e?void 0:e.length){const t=e[0];if(t.length>=5){t[0]=gf(t[0]),t[1]=gf(t[1]),t[2]=gf(t[2]),t[3]=gf(t[3]),t[4]=gf(t[4]);const e=t[2][0]-t[0][0],n=t[2][1]-t[0][1],i=Math.atan(n/e),r=t[3][0]-t[1][0],o=t[3][1]-t[1][1],s=Math.atan(o/r),a=t[1][0]-t[0][0],l=t[1][1]-t[0][1];return{vectorOneAngle:i,vectorTwoAngle:s,vectorThreeAngle:Math.atan(l/a)}}}}return null}(t.extent);let s=t.name?t.name:Yt(10);s=this.__Name(s);const a=this.__Id(t.id),l=t.zIndex?t.zIndex:this.olBaseHandle.getCurrentzIndex(),u=wp(e),h={geometry:new Ur(u),name:s,id:a,wrapX:t.wrapX},p=new Be(h);p.setStyle(ox);const f={[d]:!0,[c]:t};p.setProperties(f);const g=new ah({features:[p],wrapX:t.wrapX});g.setProperties(f);const m=new ku({source:g,zIndex:l,declutter:!0});m.setProperties(f),m.set("id",a+"_vector"),m.set("name",s+"_vector");const _={url:t.url,imageExtent:e,interpolate:!0,wrapX:t.wrapX,imageLoadFunction:(t,e)=>{t.getImage().src=e,t.getImage().onload=()=>{const e=t.getImage(),o=document.createElement("canvas"),s=o.getContext("2d"),a=Math.sqrt(e.width*e.width+e.height*e.height),l=Math.abs(a*Math.cos(i)),u=Math.abs(a*Math.cos(r)),h=Math.max(l,u),c=Math.abs(a*Math.sin(i)),d=Math.abs(a*Math.sin(r)),p=Math.max(c,d);o.width=h>e.width?Math.ceil(h):e.width,o.height=p>e.height?Math.ceil(p):e.height;const f=n;s.translate(o.width/2,o.height/2),s.rotate(f),s.drawImage(e,-e.width/2,-e.height/2),s.translate(-o.width/2,-o.height/2),s.rotate(-f),s.restore(),t.setImage(o)}}},y=new Az(_);y.setProperties(f);const v=t.opacity?t.opacity:1,w=new xg({source:y,extent:e,zIndex:l+1,opacity:v});w.setProperties(f),w.set("id",a),w.set("name",s);return{options:t,imageOptions:_,source:y,layer:w,layerVector:m}}}addLayer(t){var e;if(this.handle){const n=this.createLayer(t);if(n){this.handle.addLayer(n.layerVector),this.handle.addLayer(n.layer),this.__layers.set(this.__Id(t.id),n);const i=t.delay??300,r=t.debounce??!0,o=t.debounceOption??{};if(t.isPopup)if(t.popupType==b.normal){if(this.normalPopupIns.addLayer(t),t.eventType){const e={id:t.id,type:t.eventType,cb:this.narmalPopupCb(t),delay:i,debounce:r,debounceOption:o};this.mapEventIns.addEvent(e)}}else if(t.popupType==b.vnode&&(null==(e=this.vuePopupIns)||e.addLayer(t),t.eventType)){const e={id:t.id,type:t.eventType,cb:this.vNodePopupCb(t),delay:i,debounce:r,debounceOption:o};this.mapEventIns.addEvent(e)}return!0}return!1}return!1}fitToView(t){return!!this.olBaseHandle&&(t.extent?(this.olBaseHandle.fitToExtent(t.extent,[32,32,32,32]),!0):void 0)}hasLayer(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t.id))}hasLayerByID(t){return!(!this.olBaseHandle||!this.__layers.size)&&this.__layers.has(this.__Id(t))}removeLayer(t){return this.removeLayerByID(t.id)}removeLayerByID(t){if(this.handle){const e=this.__layers.get(this.__Id(t));return!!e&&(this.handle.removeLayer(e.layer),this.handle.removeLayer(e.layerVector),this.__layers.delete(this.__Id(t)),e.options&&e.options.isPopup&&(e.options.popupType==b.normal?(this.normalPopupIns.removeLayerByID(t),this.mapEventIns.removeEventByID(t)):e.options.popupType==b.vnode&&(this.vuePopupIns.removeLayerByID(t),this.mapEventIns.removeEventByID(t))),!0)}return!1}clearLayer(){return!(!this.handle||!this.__layers.size)&&(this.__layers.forEach((t=>{if(this.handle.removeLayer(t.layer),this.handle.removeLayer(t.layerVector),t.options&&t.options.isPopup){const e=t.options.id;t.options.popupType==b.normal?(this.normalPopupIns.removeLayerByID(e),this.mapEventIns.removeEventByID(e)):t.options.popupType==b.vnode&&(this.vuePopupIns.removeLayerByID(e),this.mapEventIns.removeEventByID(e))}})),this.__layers.clear(),!0)}setLayerOpacity(t,e){return this.setLayerOpacityByID(t.id,e)}setLayerOpacityByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setOpacity(e),!0)}return!1}showHiddenLayer(t,e){return this.showHiddenLayerByID(t.id,e)}showHiddenLayerByID(t,e){if(this.olBaseHandle){const n=this.__layers.get(this.__Id(t));return!!n&&(n.layer.setVisible(e),!0)}return!1}getExtent(t){return this.getExtentById(t.id)}getExtentById(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));return e?e.layer.getExtent():[]}return[]}getCenter(t){return this.getCenterById(t.id)}getCenterById(t){if(this.olBaseHandle){const e=this.__layers.get(this.__Id(t));if(e){return Tn(e.layer.getExtent())}return[]}return[]}}class Bz extends Dw{constructor(t,n,i,r=1,o=21){super(t,i,r,o),e(this,"mapEventIns",null),e(this,"geoDrawIns",null),e(this,"geojsonIns",null),e(this,"imageIns",null),e(this,"labelIns",null),e(this,"__funcLayers",null),e(this,"__mapEventsMap",null),e(this,"customT",null),this.__funcLayers=new Map,this.__mapEventsMap=new Map,this.customT=n,this.mapEventIns=new Fw(this),this.geojsonIns=new Fz(this),this.imageIns=new zz(this)}createGeoDrawIns(){this.geoDrawIns||(this.geoDrawIns=new _x(this))}destroyGeoDrawIns(){this.geoDrawIns&&this.geoDrawIns.destructor(),this.geoDrawIns=null}createLabelDrawIns(){this.labelIns||(this.labelIns=new Rz(this))}destroyLabelDrawIns(){this.labelIns&&this.labelIns.destructor(),this.labelIns=null}destructor(){this.clearMapEvent(),this.geoDrawIns&&this.geoDrawIns.destructor(),this.mapEventIns.destructor(),this.geojsonIns.destructor(),this.imageIns.destructor(),this.labelIns&&this.labelIns.destructor(),this.customT=null,this.__funcLayers=null,this.__mapEventsMap=null,super.destructor()}clearFuncLayer(){if(this.__funcLayers&&this.__funcLayers.size){for(const[t,e]of this.__funcLayers.entries())e.removeLayer(t);return this.__funcLayers.clear(),!0}return!1}addMouseMoveInfoEvent(t){const e={id:"MouseMoveInfo",type:"pointermove",cb:e=>{const n=e.coordinate;let{longitude:i,latitude:r}=yf(n);"number"==typeof i&&(i=i.toFixed(6)),"number"==typeof r&&(r=r.toFixed(6));const o=this.getViewZoom().toFixed(2),s=this.getScale(),a=this.getResolution();t(i,r,o,s,a)},debounce:!1};this.mapEventIns.addEvent(e),this.__mapEventsMap.set("MouseMoveInfo",e)}clearMapEvent(){if(this.__mapEventsMap&&this.__mapEventsMap.size){for(const[t,e]of this.__mapEventsMap.entries())this.mapEventIns.removeEventByID(t);return this.__mapEventsMap.clear(),!0}return!1}geoDrawShape(t){if(this.geoDrawIns)return this.geoDrawIns.drawShape(t)}cancelDrawShape(){this.geoDrawIns&&this.geoDrawIns.removeallInteraction()}clearGeoDraw(){this.geoDrawIns&&(this.geoDrawIns.clearAllDrawShape(),this.geoDrawIns.removeallInteraction())}updateGeoDrawLabelInfos(t,e,n,i){this.geoDrawIns&&this.geoDrawIns.updateAllDrawDataLabelStyle(t,e,n,i)}getGeoDrawGeojsonData(){if(this.geoDrawIns){return this.geoDrawIns.getAllDrawData()}return null}saveGeoDrawGeojsonData(){if(this.geoDrawIns)return this.geoDrawIns.saveAllDrawData()}addGeoDrawGeojsonData(t){this.geoDrawIns&&(this.geoDrawIns.removeallInteraction(),this.geoDrawIns.addGeojsonData(t))}removeGeoDrawGeojsonData(t){this.geoDrawIns&&this.geoDrawIns.removeGeojsonData(t)}addGeojsonData(t){t&&this.geojsonIns.addLayer(t)}removeGeojsonData(t){this.geojsonIns.removeLayer(t)}setGeojsonDataStyle(t){this.geojsonIns.setFeatureStyle(t)}resetGeojsonDataStyle(t){this.geojsonIns.resetFeatureStyle(t)}setGeojsonDataIndex(t,e){this.geojsonIns.setLayerIndex(t,e)}resetGeojsonDataIndex(t){this.geojsonIns.resetLayerIndex(t)}fitToViewGeojsonData(t){this.geojsonIns.fitToView(t)}addGeojsonDataEvent(t,e,n){const i={id:t,type:e,cb:t=>{let e=t.pixel;e.length||(e=this.handle.getEventPixel(t.originalEvent));let i=!1,r=null,o="",s=!1;const a=this.handle.forEachFeatureAtPixel(e,(function(t){if(i=t.get(d),r=t.get(c),o=null==r?void 0:r.id,s=null==r?void 0:r.customSearchResult,i&&s)return t}));a?(n(a,o,s,!0),this.handle.getTargetElement().style.cursor="pointer"):(n(a,o,s,!1),this.handle.getTargetElement().style.cursor="")},debounce:!1};this.mapEventIns.addEvent(i),this.__mapEventsMap.set(t,i)}removeGeojsonDataEvent(t){if(this.__mapEventsMap&&this.__mapEventsMap.size){const e=this.__mapEventsMap.get(t);e&&(this.mapEventIns.removeEvent(e),this.__mapEventsMap.delete(t))}}addImageData(t){t&&this.imageIns.addLayer(t)}removeImageData(t){this.imageIns.removeLayer(t)}clearImageData(){this.imageIns.clearLayer()}fitToViewImageData(t){this.imageIns.fitToView(t)}addImageDataEvent(t,e,n){const i={id:t,type:e,cb:e=>{let i=e.pixel;i.length||(i=this.handle.getEventPixel(e.originalEvent));let r=!1,o=null,s="";const a=this.handle.forEachFeatureAtPixel(i,(function(e){if(r=e.get(d),o=e.get(c),s=null==o?void 0:o.id,r&&s==t)return e}));a?(n&&n(a,s,!0),this.handle.getTargetElement().style.cursor="pointer"):(n&&n(a,s,!1),this.handle.getTargetElement().style.cursor="")},debounce:!1};this.mapEventIns.addEvent(i),this.__mapEventsMap.set(t,i)}labelDrawShape(t){if(this.labelIns)return this.labelIns.drawShape(t)}cancelLabelDrawShape(){this.labelIns&&this.labelIns.removeallInteraction()}clearLabelDraw(){this.labelIns&&(this.labelIns.clearAllDrawShape(),this.labelIns.removeallInteraction())}updateLableDrawLabelInfos(t,e,n,i){this.labelIns&&this.labelIns.updateAllDrawDataLabelStyle(t,e,n,i)}getLabelDrawGeojsonData(){if(this.labelIns){return this.labelIns.getAllDrawData()}return null}saveLabelDrawGeojsonData(){if(this.labelIns)return this.labelIns.saveAllDrawData()}addLabelDrawGeojsonData(t){this.labelIns&&(this.labelIns.removeallInteraction(),this.labelIns.addGeojsonData(t))}removeLabelDrawGeojsonData(t){this.labelIns&&this.labelIns.removeGeojsonData(t)}addLabelDrawImageData(t){this.labelIns&&(this.labelIns.removeallInteraction(),this.labelIns.addImageData(t))}}const jz={params:{geojson:null}},Gz=Nt("labelDrawStore",(()=>{const t=yt({reset:0,hasGeojson:0});return{labelDrawParas:t,setLabelDrawParams:function(e,n){jz.params[e]=n,"geojson"===e&&(n?t.hasGeojson++:t.hasGeojson=0)},resetLabelDrawNormalParams:function(){jz.params={geojson:null},t.hasGeojson=0},resetLabelDrawParams:function(){t.reset=t.reset+1}}}));
/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */
function Nz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Vz(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nz(Object(n),!0).forEach((function(e){Uz(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nz(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hz(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function Wz(t){return(Wz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xz(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Hz(i.key),i)}}function Uz(t,e,n){return(e=Hz(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $z(t){return function(t){if(Array.isArray(t))return Yz(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Yz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yz(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yz(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var qz="undefined"!=typeof window&&void 0!==window.document,Zz=qz?window:{},Kz=!(!qz||!Zz.document.documentElement)&&"ontouchstart"in Zz.document.documentElement,Jz=!!qz&&"PointerEvent"in Zz,Qz="cropper",tB="all",eB="crop",nB="move",iB="zoom",rB="e",oB="w",sB="s",aB="n",lB="ne",uB="nw",hB="se",cB="sw",dB="".concat(Qz,"-crop"),pB="".concat(Qz,"-disabled"),fB="".concat(Qz,"-hidden"),gB="".concat(Qz,"-hide"),mB="".concat(Qz,"-invisible"),_B="".concat(Qz,"-modal"),yB="".concat(Qz,"-move"),vB="".concat(Qz,"Action"),wB="".concat(Qz,"Preview"),xB="crop",bB="move",CB="none",SB="crop",EB="cropend",IB="cropmove",PB="cropstart",TB="dblclick",kB=Jz?"pointerdown":Kz?"touchstart":"mousedown",DB=Jz?"pointermove":Kz?"touchmove":"mousemove",MB=Jz?"pointerup pointercancel":Kz?"touchend touchcancel":"mouseup",LB="ready",RB="resize",OB="wheel",FB="zoom",AB="image/jpeg",zB=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,BB=/^data:/,jB=/^data:image\/jpeg;base64,/,GB=/^img|canvas$/i,NB={viewMode:0,dragMode:xB,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},VB=Number.isNaN||Zz.isNaN;function HB(t){return"number"==typeof t&&!VB(t)}var WB=function(t){return t>0&&t<1/0};function XB(t){return void 0===t}function UB(t){return"object"===Wz(t)&&null!==t}var $B=Object.prototype.hasOwnProperty;function YB(t){if(!UB(t))return!1;try{var e=t.constructor,n=e.prototype;return e&&n&&$B.call(n,"isPrototypeOf")}catch(i){return!1}}function qB(t){return"function"==typeof t}var ZB=Array.prototype.slice;function KB(t){return Array.from?Array.from(t):ZB.call(t)}function JB(t,e){return t&&qB(e)&&(Array.isArray(t)||HB(t.length)?KB(t).forEach((function(n,i){e.call(t,n,i,t)})):UB(t)&&Object.keys(t).forEach((function(n){e.call(t,t[n],n,t)}))),t}var QB=Object.assign||function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return UB(t)&&n.length>0&&n.forEach((function(e){UB(e)&&Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t},tj=/\.\d*(?:0|9){12}\d*$/;function ej(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return tj.test(t)?Math.round(t*e)/e:t}var nj=/^width|height|left|top|marginLeft|marginTop$/;function ij(t,e){var n=t.style;JB(e,(function(t,e){nj.test(e)&&HB(t)&&(t="".concat(t,"px")),n[e]=t}))}function rj(t,e){if(e)if(HB(t.length))JB(t,(function(t){rj(t,e)}));else if(t.classList)t.classList.add(e);else{var n=t.className.trim();n?n.indexOf(e)<0&&(t.className="".concat(n," ").concat(e)):t.className=e}}function oj(t,e){e&&(HB(t.length)?JB(t,(function(t){oj(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function sj(t,e,n){e&&(HB(t.length)?JB(t,(function(t){sj(t,e,n)})):n?rj(t,e):oj(t,e))}var aj=/([a-z\d])([A-Z])/g;function lj(t){return t.replace(aj,"$1-$2").toLowerCase()}function uj(t,e){return UB(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(lj(e)))}function hj(t,e,n){UB(n)?t[e]=n:t.dataset?t.dataset[e]=n:t.setAttribute("data-".concat(lj(e)),n)}var cj=/\s\s*/,dj=function(){var t=!1;if(qz){var e=!1,n=function(){},i=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(t){e=t}});Zz.addEventListener("test",n,i),Zz.removeEventListener("test",n,i)}return t}();function pj(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;e.trim().split(cj).forEach((function(e){if(!dj){var o=t.listeners;o&&o[e]&&o[e][n]&&(r=o[e][n],delete o[e][n],0===Object.keys(o[e]).length&&delete o[e],0===Object.keys(o).length&&delete t.listeners)}t.removeEventListener(e,r,i)}))}function fj(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;e.trim().split(cj).forEach((function(e){if(i.once&&!dj){var o=t.listeners,s=void 0===o?{}:o;r=function(){delete s[e][n],t.removeEventListener(e,r,i);for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];n.apply(t,a)},s[e]||(s[e]={}),s[e][n]&&t.removeEventListener(e,s[e][n],i),s[e][n]=r,t.listeners=s}t.addEventListener(e,r,i)}))}function gj(t,e,n){var i;return qB(Event)&&qB(CustomEvent)?i=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,n),t.dispatchEvent(i)}function mj(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var _j=Zz.location,yj=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function vj(t){var e=t.match(yj);return null!==e&&(e[1]!==_j.protocol||e[2]!==_j.hostname||e[3]!==_j.port)}function wj(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function xj(t){var e=t.rotate,n=t.scaleX,i=t.scaleY,r=t.translateX,o=t.translateY,s=[];HB(r)&&0!==r&&s.push("translateX(".concat(r,"px)")),HB(o)&&0!==o&&s.push("translateY(".concat(o,"px)")),HB(e)&&0!==e&&s.push("rotate(".concat(e,"deg)")),HB(n)&&1!==n&&s.push("scaleX(".concat(n,")")),HB(i)&&1!==i&&s.push("scaleY(".concat(i,")"));var a=s.length?s.join(" "):"none";return{WebkitTransform:a,msTransform:a,transform:a}}function bj(t,e){var n=t.pageX,i=t.pageY,r={endX:n,endY:i};return e?r:Vz({startX:n,startY:i},r)}function Cj(t){var e=t.aspectRatio,n=t.height,i=t.width,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",o=WB(i),s=WB(n);if(o&&s){var a=n*e;"contain"===r&&a>i||"cover"===r&&a<i?n=i/e:i=n*e}else o?n=i/e:s&&(i=n*e);return{width:i,height:n}}var Sj=String.fromCharCode;var Ej=/^data:.*,/;function Ij(t){var e,n=new DataView(t);try{var i,r,o;if(255===n.getUint8(0)&&216===n.getUint8(1))for(var s=n.byteLength,a=2;a+1<s;){if(255===n.getUint8(a)&&225===n.getUint8(a+1)){r=a;break}a+=1}if(r){var l=r+10;if("Exif"===function(t,e,n){var i="";n+=e;for(var r=e;r<n;r+=1)i+=Sj(t.getUint8(r));return i}(n,r+4,4)){var u=n.getUint16(l);if(((i=18761===u)||19789===u)&&42===n.getUint16(l+2,i)){var h=n.getUint32(l+4,i);h>=8&&(o=l+h)}}}if(o){var c,d,p=n.getUint16(o,i);for(d=0;d<p;d+=1)if(c=o+12*d+2,274===n.getUint16(c,i)){c+=8,e=n.getUint16(c,i),n.setUint16(c,1,i);break}}}catch(f){e=1}return e}var Pj={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,n=this.container,i=this.cropper,r=Number(e.minContainerWidth),o=Number(e.minContainerHeight);rj(i,fB),oj(t,fB);var s={width:Math.max(n.offsetWidth,r>=0?r:200),height:Math.max(n.offsetHeight,o>=0?o:100)};this.containerData=s,ij(i,{width:s.width,height:s.height}),rj(t,fB),oj(i,fB)},initCanvas:function(){var t=this.containerData,e=this.imageData,n=this.options.viewMode,i=Math.abs(e.rotate)%180==90,r=i?e.naturalHeight:e.naturalWidth,o=i?e.naturalWidth:e.naturalHeight,s=r/o,a=t.width,l=t.height;t.height*s>t.width?3===n?a=t.height*s:l=t.width/s:3===n?l=t.width/s:a=t.height*s;var u={aspectRatio:s,naturalWidth:r,naturalHeight:o,width:a,height:l};this.canvasData=u,this.limited=1===n||2===n,this.limitCanvas(!0,!0),u.width=Math.min(Math.max(u.width,u.minWidth),u.maxWidth),u.height=Math.min(Math.max(u.height,u.minHeight),u.maxHeight),u.left=(t.width-u.width)/2,u.top=(t.height-u.height)/2,u.oldLeft=u.left,u.oldTop=u.top,this.initialCanvasData=QB({},u)},limitCanvas:function(t,e){var n=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,s=n.viewMode,a=r.aspectRatio,l=this.cropped&&o;if(t){var u=Number(n.minCanvasWidth)||0,h=Number(n.minCanvasHeight)||0;s>1?(u=Math.max(u,i.width),h=Math.max(h,i.height),3===s&&(h*a>u?u=h*a:h=u/a)):s>0&&(u?u=Math.max(u,l?o.width:0):h?h=Math.max(h,l?o.height:0):l&&(u=o.width,(h=o.height)*a>u?u=h*a:h=u/a));var c=Cj({aspectRatio:a,width:u,height:h});u=c.width,h=c.height,r.minWidth=u,r.minHeight=h,r.maxWidth=1/0,r.maxHeight=1/0}if(e)if(s>(l?0:1)){var d=i.width-r.width,p=i.height-r.height;r.minLeft=Math.min(0,d),r.minTop=Math.min(0,p),r.maxLeft=Math.max(0,d),r.maxTop=Math.max(0,p),l&&this.limited&&(r.minLeft=Math.min(o.left,o.left+(o.width-r.width)),r.minTop=Math.min(o.top,o.top+(o.height-r.height)),r.maxLeft=o.left,r.maxTop=o.top,2===s&&(r.width>=i.width&&(r.minLeft=Math.min(0,d),r.maxLeft=Math.max(0,d)),r.height>=i.height&&(r.minTop=Math.min(0,p),r.maxTop=Math.max(0,p))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=i.width,r.maxTop=i.height},renderCanvas:function(t,e){var n=this.canvasData,i=this.imageData;if(e){var r=function(t){var e=t.width,n=t.height,i=t.degree;if(90==(i=Math.abs(i)%180))return{width:n,height:e};var r=i%90*Math.PI/180,o=Math.sin(r),s=Math.cos(r),a=e*s+n*o,l=e*o+n*s;return i>90?{width:l,height:a}:{width:a,height:l}}({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0}),o=r.width,s=r.height,a=n.width*(o/n.naturalWidth),l=n.height*(s/n.naturalHeight);n.left-=(a-n.width)/2,n.top-=(l-n.height)/2,n.width=a,n.height=l,n.aspectRatio=o/s,n.naturalWidth=o,n.naturalHeight=s,this.limitCanvas(!0,!1)}(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCanvas(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,ij(this.canvas,QB({width:n.width,height:n.height},xj({translateX:n.left,translateY:n.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,n=this.imageData,i=n.naturalWidth*(e.width/e.naturalWidth),r=n.naturalHeight*(e.height/e.naturalHeight);QB(n,{width:i,height:r,left:(e.width-i)/2,top:(e.height-r)/2}),ij(this.image,QB({width:n.width,height:n.height},xj(QB({translateX:n.left,translateY:n.top},n)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,n=t.aspectRatio||t.initialAspectRatio,i=Number(t.autoCropArea)||.8,r={width:e.width,height:e.height};n&&(e.height*n>e.width?r.height=r.width/n:r.width=r.height*n),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*i),r.height=Math.max(r.minHeight,r.height*i),r.left=e.left+(e.width-r.width)/2,r.top=e.top+(e.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=QB({},r)},limitCropBox:function(t,e){var n=this.options,i=this.containerData,r=this.canvasData,o=this.cropBoxData,s=this.limited,a=n.aspectRatio;if(t){var l=Number(n.minCropBoxWidth)||0,u=Number(n.minCropBoxHeight)||0,h=s?Math.min(i.width,r.width,r.width+r.left,i.width-r.left):i.width,c=s?Math.min(i.height,r.height,r.height+r.top,i.height-r.top):i.height;l=Math.min(l,i.width),u=Math.min(u,i.height),a&&(l&&u?u*a>l?u=l/a:l=u*a:l?u=l/a:u&&(l=u*a),c*a>h?c=h/a:h=c*a),o.minWidth=Math.min(l,h),o.minHeight=Math.min(u,c),o.maxWidth=h,o.maxHeight=c}e&&(s?(o.minLeft=Math.max(0,r.left),o.minTop=Math.max(0,r.top),o.maxLeft=Math.min(i.width,r.left+r.width)-o.width,o.maxTop=Math.min(i.height,r.top+r.height)-o.height):(o.minLeft=0,o.minTop=0,o.maxLeft=i.width-o.width,o.maxTop=i.height-o.height))},renderCropBox:function(){var t=this.options,e=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,t.movable&&t.cropBoxMovable&&hj(this.face,vB,n.width>=e.width&&n.height>=e.height?nB:tB),ij(this.cropBox,QB({width:n.width,height:n.height},xj({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),gj(this.element,SB,this.getData())}},Tj={initPreview:function(){var t=this.element,e=this.crossOrigin,n=this.options.preview,i=e?this.crossOriginUrl:this.url,r=t.alt||"The image to preview",o=document.createElement("img");if(e&&(o.crossOrigin=e),o.src=i,o.alt=r,this.viewBox.appendChild(o),this.viewBoxImage=o,n){var s=n;"string"==typeof n?s=t.ownerDocument.querySelectorAll(n):n.querySelector&&(s=[n]),this.previews=s,JB(s,(function(t){var n=document.createElement("img");hj(t,wB,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(n.crossOrigin=e),n.src=i,n.alt=r,n.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(n)}))}},resetPreview:function(){JB(this.previews,(function(t){var e=uj(t,wB);ij(t,{width:e.width,height:e.height}),t.innerHTML=e.html,function(t,e){if(UB(t[e]))try{delete t[e]}catch(n){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(n){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(lj(e)))}(t,wB)}))},preview:function(){var t=this.imageData,e=this.canvasData,n=this.cropBoxData,i=n.width,r=n.height,o=t.width,s=t.height,a=n.left-e.left-t.left,l=n.top-e.top-t.top;this.cropped&&!this.disabled&&(ij(this.viewBoxImage,QB({width:o,height:s},xj(QB({translateX:-a,translateY:-l},t)))),JB(this.previews,(function(e){var n=uj(e,wB),u=n.width,h=n.height,c=u,d=h,p=1;i&&(d=r*(p=u/i)),r&&d>h&&(c=i*(p=h/r),d=h),ij(e,{width:c,height:d}),ij(e.getElementsByTagName("img")[0],QB({width:o*p,height:s*p},xj(QB({translateX:-a*p,translateY:-l*p},t))))})))}},kj={bind:function(){var t=this.element,e=this.options,n=this.cropper;qB(e.cropstart)&&fj(t,PB,e.cropstart),qB(e.cropmove)&&fj(t,IB,e.cropmove),qB(e.cropend)&&fj(t,EB,e.cropend),qB(e.crop)&&fj(t,SB,e.crop),qB(e.zoom)&&fj(t,FB,e.zoom),fj(n,kB,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&fj(n,OB,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&fj(n,TB,this.onDblclick=this.dblclick.bind(this)),fj(t.ownerDocument,DB,this.onCropMove=this.cropMove.bind(this)),fj(t.ownerDocument,MB,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&fj(window,RB,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,n=this.cropper;qB(e.cropstart)&&pj(t,PB,e.cropstart),qB(e.cropmove)&&pj(t,IB,e.cropmove),qB(e.cropend)&&pj(t,EB,e.cropend),qB(e.crop)&&pj(t,SB,e.crop),qB(e.zoom)&&pj(t,FB,e.zoom),pj(n,kB,this.onCropStart),e.zoomable&&e.zoomOnWheel&&pj(n,OB,this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&pj(n,TB,this.onDblclick),pj(t.ownerDocument,DB,this.onCropMove),pj(t.ownerDocument,MB,this.onCropEnd),e.responsive&&pj(window,RB,this.onResize)}},Dj={resize:function(){if(!this.disabled){var t,e,n=this.options,i=this.container,r=this.containerData,o=i.offsetWidth/r.width,s=i.offsetHeight/r.height,a=Math.abs(o-1)>Math.abs(s-1)?o:s;if(1!==a)n.restore&&(t=this.getCanvasData(),e=this.getCropBoxData()),this.render(),n.restore&&(this.setCanvasData(JB(t,(function(e,n){t[n]=e*a}))),this.setCropBoxData(JB(e,(function(t,n){e[n]=t*a}))))}},dblclick:function(){var t,e;this.disabled||this.options.dragMode===CB||this.setDragMode((t=this.dragBox,e=dB,(t.classList?t.classList.contains(e):t.className.indexOf(e)>-1)?bB:xB))},wheel:function(t){var e=this,n=Number(this.options.wheelZoomRatio)||.1,i=1;this.disabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){e.wheeling=!1}),50),t.deltaY?i=t.deltaY>0?1:-1:t.wheelDelta?i=-t.wheelDelta/120:t.detail&&(i=t.detail>0?1:-1),this.zoom(-i*n,t)))},cropStart:function(t){var e=t.buttons,n=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(HB(e)&&1!==e||HB(n)&&0!==n||t.ctrlKey))){var i,r=this.options,o=this.pointers;t.changedTouches?JB(t.changedTouches,(function(t){o[t.identifier]=bj(t)})):o[t.pointerId||0]=bj(t),i=Object.keys(o).length>1&&r.zoomable&&r.zoomOnTouch?iB:uj(t.target,vB),zB.test(i)&&!1!==gj(this.element,PB,{originalEvent:t,action:i})&&(t.preventDefault(),this.action=i,this.cropping=!1,i===eB&&(this.cropping=!0,rj(this.dragBox,_B)))}},cropMove:function(t){var e=this.action;if(!this.disabled&&e){var n=this.pointers;t.preventDefault(),!1!==gj(this.element,IB,{originalEvent:t,action:e})&&(t.changedTouches?JB(t.changedTouches,(function(t){QB(n[t.identifier]||{},bj(t,!0))})):QB(n[t.pointerId||0]||{},bj(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,n=this.pointers;t.changedTouches?JB(t.changedTouches,(function(t){delete n[t.identifier]})):delete n[t.pointerId||0],e&&(t.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,sj(this.dragBox,_B,this.cropped&&this.options.modal)),gj(this.element,EB,{originalEvent:t,action:e}))}}},Mj={change:function(t){var e,n=this.options,i=this.canvasData,r=this.containerData,o=this.cropBoxData,s=this.pointers,a=this.action,l=n.aspectRatio,u=o.left,h=o.top,c=o.width,d=o.height,p=u+c,f=h+d,g=0,m=0,_=r.width,y=r.height,v=!0;!l&&t.shiftKey&&(l=c&&d?c/d:1),this.limited&&(g=o.minLeft,m=o.minTop,_=g+Math.min(r.width,i.width,i.left+i.width),y=m+Math.min(r.height,i.height,i.top+i.height));var w=s[Object.keys(s)[0]],x={x:w.endX-w.startX,y:w.endY-w.startY},b=function(t){switch(t){case rB:p+x.x>_&&(x.x=_-p);break;case oB:u+x.x<g&&(x.x=g-u);break;case aB:h+x.y<m&&(x.y=m-h);break;case sB:f+x.y>y&&(x.y=y-f)}};switch(a){case tB:u+=x.x,h+=x.y;break;case rB:if(x.x>=0&&(p>=_||l&&(h<=m||f>=y))){v=!1;break}b(rB),(c+=x.x)<0&&(a=oB,u-=c=-c),l&&(d=c/l,h+=(o.height-d)/2);break;case aB:if(x.y<=0&&(h<=m||l&&(u<=g||p>=_))){v=!1;break}b(aB),d-=x.y,h+=x.y,d<0&&(a=sB,h-=d=-d),l&&(c=d*l,u+=(o.width-c)/2);break;case oB:if(x.x<=0&&(u<=g||l&&(h<=m||f>=y))){v=!1;break}b(oB),c-=x.x,u+=x.x,c<0&&(a=rB,u-=c=-c),l&&(d=c/l,h+=(o.height-d)/2);break;case sB:if(x.y>=0&&(f>=y||l&&(u<=g||p>=_))){v=!1;break}b(sB),(d+=x.y)<0&&(a=aB,h-=d=-d),l&&(c=d*l,u+=(o.width-c)/2);break;case lB:if(l){if(x.y<=0&&(h<=m||p>=_)){v=!1;break}b(aB),d-=x.y,h+=x.y,c=d*l}else b(aB),b(rB),x.x>=0?p<_?c+=x.x:x.y<=0&&h<=m&&(v=!1):c+=x.x,x.y<=0?h>m&&(d-=x.y,h+=x.y):(d-=x.y,h+=x.y);c<0&&d<0?(a=cB,h-=d=-d,u-=c=-c):c<0?(a=uB,u-=c=-c):d<0&&(a=hB,h-=d=-d);break;case uB:if(l){if(x.y<=0&&(h<=m||u<=g)){v=!1;break}b(aB),d-=x.y,h+=x.y,c=d*l,u+=o.width-c}else b(aB),b(oB),x.x<=0?u>g?(c-=x.x,u+=x.x):x.y<=0&&h<=m&&(v=!1):(c-=x.x,u+=x.x),x.y<=0?h>m&&(d-=x.y,h+=x.y):(d-=x.y,h+=x.y);c<0&&d<0?(a=hB,h-=d=-d,u-=c=-c):c<0?(a=lB,u-=c=-c):d<0&&(a=cB,h-=d=-d);break;case cB:if(l){if(x.x<=0&&(u<=g||f>=y)){v=!1;break}b(oB),c-=x.x,u+=x.x,d=c/l}else b(sB),b(oB),x.x<=0?u>g?(c-=x.x,u+=x.x):x.y>=0&&f>=y&&(v=!1):(c-=x.x,u+=x.x),x.y>=0?f<y&&(d+=x.y):d+=x.y;c<0&&d<0?(a=lB,h-=d=-d,u-=c=-c):c<0?(a=hB,u-=c=-c):d<0&&(a=uB,h-=d=-d);break;case hB:if(l){if(x.x>=0&&(p>=_||f>=y)){v=!1;break}b(rB),d=(c+=x.x)/l}else b(sB),b(rB),x.x>=0?p<_?c+=x.x:x.y>=0&&f>=y&&(v=!1):c+=x.x,x.y>=0?f<y&&(d+=x.y):d+=x.y;c<0&&d<0?(a=uB,h-=d=-d,u-=c=-c):c<0?(a=cB,u-=c=-c):d<0&&(a=lB,h-=d=-d);break;case nB:this.move(x.x,x.y),v=!1;break;case iB:this.zoom(function(t){var e=Vz({},t),n=0;return JB(t,(function(t,i){delete e[i],JB(e,(function(e){var i=Math.abs(t.startX-e.startX),r=Math.abs(t.startY-e.startY),o=Math.abs(t.endX-e.endX),s=Math.abs(t.endY-e.endY),a=Math.sqrt(i*i+r*r),l=(Math.sqrt(o*o+s*s)-a)/a;Math.abs(l)>Math.abs(n)&&(n=l)}))})),n}(s),t),v=!1;break;case eB:if(!x.x||!x.y){v=!1;break}e=mj(this.cropper),u=w.startX-e.left,h=w.startY-e.top,c=o.minWidth,d=o.minHeight,x.x>0?a=x.y>0?hB:lB:x.x<0&&(u-=c,a=x.y>0?cB:uB),x.y<0&&(h-=d),this.cropped||(oj(this.cropBox,fB),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}v&&(o.width=c,o.height=d,o.left=u,o.top=h,this.action=a,this.renderCropBox()),JB(s,(function(t){t.startX=t.endX,t.startY=t.endY}))}},Lj={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&rj(this.dragBox,_B),oj(this.cropBox,fB),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=QB({},this.initialImageData),this.canvasData=QB({},this.initialCanvasData),this.cropBoxData=QB({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(QB(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),oj(this.dragBox,_B),rj(this.cropBox,fB)),this},replace:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,JB(this.previews,(function(e){e.getElementsByTagName("img")[0].src=t})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,oj(this.cropper,pB)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,rj(this.cropper,pB)),this},destroy:function(){var t=this.element;return t[Qz]?(t[Qz]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.canvasData,i=n.left,r=n.top;return this.moveTo(XB(t)?t:i+Number(t),XB(e)?e:r+Number(e))},moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.canvasData,i=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(HB(t)&&(n.left=t,i=!0),HB(e)&&(n.top=e,i=!0),i&&this.renderCanvas(!0)),this},zoom:function(t,e){var n=this.canvasData;return t=(t=Number(t))<0?1/(1-t):1+t,this.zoomTo(n.width*t/n.naturalWidth,null,e)},zoomTo:function(t,e,n){var i=this.options,r=this.canvasData,o=r.width,s=r.height,a=r.naturalWidth,l=r.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&i.zoomable){var u=a*t,h=l*t;if(!1===gj(this.element,FB,{ratio:t,oldRatio:o/a,originalEvent:n}))return this;if(n){var c=this.pointers,d=mj(this.cropper),p=c&&Object.keys(c).length?function(t){var e=0,n=0,i=0;return JB(t,(function(t){var r=t.startX,o=t.startY;e+=r,n+=o,i+=1})),{pageX:e/=i,pageY:n/=i}}(c):{pageX:n.pageX,pageY:n.pageY};r.left-=(u-o)*((p.pageX-d.left-r.left)/o),r.top-=(h-s)*((p.pageY-d.top-r.top)/s)}else YB(e)&&HB(e.x)&&HB(e.y)?(r.left-=(u-o)*((e.x-r.left)/o),r.top-=(h-s)*((e.y-r.top)/s)):(r.left-=(u-o)/2,r.top-=(h-s)/2);r.width=u,r.height=h,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return HB(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,HB(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(HB(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.imageData,i=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(HB(t)&&(n.scaleX=t,i=!0),HB(e)&&(n.scaleY=e,i=!0),i&&this.renderCanvas(!0,!0)),this},getData:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.options,i=this.imageData,r=this.canvasData,o=this.cropBoxData;if(this.ready&&this.cropped){t={x:o.left-r.left,y:o.top-r.top,width:o.width,height:o.height};var s=i.width/i.naturalWidth;if(JB(t,(function(e,n){t[n]=e/s})),e){var a=Math.round(t.y+t.height),l=Math.round(t.x+t.width);t.x=Math.round(t.x),t.y=Math.round(t.y),t.width=l-t.x,t.height=a-t.y}}else t={x:0,y:0,width:0,height:0};return n.rotatable&&(t.rotate=i.rotate||0),n.scalable&&(t.scaleX=i.scaleX||1,t.scaleY=i.scaleY||1),t},setData:function(t){var e=this.options,n=this.imageData,i=this.canvasData,r={};if(this.ready&&!this.disabled&&YB(t)){var o=!1;e.rotatable&&HB(t.rotate)&&t.rotate!==n.rotate&&(n.rotate=t.rotate,o=!0),e.scalable&&(HB(t.scaleX)&&t.scaleX!==n.scaleX&&(n.scaleX=t.scaleX,o=!0),HB(t.scaleY)&&t.scaleY!==n.scaleY&&(n.scaleY=t.scaleY,o=!0)),o&&this.renderCanvas(!0,!0);var s=n.width/n.naturalWidth;HB(t.x)&&(r.left=t.x*s+i.left),HB(t.y)&&(r.top=t.y*s+i.top),HB(t.width)&&(r.width=t.width*s),HB(t.height)&&(r.height=t.height*s),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?QB({},this.containerData):{}},getImageData:function(){return this.sized?QB({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&JB(["left","top","width","height","naturalWidth","naturalHeight"],(function(n){e[n]=t[n]})),e},setCanvasData:function(t){var e=this.canvasData,n=e.aspectRatio;return this.ready&&!this.disabled&&YB(t)&&(HB(t.left)&&(e.left=t.left),HB(t.top)&&(e.top=t.top),HB(t.width)?(e.width=t.width,e.height=t.width/n):HB(t.height)&&(e.height=t.height,e.width=t.height*n),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,e=this.cropBoxData;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,n,i=this.cropBoxData,r=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&YB(t)&&(HB(t.left)&&(i.left=t.left),HB(t.top)&&(i.top=t.top),HB(t.width)&&t.width!==i.width&&(e=!0,i.width=t.width),HB(t.height)&&t.height!==i.height&&(n=!0,i.height=t.height),r&&(e?i.height=i.width/r:n&&(i.width=i.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,n=function(t,e,n,i){var r=e.aspectRatio,o=e.naturalWidth,s=e.naturalHeight,a=e.rotate,l=void 0===a?0:a,u=e.scaleX,h=void 0===u?1:u,c=e.scaleY,d=void 0===c?1:c,p=n.aspectRatio,f=n.naturalWidth,g=n.naturalHeight,m=i.fillColor,_=void 0===m?"transparent":m,y=i.imageSmoothingEnabled,v=void 0===y||y,w=i.imageSmoothingQuality,x=void 0===w?"low":w,b=i.maxWidth,C=void 0===b?1/0:b,S=i.maxHeight,E=void 0===S?1/0:S,I=i.minWidth,P=void 0===I?0:I,T=i.minHeight,k=void 0===T?0:T,D=document.createElement("canvas"),M=D.getContext("2d"),L=Cj({aspectRatio:p,width:C,height:E}),R=Cj({aspectRatio:p,width:P,height:k},"cover"),O=Math.min(L.width,Math.max(R.width,f)),F=Math.min(L.height,Math.max(R.height,g)),A=Cj({aspectRatio:r,width:C,height:E}),z=Cj({aspectRatio:r,width:P,height:k},"cover"),B=Math.min(A.width,Math.max(z.width,o)),j=Math.min(A.height,Math.max(z.height,s)),G=[-B/2,-j/2,B,j];return D.width=ej(O),D.height=ej(F),M.fillStyle=_,M.fillRect(0,0,O,F),M.save(),M.translate(O/2,F/2),M.rotate(l*Math.PI/180),M.scale(h,d),M.imageSmoothingEnabled=v,M.imageSmoothingQuality=x,M.drawImage.apply(M,[t].concat($z(G.map((function(t){return Math.floor(ej(t))}))))),M.restore(),D}(this.image,this.imageData,e,t);if(!this.cropped)return n;var i=this.getData(t.rounded),r=i.x,o=i.y,s=i.width,a=i.height,l=n.width/Math.floor(e.naturalWidth);1!==l&&(r*=l,o*=l,s*=l,a*=l);var u=s/a,h=Cj({aspectRatio:u,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),c=Cj({aspectRatio:u,width:t.minWidth||0,height:t.minHeight||0},"cover"),d=Cj({aspectRatio:u,width:t.width||(1!==l?n.width:s),height:t.height||(1!==l?n.height:a)}),p=d.width,f=d.height;p=Math.min(h.width,Math.max(c.width,p)),f=Math.min(h.height,Math.max(c.height,f));var g=document.createElement("canvas"),m=g.getContext("2d");g.width=ej(p),g.height=ej(f),m.fillStyle=t.fillColor||"transparent",m.fillRect(0,0,p,f);var _=t.imageSmoothingEnabled,y=void 0===_||_,v=t.imageSmoothingQuality;m.imageSmoothingEnabled=y,v&&(m.imageSmoothingQuality=v);var w,x,b,C,S,E,I=n.width,P=n.height,T=r,k=o;T<=-s||T>I?(T=0,w=0,b=0,S=0):T<=0?(b=-T,T=0,S=w=Math.min(I,s+T)):T<=I&&(b=0,S=w=Math.min(s,I-T)),w<=0||k<=-a||k>P?(k=0,x=0,C=0,E=0):k<=0?(C=-k,k=0,E=x=Math.min(P,a+k)):k<=P&&(C=0,E=x=Math.min(a,P-k));var D=[T,k,w,x];if(S>0&&E>0){var M=p/s;D.push(b*M,C*M,S*M,E*M)}return m.drawImage.apply(m,[n].concat($z(D.map((function(t){return Math.floor(ej(t))}))))),g},setAspectRatio:function(t){var e=this.options;return this.disabled||XB(t)||(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,n=this.dragBox,i=this.face;if(this.ready&&!this.disabled){var r=t===xB,o=e.movable&&t===bB;t=r||o?t:CB,e.dragMode=t,hj(n,vB,t),sj(n,dB,r),sj(n,yB,o),e.cropBoxMovable||(hj(i,vB,t),sj(i,dB,r),sj(i,yB,o))}return this}},Rj=Zz.Cropper,Oj=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e||!GB.test(e.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=e,this.options=QB({},NB,YB(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return e=t,i=[{key:"noConflict",value:function(){return window.Cropper=Rj,t}},{key:"setDefaults",value:function(t){QB(NB,YB(t)&&t)}}],(n=[{key:"init",value:function(){var t,e=this.element,n=e.tagName.toLowerCase();if(!e[Qz]){if(e[Qz]=this,"img"===n){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===n&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}},{key:"load",value:function(t){var e=this;if(t){this.url=t,this.imageData={};var n=this.element,i=this.options;if(i.rotatable||i.scalable||(i.checkOrientation=!1),i.checkOrientation&&window.ArrayBuffer)if(BB.test(t))jB.test(t)?this.read((r=t.replace(Ej,""),o=atob(r),s=new ArrayBuffer(o.length),JB(a=new Uint8Array(s),(function(t,e){a[e]=o.charCodeAt(e)})),s)):this.clone();else{var r,o,s,a,l=new XMLHttpRequest,u=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=u,l.onerror=u,l.ontimeout=u,l.onprogress=function(){l.getResponseHeader("content-type")!==AB&&l.abort()},l.onload=function(){e.read(l.response)},l.onloadend=function(){e.reloading=!1,e.xhr=null},i.checkCrossOrigin&&vj(t)&&n.crossOrigin&&(t=wj(t)),l.open("GET",t,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===n.crossOrigin,l.send()}else this.clone()}}},{key:"read",value:function(t){var e=this.options,n=this.imageData,i=Ij(t),r=0,o=1,s=1;if(i>1){this.url=function(t,e){for(var n=[],i=new Uint8Array(t);i.length>0;)n.push(Sj.apply(null,KB(i.subarray(0,8192)))),i=i.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(n.join("")))}(t,AB);var a=function(t){var e=0,n=1,i=1;switch(t){case 2:n=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90}return{rotate:e,scaleX:n,scaleY:i}}(i);r=a.rotate,o=a.scaleX,s=a.scaleY}e.rotatable&&(n.rotate=r),e.scalable&&(n.scaleX=o,n.scaleY=s),this.clone()}},{key:"clone",value:function(){var t=this.element,e=this.url,n=t.crossOrigin,i=e;this.options.checkCrossOrigin&&vj(e)&&(n||(n="anonymous"),i=wj(e)),this.crossOrigin=n,this.crossOriginUrl=i;var r=document.createElement("img");n&&(r.crossOrigin=n),r.src=i||e,r.alt=t.alt||"The image to crop",this.image=r,r.onload=this.start.bind(this),r.onerror=this.stop.bind(this),rj(r,gB),t.parentNode.insertBefore(r,t.nextSibling)}},{key:"start",value:function(){var t=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var n=Zz.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(Zz.navigator.userAgent),i=function(e,n){QB(t.imageData,{naturalWidth:e,naturalHeight:n,aspectRatio:e/n}),t.initialImageData=QB({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(!e.naturalWidth||n){var r=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=r,r.onload=function(){i(r.width,r.height),n||o.removeChild(r)},r.src=e.src,n||(r.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(r))}else i(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var t=this.element,e=this.options,n=this.image,i=t.parentNode,r=document.createElement("div");r.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var o=r.querySelector(".".concat(Qz,"-container")),s=o.querySelector(".".concat(Qz,"-canvas")),a=o.querySelector(".".concat(Qz,"-drag-box")),l=o.querySelector(".".concat(Qz,"-crop-box")),u=l.querySelector(".".concat(Qz,"-face"));this.container=i,this.cropper=o,this.canvas=s,this.dragBox=a,this.cropBox=l,this.viewBox=o.querySelector(".".concat(Qz,"-view-box")),this.face=u,s.appendChild(n),rj(t,fB),i.insertBefore(o,t.nextSibling),oj(n,gB),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,rj(l,fB),e.guides||rj(l.getElementsByClassName("".concat(Qz,"-dashed")),fB),e.center||rj(l.getElementsByClassName("".concat(Qz,"-center")),fB),e.background&&rj(o,"".concat(Qz,"-bg")),e.highlight||rj(u,mB),e.cropBoxMovable&&(rj(u,yB),hj(u,vB,tB)),e.cropBoxResizable||(rj(l.getElementsByClassName("".concat(Qz,"-line")),fB),rj(l.getElementsByClassName("".concat(Qz,"-point")),fB)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),qB(e.ready)&&fj(t,LB,e.ready,{once:!0}),gj(t,LB)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var t=this.cropper.parentNode;t&&t.removeChild(this.cropper),oj(this.element,fB)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&Xz(e.prototype,n),i&&Xz(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,i}();QB(Oj.prototype,Pj,Tj,kj,Dj,Mj,Lj);const Fj=(t=>(nt("data-v-b1cd5bba"),t=t(),it(),t))((()=>rt("div",{id:"main_map",class:"ol_map_container"},null,-1))),Aj={key:0,id:"crop_mask_map_img_box",class:"row_nw_center_center ol_crop_container"},zj=["src"],Bj={class:"row_nw_fs_center crop_act_box"},jj=Q(J({__name:"MapViewer",setup(t){const e=Vt(),{searchParas:n,setSearchParams:i,resetNormalSearchParams:u,setScrollFlagResult:h,setHoverSearchResult:c,setClickSearchResult:d,setViewSearchResult:g,clearViewSearchResult:m,setMapPopupClickAction:_}=C(),{labelDrawParas:v,setLabelDrawParams:w,resetLabelDrawNormalParams:x,resetLabelDrawParams:b}=Gz(),{systemConfig:T}=Ht(),{mapParas:k,setInfos:D,setInfoZoom:M,setDrawGeojson:L,setDrawAction:R,setIsCanDraw:O,setRegionAction:F}=S();let A=null;const z=window.devicePixelRatio?window.devicePixelRatio:2;let B,j=null;const G=ct(""),N=ct(!1);function V(){B&&(B.clear(),B.destroy(),B=null),R({action:""}),G.value="",N.value=!1}function H(){if(B){!function(t,e){if(!t)return;const n=document.createElement("a");n.style.display="none",n.href=t,n.setAttribute("download",e),document.body.appendChild(n),n.click(),document.body.removeChild(n)}(B.getCroppedCanvas().toDataURL(),"crop.png"),B.clear(),B.destroy(),B=null}R({action:""}),G.value="",N.value=!1}const W=()=>{setTimeout((()=>{if(A){let t=A.getLabelDrawGeojsonData();t&&t.features&&0===t.features.length&&(t=null),w("geojson",t)}}),500)},X=t=>(t,e)=>{W()};let U=Y();function $(){j=requestAnimationFrame((()=>{let t=A.getViewZoom().toFixed(2);M(t),$()}))}function Y(){return{[P.text]:{shape:r,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:!1,isShowLngLat:!1,isShowLabel:!1,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.point]:{shape:o,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.line]:{shape:a,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.curve]:{shape:a,isClear:!1,isFreehand:!0,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.square]:{shape:p,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.rect]:{shape:f,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.polygon]:{shape:s,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.circle]:{shape:l,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0},[P.geoCircle]:{shape:y,isClear:!1,isFreehand:!1,needModify:!0,once:!1,callback:X(P.point),isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0}}}return at((()=>{A=new Bz("main_map",st.t,z),A.addBgLayer(T.mapLayer,T.language),A.addMouseMoveInfoEvent(D),$()})),Wt((()=>{!function(){j&&cancelAnimationFrame(j);A&&A.destructor()}()})),ut([()=>T.mapLayer,()=>T.language],(()=>{lt((()=>{A&&A.addBgLayer(T.mapLayer,T.language)}))}),{deep:!0,immediate:!0}),ut((()=>k.headerAction),(()=>{A&&("location"==k.headerAction.type?A.setPosition(k.headerAction.longitude,k.headerAction.latitude):"zoom"==k.headerAction.type&&A.flyToZoom(k.headerAction.zoom))}),{deep:!0,immediate:!1}),ut((()=>k.isCanDraw),(()=>{!k.isCanDraw&&A&&A.cancelDrawShape()}),{deep:!0,immediate:!1}),ut((()=>k.drawActionFlag),(()=>{if(E.drawAction.useFor==I&&A)switch(A.destroyGeoDrawIns(),A.createLabelDrawIns(),E.drawAction.action){case P.text:case P.point:case P.line:case P.curve:case P.square:case P.rect:case P.polygon:case P.circle:case P.geoCircle:A.labelDrawShape(U[E.drawAction.action]);break;case P.clear:A.clearLabelDraw(),F({action:"clear"}),w("geojson",null);break;case P.exportGeojson:A.saveLabelDrawGeojsonData()||Xt({type:"warning",showClose:!0,offset:64,message:st.t("common.noDrawData")});break;case P.input:case P.uploadFile:case P.region:if(E.drawAction.geojson){const t=(t,e)=>{W(),"deleteEnd"==t&&F({action:"clear"})};let e=(t,e)=>{W()};E.drawAction.action==P.region&&(O(!1),e=t);const n={id:"label_geojson_"+Yt(10),data:E.drawAction.geojson,callback:e,shape:"",isClear:!1,isFreehand:!1,needModify:!0,once:!1,isShowSegments:T.drawGeo.isShowSeg,isShowLngLat:T.drawGeo.isShowLngLat,isShowLabel:T.drawGeo.isShowLabel,isShowTip:T.drawGeo.isShowTip,isShowAction:!0};A.addLabelDrawGeojsonData(n),R({action:""})}else A.cancelLabelDrawShape();break;case P.uploadImage:E.drawAction.geojson?(t=E.drawAction.geojson,new Promise(((e,n)=>{const i=new Image;i.src=t,i.onload=()=>{e({width:i.naturalWidth,height:i.naturalHeight})},i.onerror=function(){n({width:-1,height:-1})}}))).then((t=>{if(t.width>0){const e=(t,e)=>{W()},n={id:"label_image_"+Yt(10),data:"",image:{data:E.drawAction.geojson,width:t.width,height:t.height},callback:e,shape:f,isClear:!1,isFreehand:!1,needModify:!0,once:!1,isShowSegments:!1,isShowLngLat:!1,isShowLabel:!1,isShowTip:!1,isShowAction:!0};A.addLabelDrawImageData(n)}})).catch((t=>{})):A.cancelLabelDrawShape();break;case P.crop:B&&(B.clear(),B.destroy(),B=null),A&&(A.handle.once("rendercomplete",(function(){const t=document.createElement("canvas"),e=A.handle.getSize();t.width=e[0],t.height=e[1];const n=t.getContext("2d");Array.prototype.forEach.call(A.handle.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let i;n.globalAlpha=""===e?1:Number(e);const r=t.style.transform;i=r?r.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(n,i);const o=t.parentNode.style.backgroundColor;o&&(n.fillStyle=o,n.fillRect(0,0,t.width,t.height)),n.drawImage(t,0,0)}})),n.globalAlpha=1,n.setTransform(1,0,0,1,0,0);try{G.value=t.toDataURL("image/png",1),N.value=!0,lt((()=>{let t=null;if(N.value)t=document.getElementById("crop_mask_map_img");else{const e=A.handle.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer");e.length&&(t=e[e.length-1])}t?B=new Oj(t,{background:!1,ready:()=>{B&&B.crop()}}):(Xt({type:"warning",showClose:!0,offset:64,message:st.t("common.cropErrTip2")}),V())}))}catch(i){Xt({type:"warning",showClose:!0,offset:64,message:st.t("common.cropErrTip")}),V()}})),A.handle.renderSync())}var t}),{deep:!0,immediate:!1}),ut((()=>T.drawGeo),(()=>{U=Y(),A&&A.updateLableDrawLabelInfos(T.drawGeo.isShowSeg,T.drawGeo.isShowLngLat,T.drawGeo.isShowLabel,T.drawGeo.isShowTip)}),{deep:!0,immediate:!1}),ut([()=>e.name,()=>k.resetMapFlag],(()=>{R({action:""}),function(t=!0){A&&(A.clearGeoDraw(),A.clearLabelDraw(),F({action:"clear"}),m(),t&&A.flyToPositionAndZoom())}(!0)}),{deep:!0,immediate:!1}),(t,e)=>{const n=Lt("el-button");return tt(),et(St,null,[Fj,N.value?(tt(),et("div",Aj,[N.value?(tt(),et("img",{key:0,id:"crop_mask_map_img",src:G.value,crossorigin:"anonymous",class:"crop_mask_map_img_show"},null,8,zj)):It("",!0),rt("div",Bj,[xt(n,{type:"danger",icon:gt(Ut),circle:"",onClick:V},null,8,["icon"]),xt(n,{type:"success",icon:gt($t),circle:"",onClick:H},null,8,["icon"])])])):It("",!0)],64)}}}),[["__scopeId","data-v-b1cd5bba"]]),Gj={class:"wh_100vw_100vh"},Nj=J({__name:"dataCenterIndex",setup:t=>(t,e)=>{const n=Lt("router-view");return tt(),et("div",Gj,[xt(jj),xt(n)])}});export{Nj as default};
